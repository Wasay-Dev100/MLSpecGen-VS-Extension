[
  {
    "postURL": "https://stackoverflow.com/questions/40904979",
    "title": "",
    "question": "This question already has answers here:\nWhat does the 'b' character do in front of a string literal? (12 answers)\nClosed 8 years ago.\nDurng the test of TensorFlow r0.12(CPU) installed on Windows 10, I found that the printed string contant is always with an 'b' in the end. The print of python is normal. I cannot figure out the reason so came here for help. The code is as follows:\n\n>>>import tensorflow as tf\n>>>hello = tf.constant('Hello, TensorFlow!')\n>>>sess = tf.Session()\n>>>print(sess.run(hello))\nb'Hello, TensorFlow!'",
    "answer": "45\n\nUse sess.run(hello).decode() because it is a bytestring. decode method will return the string.\n\nYour print statement must look like\n\nprint(sess.run(hello).decode())",
    "mlApiName": "tf.io.decode_raw",
    "embedding": [
      1.5259675979614258,
      0.45635437965393066,
      -2.1246371269226074,
      -1.4553053379058838,
      1.3595073223114014,
      -0.38368552923202515,
      -0.023488664999604225,
      1.2980093955993652,
      -0.8321092128753662,
      -1.655609369277954,
      -1.0520391464233398,
      1.4931437969207764,
      0.22077897191047668,
      -0.354032427072525,
      0.5119945406913757,
      -0.2643173933029175,
      1.0427910089492798,
      -0.4698067605495453,
      0.5279850363731384,
      0.23072493076324463,
      -0.552047073841095,
      1.0110522508621216,
      0.10564780235290527,
      0.40263858437538147,
      1.4172906875610352,
      0.33008185029029846,
      -0.16597600281238556,
      0.719023585319519,
      -0.5929461717605591,
      -0.35304880142211914,
      0.3203751742839813,
      1.0784313678741455,
      0.4354766011238098,
      -0.28702452778816223,
      -0.9557334780693054,
      -1.4290266036987305,
      1.093205451965332,
      0.322214275598526,
      0.2909741699695587,
      0.3637787401676178,
      0.822727382183075,
      0.37326425313949585,
      -0.05424189567565918,
      0.29489850997924805,
      1.4132323265075684,
      -0.9746764302253723,
      -0.09506013989448547,
      0.9184821844100952,
      0.7213965058326721,
      -1.4728561639785767,
      0.5541315674781799,
      -0.11141888052225113,
      0.4667873978614807,
      0.3032333552837372,
      1.1716463565826416,
      1.1426934003829956,
      -0.25693565607070923,
      -0.17652608454227448,
      -0.34621283411979675,
      0.2481953203678131,
      0.627657413482666,
      1.4959880113601685,
      -1.4140461683273315,
      1.1542847156524658,
      0.8980976343154907,
      -0.633037269115448,
      -0.8714072704315186,
      0.8523253202438354,
      0.4319263696670532,
      0.0628504529595375,
      1.2109124660491943,
      -0.4318143129348755,
      -0.24992766976356506,
      0.6343710422515869,
      -0.7158586382865906,
      -0.3540281653404236,
      -1.0525243282318115,
      -0.7292910218238831,
      -0.9593526124954224,
      1.2881656885147095,
      -0.9218936562538147,
      -0.9296818375587463,
      0.02048495225608349,
      -0.1853882372379303,
      -0.03220473974943161,
      -0.5379170179367065,
      -0.5582730770111084,
      0.036500636488199234,
      -0.8084759712219238,
      1.5141671895980835,
      0.06955614686012268,
      -0.19053687155246735,
      0.5521827340126038,
      0.2274152785539627,
      -0.5653590559959412,
      0.2937454283237457,
      -0.5713947415351868,
      0.7975181937217712,
      -0.2832808792591095,
      -1.0419284105300903,
      0.18940967321395874,
      0.5922650098800659,
      -0.11637111008167267,
      -0.5671740174293518,
      1.1386208534240723,
      0.6230725049972534,
      0.5988636612892151,
      -0.2651421129703522,
      -0.5793424844741821,
      -0.4658859074115753,
      -0.3615620732307434,
      1.1827585697174072,
      -0.8933806419372559,
      -0.3119446337223053,
      0.7311261892318726,
      -0.24419890344142914,
      0.14770103991031647,
      -0.9797139763832092,
      -0.7773701548576355,
      0.9509698152542114,
      -1.0324674844741821,
      -1.354430079460144,
      0.3204349875450134,
      0.22854165732860565,
      -0.0099250553175807,
      0.34237828850746155,
      -0.11835480481386185,
      -0.03777902200818062,
      0.46864160895347595,
      -1.1611329317092896,
      -0.07899294793605804,
      0.22325627505779266,
      -0.4660198390483856,
      0.5302062034606934,
      0.2884664237499237,
      1.0712443590164185,
      0.019184863194823265,
      0.6543514728546143,
      0.4370061457157135,
      0.18037809431552887,
      0.28719738125801086,
      0.09378259629011154,
      0.13311678171157837,
      -0.7958186268806458,
      0.15564711391925812,
      -1.4786417484283447,
      0.08541297167539597,
      -0.5089269876480103,
      0.3862355351448059,
      0.5557758808135986,
      0.13980023562908173,
      0.6998422145843506,
      -0.10616492480039597,
      0.5410874485969543,
      0.8181753158569336,
      0.18184705078601837,
      1.27627694606781,
      0.236646369099617,
      0.2717491686344147,
      0.5739118456840515,
      0.7873502373695374,
      0.1707325130701065,
      -0.738780677318573,
      1.1893806457519531,
      -0.2839420735836029,
      -1.3428834676742554,
      0.24949859082698822,
      0.18909065425395966,
      0.5714089870452881,
      -0.011120683513581753,
      -1.4804112911224365,
      0.15332886576652527,
      -0.10089627653360367,
      0.21111126244068146,
      -0.7691090703010559,
      0.8197818398475647,
      0.3450305461883545,
      -0.69654381275177,
      0.18468861281871796,
      0.021683624014258385,
      0.10655836760997772,
      -0.1478128880262375,
      1.1510246992111206,
      -0.10980580747127533,
      0.4460442066192627,
      -0.25321099162101746,
      -0.7062250375747681,
      0.5190499424934387,
      -0.29637718200683594,
      0.1596437245607376,
      0.13147848844528198,
      0.4143294394016266,
      -1.2614918947219849,
      -0.3493158221244812,
      -1.105222463607788,
      -0.9601513147354126,
      0.07803251594305038,
      0.26249805092811584,
      0.98253333568573,
      0.1318577527999878,
      -0.4134008586406708,
      -0.13088276982307434,
      -0.27177369594573975,
      -0.43546974658966064,
      -1.1561425924301147,
      0.6633832454681396,
      -1.0489388704299927,
      0.3104926347732544,
      -1.0576461553573608,
      0.8768306970596313,
      0.7337833046913147,
      0.265468567609787,
      -0.7106188535690308,
      0.6685245037078857,
      -0.5159422755241394,
      -0.9464365243911743,
      0.009394713677465916,
      -0.3975996673107147,
      -1.2957552671432495,
      0.49907928705215454,
      0.4227670431137085,
      -0.5305262207984924,
      0.6699621677398682,
      -0.09480994939804077,
      0.6781883835792542,
      0.5919567346572876,
      -0.4018203020095825,
      0.1469382345676422,
      -0.7616956233978271,
      0.2547798752784729,
      0.0704713761806488,
      -1.7288155555725098,
      0.498505562543869,
      0.45900434255599976,
      0.2827616035938263,
      0.012935351580381393,
      0.6145170331001282,
      0.8338693380355835,
      0.6856942772865295,
      0.8482111692428589,
      0.0034254775382578373,
      0.1173132061958313,
      -0.16250719130039215,
      0.3064492344856262,
      0.05827236920595169,
      0.6113725900650024,
      -0.04763063043355942,
      -1.1016416549682617,
      -0.6169707179069519,
      -0.2635621428489685,
      -0.14180132746696472,
      -0.26806747913360596,
      0.2698674201965332,
      1.1633470058441162,
      0.91108638048172,
      0.04803472012281418,
      -0.27985888719558716,
      0.024905750527977943,
      -0.0760062038898468,
      -0.6489836573600769,
      -0.35184672474861145,
      -0.3052579462528229,
      1.2773548364639282,
      -0.17959611117839813,
      -1.0125181674957275,
      -0.2573234438896179,
      -0.654382050037384,
      0.08884255588054657,
      -0.270990252494812,
      -0.07509143650531769,
      0.5864404439926147,
      1.2421457767486572,
      -0.1604783833026886,
      -0.4696967899799347,
      -0.4297144114971161,
      0.3529432415962219,
      0.4375555217266083,
      -0.5116167068481445,
      -0.37167760729789734,
      0.28209149837493896,
      -0.41913992166519165,
      -0.1459815502166748,
      -0.19385668635368347,
      0.4184078872203827,
      -0.7088988423347473,
      0.059176549315452576,
      -0.82366943359375,
      -0.5295591354370117,
      -0.38466373085975647,
      -0.05161695182323456,
      0.04141530767083168,
      0.3394019305706024,
      0.15461954474449158,
      0.6553824543952942,
      0.050380367785692215,
      1.246092677116394,
      1.0472590923309326,
      0.6301027536392212,
      -0.7130597829818726,
      -0.5302379131317139,
      -0.11368902772665024,
      0.6726618409156799,
      0.6606876254081726,
      0.5699943900108337,
      -0.8880033493041992,
      0.1121843084692955,
      -0.14221657812595367,
      -0.23996314406394958,
      0.14709313213825226,
      0.02921140193939209,
      -0.6082592010498047,
      0.7429085373878479,
      -0.09765307605266571,
      0.6105958819389343,
      -0.6811254620552063,
      0.6310539841651917,
      0.04958738759160042,
      0.3007127642631531,
      1.097206473350525,
      -0.2984905540943146,
      -0.28593161702156067,
      -0.429409921169281,
      0.8725569248199463,
      -0.5221459269523621,
      0.0031681531108915806,
      -0.22277264297008514,
      -0.6259233951568604,
      1.060531497001648,
      -0.38389843702316284,
      -1.4653040170669556,
      0.00635473383590579,
      0.7287449836730957,
      0.40602248907089233,
      0.11815892159938812,
      -0.9532989263534546,
      0.9223567247390747,
      -0.42573949694633484,
      0.6361930966377258,
      0.5865899324417114,
      -0.12889300286769867,
      0.8912372589111328,
      -0.11352112144231796,
      0.8278743028640747,
      0.2316073626279831,
      0.34029996395111084,
      0.34228119254112244,
      -0.33166199922561646,
      -0.7386612892150879,
      1.1748812198638916,
      0.6834760308265686,
      -0.7864616513252258,
      0.8052526712417603,
      -0.5092852711677551,
      0.17328454554080963,
      0.03026174195110798,
      0.7151975035667419,
      0.8876578211784363,
      0.2991192936897278,
      0.7949987649917603,
      -1.2180095911026,
      1.1511704921722412,
      0.054428886622190475,
      -0.38533830642700195,
      0.6398899555206299,
      0.050083741545677185,
      0.6022381782531738,
      0.9179792404174805,
      0.18653658032417297,
      0.5982472896575928,
      -0.3629600405693054,
      -0.525206446647644,
      -0.3936879336833954,
      0.5428518652915955,
      0.7988971471786499,
      0.21225295960903168,
      -0.2402486950159073,
      -1.3171151876449585,
      -0.4591430425643921,
      0.4081991910934448,
      0.5356470942497253,
      0.4197782278060913,
      -0.6290037035942078,
      0.028615951538085938,
      -0.13498178124427795,
      0.6512036919593811,
      -0.6572449803352356,
      1.0488641262054443,
      -1.3547619581222534,
      0.46138322353363037,
      0.5197696685791016,
      -0.6114004254341125,
      -0.6580489873886108,
      0.06201019510626793,
      -0.13750658929347992,
      0.631343424320221,
      -0.6644590497016907,
      0.8037810921669006,
      0.720940887928009,
      -1.1422288417816162,
      0.07742609083652496,
      -0.9981776475906372,
      -1.3992412090301514,
      0.5579143166542053,
      0.2838374078273773,
      -0.313351571559906,
      -0.5363194346427917,
      -0.5194722414016724,
      -0.41914206743240356,
      0.5768058896064758,
      0.318204790353775,
      0.23441098630428314,
      0.4048946797847748,
      -0.243777334690094,
      -1.1650630235671997,
      0.5710687041282654,
      -0.2668122351169586,
      1.1886528730392456,
      0.3394719660282135,
      -0.04173623397946358,
      -0.9533568024635315,
      0.8511640429496765,
      0.9939833879470825,
      -0.016594067215919495,
      0.6408360004425049,
      0.3922315239906311,
      0.21986214816570282,
      -0.026608074083924294,
      0.5543853044509888,
      0.019819924607872963,
      -1.0429998636245728,
      0.14229711890220642,
      0.32062503695487976,
      0.2983269691467285,
      0.2586292326450348,
      -1.0247290134429932,
      0.25104695558547974,
      -0.3814018964767456,
      0.9676668047904968,
      0.008478368632495403,
      1.0487457513809204,
      1.2943975925445557,
      -1.1287535429000854,
      -0.6001240015029907,
      -0.7303399443626404,
      0.7721681594848633,
      0.9960034489631653,
      1.44916570186615,
      -0.9014040231704712,
      -0.9130092263221741,
      0.37277454137802124,
      -0.5893576145172119,
      1.0015058517456055,
      0.14390401542186737,
      0.16095055639743805,
      1.8955669403076172,
      -0.9573491811752319,
      0.265596866607666,
      -0.3118705451488495,
      -0.3594285547733307,
      -0.43539687991142273,
      0.44031602144241333,
      -0.46448996663093567,
      -0.07218223810195923,
      0.7323086857795715,
      -0.4755697548389435,
      -0.3927111029624939,
      0.799067497253418,
      -0.711110532283783,
      1.019002079963684,
      0.9528458118438721,
      -1.257020115852356,
      0.2494824230670929,
      0.9761893153190613,
      -0.2710433602333069,
      -0.23620575666427612,
      0.5972836017608643,
      -0.19319167733192444,
      0.19001828134059906,
      -0.5427282452583313,
      0.9442716836929321,
      0.1163601204752922,
      -0.2988705337047577,
      -0.0941273421049118,
      -0.5234156250953674,
      -0.11841968446969986,
      0.9585471153259277,
      -0.3942508399486542,
      -0.20795853435993195,
      -0.5950036644935608,
      -0.706322431564331,
      0.25171640515327454,
      0.48354703187942505,
      0.31202614307403564,
      0.2099771499633789,
      -1.1277995109558105,
      -1.4658371210098267,
      0.16742463409900665,
      -0.11189313977956772,
      -0.29673925042152405,
      0.6558815240859985,
      -0.4100595712661743,
      -0.7648458480834961,
      -0.614722490310669,
      0.9730336666107178,
      0.4323973059654236,
      0.5512051582336426,
      -0.45073744654655457,
      -0.7484052777290344,
      -0.8703446984291077,
      0.26371142268180847,
      0.08641757071018219,
      -0.07336978614330292,
      0.020794352516531944,
      -0.2449851632118225,
      1.7680408954620361,
      -0.7046576142311096,
      0.742513120174408,
      -0.17785091698169708,
      -1.4560670852661133,
      -0.5344712138175964,
      0.28383201360702515,
      -0.28495311737060547,
      -0.6146042943000793,
      -0.6113559603691101,
      -0.03747493773698807,
      -0.2025475949048996,
      -0.32960882782936096,
      -0.8742673993110657,
      -0.2544524371623993,
      1.0547326803207397,
      -0.23471036553382874,
      -0.0264590997248888,
      -0.09094171226024628,
      0.11407248675823212,
      0.29582980275154114,
      -0.14263175427913666,
      0.9521462917327881,
      0.19950370490550995,
      0.014268879778683186,
      0.7363377213478088,
      0.17849548161029816,
      0.962662398815155,
      -0.705220103263855,
      0.44156304001808167,
      -0.5412670969963074,
      -0.4235091507434845,
      0.4361012578010559,
      0.05152178928256035,
      0.05212099850177765,
      -2.2062973976135254,
      0.31046462059020996,
      -0.6375593543052673,
      0.2540817856788635,
      -0.5890840291976929,
      0.9120890498161316,
      -0.40770581364631653,
      -1.1068497896194458,
      -0.20791222155094147,
      -0.31882941722869873,
      -1.3602392673492432,
      -0.584065854549408,
      -0.2047835886478424,
      -0.12451144307851791,
      0.5870222449302673,
      0.6341421604156494,
      -0.5396440625190735,
      0.1013035699725151,
      -0.2315610647201538,
      -0.21447642147541046,
      -0.13705477118492126,
      -0.5062107443809509,
      -1.0813705921173096,
      -0.3284004330635071,
      -0.14806824922561646,
      -0.1870114654302597,
      0.28983187675476074,
      -0.33480262756347656,
      0.0832090675830841,
      -0.8860798478126526,
      -0.601019561290741,
      0.32866233587265015,
      -0.8594486117362976,
      0.4143363833427429,
      1.089666485786438,
      -0.173831045627594,
      0.29389846324920654,
      -0.4160981774330139,
      -0.9760597348213196,
      1.064611792564392,
      0.05623583868145943,
      -0.10248434543609619,
      -0.03575146198272705,
      -0.5349369049072266,
      -0.240285262465477,
      0.37052595615386963,
      0.03832466900348663,
      -0.5419003367424011,
      0.12061286717653275,
      -0.5873252749443054,
      -1.1034190654754639,
      0.28582870960235596,
      0.8597586750984192,
      1.572418451309204,
      -1.370590090751648,
      -0.19350846111774445,
      0.4354955554008484,
      0.06818604469299316,
      0.281826913356781,
      0.04215899854898453,
      0.44373881816864014,
      0.7622815370559692,
      -0.009048793464899063,
      -0.5882102847099304,
      -0.298812597990036,
      0.3280898928642273,
      -0.9456135034561157,
      0.7354882955551147,
      1.0362988710403442,
      0.3066674470901489,
      -0.5187197923660278,
      0.22054186463356018,
      -0.7005186676979065,
      0.5802211761474609,
      -0.8435999155044556,
      1.0582822561264038,
      0.19022445380687714,
      0.4347347617149353,
      0.33261245489120483,
      0.31673771142959595,
      0.3134012520313263,
      -1.1034642457962036,
      0.8148252367973328,
      -1.2205933332443237,
      -0.9629060626029968,
      -1.0177329778671265,
      0.6619424223899841,
      -1.2550513744354248,
      0.6302803158760071,
      -0.3538680076599121,
      1.2679673433303833,
      0.43393802642822266,
      0.42115065455436707,
      0.9378254413604736,
      0.1848434954881668,
      -0.4794161915779114,
      0.7977604269981384,
      0.8971565961837769,
      0.48417186737060547,
      -0.2805917263031006,
      0.03188883885741234,
      1.1168774366378784,
      2.1478257179260254,
      -0.16870084404945374,
      1.0232027769088745,
      0.7925013303756714,
      -0.21140527725219727,
      0.619259774684906,
      -1.111768126487732,
      -1.2460554838180542,
      -1.2471680641174316,
      0.3524898588657379,
      -1.4091788530349731,
      -0.7873933911323547,
      -0.30836325883865356,
      0.7738063335418701,
      0.023085683584213257,
      -0.5783796310424805,
      -0.3486447036266327,
      -0.4523257613182068,
      -0.8727505207061768,
      0.07937633246183395,
      0.2621762156486511,
      -0.01724434457719326,
      -0.041824404150247574,
      0.8677873611450195,
      0.6969764828681946,
      0.7755854725837708,
      0.39986273646354675,
      0.22494660317897797,
      -0.3783462345600128,
      0.5450137853622437,
      0.095762699842453,
      -0.5015054941177368,
      -0.9206352829933167,
      0.18795624375343323,
      -0.07140255719423294,
      -0.23948273062705994,
      0.09399467706680298,
      -0.6956730484962463,
      -0.6167236566543579,
      0.3641093969345093,
      0.6728540062904358,
      -0.013284862972795963,
      -0.4755191206932068,
      0.006443095859140158,
      -0.04690581560134888,
      -0.4633978605270386,
      -0.30708351731300354,
      0.11689980328083038,
      0.47631165385246277,
      0.008398858830332756,
      -0.6849371194839478,
      -0.5955770611763,
      0.2919360399246216,
      0.9603012204170227,
      0.18650415539741516,
      0.12130814045667648,
      0.09610243141651154,
      -1.4541361331939697,
      -0.8466814160346985,
      -0.30720657110214233,
      0.2663789689540863,
      -0.29959291219711304,
      0.7420037388801575,
      0.29183149337768555,
      0.1355448216199875,
      -0.7872464060783386,
      -1.1581107378005981,
      -0.9005096554756165,
      -0.07898417115211487,
      -0.021448615938425064,
      0.02051854319870472,
      -1.0715687274932861,
      -0.2696319818496704,
      -1.0612198114395142,
      0.24471025168895721,
      0.12442401796579361,
      -0.7167413234710693,
      0.24606457352638245,
      0.4903058111667633,
      -0.3945753574371338,
      0.6111359596252441,
      0.045933302491903305,
      1.3772897720336914,
      -0.18436314165592194,
      0.39726364612579346,
      0.1864366978406906,
      -0.9953595399856567,
      -1.090233325958252,
      -0.6437020301818848,
      0.3468337953090668,
      0.2961760461330414,
      0.07654891908168793,
      0.19099849462509155,
      -0.8958618640899658,
      -0.16398683190345764,
      -1.115769624710083,
      1.1451339721679688,
      -0.3123360574245453,
      -0.692821204662323,
      0.4526950716972351,
      -0.9244938492774963,
      -0.48240870237350464,
      0.08469309657812119,
      -0.21478861570358276,
      -0.40521663427352905,
      -0.08352921158075333,
      1.0352994203567505,
      1.636273741722107,
      -0.15523749589920044,
      0.4016241431236267,
      -0.5250129103660583,
      -0.1396857351064682,
      -0.3382651209831238,
      -1.0801680088043213,
      -0.16527198255062103,
      -0.4539984166622162,
      -0.3269001245498657
    ],
    "label": {
      "level1": "SAM",
      "level2": "DT",
      "level3": "PT",
      "leafContractCategory": "PT",
      "rootCause": "Unacceptable Input Type",
      "effect": "IF",
      "mlLibrary": "TensorFlow",
      "contractViolationLocation": "Model Evaluation",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): SAM\nThe post addresses a violation involving the use of a single API method, specifically tf.io.decode_raw, which is the sole API causing the issue.\n\nLevel 2: DT\nThe core problem pertains to incorrect handling of data types�specifically, string literals versus byte strings�which TensorFlow expects.\n\nLevel 3 (Hybrid Patterns): PT\nThe issue is specifically caused by a primitive Python data type mismatch (string versus byte representation), leading to unexpected results.\n\nLeaf Contract Category: PT\nMatches the Level 3 categorization exactly, as the fundamental data type causing the problem is a primitive type.\n\nRoot Cause: Unacceptable Input Type\nThe TensorFlow API expects byte strings, but it receives regular string literals, resulting in the inappropriate input being passed.\n\nEffect: Incorrect Functionality\nAlthough the program does not crash, it produces incorrect output by appending an unintended character (b) to the printed result.\n\nML Library: TensorFlow\nTensorFlow's API method specifically triggered this data handling issue.\n\nContract Violation Location: Model Evaluation\nThis problem emerges clearly during the evaluation phase when results are printed after session execution.\n\nDetection Technique: Static Analysis\nThe issue can be identified through inspection of the source code without execution.\n"
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/45175469",
    "title": "",
    "question": "This is my convolution neural net:\n\ndef convolutional_neural_network(frame):\n    wts = {'conv1': tf.random_normal([5, 5, 3, 32]),\n            'conv2': tf.random_normal([5, 5, 32, 64]),\n            'fc': tf.random_normal([158*117*64 + 4, 128]),\n            'out': tf.random_normal([128, n_classes])\n            }\n    biases = {'fc': tf.random_normal([128]),\n                'out': tf.random_normal([n_classes])\n            }\n\n    conv1 = conv2d(frame, wts['conv1'])\n    # print(conv1)\n    conv1 = maxpool2d(conv1)\n    # print(conv1)\n    conv2 = conv2d(conv1, wts['conv2'])\n    conv2 = maxpool2d(conv2)\n    # print(conv2)\n    conv2 = tf.reshape(conv2, shape=[-1,158*117*64])\n    print(conv2)\n    print(controls_at_each_frame)\n    conv2 = tf.concat(conv2, controls_at_each_frame, axis=1)\n    fc = tf.add(tf.matmul(conv2, wts['fc']), biases['fc'])\n\n    output = tf.nn.relu(tf.add(tf.matmul(fc, wts['out']), biases['out']))\n\n    return output\nwhere\n\nframe = tf.placeholder('float', [None, 640-10, 465, 3])\ncontrols_at_each_frame = tf.placeholder('float', [None, 4]) # [w, a, s, d] (1/0)\nare the used placeholder.\n\nI am making a self driving car in GTA San Andreas. What I want to do is concatenate frame and controls_at_each_frame into a single layer which will be then sent to an fully connected layer. When I run I get an error TypeError: concat() got multiple values for argument 'axis' at\n\nconv2 = tf.concat(conv2, controls_at_each_frame, axis=1)\nCould you explain why this happening?",
    "answer": "50\n\nTry\n\nconv2 = tf.concat((conv2, controls_at_each_frame), axis=1).\n\nNote I'm putting the two frames that you want to concatenate within parentheses, as specified here.",
    "mlApiName": "tf.concat",
    "embedding": [
      0.500029444694519,
      1.5563424825668335,
      -2.1158831119537354,
      -1.9090222120285034,
      1.1812739372253418,
      -0.9806349277496338,
      0.7639613747596741,
      0.5764119625091553,
      -1.4955612421035767,
      -0.7102829217910767,
      -1.1192970275878906,
      0.10382799059152603,
      1.5552961826324463,
      0.3193519115447998,
      0.4325740933418274,
      -0.7074021697044373,
      0.18980075418949127,
      0.6027603149414062,
      -0.011583887971937656,
      0.25505366921424866,
      -0.5058490037918091,
      -0.5996317863464355,
      0.7173009514808655,
      0.14556801319122314,
      1.149817705154419,
      1.4665541648864746,
      -1.0101876258850098,
      0.09933265298604965,
      -0.6835356950759888,
      0.5541141033172607,
      0.9997332096099854,
      0.12159940600395203,
      -0.8127852082252502,
      -0.9508726596832275,
      -1.7186260223388672,
      -0.694597601890564,
      0.8804563283920288,
      -0.5456556081771851,
      0.07489372044801712,
      0.4183710813522339,
      0.7160527110099792,
      1.1226197481155396,
      -0.7166744470596313,
      -1.1605736017227173,
      0.057983189821243286,
      -0.5272624492645264,
      1.1853246688842773,
      0.12155351042747498,
      0.7064382433891296,
      -1.226464867591858,
      -0.08665145188570023,
      0.7722880840301514,
      -0.4117162823677063,
      0.08758904039859772,
      1.7833768129348755,
      0.016752969473600388,
      -0.804905891418457,
      0.7314452528953552,
      0.13791581988334656,
      -0.21021361649036407,
      0.8321132063865662,
      1.055100917816162,
      -0.9550462961196899,
      1.5662212371826172,
      0.8392528295516968,
      0.14237891137599945,
      -1.1839005947113037,
      1.3985273838043213,
      -0.10613633692264557,
      0.052737124264240265,
      0.14806075394153595,
      -0.08753257244825363,
      0.4458889961242676,
      0.7862669825553894,
      -0.47461745142936707,
      -0.10765983164310455,
      -0.06154922395944595,
      -0.8819643259048462,
      -0.6651491522789001,
      0.9268969893455505,
      -0.02071397379040718,
      -0.22734715044498444,
      0.97157883644104,
      0.05520680546760559,
      0.1349892020225525,
      0.436811625957489,
      -0.027186023071408272,
      -0.44319137930870056,
      -1.0525614023208618,
      1.39995539188385,
      0.10112319141626358,
      0.225265771150589,
      0.5777561664581299,
      0.73260897397995,
      -0.2081243395805359,
      -0.1852642297744751,
      -0.1629054695367813,
      0.38669613003730774,
      -0.2259407639503479,
      -0.2630387544631958,
      -0.6936116814613342,
      1.1911520957946777,
      -0.5933395624160767,
      -0.11040976643562317,
      0.3678012788295746,
      1.3030879497528076,
      0.49331650137901306,
      -0.04948053136467934,
      0.17517365515232086,
      -0.7783392071723938,
      -1.3430759906768799,
      0.34791672229766846,
      -0.5763781070709229,
      -0.2966902256011963,
      -0.4253460168838501,
      -0.41757693886756897,
      0.27428504824638367,
      -0.48356834053993225,
      0.05705514922738075,
      -0.07870575785636902,
      0.5286021828651428,
      -0.544335126876831,
      -0.39569324254989624,
      0.9888890981674194,
      -0.2327151596546173,
      0.9266566038131714,
      -0.5252962112426758,
      0.3487487733364105,
      -0.1877308338880539,
      -0.88422030210495,
      -0.41853752732276917,
      -0.2895803153514862,
      0.09197507798671722,
      0.2267196774482727,
      -0.037987761199474335,
      0.6482713222503662,
      -0.9624821543693542,
      -1.3382008075714111,
      0.19891752302646637,
      0.25149303674697876,
      0.18250182271003723,
      -0.26360976696014404,
      -0.09055297821760178,
      -1.330751657485962,
      0.34851258993148804,
      -1.6812925338745117,
      0.12661443650722504,
      -0.6396282315254211,
      -0.3867272734642029,
      -0.8513749837875366,
      -0.012671113014221191,
      0.2725633382797241,
      -0.7485156059265137,
      -0.07475046068429947,
      0.9775261282920837,
      -0.053256403654813766,
      0.3920617997646332,
      -0.18153510987758636,
      0.329103946685791,
      0.27469533681869507,
      0.9465819001197815,
      0.2704108655452728,
      -0.5207250714302063,
      -0.07705710083246231,
      -0.42124608159065247,
      -0.2973732054233551,
      0.4767608046531677,
      0.7396681904792786,
      0.09271453320980072,
      -0.11778674274682999,
      -0.9292106032371521,
      -0.1903722733259201,
      -0.9638461470603943,
      -0.4178374111652374,
      -0.017958467826247215,
      0.5468690991401672,
      0.7584958672523499,
      -0.7614415884017944,
      -0.342300683259964,
      0.6254368424415588,
      0.9327596426010132,
      0.26308298110961914,
      0.3598164916038513,
      0.24623392522335052,
      0.03651875630021095,
      0.29039934277534485,
      -0.603661298751831,
      -0.015911037102341652,
      -0.4471450746059418,
      -0.40255340933799744,
      0.5496149063110352,
      -0.026150772348046303,
      -0.6027278900146484,
      -0.3022249639034271,
      -0.7858423590660095,
      -0.03939933702349663,
      0.7368322014808655,
      -0.506409227848053,
      0.426533043384552,
      -0.21277107298374176,
      -1.011413335800171,
      -0.954458475112915,
      -0.4333212077617645,
      0.7870965003967285,
      -1.4010356664657593,
      0.5357111692428589,
      -0.9869965314865112,
      1.21900475025177,
      -0.7338680624961853,
      0.8741018772125244,
      0.38940495252609253,
      -0.5714284777641296,
      -0.2577725648880005,
      0.3448093831539154,
      -0.693824052810669,
      -0.46048131585121155,
      0.706301748752594,
      -0.763129711151123,
      -1.2738659381866455,
      0.46404722332954407,
      0.5572589039802551,
      -0.7454721927642822,
      1.175402045249939,
      -0.14471130073070526,
      0.864592432975769,
      -0.3996976912021637,
      0.34767061471939087,
      -0.4748862385749817,
      -0.42377713322639465,
      0.6128599047660828,
      -0.5800211429595947,
      -0.6314634084701538,
      1.2730231285095215,
      -0.03449413552880287,
      0.31554359197616577,
      1.1345622539520264,
      0.731178343296051,
      0.5925784707069397,
      -0.45344221591949463,
      0.4980749487876892,
      -0.05312017351388931,
      0.7162520289421082,
      -0.09475748986005783,
      -0.23947124183177948,
      -0.6771284937858582,
      -0.3118811249732971,
      -0.08686397969722748,
      -0.9173049926757812,
      0.24286049604415894,
      0.33606839179992676,
      -0.16174615919589996,
      -0.12876123189926147,
      -0.08996137231588364,
      0.423692524433136,
      0.45207279920578003,
      -0.3609694838523865,
      -0.25217458605766296,
      0.26253411173820496,
      -0.46186891198158264,
      -0.25631389021873474,
      -0.22341583669185638,
      0.2676424980163574,
      0.42731770873069763,
      -0.22133925557136536,
      -0.5330052971839905,
      -1.2586400508880615,
      -0.24726073443889618,
      -0.3331274092197418,
      0.161391481757164,
      -0.6242086291313171,
      0.11393304914236069,
      0.5764893889427185,
      0.5366945862770081,
      -0.06796354800462723,
      0.3373674154281616,
      0.7946621179580688,
      -0.2590333819389343,
      -1.4797322750091553,
      -0.1804509162902832,
      -0.4927968978881836,
      -0.8611548542976379,
      0.016384704038500786,
      0.2021780014038086,
      -0.6616307497024536,
      -0.08682800829410553,
      -0.10156690329313278,
      0.0837155133485794,
      0.3128482401371002,
      0.8206658959388733,
      0.13036146759986877,
      0.347248375415802,
      1.1111220121383667,
      -0.3758160471916199,
      0.037323806434869766,
      0.7959886789321899,
      0.18801823258399963,
      0.8252692818641663,
      -0.44683268666267395,
      0.09652534872293472,
      -0.6038708686828613,
      -0.3351359963417053,
      1.7236887216567993,
      0.8966047167778015,
      0.6325702667236328,
      0.6254644393920898,
      -0.11673226952552795,
      0.5031597018241882,
      0.08394280076026917,
      0.09162066131830215,
      -0.0452728196978569,
      -0.685285210609436,
      -0.5613738298416138,
      0.5531229972839355,
      -0.24031083285808563,
      0.28095051646232605,
      0.6053813695907593,
      0.9557363390922546,
      0.2019582837820053,
      0.690425455570221,
      -0.4069617688655853,
      -0.21412800252437592,
      -0.5101597309112549,
      -0.5122302174568176,
      -0.3612219989299774,
      -0.04338185116648674,
      1.1165117025375366,
      -0.29601284861564636,
      0.3217563033103943,
      0.5633897185325623,
      -1.0219335556030273,
      0.5232182145118713,
      -0.23460151255130768,
      0.7798663973808289,
      -0.4956221580505371,
      -0.12963475286960602,
      0.04479362070560455,
      -0.3050853908061981,
      0.46338000893592834,
      0.36081022024154663,
      1.2260175943374634,
      -0.8241434693336487,
      -0.054327573627233505,
      0.4449877142906189,
      -1.0381324291229248,
      -0.16825023293495178,
      0.8675696849822998,
      -0.8570533394813538,
      0.056675925850868225,
      0.8226261734962463,
      0.4836023449897766,
      -0.5438329577445984,
      -0.26545050740242004,
      0.14361120760440826,
      -0.26805272698402405,
      -0.0019943113438785076,
      0.4382167458534241,
      0.44659721851348877,
      0.26863330602645874,
      0.005965865682810545,
      0.7798111438751221,
      0.9929364919662476,
      -0.5677796602249146,
      -0.22368605434894562,
      0.028402552008628845,
      0.16639885306358337,
      0.6565046906471252,
      1.306007742881775,
      0.7542984485626221,
      0.3796467185020447,
      -0.29593342542648315,
      -0.3487531840801239,
      -0.7911677360534668,
      -0.5367147922515869,
      0.2210688591003418,
      -0.07684164494276047,
      -0.10160722583532333,
      -0.6661475300788879,
      0.04646904021501541,
      -0.019363602623343468,
      0.16059932112693787,
      0.7778999209403992,
      -0.6510074138641357,
      -0.5150334239006042,
      0.446649432182312,
      0.40406861901283264,
      -0.056065842509269714,
      0.6479376554489136,
      -0.5991771817207336,
      0.22176000475883484,
      0.7024372220039368,
      -0.39687472581863403,
      -0.5069783926010132,
      -0.9453458189964294,
      -0.6704070568084717,
      1.447625756263733,
      -0.4767468571662903,
      0.18896238505840302,
      -0.023546917364001274,
      0.24291062355041504,
      1.0641392469406128,
      -0.20479409396648407,
      -0.739523708820343,
      0.19573752582073212,
      -0.4307745099067688,
      -0.16828219592571259,
      -0.129306361079216,
      -0.26754000782966614,
      0.04033716768026352,
      0.04239128530025482,
      0.875822901725769,
      0.40418311953544617,
      1.1875258684158325,
      0.5404132604598999,
      -1.2236045598983765,
      1.5256749391555786,
      -0.1102335974574089,
      1.3412814140319824,
      0.6205188632011414,
      -0.48822638392448425,
      -1.223865032196045,
      -0.6551265120506287,
      1.660471796989441,
      -0.02398594841361046,
      0.38766226172447205,
      0.6937651634216309,
      0.582411527633667,
      -0.23976357281208038,
      0.8335332870483398,
      -0.02782609686255455,
      -0.8261544704437256,
      0.658984363079071,
      0.32491958141326904,
      0.26326897740364075,
      0.09410890191793442,
      -0.9922864437103271,
      0.08197107911109924,
      -0.6703620553016663,
      1.1938973665237427,
      0.36203673481941223,
      1.0007866621017456,
      0.44145163893699646,
      -1.2120269536972046,
      -0.6469110250473022,
      -1.2583072185516357,
      0.7070311307907104,
      1.1976494789123535,
      0.6014484763145447,
      -0.7071037888526917,
      -1.8131057024002075,
      1.1499360799789429,
      -0.42261162400245667,
      0.5602611303329468,
      0.22369322180747986,
      0.018330983817577362,
      1.5634584426879883,
      -0.40522655844688416,
      0.3657972812652588,
      -0.37210550904273987,
      0.21987123787403107,
      -0.4437231123447418,
      0.5929969549179077,
      0.8891357779502869,
      -1.1795629262924194,
      -0.5955482721328735,
      0.6041371822357178,
      -0.28306901454925537,
      0.1835343837738037,
      -0.7840463519096375,
      0.9229559302330017,
      0.2900495231151581,
      -0.5669382214546204,
      -0.01075443159788847,
      0.3354121446609497,
      0.01971738040447235,
      0.22468528151512146,
      0.2843092679977417,
      1.0471400022506714,
      0.5439288020133972,
      0.5530818700790405,
      0.9411319494247437,
      -0.18823105096817017,
      -0.9042032957077026,
      -0.033110227435827255,
      -1.0393421649932861,
      -0.3323086202144623,
      0.4994691014289856,
      -0.12370035797357559,
      -0.18190865218639374,
      0.2568463981151581,
      -0.20360828936100006,
      -0.35228708386421204,
      -0.7737956047058105,
      -0.33622094988822937,
      -0.12805360555648804,
      0.09186073392629623,
      -0.9784395694732666,
      -0.44040733575820923,
      -0.23113568127155304,
      0.7924707531929016,
      -0.7083917260169983,
      -0.5310800075531006,
      0.8211341500282288,
      -0.4987986087799072,
      0.12370199710130692,
      0.04067567363381386,
      -0.3207258880138397,
      0.4736112356185913,
      -1.0112041234970093,
      -0.29678282141685486,
      0.5406567454338074,
      0.13996900618076324,
      -0.035121917724609375,
      0.11394785344600677,
      -0.5291557312011719,
      0.6354336738586426,
      -1.251351237297058,
      0.9694735407829285,
      -0.7340440154075623,
      -0.7422729730606079,
      0.1501985490322113,
      0.7392454743385315,
      0.17542196810245514,
      -0.6182631850242615,
      -0.5977794528007507,
      -0.8591344952583313,
      0.27811187505722046,
      0.09409426152706146,
      -1.4452319145202637,
      0.5016701221466064,
      0.3118874132633209,
      -0.329975962638855,
      0.13083451986312866,
      -0.837375283241272,
      -0.14756932854652405,
      0.5745396614074707,
      0.2008945345878601,
      0.06397479772567749,
      0.04200443997979164,
      0.8827561736106873,
      0.3991580605506897,
      0.30250295996665955,
      0.43566903471946716,
      -0.7997455596923828,
      -0.041739292442798615,
      -0.33516672253608704,
      -0.30583620071411133,
      0.5535383820533752,
      0.7752629518508911,
      0.32022160291671753,
      -1.198431372642517,
      -0.021508321166038513,
      -1.4043879508972168,
      0.3716500401496887,
      -0.9345976710319519,
      1.146461009979248,
      -0.01196478120982647,
      -1.0053696632385254,
      -0.37335026264190674,
      -0.06299741566181183,
      -0.27083662152290344,
      -0.7744395136833191,
      0.35881131887435913,
      1.1905748844146729,
      0.22725903987884521,
      -0.8137797117233276,
      0.3535158336162567,
      -0.38897639513015747,
      0.6947328448295593,
      -0.02953687496483326,
      -0.23415116965770721,
      0.10814910382032394,
      -1.170259714126587,
      0.010945304296910763,
      -0.5075235366821289,
      0.27730855345726013,
      0.41702941060066223,
      0.9555289149284363,
      0.30022934079170227,
      -0.871048092842102,
      -1.3377524614334106,
      0.7618069648742676,
      -1.4241424798965454,
      -0.4193499684333801,
      0.4805007874965668,
      -0.32031309604644775,
      0.5377432703971863,
      -0.5450711846351624,
      -0.6289628148078918,
      0.1773425042629242,
      -0.21866358816623688,
      -0.15835022926330566,
      -0.27324774861335754,
      0.92057204246521,
      -0.6166688203811646,
      -0.2336777299642563,
      -0.7030743360519409,
      -0.3694216310977936,
      0.5713167786598206,
      -0.7343540191650391,
      -0.9771840572357178,
      0.7180453538894653,
      1.158416986465454,
      1.3409371376037598,
      -1.0128130912780762,
      -0.15412643551826477,
      1.341721773147583,
      -0.4942933917045593,
      0.016079731285572052,
      -1.0800285339355469,
      0.3185652494430542,
      0.21490062773227692,
      0.17046350240707397,
      0.04299159720540047,
      0.6285869479179382,
      0.0361924022436142,
      0.4167337417602539,
      0.5839730501174927,
      -0.3437707722187042,
      -0.11460553854703903,
      -0.03609120473265648,
      0.39904868602752686,
      -1.031304955482483,
      1.002657175064087,
      0.45826151967048645,
      0.37637004256248474,
      -0.17651495337486267,
      -0.4381136894226074,
      -0.303823858499527,
      0.7400686144828796,
      0.4143654704093933,
      -0.8906095027923584,
      0.6557816863059998,
      -0.674031674861908,
      -0.3491937220096588,
      -1.9191218614578247,
      0.999652624130249,
      -0.4203358292579651,
      1.0339841842651367,
      0.4426072835922241,
      0.852472186088562,
      0.29843518137931824,
      0.8871182799339294,
      -0.31239548325538635,
      0.1149156242609024,
      0.4682671129703522,
      -0.6753481030464172,
      0.9057866930961609,
      0.03940432146191597,
      -1.167746663093567,
      0.20606057345867157,
      0.9279706478118896,
      1.7593936920166016,
      -0.6106518507003784,
      0.57453852891922,
      -0.060080669820308685,
      -0.004908804781734943,
      0.13788637518882751,
      -0.39823031425476074,
      -0.9398267865180969,
      -0.21877987682819366,
      -0.8539746403694153,
      -0.6379019618034363,
      -0.8770849704742432,
      0.35627949237823486,
      0.4886408746242523,
      -0.39861154556274414,
      0.6579381823539734,
      -0.3686131536960602,
      -0.34195637702941895,
      -0.978869616985321,
      0.6906235218048096,
      -0.1722790151834488,
      -0.12610910832881927,
      0.8661913275718689,
      1.1109933853149414,
      -0.7877417802810669,
      0.31849896907806396,
      1.4159611463546753,
      0.6613611578941345,
      -0.083247609436512,
      0.882828950881958,
      0.8274484276771545,
      0.5497517585754395,
      -0.7782559990882874,
      0.18025167286396027,
      -1.164178490638733,
      0.2384471893310547,
      -0.45594489574432373,
      -0.5942848920822144,
      -0.6344285607337952,
      0.9071481227874756,
      -0.32351943850517273,
      -0.046654216945171356,
      -0.0032426200341433287,
      -0.1838746815919876,
      0.8938305974006653,
      0.4429567754268646,
      -0.4493957757949829,
      0.5033324360847473,
      0.9174259305000305,
      0.20658618211746216,
      -0.029206493869423866,
      -0.09591104090213776,
      0.5010574460029602,
      0.4677743911743164,
      0.6899808049201965,
      0.015485958196222782,
      0.25693342089653015,
      -0.4065345525741577,
      -0.4743337631225586,
      -0.5858330130577087,
      0.19320650398731232,
      -0.489590585231781,
      0.41429266333580017,
      -0.6652288436889648,
      0.3846960961818695,
      0.17678166925907135,
      -0.7233763337135315,
      -0.7622858285903931,
      0.4929722547531128,
      -0.8428874015808105,
      -0.5441082119941711,
      -1.227461814880371,
      0.4515507221221924,
      -0.45027869939804077,
      -1.0058850049972534,
      0.21883045136928558,
      -0.7531747817993164,
      -0.514838457107544,
      0.5420250296592712,
      -0.6434404850006104,
      -0.4525437653064728,
      -1.1789063215255737,
      1.472693920135498,
      0.531049907207489,
      -0.20134706795215607,
      -0.5968886017799377,
      -0.8751734495162964,
      -0.3421698808670044,
      -0.2794263958930969,
      -1.0459413528442383,
      -0.4378287196159363,
      -0.28405311703681946,
      -1.0666569471359253,
      -0.7123433351516724,
      0.5811227560043335,
      -0.9590199589729309,
      1.1126712560653687,
      0.8285351991653442,
      -1.1720771789550781,
      -0.41873207688331604,
      -0.5851283669471741,
      -0.9097223281860352,
      0.9406853914260864,
      0.3682793974876404,
      0.3270901143550873,
      0.022021790966391563,
      1.6118875741958618,
      2.3969693183898926,
      0.5205784440040588,
      0.8370598554611206,
      -0.12893563508987427,
      0.4099322557449341,
      -0.06398666650056839,
      -0.30955809354782104,
      -0.2854502201080322,
      -0.7250282764434814,
      -0.15021651983261108
    ],
    "label": {
      "level1": "SAM",
      "level2": "DT",
      "level3": "BIT",
      "leafContractCategory": "BIT",
      "rootCause": "Unacceptable Input Type",
      "effect": "Crash",
      "mlLibrary": "TensorFlow",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1: SAM\nThe violation involves only the tf.concat method from TensorFlow, representing a single method usage error.\n\nLevel 2: DT\nIt arises from passing incorrect input arguments to the API, thus constituting a data type mismatch.\n\nLevel 3: BIT\nThe TensorFlow built-in tensor data types are involved in this issue. Specifically, the error arises due to misuse of built-in data structures required by the API.\n\nLeaf Contract Category: BIT\nThe error directly involves built-in TensorFlow tensor types, accurately matching Level 3 categorization.\n\nRoot Cause: Unacceptable Input Type\nThe error is triggered by incorrect input format�passing tensors separately instead of encapsulating them within a required container (like a tuple or list).\n\nEffect: Crash\nThe misuse directly causes a runtime error, resulting in program termination.\n\nML Library: TensorFlow\nThe root of the issue lies in the TensorFlow library.\n\nContract Violation Location: Model Construction\nThe error is identified during the construction phase of the neural network.\n\nDetection Technique: Static Analysis\nThe issue was found by inspecting the code structure, even without running the model."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/48699954",
    "title": "",
    "question": "7\n\nwhen triying to fit the model i get this error\ni'm using Keras and every time i try to fit my model\n\npadded_model.fit(train_X, train_y, epochs=50, verbose=1)\ni get this error :\n\n'int' object has no attribute 'ndim'",
    "answer": "13\n\nIf train_x and train_y are normal Python lists, they don't have the attribute .ndim. Only Numpy arrays have this attribute representing the number of dimensions.\n\n(https://docs.scipy.org/doc/numpy-1.12.0/reference/generated/numpy.ndarray.ndim.html)",
    "mlApiName": "keras.models.fit",
    "embedding": [
      0.08212613314390182,
      0.8147738575935364,
      -2.483966827392578,
      -1.4145399332046509,
      0.5144026279449463,
      1.300243854522705,
      -0.22671987116336823,
      -0.3352321684360504,
      -1.1987048387527466,
      -0.9354487061500549,
      -0.4218757152557373,
      0.2351190149784088,
      1.2241348028182983,
      -0.32439103722572327,
      -0.7814890742301941,
      -0.2869345247745514,
      -0.31527942419052124,
      0.1269388645887375,
      -0.46860817074775696,
      0.824452817440033,
      0.3967064917087555,
      0.4017738699913025,
      -0.4304422438144684,
      -0.17322887480258942,
      1.4192990064620972,
      0.4376153349876404,
      -0.5687437057495117,
      1.0318410396575928,
      -0.09722773730754852,
      1.1127163171768188,
      1.0723016262054443,
      -0.460285484790802,
      0.6070380210876465,
      -0.8741238713264465,
      -0.7486510872840881,
      -0.5133215188980103,
      1.1739846467971802,
      1.0612305402755737,
      0.3294960856437683,
      0.34280523657798767,
      0.730333149433136,
      0.1651437133550644,
      -0.8431404232978821,
      1.638993740081787,
      -0.13681726157665253,
      -0.41779229044914246,
      1.7518219947814941,
      0.005192003678530455,
      0.5009912848472595,
      0.2841298580169678,
      0.18580514192581177,
      -0.42194461822509766,
      0.11853525787591934,
      0.31560155749320984,
      1.388109803199768,
      0.5189643502235413,
      0.17075058817863464,
      1.3147294521331787,
      0.5446924567222595,
      -0.6688621044158936,
      0.5017329454421997,
      0.5886770486831665,
      -1.1816301345825195,
      1.3015111684799194,
      1.2625651359558105,
      -0.23998859524726868,
      -0.5087440609931946,
      0.539255678653717,
      -0.6005977988243103,
      -0.37704524397850037,
      1.2069745063781738,
      0.5529665350914001,
      0.24024401605129242,
      0.9894025325775146,
      -1.0625370740890503,
      0.08558816462755203,
      -0.5671639442443848,
      -0.1710621863603592,
      -0.4628371298313141,
      0.4570583701133728,
      0.35494911670684814,
      1.2380766868591309,
      1.5197746753692627,
      -0.8060879707336426,
      0.6510714292526245,
      -0.2827109694480896,
      -1.2055829763412476,
      -0.026639360934495926,
      -0.34910848736763,
      0.9855024218559265,
      -0.9003171920776367,
      0.4944102466106415,
      0.325017511844635,
      1.0174638032913208,
      -0.9501757025718689,
      -0.5755159854888916,
      -0.39689871668815613,
      0.275428831577301,
      -0.9517706632614136,
      -0.44472479820251465,
      0.12478557974100113,
      1.2566488981246948,
      -0.07043100148439407,
      -0.6104018092155457,
      0.22828786075115204,
      1.5128670930862427,
      -0.19090616703033447,
      -0.08448123186826706,
      0.3686365783214569,
      -0.7241392135620117,
      -0.873456597328186,
      0.39004066586494446,
      -0.40991106629371643,
      -0.4855169355869293,
      -0.5343772172927856,
      -0.6356255412101746,
      0.8020104169845581,
      -1.4821839332580566,
      0.18887314200401306,
      1.094896912574768,
      -0.565138041973114,
      -0.6434956789016724,
      0.784343957901001,
      0.4621172249317169,
      0.16423818469047546,
      0.2209005206823349,
      -0.27011334896087646,
      0.7249796986579895,
      -0.05076732486486435,
      -0.7669069170951843,
      0.3762097656726837,
      -0.1941278725862503,
      -0.5189105272293091,
      -0.30477970838546753,
      0.14068344235420227,
      0.7140554189682007,
      -1.1006163358688354,
      -0.6466329097747803,
      -0.46226078271865845,
      0.9203655123710632,
      -0.038990892469882965,
      0.16273386776447296,
      -0.0029144238214939833,
      -1.2630174160003662,
      0.8004293441772461,
      -0.88453608751297,
      0.6243419647216797,
      -0.7049302458763123,
      -0.15037794411182404,
      0.5739506483078003,
      -0.05722680315375328,
      1.3853040933609009,
      -1.481790542602539,
      -0.3309001624584198,
      -0.22031326591968536,
      -0.23102594912052155,
      0.5527390837669373,
      0.6325762271881104,
      0.44173961877822876,
      -0.8455516695976257,
      0.5784624218940735,
      1.0379552841186523,
      -1.0365275144577026,
      1.3154270648956299,
      0.48774728178977966,
      -1.3455629348754883,
      0.37539464235305786,
      0.6527718901634216,
      -0.7318785190582275,
      -0.27150753140449524,
      -0.8886358737945557,
      -0.9711591601371765,
      0.287028044462204,
      -0.19076432287693024,
      0.5157233476638794,
      0.9622303247451782,
      0.5036025047302246,
      -0.7880340814590454,
      0.21449686586856842,
      -0.8108575344085693,
      0.6794143915176392,
      -0.018681520596146584,
      0.6218678951263428,
      -0.7802615761756897,
      -0.7134441137313843,
      -0.7351492643356323,
      0.4159602224826813,
      0.46999111771583557,
      0.2185843288898468,
      -0.2963041365146637,
      0.33832213282585144,
      0.09956832230091095,
      0.18927079439163208,
      -0.9670631885528564,
      0.4470268785953522,
      -0.46298500895500183,
      0.6862596869468689,
      -0.19243060052394867,
      0.8577932119369507,
      0.5382570624351501,
      0.10397425293922424,
      -0.2777632474899292,
      -1.5174715518951416,
      -0.06245354190468788,
      -0.35675927996635437,
      0.7064779996871948,
      0.17793917655944824,
      0.5025018453598022,
      -0.5015817284584045,
      0.9874432682991028,
      0.1711231917142868,
      -0.3403996229171753,
      -0.40059709548950195,
      0.13048005104064941,
      -0.10470404475927353,
      -0.11983569711446762,
      0.6539068222045898,
      -0.9809433817863464,
      -0.5766685009002686,
      0.0935155376791954,
      0.24075353145599365,
      -0.6120046973228455,
      0.8006228804588318,
      -0.6620550751686096,
      1.317497968673706,
      -0.32330426573753357,
      0.2624811828136444,
      0.3741483986377716,
      -0.35878482460975647,
      -0.39774417877197266,
      -0.8375583291053772,
      -0.8529516458511353,
      0.8852624297142029,
      0.7857521772384644,
      0.15698620676994324,
      0.6366043090820312,
      0.2852127254009247,
      0.8258873820304871,
      -0.10424317419528961,
      -0.09103723615407944,
      0.5893021821975708,
      1.1530523300170898,
      -0.003297555260360241,
      -0.06773941218852997,
      -0.8026590943336487,
      0.6722119450569153,
      -0.24005499482154846,
      -1.256608247756958,
      0.20313423871994019,
      1.3521167039871216,
      0.12126883864402771,
      0.6952664256095886,
      0.4200372099876404,
      0.0417802631855011,
      1.6466153860092163,
      -0.43493974208831787,
      -0.4029781222343445,
      -0.29550865292549133,
      0.04743761941790581,
      -0.7327719926834106,
      0.812785267829895,
      -0.1766313910484314,
      0.14921949803829193,
      0.5299569964408875,
      -0.9791085124015808,
      -1.2636492252349854,
      0.8651281595230103,
      0.1024947464466095,
      -0.09502052515745163,
      -0.26340383291244507,
      -0.33205628395080566,
      0.5268756747245789,
      0.47681882977485657,
      -0.16831229627132416,
      0.9375013113021851,
      0.6796694397926331,
      -0.5783957242965698,
      0.4602435231208801,
      -0.6642622947692871,
      -0.00988042913377285,
      -0.5349372029304504,
      -0.7289777994155884,
      -0.2501692473888397,
      -0.48242902755737305,
      0.25533759593963623,
      0.008340371772646904,
      -0.22018186748027802,
      0.17718501389026642,
      -0.12271679937839508,
      -0.1286667138338089,
      -0.2891978323459625,
      -0.22659558057785034,
      -0.533045768737793,
      0.578208327293396,
      0.10766281932592392,
      0.6321166753768921,
      0.9633933901786804,
      0.20817802846431732,
      0.3299260437488556,
      -0.5084144473075867,
      0.4530879855155945,
      0.7896384596824646,
      0.42234542965888977,
      0.1723606139421463,
      -0.27275437116622925,
      -0.26078879833221436,
      0.3123924136161804,
      -0.274075448513031,
      -0.24627180397510529,
      -0.11721388250589371,
      -1.1278975009918213,
      0.41139286756515503,
      -0.2090332955121994,
      0.9319452047348022,
      -0.7728598117828369,
      0.08290991932153702,
      0.21074026823043823,
      0.15963876247406006,
      0.24510382115840912,
      -0.7546252608299255,
      0.2668309807777405,
      -0.53128981590271,
      -0.000027453608709038235,
      -0.38928765058517456,
      -0.7656689882278442,
      1.0620872974395752,
      0.2455555498600006,
      0.5173993706703186,
      0.6709110736846924,
      -0.09978509694337845,
      0.3020901381969452,
      0.19280283153057098,
      0.1532326638698578,
      -0.4618193805217743,
      -1.2482035160064697,
      -0.3088083565235138,
      -0.15837223827838898,
      0.21144099533557892,
      0.11938241124153137,
      0.5931664705276489,
      -0.02332601323723793,
      0.17508485913276672,
      0.9352598786354065,
      -0.9098355174064636,
      0.00794773269444704,
      0.15338867902755737,
      -1.5141160488128662,
      -0.7087058424949646,
      0.8090938925743103,
      1.0869569778442383,
      -0.09241056442260742,
      0.37192288041114807,
      0.146596759557724,
      -0.9618613719940186,
      0.18840841948986053,
      0.19992029666900635,
      0.1406603455543518,
      -0.10397792607545853,
      0.3853822648525238,
      0.21741056442260742,
      1.0069786310195923,
      0.2928777039051056,
      0.17914873361587524,
      -0.9756143689155579,
      0.10613243281841278,
      0.06793168187141418,
      0.7390548586845398,
      0.1451144963502884,
      1.1913574934005737,
      -0.20612886548042297,
      0.4968133270740509,
      -0.6302542090415955,
      -0.23123261332511902,
      -0.3096015751361847,
      0.338318794965744,
      0.1585245430469513,
      -0.39347317814826965,
      -0.2948002219200134,
      -1.1618026494979858,
      0.2379649132490158,
      0.988695502281189,
      -0.7132385969161987,
      0.008526355028152466,
      -0.7504331469535828,
      0.13048450648784637,
      0.16882124543190002,
      0.23846139013767242,
      -0.5231553316116333,
      -0.7907366752624512,
      0.5554335713386536,
      -0.1942722052335739,
      -0.30260413885116577,
      -1.1689764261245728,
      -0.21826991438865662,
      0.6311710476875305,
      -1.1078540086746216,
      0.5721755027770996,
      0.25517895817756653,
      -0.8523940443992615,
      0.1919792890548706,
      -0.5359338521957397,
      -0.12821508944034576,
      -0.3031173646450043,
      0.11416885256767273,
      -0.03926123306155205,
      -0.05298323556780815,
      -0.710209846496582,
      -0.17374084889888763,
      1.0103100538253784,
      0.027041153982281685,
      -0.34049180150032043,
      0.5749272108078003,
      -0.3449265658855438,
      -1.3816947937011719,
      0.8592243194580078,
      0.13007089495658875,
      -0.1099979430437088,
      1.0548436641693115,
      -0.9245830774307251,
      -0.7354522347450256,
      0.031968798488378525,
      0.4441487491130829,
      -0.4007940888404846,
      -0.05206892266869545,
      0.48853006958961487,
      0.4115641415119171,
      0.547361433506012,
      0.9765764474868774,
      0.5962163209915161,
      -1.573056936264038,
      -0.5264725089073181,
      0.28590479493141174,
      0.33469000458717346,
      0.46929875016212463,
      -0.5635661482810974,
      0.03733759745955467,
      0.4019997715950012,
      0.9573818445205688,
      -0.1605442464351654,
      0.06693828105926514,
      0.3781338930130005,
      0.03675440698862076,
      -0.6937911510467529,
      -0.08195284008979797,
      0.41781800985336304,
      0.522273063659668,
      0.9417489767074585,
      -0.35961756110191345,
      -2.0990569591522217,
      1.2990314960479736,
      1.2335587739944458,
      -0.37199199199676514,
      0.2289128303527832,
      0.24530543386936188,
      1.4687628746032715,
      -0.6915277242660522,
      0.30441635847091675,
      -0.02789333090186119,
      0.5214505195617676,
      0.7069247961044312,
      -0.9818632006645203,
      0.27395525574684143,
      -1.666945219039917,
      0.7348009943962097,
      -0.6771677136421204,
      -1.506672978401184,
      -0.04367475211620331,
      -0.738305926322937,
      0.218784362077713,
      1.2643393278121948,
      0.11701842397451401,
      0.10252155363559723,
      0.0728488489985466,
      -0.5141078233718872,
      -0.00832836702466011,
      0.7996702194213867,
      -0.2659667730331421,
      -0.3892612159252167,
      -0.1631472259759903,
      0.8925861120223999,
      0.3386564254760742,
      -1.2463536262512207,
      0.13406026363372803,
      -0.35956689715385437,
      0.43526652455329895,
      1.4338359832763672,
      0.326964795589447,
      0.19424712657928467,
      1.1752933263778687,
      0.23057444393634796,
      0.28970956802368164,
      -0.8100418448448181,
      -0.36580002307891846,
      -0.03271966800093651,
      -0.2539229393005371,
      -0.5579996705055237,
      -0.4424533247947693,
      0.29397889971733093,
      0.057243045419454575,
      0.3918741047382355,
      -0.6080016493797302,
      -0.03130722790956497,
      0.2644517123699188,
      0.17112985253334045,
      0.35922181606292725,
      -0.363684743642807,
      0.8440799117088318,
      -0.2928386330604553,
      -0.4398565888404846,
      0.09936615824699402,
      0.8270869255065918,
      0.4764953553676605,
      0.8787336349487305,
      -0.13002870976924896,
      0.3005520701408386,
      -0.7554887533187866,
      0.07454711943864822,
      -0.3473847806453705,
      -0.28224337100982666,
      0.1914176493883133,
      -0.016003059223294258,
      -1.2812778949737549,
      -0.15741975605487823,
      -1.082258939743042,
      -0.32906994223594666,
      -0.11365800350904465,
      0.535732090473175,
      -1.713152527809143,
      0.5351133346557617,
      0.3669847249984741,
      0.8461647629737854,
      0.12751758098602295,
      -1.7131530046463013,
      -0.2877427935600281,
      0.5344010591506958,
      -0.2541343867778778,
      -0.8200521469116211,
      1.0729824304580688,
      -0.02498890832066536,
      -0.5229743123054504,
      -0.4333784282207489,
      0.30060243606567383,
      -0.21734923124313354,
      -0.7880125641822815,
      -0.7639200687408447,
      -0.08959189802408218,
      -0.35194921493530273,
      0.3614702522754669,
      0.9647997617721558,
      -0.5834012031555176,
      0.5920538306236267,
      -0.8392102718353271,
      0.09239650517702103,
      -0.7680532336235046,
      0.36657223105430603,
      -0.5986737012863159,
      -0.5242428183555603,
      0.021848781034350395,
      -1.3361499309539795,
      -1.084863305091858,
      -1.2757056951522827,
      0.5372077226638794,
      1.633123755455017,
      0.10618645697832108,
      -0.40061137080192566,
      0.09362678229808807,
      -1.1610718965530396,
      0.3157113492488861,
      0.4852379858493805,
      0.1286381483078003,
      0.25854793190956116,
      -1.4767189025878906,
      0.9120510220527649,
      0.6143449544906616,
      -0.6765071749687195,
      -0.44453728199005127,
      0.8277642130851746,
      0.39020729064941406,
      -1.1178197860717773,
      -0.3979465663433075,
      0.5149530172348022,
      -1.1745469570159912,
      -0.023638227954506874,
      0.7434898614883423,
      -1.0132988691329956,
      0.5857268571853638,
      0.5021744966506958,
      -0.9777446985244751,
      0.04782708361744881,
      0.09383741766214371,
      -0.35728877782821655,
      0.018010174855589867,
      0.4769169092178345,
      -0.9448272585868835,
      -0.18524722754955292,
      -0.3851478397846222,
      -0.5549719929695129,
      0.15969674289226532,
      -0.38888946175575256,
      -1.6552156209945679,
      0.11437270045280457,
      0.8660700917243958,
      0.9617128372192383,
      -0.469043105840683,
      0.5126004815101624,
      1.0886155366897583,
      -0.7453269362449646,
      -0.4724060893058777,
      -0.40513041615486145,
      0.9396267533302307,
      0.7860897779464722,
      0.7352530360221863,
      0.09497381001710892,
      1.3215510845184326,
      0.27830401062965393,
      -0.5702929496765137,
      0.5859047174453735,
      -0.0568045973777771,
      -1.0159595012664795,
      -0.41503024101257324,
      -0.5601486563682556,
      -0.8578159213066101,
      0.7497944831848145,
      -1.101080298423767,
      0.10703221708536148,
      -0.7241921424865723,
      -0.8743999004364014,
      0.445463627576828,
      0.6961959600448608,
      0.23118510842323303,
      -1.7091240882873535,
      -0.47617676854133606,
      -1.512484073638916,
      -0.11702332645654678,
      -1.1447312831878662,
      1.1712509393692017,
      -0.2543691396713257,
      0.8720630407333374,
      0.9996117353439331,
      1.3505240678787231,
      0.17662550508975983,
      -0.44810768961906433,
      -0.5582563877105713,
      0.24667222797870636,
      0.0026546448934823275,
      -1.2636736631393433,
      0.6301034688949585,
      0.655207097530365,
      0.32754775881767273,
      -0.3712213635444641,
      2.0361416339874268,
      1.8428611755371094,
      -0.08452156186103821,
      0.13326019048690796,
      0.456309974193573,
      -0.7288265824317932,
      -0.3304530680179596,
      -0.6097942590713501,
      -0.7585451006889343,
      -0.6190605163574219,
      -0.04592990130186081,
      -0.15697818994522095,
      -0.36117929220199585,
      0.12108922749757767,
      0.44673967361450195,
      0.18630804121494293,
      0.013863378204405308,
      0.08554679900407791,
      -0.6144378185272217,
      -0.6748344302177429,
      0.12987913191318512,
      0.7641385197639465,
      0.6323856711387634,
      0.48295795917510986,
      0.5968883037567139,
      0.03956621512770653,
      0.5716766715049744,
      0.9989246129989624,
      0.27963805198669434,
      -0.6434965133666992,
      0.9325749278068542,
      -0.033942002803087234,
      0.21073435246944427,
      0.04577115923166275,
      0.6223184466362,
      -0.49414366483688354,
      0.8994138836860657,
      -1.3791229724884033,
      0.15497730672359467,
      -0.25937768816947937,
      -0.02621866948902607,
      -0.9951062202453613,
      -0.10872536152601242,
      -0.6104938387870789,
      -0.669050395488739,
      0.14737586677074432,
      -0.5482521653175354,
      -0.5887307524681091,
      0.17530804872512817,
      0.18575547635555267,
      0.4056279957294464,
      -0.15756843984127045,
      0.15516074001789093,
      0.16781386733055115,
      -0.4414824843406677,
      -0.21666769683361053,
      0.2313934713602066,
      -0.061132241040468216,
      -0.3628546893596649,
      0.1553126573562622,
      -0.4339250326156616,
      0.20311422646045685,
      -0.8054584860801697,
      0.5988361239433289,
      0.29711273312568665,
      0.61761873960495,
      0.6859444975852966,
      -0.9041842818260193,
      -0.8479549884796143,
      -0.6918983459472656,
      -0.38765692710876465,
      0.09016626328229904,
      -0.7513447999954224,
      0.3221852779388428,
      -0.5933945775032043,
      -1.0812112092971802,
      -0.2792598009109497,
      -0.05171592906117439,
      -0.317636638879776,
      0.2389879822731018,
      -0.942367672920227,
      0.2570508122444153,
      -1.4691020250320435,
      0.9445662498474121,
      0.33685633540153503,
      0.7676316499710083,
      -0.4423239529132843,
      -0.2512373924255371,
      -1.0889986753463745,
      -0.11797752976417542,
      -1.0456154346466064,
      1.4877145290374756,
      0.6801021099090576,
      0.7172935605049133,
      -0.5043436884880066,
      -0.9120796918869019,
      -0.9368225336074829,
      1.460717797279358,
      0.4174058735370636,
      0.4405651092529297,
      -1.0196741819381714,
      -0.8291758894920349,
      -0.23101329803466797,
      1.1692492961883545,
      -0.8119188547134399,
      0.6652772426605225,
      0.1953936219215393,
      1.1020653247833252,
      1.190786600112915,
      -0.011338711716234684,
      0.332431823015213,
      -0.41583025455474854,
      1.1019991636276245,
      0.6918997168540955,
      0.09898891299962997,
      -0.13035623729228973,
      -0.8406476378440857,
      -0.4468004107475281
    ],
    "label": {
      "level1": "SAM",
      "level2": "DT",
      "level3": "MT",
      "leafContractCategory": "MT",
      "rootCause": "Unacceptable Input Type",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Train",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1: SAM\nThe issue is centered around the single Keras method model.fit, which leads to the error.\n\nLevel 2: DT\nThe provided input arrays have an incorrect data shape, indicating a fundamental data type incompatibility.\n\nLevel 3: MT\nThe data issue is specifically related to the machine learning data structure�shapes and dimensions required by Keras for training.\n\nLeaf Contract Category: MT\nPrecisely matches the Level 3 categorization because the issue stems from ML data shapes.\n\nRoot Cause: Unacceptable Input Type\nThe model training method receives data arrays of incorrect dimensions, violating expected input type constraints.\n\nEffect: Crash\nThe provided input directly leads to the crash of the training process.\n\nML Library: Keras\nThe issue is explicitly tied to the Keras ML framework.\n\nContract Violation Location: Train\nOccurs clearly during the training phase when model.fit is executed.\n\nDetection Technique: Static Analysis\nIdentifiable via code inspection without execution, due to obvious data shape mismatch."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/36096386",
    "title": "",
    "question": "Calling tf.set_random_seed(SEED) has no effect that I can tell...\nFor example, running the code below several times inside an IPython notebook produces different output each time:\n\nimport tensorflow as tf\ntf.set_random_seed(42)\nsess = tf.InteractiveSession()\na = tf.constant([1, 2, 3, 4, 5])\ntf.initialize_all_variables().run()\na_shuf = tf.random_shuffle(a)\nprint(a.eval())\nprint(a_shuf.eval())\nsess.close()\nIf I set the seed explicitly: a_shuf = tf.random_shuffle(a, seed=42), the output is the same after each run. But why do I need to set the seed if I already call tf.set_random_seed(42)?\n\nThe equivalent code using numpy just works:\n\nimport numpy as np\nnp.random.seed(42)\na = [1,2,3,4,5]\nnp.random.shuffle(a)\nprint(a)",
    "answer": "13\n\nThat only sets the graph-level random seed. If you execute this snippet several times in a row, the graph will change, and two shuffle statements will get different operation-level seeds. The details are described in the doc string for set_random_seed\n\nTo get deterministic a_shuf you can either\n\nCall tf.reset_default_graph() between invocations or\nSet operation-level seed for shuffle: a_shuf = tf.random_shuffle(a, seed=42)",
    "mlApiName": "tf.random.shuffle,tf.reset_default_graph",
    "embedding": [
      0.6686340570449829,
      1.2483875751495361,
      -3.397003173828125,
      -1.270593523979187,
      0.7808386087417603,
      -0.7220703363418579,
      0.9725651741027832,
      0.41055911779403687,
      -0.6710358262062073,
      -0.9899745583534241,
      -0.8369726538658142,
      1.0210007429122925,
      0.9663640856742859,
      0.4547645151615143,
      -1.09203040599823,
      0.40650567412376404,
      0.37471601366996765,
      -0.28349244594573975,
      -0.10981611907482147,
      0.24325717985630035,
      -0.2690168619155884,
      -0.5716285705566406,
      0.4539962112903595,
      -0.9258679151535034,
      0.6545501947402954,
      1.0287690162658691,
      -0.22204768657684326,
      -0.6725161075592041,
      -0.8915019035339355,
      0.7079285979270935,
      1.2887219190597534,
      0.9652252793312073,
      -0.23474787175655365,
      -0.22320128977298737,
      -1.7307485342025757,
      -0.6462741494178772,
      1.0748515129089355,
      -0.9536029696464539,
      0.6479206681251526,
      -0.7191440463066101,
      -1.3107047080993652,
      0.8896644711494446,
      0.31913942098617554,
      -0.8501289486885071,
      0.24412775039672852,
      0.3423200249671936,
      0.9588790535926819,
      1.275499939918518,
      0.3478371798992157,
      -1.3653838634490967,
      -0.16369673609733582,
      0.1530722826719284,
      0.030828289687633514,
      0.24289174377918243,
      0.8245435953140259,
      0.852318286895752,
      -0.6321372389793396,
      0.30353692173957825,
      1.0600568056106567,
      -0.5617178678512573,
      0.6306395530700684,
      1.1230849027633667,
      -0.8942526578903198,
      0.9661615490913391,
      -0.18923501670360565,
      0.09035325795412064,
      -0.6782373189926147,
      0.28809913992881775,
      0.27314233779907227,
      -0.3693256974220276,
      1.062146544456482,
      0.5002360343933105,
      -0.373828649520874,
      0.19074268639087677,
      -0.17091429233551025,
      0.6642012000083923,
      -0.005829210393130779,
      0.06367941200733185,
      -0.5652056336402893,
      0.6447837352752686,
      -0.9842170476913452,
      0.06464464217424393,
      0.9218108057975769,
      0.6343287229537964,
      0.6480922698974609,
      0.4993494153022766,
      -0.025420334190130234,
      -0.34641820192337036,
      -1.215632677078247,
      1.6551787853240967,
      -0.3585449159145355,
      -0.06259527057409286,
      0.6837058067321777,
      0.38871365785598755,
      -1.2651560306549072,
      0.20889271795749664,
      -0.5500181913375854,
      0.5234768390655518,
      -0.7734518647193909,
      -0.19488346576690674,
      -0.7076759338378906,
      0.2774435579776764,
      -0.1334718018770218,
      -0.837163507938385,
      0.1406663954257965,
      0.429023802280426,
      0.22394801676273346,
      0.7238672971725464,
      0.07067372649908066,
      -0.4239308834075928,
      -0.20707324147224426,
      0.3860794007778168,
      0.006200658623129129,
      -0.22984685003757477,
      0.6011874675750732,
      -0.3838516175746918,
      0.8599725365638733,
      -0.16481754183769226,
      -0.19537918269634247,
      0.5480101704597473,
      -0.49832606315612793,
      -0.7788069844245911,
      -0.20017731189727783,
      0.7526599168777466,
      -0.05298946052789688,
      0.5010861754417419,
      -0.11821576207876205,
      -0.4871063232421875,
      0.39912766218185425,
      -0.8626050353050232,
      0.29398342967033386,
      -0.667268693447113,
      -0.6934645771980286,
      1.0400338172912598,
      0.14643026888370514,
      1.1814792156219482,
      0.04033121466636658,
      -0.19337570667266846,
      0.4136503040790558,
      -0.16638338565826416,
      0.17648206651210785,
      -0.22273652255535126,
      -0.1093355044722557,
      -0.2807310223579407,
      0.1552092283964157,
      -0.6236128807067871,
      0.5126601457595825,
      -0.4580378234386444,
      -1.1371426582336426,
      -0.3640572726726532,
      0.786203920841217,
      0.1179393008351326,
      -0.9018132090568542,
      -0.05449013039469719,
      0.6797953844070435,
      -0.38456884026527405,
      0.7675676345825195,
      0.023832112550735474,
      0.27579712867736816,
      0.9755006432533264,
      1.2611404657363892,
      0.018526120111346245,
      0.25675150752067566,
      0.7169843912124634,
      -0.40711912512779236,
      -0.9841554164886475,
      0.4326561391353607,
      0.6783816814422607,
      -0.10359136760234833,
      0.24838414788246155,
      -0.7284822463989258,
      -0.30069079995155334,
      -0.08044511079788208,
      -0.4992009401321411,
      -0.11642342060804367,
      1.2139581441879272,
      0.7635605335235596,
      -0.8469676375389099,
      -0.07212302833795547,
      0.16251038014888763,
      0.5884751081466675,
      -0.4197831153869629,
      0.6823826432228088,
      -0.20943577587604523,
      -0.006594961509108543,
      0.22270093858242035,
      -0.2770065367221832,
      -0.17054308950901031,
      -0.5581740140914917,
      -0.5950247645378113,
      0.4916919767856598,
      0.06365615874528885,
      -1.6731975078582764,
      -0.0015332690672948956,
      -0.6346713304519653,
      0.03661248832941055,
      -0.152526393532753,
      0.07159223407506943,
      0.7145957946777344,
      0.29038166999816895,
      -0.3366245925426483,
      -0.6735950112342834,
      -0.5609147548675537,
      -0.3365437984466553,
      -0.9419493079185486,
      0.996052622795105,
      -0.11437351256608963,
      0.5462474226951599,
      -0.6512419581413269,
      0.7516875863075256,
      0.7284920811653137,
      0.656445324420929,
      -0.2449820339679718,
      0.7455987334251404,
      0.33379632234573364,
      -0.7378172278404236,
      0.6948202848434448,
      -1.4989781379699707,
      -0.8572264909744263,
      -0.26444217562675476,
      -0.11833998560905457,
      -0.9400435090065002,
      0.05701575428247452,
      0.5317031145095825,
      0.7948867678642273,
      -0.5567948222160339,
      -0.22487695515155792,
      -0.8128565549850464,
      -0.3162393271923065,
      0.5542747378349304,
      -0.5498793721199036,
      -0.7932953834533691,
      0.035544220358133316,
      0.809118390083313,
      0.6448412537574768,
      0.42116278409957886,
      0.7576080560684204,
      0.7000270485877991,
      0.9717029929161072,
      0.21116399765014648,
      -0.6928162574768066,
      1.0503379106521606,
      -0.257996529340744,
      0.639411985874176,
      -0.7107254862785339,
      0.12199806421995163,
      0.3403362035751343,
      -1.6225744485855103,
      -0.20711933076381683,
      0.46087539196014404,
      0.41691288352012634,
      -0.3128766417503357,
      -0.0028685634024441242,
      0.8479402661323547,
      0.1358930468559265,
      -0.5118640065193176,
      -0.9346556067466736,
      -0.6059839129447937,
      -0.08701176941394806,
      -0.2562500536441803,
      0.04147156700491905,
      0.5032881498336792,
      1.2626806497573853,
      0.16143906116485596,
      -0.3189195692539215,
      -0.45530965924263,
      -0.08193276822566986,
      -0.0507240891456604,
      -0.7609296441078186,
      -0.36134466528892517,
      -0.34585654735565186,
      0.6035277247428894,
      1.1096220016479492,
      1.1501340866088867,
      -0.34317848086357117,
      0.37061169743537903,
      0.25673791766166687,
      -0.0929039865732193,
      -0.19985650479793549,
      0.5946586728096008,
      -0.5534192323684692,
      -0.8876112103462219,
      -1.6675423383712769,
      1.0340155363082886,
      -0.4266154170036316,
      -0.40049439668655396,
      0.4786264896392822,
      -0.501275897026062,
      -0.512840211391449,
      0.8605524897575378,
      0.32268670201301575,
      0.5369783639907837,
      0.4867429733276367,
      0.3248733580112457,
      0.761108934879303,
      0.9762015342712402,
      -0.29399800300598145,
      -0.08329836279153824,
      -0.3418991267681122,
      -0.30232757329940796,
      0.41376468539237976,
      1.8034054040908813,
      0.6729933619499207,
      0.6915850043296814,
      -0.6421846747398376,
      0.45065611600875854,
      0.20143164694309235,
      -0.05286549776792526,
      0.5395829081535339,
      0.13222548365592957,
      -0.34550875425338745,
      0.778203010559082,
      -1.2183045148849487,
      0.6173892617225647,
      -0.7940145134925842,
      0.6562182903289795,
      0.46730831265449524,
      0.6988763213157654,
      0.9208256006240845,
      -0.20196659862995148,
      -0.6006059646606445,
      -0.3218387961387634,
      0.22455666959285736,
      -0.5881146192550659,
      -0.10015718638896942,
      0.9722665548324585,
      -0.2892751395702362,
      1.7050299644470215,
      -0.03827995806932449,
      -0.6167171597480774,
      0.8803091049194336,
      0.7655673623085022,
      -0.11584806442260742,
      -1.066308617591858,
      -0.8926840424537659,
      -0.2065422087907791,
      0.14281202852725983,
      0.13326893746852875,
      0.7076535820960999,
      0.365338534116745,
      0.6719516515731812,
      -0.7316271662712097,
      0.09480153024196625,
      -0.16171923279762268,
      -0.1374625563621521,
      1.6950883865356445,
      -0.38626155257225037,
      -0.7947728037834167,
      0.33591949939727783,
      0.4586949348449707,
      0.13118602335453033,
      -0.14640682935714722,
      -0.2932966649532318,
      0.6136946082115173,
      0.6866037845611572,
      -0.07111332565546036,
      0.3217952847480774,
      0.1567946821451187,
      0.34660571813583374,
      -0.017744505777955055,
      0.23343077301979065,
      -1.0058603286743164,
      -0.34856024384498596,
      0.469272255897522,
      0.11239378154277802,
      1.0704361200332642,
      0.6635240316390991,
      -0.06522225588560104,
      0.1728638857603073,
      0.1802821159362793,
      -0.32694727182388306,
      0.1986653059720993,
      -0.2735985815525055,
      0.8667595386505127,
      -0.04007520154118538,
      -0.043889790773391724,
      -0.8732845187187195,
      0.3910173177719116,
      0.20329320430755615,
      0.6397944092750549,
      0.7279117703437805,
      -1.0800719261169434,
      0.19317883253097534,
      -0.3438611328601837,
      0.3177850544452667,
      0.6562082767486572,
      0.4436270594596863,
      -1.0767402648925781,
      0.16301654279232025,
      1.222367763519287,
      -0.3750636577606201,
      0.6578229069709778,
      -0.15330731868743896,
      0.15292984247207642,
      0.970228374004364,
      0.38299593329429626,
      0.9455538392066956,
      0.7772665619850159,
      -0.610653281211853,
      0.08453353494405746,
      -0.587935209274292,
      -1.6049678325653076,
      -0.4884891211986542,
      -0.8794332146644592,
      0.5696228742599487,
      0.11160370707511902,
      -0.635358989238739,
      -0.6888070106506348,
      0.41819220781326294,
      -0.20962199568748474,
      0.35002559423446655,
      1.0574805736541748,
      0.22589965164661407,
      -1.6282765865325928,
      1.019924521446228,
      -0.5359087586402893,
      0.8660495281219482,
      0.6509093642234802,
      -0.8656567335128784,
      -0.46486765146255493,
      0.6314339637756348,
      0.2376304566860199,
      -0.09372155368328094,
      0.26568496227264404,
      -0.1776396930217743,
      0.5313445925712585,
      -0.4457482695579529,
      0.8265774846076965,
      -0.18667393922805786,
      -1.4981775283813477,
      0.5421525239944458,
      1.2413543462753296,
      -0.02523508109152317,
      0.021628325805068016,
      -0.698042094707489,
      -0.2482493817806244,
      0.2355218231678009,
      1.0217632055282593,
      -0.7630777955055237,
      1.5898760557174683,
      1.0246626138687134,
      -0.5151940584182739,
      -0.8932244777679443,
      -0.407589852809906,
      0.005384089890867472,
      1.2239048480987549,
      0.8349940180778503,
      -1.1815499067306519,
      -0.8778126239776611,
      0.9497326612472534,
      -0.04844760149717331,
      0.6899123191833496,
      0.8985674977302551,
      0.23516646027565002,
      2.0151050090789795,
      -0.6852035522460938,
      -0.40076419711112976,
      0.27092114090919495,
      -0.15212176740169525,
      0.11510202288627625,
      0.0023722306359559298,
      0.33878836035728455,
      -0.458758145570755,
      -0.21809116005897522,
      -0.7984620928764343,
      0.6873978972434998,
      0.05005405843257904,
      -0.32561981678009033,
      0.9456773400306702,
      0.9360010027885437,
      -0.12228361517190933,
      -0.6579704284667969,
      -0.08088631182909012,
      0.914082944393158,
      -0.0621536448597908,
      -0.2291533201932907,
      0.982502818107605,
      -0.14000415802001953,
      -0.09825433790683746,
      0.6879546046257019,
      -0.45321500301361084,
      -0.49017542600631714,
      -0.34548941254615784,
      -0.16240133345127106,
      0.08514019101858139,
      1.3487591743469238,
      -0.8150120973587036,
      -0.31134340167045593,
      0.1157209500670433,
      -0.3090977370738983,
      0.3643104135990143,
      0.04314078763127327,
      0.8115959763526917,
      0.11300279945135117,
      -0.49567312002182007,
      -0.9771096706390381,
      0.44811463356018066,
      0.25323495268821716,
      0.0253768227994442,
      0.16079439222812653,
      -0.3140951693058014,
      0.4303937256336212,
      -0.2920122444629669,
      -0.7053346037864685,
      0.5669010877609253,
      0.02574780024588108,
      1.1777361631393433,
      -1.271347999572754,
      -1.191972017288208,
      0.766197144985199,
      -0.48767146468162537,
      0.18047602474689484,
      1.2146751880645752,
      0.9521797299385071,
      1.0249571800231934,
      -1.0062930583953857,
      0.25277599692344666,
      -0.9339933395385742,
      -1.5646452903747559,
      -0.52729332447052,
      0.28459879755973816,
      -0.09461480379104614,
      -0.3854163885116577,
      -0.8901241421699524,
      -1.407739520072937,
      0.16740351915359497,
      -0.8452364206314087,
      -0.8848856091499329,
      -0.14346764981746674,
      0.2881755232810974,
      -0.6656975150108337,
      -0.32794082164764404,
      -0.6443085670471191,
      0.0893985703587532,
      -0.0015291161835193634,
      0.034568656235933304,
      -0.13192692399024963,
      0.3631094694137573,
      -0.10981449484825134,
      0.4773900508880615,
      0.6518622040748596,
      1.0705112218856812,
      0.7672631144523621,
      -0.3393896818161011,
      -0.9958832859992981,
      -0.5393103957176208,
      -0.2148880809545517,
      0.15083017945289612,
      0.3375769257545471,
      -2.5565009117126465,
      0.1372564733028412,
      0.22591057419776917,
      0.5819528698921204,
      -0.08097401261329651,
      0.520452618598938,
      0.20074597001075745,
      -0.7824059128761292,
      -1.068607211112976,
      -1.4096237421035767,
      -0.31829261779785156,
      -0.1797308772802353,
      -0.2529735565185547,
      0.6908841729164124,
      -0.44922342896461487,
      1.1618390083312988,
      -0.12914174795150757,
      0.32386571168899536,
      -0.16966672241687775,
      0.029927538707852364,
      0.18006008863449097,
      0.48486170172691345,
      -0.5198862552642822,
      -0.3859363794326782,
      -0.4411725401878357,
      -0.4302586615085602,
      0.39991283416748047,
      -0.7940376400947571,
      0.1283450573682785,
      -0.35148635506629944,
      -0.87459796667099,
      -0.16010120511054993,
      -0.7258564233779907,
      1.0405375957489014,
      0.4510243237018585,
      0.10701163113117218,
      0.542015790939331,
      -0.9306902885437012,
      -0.6623733043670654,
      1.3714171648025513,
      -0.9859415292739868,
      -0.918594241142273,
      0.24825358390808105,
      0.3697584271430969,
      -0.15640322864055634,
      -0.17958079278469086,
      1.5456476211547852,
      -0.43924394249916077,
      -0.32468584179878235,
      -0.5301985740661621,
      -1.0516676902770996,
      0.09690885990858078,
      0.7339510321617126,
      1.9331125020980835,
      -1.1824517250061035,
      -0.8462995886802673,
      1.0333889722824097,
      -0.8985387086868286,
      0.15548080205917358,
      0.43348199129104614,
      0.45116937160491943,
      0.1686549037694931,
      0.09515897184610367,
      0.6978610754013062,
      0.04379153624176979,
      -0.25665274262428284,
      -0.6008604168891907,
      0.24358110129833221,
      0.5255271792411804,
      -0.0889311134815216,
      -1.149300217628479,
      0.007438620552420616,
      -0.9295635223388672,
      0.6720057725906372,
      -0.9136419296264648,
      0.6506156325340271,
      -0.3045593202114105,
      -0.20560024678707123,
      -0.8705312609672546,
      0.7751976251602173,
      0.19638481736183167,
      -0.9638922214508057,
      0.7749727964401245,
      -1.677716612815857,
      0.5749980211257935,
      -0.6822349429130554,
      1.056660771369934,
      -1.0161761045455933,
      0.4906880259513855,
      0.18074828386306763,
      0.25639602541923523,
      0.17554394900798798,
      0.49121153354644775,
      -0.06505484879016876,
      -0.3104265034198761,
      0.19191855192184448,
      0.043286897242069244,
      0.4871020019054413,
      0.4217919409275055,
      -0.663653552532196,
      -0.15523552894592285,
      0.8696291446685791,
      1.232407569885254,
      0.48940762877464294,
      0.0550573468208313,
      0.1733689308166504,
      0.24623461067676544,
      0.5431613922119141,
      -0.8266032338142395,
      -0.9762248992919922,
      -0.9456977844238281,
      -1.0967611074447632,
      -0.1948079913854599,
      -1.0869213342666626,
      -0.22205346822738647,
      0.5548723340034485,
      -0.3930756449699402,
      1.0446701049804688,
      0.3398250937461853,
      -0.5899997353553772,
      -0.6843084096908569,
      0.0072272042743861675,
      -0.040629081428050995,
      -0.7356165647506714,
      0.35866686701774597,
      0.8799545764923096,
      0.3317776620388031,
      1.0852444171905518,
      0.7754626274108887,
      0.1917792111635208,
      0.038978345692157745,
      0.9532657861709595,
      -0.08850830793380737,
      0.17084598541259766,
      -0.94342041015625,
      -0.2082681953907013,
      0.02477584220468998,
      -0.10670390725135803,
      -0.30475109815597534,
      -0.5717484354972839,
      -1.4524213075637817,
      -0.09377268701791763,
      -0.023150119930505753,
      0.5442701578140259,
      0.1200651302933693,
      -0.7461629509925842,
      0.8982695937156677,
      0.04079575091600418,
      -0.9837847948074341,
      -0.18500670790672302,
      0.07807689160108566,
      0.29359498620033264,
      -0.6146799325942993,
      -0.26461803913116455,
      -0.6809064745903015,
      0.5942777395248413,
      -0.2248673141002655,
      0.13287727534770966,
      -0.19029799103736877,
      -0.7983734011650085,
      -0.9808706045150757,
      -0.21121568977832794,
      -0.2290124148130417,
      -0.5535527467727661,
      0.8934778571128845,
      -0.13839571177959442,
      0.16173939406871796,
      -0.1744193136692047,
      -1.719795823097229,
      -0.307074636220932,
      0.4494008719921112,
      -0.1331348419189453,
      0.03917652368545532,
      -0.9193300604820251,
      0.1833360493183136,
      -0.06863480061292648,
      0.26866307854652405,
      -0.26225215196609497,
      -0.2946870028972626,
      0.6142355799674988,
      0.27733904123306274,
      -0.09195736795663834,
      -0.572160542011261,
      -0.12669256329536438,
      1.0304638147354126,
      -0.20952574908733368,
      0.662606954574585,
      0.3638628423213959,
      -0.4117893874645233,
      -0.26619142293930054,
      -0.9125254154205322,
      -1.0942078828811646,
      0.7661811113357544,
      0.11687743663787842,
      0.779784619808197,
      -0.5741162896156311,
      -0.7086763381958008,
      -1.007253646850586,
      1.033760905265808,
      -0.41959354281425476,
      -1.3248307704925537,
      -0.4528140425682068,
      -0.5877535343170166,
      -1.2243201732635498,
      -0.21720705926418304,
      -0.022772863507270813,
      -0.0021236748434603214,
      0.2918180525302887,
      1.3512827157974243,
      2.165400505065918,
      0.17174123227596283,
      0.21702855825424194,
      -0.6640431880950928,
      -0.3615531921386719,
      0.5159004926681519,
      -1.0136260986328125,
      -0.30145686864852905,
      0.1704639047384262,
      0.06825961172580719
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SL",
      "level3": "F,IC-1",
      "leafContractCategory": "Comb. of SAM(Level 3) and AMO(Level 2)",
      "rootCause": "Missing Options",
      "effect": "IF",
      "mlLibrary": "TensorFlow",
      "contractViolationLocation": "Model Evaluation",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1: Hybrid\nThe issue involves multiple TensorFlow API methods interacting, indicating complexity beyond a single API call.\n\nLevel 2: Selection (SL)\nThe error occurs due to the incorrect selection or configuration of certain API parameters or methods.\n\nLevel 3: Eventually (F), Intra-argument Contract (IC-1)\nThis combines two problems: issues with execution sequence (eventually correct use required) and internal consistency of arguments.\n\nLeaf Contract Category: Combination of SAM(Level 3) and AMO(Level 2)\nIt combines both API usage correctness and the order of method invocations, indicating a complex, hybrid category violation.\n\nRoot Cause: Missing Options\nEssential parameters or configurations were omitted from the API call, causing the contract violation.\n\nEffect: Incorrect Functionality\nResults in incorrect behavior but not necessarily an immediate runtime crash.\n\nML Library: TensorFlow\nDirectly related to TensorFlow API usage.\n\nContract Violation Location: Model Evaluation\nOccurs clearly at the evaluation or inference stage, post-model construction.\n\nDetection Technique: Static Analysis\nDetected purely through source code inspection."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/46204569",
    "title": "",
    "question": "21\n\nI am trying to perform the usual classification on the MNIST database but with randomly cropped digits. Images are cropped the following way : removed randomly first/last and/or row/column.\n\nI would like to use a Convolutional Neural Network using Keras (and Tensorflow backend) to perform convolution and then the usual classification.\n\nInputs are of variable size and i can't manage to get it to work.\n\nHere is how I cropped digits\n\nimport numpy as np\nfrom keras.utils import to_categorical\nfrom sklearn.datasets import load_digits\n\ndigits = load_digits()\n\nX = digits.images\nX = np.expand_dims(X, axis=3)\n\nX_crop = list()\nfor index in range(len(X)):\n    X_crop.append(X[index, np.random.randint(0,2):np.random.randint(7,9), np.random.randint(0,2):np.random.randint(7,9), :])\nX_crop = np.array(X_crop)\n\ny = to_categorical(digits.target)\n\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X_crop, y, train_size=0.8, test_size=0.2)\nAnd here is the architecture of the model I want to use\n\nfrom keras.layers import Dense, Dropout\nfrom keras.layers.convolutional import Conv2D\nfrom keras.models import Sequential\n\nmodel = Sequential()\n\nmodel.add(Conv2D(filters=10, \n                 kernel_size=(3,3), \n                 input_shape=(None, None, 1), \n                 data_format='channels_last'))\n\nmodel.add(Dense(128, activation='relu'))\nmodel.add(Dropout(0.2))\n\nmodel.add(Dense(10, activation='softmax'))\n\nmodel.compile(loss='categorical_crossentropy', optimizer='sgd', metrics=['accuracy'])\n\nmodel.summary()\n\nmodel.fit(X_train, y_train, epochs=100, batch_size=16, validation_data=(X_test, y_test))\nDoes someone have an idea on how to handle variable sized input in my neural network?\n\nAnd how to perform classification?",
    "answer": "TL/DR - go to point 4\n\nSo - before we get to the point - let's fix some problems with your network:\n\nYour network will not work because of activation: with categorical_crossentropy you need to have a softmax activation:\n\nmodel.add(Dense(10, activation='softmax'))\nVectorize spatial tensors: as Daniel mentioned - you need to, at some stage, switch your vectors from spatial (images) to vectorized (vectors). Currently - applying Dense to output from a Conv2D is equivalent to (1, 1) convolution. So basically - output from your network is spatial - not vectorized what causes dimensionality mismatch (you can check that by running your network or checking the model.summary(). In order to change that you need to use either GlobalMaxPooling2D or GlobalAveragePooling2D. E.g.:\n\nmodel.add(Conv2D(filters=10, \n             kernel_size=(3, 3), \n             input_shape=(None, None, 1),\n             padding=\"same\",\n             data_format='channels_last'))\nmodel.add(GlobalMaxPooling2D())\nmodel.add(Dense(128, activation='relu'))\nmodel.add(Dropout(0.2))\n\nmodel.add(Dense(10, activation='softmax'))\nConcatenated numpy arrays need to have the same shape: if you check the shape of X_crop you'll see that it's not a spatial matrix. It's because you concatenated matrices with different shapes. Sadly - it's impossible to overcome this issue as numpy.array need to have a fixed shape.\n\nHow to make your network train on examples of different shape: The most important thing in doing this is to understand two things. First - is that in a single batch every image should have the same size. Second - is that calling fit multiple times is a bad idea - as you reset inner model states. So here is what needs to be done:\n\na. Write a function which crops a single batch - e.g. a get_cropped_batches_generator which given a matrix cuts a batch out of it and crops it randomly.\n\nb. Use train_on_batch method. Here is an example code:\n\nfrom six import next\n\nbatches_generator = get_cropped_batches_generator(X, batch_size=16)\nlosses = list()\nfor epoch_nb in range(nb_of_epochs):\n    epoch_losses = list()\n    for batch_nb in range(nb_of_batches):\n        # cropped_x has a different shape for different batches (in general)\n        cropped_x, cropped_y = next(batches_generator) \n        current_loss = model.train_on_batch(cropped_x, cropped_y)\n        epoch_losses.append(current_loss)\n    losses.append(epoch_losses.sum() / (1.0 * len(epoch_losses))\nfinal_loss = losses.sum() / (1.0 * len(losses))\nSo - a few comments to code above: First, train_on_batch doesn't use nice keras progress bar. It returns a single loss value (for a given batch) - that's why I added logic to compute loss. You could use Progbar callback for that also. Second - you need to implement get_cropped_batches_generator - I haven't written a code to keep my answer a little bit more clear. You could ask another question on how to implement it. Last thing - I use six to keep compatibility between Python 2 and Python 3.",
    "mlApiName": "keras.layers.Dense,keras.models.compile",
    "embedding": [
      0.730140745639801,
      0.5539306998252869,
      -2.32973051071167,
      -1.1477676630020142,
      0.22159022092819214,
      -0.721585214138031,
      -0.06186410412192345,
      0.3321321904659271,
      -0.27242377400398254,
      -0.5047053098678589,
      0.27164599299430847,
      0.7217016220092773,
      2.0300374031066895,
      0.5856863260269165,
      -0.5785362720489502,
      -0.8871935606002808,
      -0.16835252940654755,
      0.061814501881599426,
      0.13214519619941711,
      0.8883726596832275,
      0.6612980961799622,
      0.5360143780708313,
      0.09155088663101196,
      -0.4637676179409027,
      1.228320598602295,
      -0.14472784101963043,
      -0.5584113001823425,
      0.5791284441947937,
      0.21406124532222748,
      0.5330860018730164,
      0.6385464668273926,
      0.1592969447374344,
      -0.4256938695907593,
      -0.43135079741477966,
      -1.2059017419815063,
      0.07139834761619568,
      0.8348385691642761,
      -0.7722098231315613,
      0.7145411372184753,
      0.2872854769229889,
      0.7524333000183105,
      0.64188152551651,
      0.28691112995147705,
      0.3636324405670166,
      -0.15646272897720337,
      0.2904853820800781,
      1.658796787261963,
      -0.016841568052768707,
      0.8616124987602234,
      -0.5471351742744446,
      0.68198162317276,
      0.3907131552696228,
      0.06209911033511162,
      0.08439841121435165,
      1.0023528337478638,
      0.7493548393249512,
      0.3988703191280365,
      0.6687315702438354,
      0.7799644470214844,
      -0.684310793876648,
      0.5475732684135437,
      0.6062648892402649,
      -1.836736798286438,
      1.1142010688781738,
      0.16389405727386475,
      0.14286193251609802,
      -0.35208138823509216,
      0.707243025302887,
      -0.41767457127571106,
      -0.5594661235809326,
      0.22948598861694336,
      0.13985466957092285,
      0.05268451198935509,
      0.3062363564968109,
      0.0032358106691390276,
      -0.007520202547311783,
      -0.9464190006256104,
      -0.6961662173271179,
      -0.23471717536449432,
      0.9354223608970642,
      -0.0503205768764019,
      0.47310519218444824,
      1.1923136711120605,
      -0.22159108519554138,
      -0.03437502309679985,
      0.5687289834022522,
      -0.6628777384757996,
      -0.48237767815589905,
      -0.49501532316207886,
      0.98464035987854,
      0.06244851276278496,
      -0.06764302402734756,
      0.21496938169002533,
      0.7766758799552917,
      -0.22851693630218506,
      -0.06928177922964096,
      -0.22482356429100037,
      0.620108962059021,
      -0.9067357182502747,
      -0.5383380651473999,
      -0.20085453987121582,
      0.5243971943855286,
      -0.10993006825447083,
      -1.4891231060028076,
      -0.20029202103614807,
      0.9426776766777039,
      -0.18928392231464386,
      -0.13740584254264832,
      0.5706900954246521,
      0.0013504368253052235,
      -0.8102399706840515,
      -0.08203424513339996,
      -0.051632363349199295,
      0.15323671698570251,
      -0.013115090318024158,
      -0.01679912582039833,
      -0.19321537017822266,
      -0.3875531852245331,
      0.20706748962402344,
      -0.002555195474997163,
      -0.06289311498403549,
      -0.7639304995536804,
      0.43226158618927,
      -0.10921844094991684,
      -0.044413190335035324,
      0.707820475101471,
      -0.3793959319591522,
      0.07172617316246033,
      0.06762256473302841,
      -1.071833848953247,
      0.2664407789707184,
      -0.05624663084745407,
      0.03411593660712242,
      0.409681499004364,
      0.2849312722682953,
      1.145377516746521,
      -0.8669871091842651,
      -0.988036036491394,
      0.5699952840805054,
      -0.11340039223432541,
      0.9141430854797363,
      0.33229368925094604,
      -0.04241307079792023,
      -0.24915798008441925,
      0.24264758825302124,
      -0.3334289491176605,
      0.26522067189216614,
      -0.7057914137840271,
      -0.7573633193969727,
      -0.3860642910003662,
      -0.04022076725959778,
      0.7284405827522278,
      -1.0127207040786743,
      -0.6772681474685669,
      0.27469831705093384,
      -0.16480447351932526,
      0.23567456007003784,
      0.7875722050666809,
      0.023539049550890923,
      0.1210489273071289,
      1.195896029472351,
      0.07008333504199982,
      -0.4682437777519226,
      0.67154461145401,
      -0.2442125678062439,
      -0.7639217972755432,
      0.18038290739059448,
      0.09729886800050735,
      -0.3345746099948883,
      0.24537082016468048,
      -0.505763590335846,
      -0.4195142388343811,
      -0.0471608005464077,
      -0.6835228204727173,
      -0.13198046386241913,
      1.0040572881698608,
      0.622696042060852,
      -0.42388033866882324,
      0.5355043411254883,
      -0.21767908334732056,
      0.6683505773544312,
      0.12940020859241486,
      0.80619215965271,
      0.1705981343984604,
      -0.12110438942909241,
      -0.4125388264656067,
      0.02459365874528885,
      0.18395176529884338,
      0.03486764430999756,
      -0.6962180733680725,
      0.8904386162757874,
      -0.375663697719574,
      -0.6299222111701965,
      -0.5590184330940247,
      -0.29401424527168274,
      -0.27217963337898254,
      0.7202234268188477,
      -0.9641817808151245,
      0.7249200940132141,
      -0.5781880617141724,
      -0.31042444705963135,
      0.6210154891014099,
      -0.7733946442604065,
      1.1911420822143555,
      -0.5140392184257507,
      0.6574660539627075,
      -0.37273845076560974,
      0.770548939704895,
      -0.9555718302726746,
      0.41890645027160645,
      0.33101168274879456,
      -0.6627298593521118,
      0.025994451716542244,
      0.5154811143875122,
      -0.3546203672885895,
      -0.6036023497581482,
      0.5780810117721558,
      -0.7111008763313293,
      -0.15010367333889008,
      0.4239063560962677,
      0.5087556838989258,
      -0.5429738163948059,
      1.1770330667495728,
      -0.014054189436137676,
      0.5713200569152832,
      -0.50642329454422,
      0.5532383918762207,
      0.20437321066856384,
      -0.14264050126075745,
      0.07274214178323746,
      -1.0398560762405396,
      -0.6744117736816406,
      0.4656422734260559,
      -0.07138968259096146,
      -0.4691125452518463,
      0.6029417514801025,
      0.7793337106704712,
      0.9205067157745361,
      -0.6545789837837219,
      -0.030223945155739784,
      0.003712503472343087,
      0.33428433537483215,
      0.10412660986185074,
      0.05039166286587715,
      -0.7147610783576965,
      0.25456514954566956,
      0.0061141555197536945,
      -0.3970726728439331,
      -0.055787574499845505,
      0.607630729675293,
      -0.0535314716398716,
      0.1743512749671936,
      0.4992629289627075,
      0.17338618636131287,
      0.8172975778579712,
      -0.49837321043014526,
      -0.033999547362327576,
      0.05264470726251602,
      0.6157167553901672,
      -0.09279796481132507,
      0.630472719669342,
      0.6033324599266052,
      -0.2574302554130554,
      0.48628634214401245,
      0.26474320888519287,
      -0.941277027130127,
      -0.2307850867509842,
      -0.02622307278215885,
      -0.35285326838493347,
      -0.3170071244239807,
      -0.186641126871109,
      0.13352088630199432,
      1.1101316213607788,
      0.02031012810766697,
      0.9210079312324524,
      0.68487548828125,
      -0.03757903724908829,
      -0.5105161666870117,
      0.2452349066734314,
      -0.18903933465480804,
      -0.8602364659309387,
      -1.1059683561325073,
      -0.5196322202682495,
      0.02767631597816944,
      -0.1472543478012085,
      0.11114206165075302,
      0.2525292932987213,
      0.04477490484714508,
      0.12401728332042694,
      0.41980233788490295,
      -0.2498340755701065,
      0.49880251288414,
      -0.4081903100013733,
      0.05853261426091194,
      0.5729981660842896,
      0.36970221996307373,
      0.41022855043411255,
      0.11999058723449707,
      0.15217262506484985,
      -0.6178498268127441,
      0.6612224578857422,
      0.10874917358160019,
      0.7971521019935608,
      0.2462959885597229,
      0.012668190523982048,
      0.34944963455200195,
      -0.2265680879354477,
      -0.06863325834274292,
      0.18607431650161743,
      -0.6896013617515564,
      -0.9027204513549805,
      -0.012671097181737423,
      -0.5593059659004211,
      0.4987975060939789,
      -0.3023877739906311,
      -0.7027607560157776,
      0.11779146641492844,
      0.2849961221218109,
      0.5890737771987915,
      -0.3163837790489197,
      0.1742161214351654,
      -0.3408131003379822,
      0.24451036751270294,
      0.30190223455429077,
      -0.2792589068412781,
      0.8066198825836182,
      0.02854778990149498,
      0.35524553060531616,
      0.3302799165248871,
      0.31588882207870483,
      0.6994538307189941,
      0.2569091022014618,
      0.29816609621047974,
      -1.2339472770690918,
      -0.7382643818855286,
      -0.3569888174533844,
      0.12438775599002838,
      -0.26036179065704346,
      0.8444588780403137,
      0.37157267332077026,
      0.10234170407056808,
      0.2191043198108673,
      -0.17092423141002655,
      -0.813719630241394,
      -0.3150588274002075,
      0.6835765838623047,
      -0.7948718667030334,
      -0.8481717109680176,
      -0.09729732573032379,
      0.2004404515028,
      0.0013143455144017935,
      -0.5301620960235596,
      0.09524751454591751,
      -0.4932708740234375,
      0.3184717297554016,
      0.3759784698486328,
      0.3753732740879059,
      -0.5047536492347717,
      -0.11380020529031754,
      0.05456887185573578,
      0.6295241713523865,
      -0.09662872552871704,
      -0.13190847635269165,
      -0.10933133214712143,
      -0.3111019432544708,
      0.5844528079032898,
      1.4581730365753174,
      0.22152024507522583,
      0.9120286107063293,
      -0.2805491089820862,
      -0.2196236401796341,
      -0.2740960419178009,
      -0.3845457434654236,
      0.12868212163448334,
      -0.8559380769729614,
      0.35583940148353577,
      -0.8102214932441711,
      0.006050728261470795,
      0.18735134601593018,
      0.17875763773918152,
      0.11037303507328033,
      -0.6969477534294128,
      0.5172896385192871,
      0.10313482582569122,
      0.34108200669288635,
      0.15589973330497742,
      0.2838958203792572,
      -0.9558748602867126,
      -0.4999387860298157,
      0.7081374526023865,
      0.13220945000648499,
      -1.0136547088623047,
      -0.7842590808868408,
      -0.782166063785553,
      0.43504002690315247,
      -0.2715452313423157,
      0.9460591673851013,
      0.3131844997406006,
      -0.2468777894973755,
      0.7354573607444763,
      -0.943448007106781,
      -0.7337293028831482,
      0.06557940691709518,
      -0.512021541595459,
      -0.38661423325538635,
      -0.30328038334846497,
      -0.022493058815598488,
      -0.2334757000207901,
      -0.15749432146549225,
      0.34505581855773926,
      -0.08341266214847565,
      0.26099562644958496,
      0.06328669935464859,
      -1.4622677564620972,
      0.43885019421577454,
      0.10767726600170135,
      1.0623183250427246,
      0.8651595115661621,
      -0.4415992200374603,
      -0.9272931814193726,
      -0.3341202139854431,
      0.9369701743125916,
      0.004854173865169287,
      -0.2630225121974945,
      0.72551429271698,
      0.5234719514846802,
      0.43185076117515564,
      1.4574875831604004,
      0.3219742476940155,
      -0.9323175549507141,
      0.5812670588493347,
      0.5039733648300171,
      0.79938143491745,
      -0.06607914716005325,
      -0.36791738867759705,
      -0.09205186367034912,
      -0.6613335609436035,
      0.7212677001953125,
      0.0824253186583519,
      0.3249709904193878,
      0.906832218170166,
      -0.532289981842041,
      -0.4690295159816742,
      -0.5820544958114624,
      0.6067615151405334,
      0.45154547691345215,
      1.0060310363769531,
      -0.7453768849372864,
      -1.129724383354187,
      1.4254463911056519,
      -0.5038285851478577,
      -0.19108133018016815,
      0.33996158838272095,
      0.2281273603439331,
      1.6103153228759766,
      -0.2927469313144684,
      -0.27896636724472046,
      -0.3235478699207306,
      0.36974677443504333,
      0.37283027172088623,
      0.16963240504264832,
      0.6914452910423279,
      -0.9993526339530945,
      0.014015023596584797,
      -0.3084831237792969,
      -0.9316459894180298,
      -0.008793272078037262,
      -0.527025043964386,
      0.3934684693813324,
      0.7687171697616577,
      -0.974581778049469,
      -0.2296978384256363,
      0.3929969072341919,
      -0.18239548802375793,
      -0.19626300036907196,
      0.5935440063476562,
      -0.04399288818240166,
      -0.515245258808136,
      0.27642035484313965,
      0.40884989500045776,
      -0.13149315118789673,
      -1.3576544523239136,
      -0.033815544098615646,
      -0.184189110994339,
      -0.5029101967811584,
      1.5648880004882812,
      0.3049216568470001,
      -0.08661293238401413,
      0.39241376519203186,
      0.3532916009426117,
      0.45517292618751526,
      -0.24439631402492523,
      0.5974474549293518,
      0.3543526828289032,
      -0.4042694866657257,
      -0.6118676066398621,
      0.11274512857198715,
      0.6934226751327515,
      0.18563957512378693,
      0.28821542859077454,
      0.1460285633802414,
      0.19526278972625732,
      -0.7659578919410706,
      0.10421715676784515,
      0.814565896987915,
      -0.42271625995635986,
      0.6731415390968323,
      -0.6141776442527771,
      -0.4784470200538635,
      0.038697075098752975,
      0.2627609074115753,
      0.052769631147384644,
      0.4607836902141571,
      0.06315986067056656,
      -0.27259981632232666,
      -1.1078364849090576,
      0.3309214115142822,
      0.6071586012840271,
      -0.580507218837738,
      -0.48656779527664185,
      0.6414453983306885,
      -0.40658000111579895,
      -0.5305668711662292,
      -0.5871872901916504,
      -0.652077317237854,
      0.09442996233701706,
      -0.12095998972654343,
      -1.3441044092178345,
      -0.013418111018836498,
      -1.4805165529251099,
      0.3892926275730133,
      -0.40793290734291077,
      -1.6289857625961304,
      -0.14583490788936615,
      -0.0440114289522171,
      -0.17043042182922363,
      0.12191285938024521,
      1.0629756450653076,
      0.09042706340551376,
      -0.060650866478681564,
      0.5267088413238525,
      0.9939015507698059,
      0.18584398925304413,
      -0.6981908679008484,
      -0.5268905162811279,
      -0.32750919461250305,
      0.8876717686653137,
      0.8287318348884583,
      0.481206476688385,
      -0.8243064880371094,
      -0.2958991825580597,
      -0.42621949315071106,
      0.38840046525001526,
      -0.8349661827087402,
      -0.45244506001472473,
      -0.8009435534477234,
      -0.5924561023712158,
      -0.8583789467811584,
      -0.40447476506233215,
      -0.7156885266304016,
      -1.2644708156585693,
      0.06367506086826324,
      1.6404684782028198,
      -0.23487772047519684,
      -0.34750276803970337,
      -0.05190588906407356,
      -0.6768274307250977,
      0.19472338259220123,
      0.4664125144481659,
      0.7366652488708496,
      -0.3470848500728607,
      -0.9337771534919739,
      0.2743643522262573,
      0.29469621181488037,
      -0.17688772082328796,
      -0.2328118085861206,
      0.861671507358551,
      0.33466219902038574,
      -0.38764894008636475,
      -0.4715581238269806,
      -0.09212104231119156,
      -0.9038295149803162,
      -0.63869309425354,
      0.38017117977142334,
      -0.01726488210260868,
      0.29970717430114746,
      -0.10233119130134583,
      -0.2854776680469513,
      0.46632811427116394,
      -0.37606289982795715,
      -0.6571409106254578,
      -0.6769960522651672,
      0.9007316827774048,
      -0.1960849016904831,
      0.05531260743737221,
      0.016192039474844933,
      -0.3389591574668884,
      0.36445391178131104,
      -0.921875536441803,
      -1.1728484630584717,
      -0.5777303576469421,
      0.4984753131866455,
      1.6304421424865723,
      -1.116996169090271,
      -0.3797807991504669,
      1.2256455421447754,
      -0.6269088983535767,
      0.2263677567243576,
      -0.15921474993228912,
      -0.10520373284816742,
      0.5293960571289062,
      -0.35402411222457886,
      0.2246236354112625,
      -0.16439059376716614,
      0.29380035400390625,
      -1.1664416790008545,
      0.6846983432769775,
      -0.13519442081451416,
      -0.2391759306192398,
      -0.036231525242328644,
      -0.35372450947761536,
      -0.5648662447929382,
      1.1755752563476562,
      -0.8091794848442078,
      0.39405685663223267,
      -0.07275377959012985,
      -0.5184372067451477,
      -0.32468870282173157,
      0.4716634750366211,
      0.12690341472625732,
      -1.3140813112258911,
      0.12172774970531464,
      -1.1506701707839966,
      0.17925986647605896,
      -1.2212327718734741,
      1.247661828994751,
      -0.11062626540660858,
      1.2191680669784546,
      0.7311685085296631,
      0.7532371282577515,
      0.010662009008228779,
      0.0037400301080197096,
      -0.607542872428894,
      0.34559324383735657,
      0.32153627276420593,
      -1.0886660814285278,
      1.1430431604385376,
      1.1091654300689697,
      0.27019745111465454,
      -0.08559296280145645,
      0.8573986291885376,
      1.0649861097335815,
      -0.13057442009449005,
      -0.20528699457645416,
      0.25427326560020447,
      0.3945234715938568,
      0.01580413058400154,
      -0.36717748641967773,
      -0.4391687214374542,
      -0.3606264591217041,
      -0.15698523819446564,
      -0.3338327407836914,
      -0.8994510769844055,
      -0.7467310428619385,
      0.6662194132804871,
      -0.030900485813617706,
      -0.1747986227273941,
      0.2162603884935379,
      -0.5271528959274292,
      -0.8802911043167114,
      0.33013272285461426,
      0.2905755341053009,
      0.28753575682640076,
      0.781509280204773,
      0.8337192535400391,
      -0.3502744138240814,
      1.0154048204421997,
      1.101269006729126,
      0.3198670744895935,
      -0.1810305118560791,
      1.0270204544067383,
      -0.1261305958032608,
      0.9869205355644226,
      -0.15432628989219666,
      0.37162691354751587,
      -0.9776414632797241,
      0.029598809778690338,
      -0.44687938690185547,
      0.4574296176433563,
      -0.5614390969276428,
      -0.07847239822149277,
      -0.22991624474525452,
      0.1760716587305069,
      -0.5363092422485352,
      -0.5188323855400085,
      0.8378676176071167,
      -0.07382220774888992,
      -0.787265956401825,
      0.5721021890640259,
      1.0708988904953003,
      0.10338657349348068,
      0.3066445291042328,
      0.28851592540740967,
      0.19378693401813507,
      -0.05724784731864929,
      -0.29312336444854736,
      -0.14520502090454102,
      0.21942085027694702,
      -0.23174825310707092,
      -0.294211745262146,
      -0.7501920461654663,
      -0.20199432969093323,
      -0.535873532295227,
      1.563333511352539,
      -0.13260507583618164,
      0.23116864264011383,
      0.1613800823688507,
      -0.5419545769691467,
      -0.3730788826942444,
      -0.19946275651454926,
      -0.10609849542379379,
      -0.5550770163536072,
      -0.940615177154541,
      0.5102012157440186,
      0.04708757996559143,
      -1.0323232412338257,
      0.03153399005532265,
      0.06567490845918655,
      -0.23057705163955688,
      -0.16726966202259064,
      -0.7518616318702698,
      -0.6831058263778687,
      -1.5368438959121704,
      0.8753575086593628,
      -0.25994443893432617,
      -0.10350019484758377,
      -1.1974912881851196,
      -0.7882972955703735,
      -0.6596537232398987,
      -0.2967338562011719,
      -0.9481897354125977,
      0.4714745879173279,
      0.6070796847343445,
      -0.2773362398147583,
      -0.808237612247467,
      -0.21575962007045746,
      -1.235642671585083,
      1.5048679113388062,
      -0.08015453070402145,
      -0.567256510257721,
      0.19704462587833405,
      -0.4553409516811371,
      -0.6822080016136169,
      0.6666815280914307,
      -0.5409611463546753,
      1.0481336116790771,
      -0.023927003145217896,
      0.9308812022209167,
      1.1490992307662964,
      0.031469494104385376,
      0.04276035726070404,
      -0.36388251185417175,
      0.12277921289205551,
      0.5854818820953369,
      0.026486767455935478,
      -0.49613717198371887,
      -0.2093706876039505,
      -0.059357233345508575
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SAI",
      "level3": "IC-2,F",
      "leafContractCategory": "SAM (Level 3) ? AMO(Level 2)",
      "rootCause": "Missing Input value-Method order Dependency",
      "effect": "Unknown",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1: Hybrid\nComplex scenario involving multiple APIs (Dense layer and compile method in Keras).\n\nLevel 2: SAM-AMO Interdependency (SAI)\nThis scenario indicates a complex dependency between the correctness of single API calls and their required method-ordering constraints.\n\nLevel 3: Inter-argument Contract (IC-2), Eventually (F)\nThis denotes combined issues related to interdependencies between arguments across multiple calls and required eventual correctness in sequence.\n\nLeaf Contract Category: SAM (Level 3) and AMO(Level 2)\nThe violation precisely matches the hybrid interaction between correct API method usage and ordering constraints.\n\nRoot Cause: Missing Input value-Method order Dependency\nThis indicates a critical input value was dependent upon a specific order of method execution which was not followed.\n\nEffect: Unknown\nThe specific consequence isn't explicitly a crash or incorrect functionality; rather, the outcome is not fully known.\n\nML Library: Keras\nPertains directly to Keras API usage.\n\nContract Violation Location: Model Construction\nIssue arises clearly during the setup of the Keras model layers.\n\nDetection Technique: Static Analysis\nProblem is evident by inspecting the code for API misuse and incorrect ordering."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/44717100",
    "title": "",
    "question": "19\n\nI have 2 numpy arrays, which I convert into tensors to use the TensorDataset object.\n\nimport torch.utils.data as data_utils\n\nX = np.zeros((100,30))\nY = np.zeros((100,30))\n\ntrain = data_utils.TensorDataset(torch.from_numpy(X).double(), torch.from_numpy(Y))\ntrain_loader = data_utils.DataLoader(train, batch_size=50, shuffle=True)\nwhen I do:\n\nfor batch_idx, (data, target) in enumerate(train_loader):\n    data, target = Variable(data), Variable(target)\n    optimizer.zero_grad()\n    output = model(data)               # error occurs here\nI get the fallowing error:\n\nTypeError: addmm_ received an invalid combination of arguments - got (int, int, torch.DoubleTensor, torch.FloatTensor), but expected one of: [...]\n* (float beta, float alpha, torch.DoubleTensor mat1, torch.DoubleTensor mat2) didn't match because some of the arguments have invalid types: (int, int, torch.DoubleTensor, torch.FloatTensor)\n* (float beta, float alpha, torch.SparseDoubleTensor mat1, torch.DoubleTensor mat2) didn't match because some of the arguments have invalid types: (int, int, torch.DoubleTensor, torch.FloatTensor)\n\nThe last error comes from:\n\noutput.addmm_(0, 1, input, weight.t())\n\nAs you see in my code I tried converting the tensor by using .double() - but this did not work. Why is he casting one array into a FloatTensor object and the other into a DoubleTensor? Any ideas?\n\npythontorchpytorch",
    "answer": "Your numpy arrays are 64-bit floating point and will be converted to torch.DoubleTensor standardly. Now, if you use them with your model, you'll need to make sure that your model parameters are also Double. Or you need to make sure, that your numpy arrays are cast as Float, because model parameters are standardly cast as float.\n\nHence, do either of the following:\n\ndata_utils.TensorDataset(torch.from_numpy(X).float(), torch.from_numpy(Y).float())\nor do:\n\nmodel.double()\nDepeding, if you want to cast your model parameters, inputs and targets as Float or as Double.",
    "mlApiName": "torch.utils.data.TensorDataset",
    "embedding": [
      0.19012407958507538,
      1.0071797370910645,
      -2.416158676147461,
      -1.322166919708252,
      1.9226561784744263,
      -0.44825422763824463,
      0.6441146731376648,
      0.13062672317028046,
      -0.7240106463432312,
      -1.092002034187317,
      -0.7591286301612854,
      0.6860306859016418,
      1.3319543600082397,
      -0.7308105826377869,
      -0.12614890933036804,
      -0.8804818987846375,
      -0.0025877233128994703,
      -0.9215615391731262,
      -0.2737841308116913,
      1.0144975185394287,
      -0.7488774657249451,
      0.05603109672665596,
      0.4970201253890991,
      -0.9359063506126404,
      0.9146926403045654,
      -0.3891933858394623,
      -0.1851266622543335,
      0.7132133841514587,
      -1.2404377460479736,
      0.07146081328392029,
      1.4647552967071533,
      -0.19792647659778595,
      0.5242148637771606,
      -0.48739153146743774,
      -1.3134167194366455,
      -0.5192379951477051,
      0.8125419020652771,
      -0.15024180710315704,
      1.0618406534194946,
      -0.12203749269247055,
      0.22518989443778992,
      0.1326732188463211,
      -0.13128232955932617,
      0.2549642324447632,
      0.26579198241233826,
      -0.5640643239021301,
      2.0008556842803955,
      0.23136578500270844,
      -0.36377763748168945,
      -0.8376578092575073,
      0.5257620811462402,
      -0.3271690011024475,
      -0.09017438441514969,
      -0.12842977046966553,
      1.584429383277893,
      -0.008700151927769184,
      -0.2570211589336395,
      0.2617737650871277,
      0.2969883978366852,
      -0.10957878828048706,
      -0.11186999082565308,
      1.6644450426101685,
      -0.42001819610595703,
      -0.07171917706727982,
      0.7386175394058228,
      0.44134706258773804,
      -1.0373464822769165,
      0.14478328824043274,
      -0.4162367284297943,
      -0.44929763674736023,
      0.9507426619529724,
      0.2851119935512543,
      0.25939539074897766,
      0.626639723777771,
      -0.17286713421344757,
      0.17799007892608643,
      0.015521902590990067,
      -0.5546911954879761,
      0.1486928015947342,
      0.25753235816955566,
      -0.06526875495910645,
      0.4105319380760193,
      1.093122124671936,
      0.036296240985393524,
      -0.11531040072441101,
      -0.3536197543144226,
      -0.9867271184921265,
      0.5493559837341309,
      -0.7347838282585144,
      0.4727460443973541,
      -0.6332619190216064,
      0.06357518583536148,
      0.7585838437080383,
      1.0670169591903687,
      -0.5200267434120178,
      -0.25052329897880554,
      -0.08961760997772217,
      0.863825798034668,
      -0.12133856862783432,
      0.22421051561832428,
      -0.39434635639190674,
      0.6409873962402344,
      0.0966394692659378,
      -0.5229378938674927,
      -0.13774459064006805,
      0.9964311718940735,
      0.5026044249534607,
      1.155172348022461,
      -0.44488146901130676,
      -0.8365005850791931,
      -1.141679286956787,
      0.4288773536682129,
      -0.5284467339515686,
      -1.558672308921814,
      -0.20221486687660217,
      -0.2021404206752777,
      0.6380282640457153,
      -1.156169056892395,
      0.5415005683898926,
      0.4920361340045929,
      -0.06525266170501709,
      -1.4001559019088745,
      0.6565257906913757,
      1.2631686925888062,
      0.24047699570655823,
      -0.6402779817581177,
      -0.32552725076675415,
      0.3247777819633484,
      0.09120658040046692,
      -1.1987743377685547,
      0.1474830061197281,
      -1.1524235010147095,
      -0.5825992822647095,
      -0.0419725626707077,
      0.7397329211235046,
      1.3567225933074951,
      -0.26288914680480957,
      -0.5335690379142761,
      0.5737860798835754,
      0.1592593789100647,
      0.12715940177440643,
      -0.25772982835769653,
      -0.3944503664970398,
      -0.8771066665649414,
      1.4331066608428955,
      -0.647269606590271,
      0.3275853991508484,
      0.13986587524414062,
      -0.493497759103775,
      0.6312980055809021,
      -0.16618767380714417,
      1.0713001489639282,
      -0.502763569355011,
      -0.6212376356124878,
      0.3327997922897339,
      -0.6309553980827332,
      0.9259718060493469,
      0.6788392663002014,
      0.8915762901306152,
      -0.618925929069519,
      1.4821895360946655,
      0.4173908233642578,
      -0.5262882113456726,
      0.3169882893562317,
      0.5333043336868286,
      -0.465646356344223,
      -0.35797157883644104,
      -0.07808416336774826,
      -0.023293234407901764,
      0.43398961424827576,
      -1.1004638671875,
      -0.5961756706237793,
      0.15800733864307404,
      -0.767381489276886,
      -0.016717569902539253,
      1.4625188112258911,
      0.43173205852508545,
      -0.01721985824406147,
      0.7412514090538025,
      -0.25346139073371887,
      0.3685135245323181,
      -0.4376157224178314,
      0.3561195135116577,
      -0.4479324221611023,
      -0.7760657072067261,
      -0.23886053264141083,
      -0.0781579464673996,
      -0.29324406385421753,
      -0.08493622392416,
      -0.2064138799905777,
      -0.2769559621810913,
      -0.12648838758468628,
      -0.6340582370758057,
      0.17470161616802216,
      -0.14643263816833496,
      0.33733564615249634,
      0.8798573613166809,
      -0.6532421708106995,
      0.759788453578949,
      0.2909528911113739,
      -0.1308356523513794,
      -0.20070339739322662,
      -0.17995589971542358,
      0.28992506861686707,
      -0.2852114737033844,
      0.8348619937896729,
      -0.11720400303602219,
      1.056458830833435,
      -0.5676326155662537,
      0.9917960166931152,
      0.46607282757759094,
      0.3948056995868683,
      0.5645186901092529,
      0.7217687368392944,
      -0.8618107438087463,
      -0.3536829948425293,
      0.8108935356140137,
      -1.352037787437439,
      -0.8817599415779114,
      0.10457246005535126,
      0.22053903341293335,
      0.34153857827186584,
      0.3117353618144989,
      0.17917446792125702,
      1.2496557235717773,
      -0.46643906831741333,
      0.38093945384025574,
      -0.00660745007917285,
      0.02161276526749134,
      -0.4715278744697571,
      -0.7542893886566162,
      -0.43469172716140747,
      0.844694197177887,
      0.25753143429756165,
      -0.428161084651947,
      0.2724127173423767,
      -0.1618029773235321,
      0.9666727185249329,
      -0.10551188886165619,
      0.02212882600724697,
      0.0824124664068222,
      0.5021592974662781,
      0.019666392356157303,
      -0.600628674030304,
      -0.7522697448730469,
      0.10454931855201721,
      -0.4468904435634613,
      -0.2801295518875122,
      0.5266625285148621,
      1.2646478414535522,
      -0.5445023775100708,
      0.38050660490989685,
      0.28201061487197876,
      0.29564833641052246,
      0.7115028500556946,
      -0.0036013296339660883,
      -1.1351516246795654,
      -0.5219154357910156,
      -0.1149701476097107,
      0.2748965322971344,
      0.9280901551246643,
      0.12934842705726624,
      0.1368923783302307,
      -0.2682504951953888,
      -1.243231177330017,
      0.09131608158349991,
      -0.29022908210754395,
      0.13154129683971405,
      0.026640634983778,
      0.1395309716463089,
      -0.28721195459365845,
      -0.07111119478940964,
      0.6665631532669067,
      -0.3781447112560272,
      0.2901078760623932,
      0.6412653923034668,
      -0.33462247252464294,
      -0.10519887506961823,
      0.15260383486747742,
      0.04018161818385124,
      -1.6142921447753906,
      -0.06525572389364243,
      -0.8819881081581116,
      1.0609190464019775,
      0.9148756265640259,
      0.38309696316719055,
      -0.4445364773273468,
      0.13622914254665375,
      0.4062406122684479,
      0.3997293710708618,
      -0.30945274233818054,
      0.21758601069450378,
      -0.11271272599697113,
      -0.211714968085289,
      -0.412966787815094,
      0.9026989340782166,
      1.158372402191162,
      -0.40338048338890076,
      -0.3622916340827942,
      -0.48414912819862366,
      0.707465648651123,
      1.4683078527450562,
      0.4927678406238556,
      0.4787614345550537,
      -0.26111331582069397,
      0.4699549674987793,
      -0.14721941947937012,
      -0.640920102596283,
      0.5495510697364807,
      -0.13801708817481995,
      -0.7678555250167847,
      0.10908078402280807,
      -0.39711499214172363,
      0.6724522709846497,
      -0.20584140717983246,
      -0.0011646862840279937,
      0.143412783741951,
      0.43461960554122925,
      0.09070485830307007,
      -0.6140571236610413,
      -0.6190863847732544,
      -0.5330506563186646,
      0.5533524751663208,
      -0.40567412972450256,
      0.34376832842826843,
      1.1147559881210327,
      0.5163995027542114,
      0.3570387661457062,
      0.11720087379217148,
      -0.012239641509950161,
      0.0726810172200203,
      -0.17745627462863922,
      0.11019489914178848,
      -0.3399123251438141,
      -1.7494767904281616,
      0.05279102548956871,
      -0.1193116307258606,
      -0.5500701069831848,
      0.10833822935819626,
      0.929871141910553,
      0.13965411484241486,
      0.16402173042297363,
      0.37933480739593506,
      -1.1602743864059448,
      0.2187429964542389,
      0.697601854801178,
      -1.1996101140975952,
      -0.636651873588562,
      1.0294359922409058,
      0.2402150183916092,
      0.8050037026405334,
      -0.21362358331680298,
      -0.0038041449151933193,
      -1.025585651397705,
      0.2636919319629669,
      0.2823343276977539,
      1.147916316986084,
      0.46938249468803406,
      -0.49230363965034485,
      -0.04385233670473099,
      1.0528812408447266,
      0.09590376913547516,
      -0.30122703313827515,
      -0.4538997709751129,
      -0.15560735762119293,
      -0.08359268307685852,
      0.36961567401885986,
      0.35490357875823975,
      0.7199145555496216,
      0.3251667320728302,
      0.12908010184764862,
      -0.1418774276971817,
      -0.27308788895606995,
      0.41879189014434814,
      -1.0469003915786743,
      -0.42870432138442993,
      -0.7202574610710144,
      -0.6320065855979919,
      -0.09000649303197861,
      0.32483187317848206,
      1.0953103303909302,
      -0.5397406220436096,
      0.26451072096824646,
      -0.8408421277999878,
      -0.04126386344432831,
      0.32681459188461304,
      1.0762289762496948,
      -1.1074893474578857,
      -0.37147852778434753,
      0.238734170794487,
      0.29251164197921753,
      -0.1696472465991974,
      -0.9496075510978699,
      -0.9590434432029724,
      0.6050146222114563,
      -0.5656697750091553,
      0.8196516633033752,
      0.31535083055496216,
      -0.9455382227897644,
      0.1656479388475418,
      -1.189400315284729,
      -0.22839294373989105,
      0.5085120797157288,
      -0.9055434465408325,
      -0.2582632005214691,
      -0.4137232303619385,
      -0.4376170337200165,
      0.09466888010501862,
      0.9258632063865662,
      0.3514114022254944,
      -0.09613658487796783,
      1.1070306301116943,
      0.4320289194583893,
      -1.1932439804077148,
      1.6222079992294312,
      0.0886419415473938,
      0.6714176535606384,
      0.6229055523872375,
      -0.5882277488708496,
      -0.6490936279296875,
      -0.4163232743740082,
      0.4486958980560303,
      0.38577139377593994,
      -0.19356600940227509,
      0.976192057132721,
      0.8317710757255554,
      1.480133056640625,
      0.46950989961624146,
      0.6862760782241821,
      -1.1548562049865723,
      0.20237016677856445,
      0.6465328931808472,
      0.11776809394359589,
      -0.040481969714164734,
      -0.1493852138519287,
      -0.1563253402709961,
      0.046078409999608994,
      1.3049211502075195,
      0.08700746297836304,
      1.5270007848739624,
      1.3688621520996094,
      0.030445583164691925,
      -0.01584252156317234,
      -0.6725969314575195,
      0.7688271999359131,
      0.6596602201461792,
      1.3134677410125732,
      -1.1225764751434326,
      -1.5226430892944336,
      1.685245394706726,
      -0.3300033509731293,
      0.01671159453690052,
      0.39229780435562134,
      -0.687972366809845,
      1.8054941892623901,
      0.431180477142334,
      0.08552383631467819,
      0.8896700739860535,
      0.3043270707130432,
      0.11735718697309494,
      -0.022242620587348938,
      -0.8456487059593201,
      -1.1599757671356201,
      -0.44097352027893066,
      -0.4664837718009949,
      -1.2947479486465454,
      -0.8414461612701416,
      -0.27154970169067383,
      -0.2690964639186859,
      0.277477502822876,
      -0.9934291243553162,
      -0.26652640104293823,
      -0.14794422686100006,
      0.3112981915473938,
      0.3308102786540985,
      -0.41915658116340637,
      -0.24800480902194977,
      0.2945939302444458,
      0.179165318608284,
      0.9689360857009888,
      0.10451287776231766,
      -0.8775402903556824,
      -0.010807218961417675,
      0.03570537269115448,
      0.26953214406967163,
      1.435555338859558,
      -0.2396942526102066,
      -0.18725021183490753,
      1.0542473793029785,
      -0.09574562311172485,
      0.4095339775085449,
      0.045362334698438644,
      0.024674899876117706,
      -0.11841461062431335,
      -1.405689001083374,
      -0.20127765834331512,
      0.43314680457115173,
      0.9315086007118225,
      0.48884591460227966,
      0.20846346020698547,
      0.21511858701705933,
      0.5566234588623047,
      -0.6743956804275513,
      0.4449525475502014,
      0.8412263989448547,
      -0.24029704928398132,
      1.5101653337478638,
      -0.6088535189628601,
      0.1296343356370926,
      0.2573428153991699,
      0.8219613432884216,
      0.035283301025629044,
      0.6656679511070251,
      -0.32807689905166626,
      0.09535656869411469,
      -1.3370457887649536,
      0.24737219512462616,
      -0.3068429231643677,
      -0.9388940334320068,
      -0.24433672428131104,
      0.2589895725250244,
      -1.2635893821716309,
      -0.251668244600296,
      -0.9144126772880554,
      0.06321310997009277,
      0.30889013409614563,
      0.2773253917694092,
      -0.7906201481819153,
      0.5770464539527893,
      -0.11719459295272827,
      0.416404664516449,
      -0.25038057565689087,
      -0.9579522013664246,
      -0.11561831831932068,
      0.49136805534362793,
      -0.8522475957870483,
      -0.17289920151233673,
      0.7916165590286255,
      0.0803421139717102,
      0.2576592266559601,
      0.5106061697006226,
      0.7605265974998474,
      -0.21751315891742706,
      0.015728075057268143,
      -1.037623405456543,
      -0.5572932958602905,
      -0.07237765938043594,
      1.0895246267318726,
      0.09578496962785721,
      -0.7348448038101196,
      0.7326294779777527,
      -0.4069066345691681,
      -0.017023716121912003,
      -1.3825840950012207,
      0.1996532380580902,
      -0.7794002890586853,
      -1.4596754312515259,
      -1.1011309623718262,
      -0.8104758262634277,
      -0.655018150806427,
      -0.022830933332443237,
      0.2965086102485657,
      1.49067223072052,
      0.37824735045433044,
      0.6478206515312195,
      -0.626187801361084,
      -0.6476421356201172,
      -0.14474470913410187,
      0.037590429186820984,
      -0.0031915863510221243,
      0.5053079128265381,
      -0.8849930763244629,
      -0.19575226306915283,
      -0.43686822056770325,
      -0.31834039092063904,
      0.03869449347257614,
      -0.20624877512454987,
      0.5633921027183533,
      -0.4216019809246063,
      0.009351302869617939,
      0.17749209702014923,
      -0.5449767112731934,
      0.6556242108345032,
      0.5772927403450012,
      -1.159949779510498,
      0.054380081593990326,
      -0.2974551022052765,
      -1.147489070892334,
      0.3523753881454468,
      -0.6293190121650696,
      -0.6426748633384705,
      -0.40477755665779114,
      0.405061811208725,
      -0.12041384726762772,
      -0.5685683488845825,
      0.706274151802063,
      -0.2943767011165619,
      0.322296679019928,
      -0.2866959273815155,
      -1.3052705526351929,
      0.13463234901428223,
      0.08528980612754822,
      0.9266626834869385,
      -0.6803855299949646,
      0.1724100261926651,
      1.34268319606781,
      -0.7378614544868469,
      -0.38827386498451233,
      -0.5393477082252502,
      0.3714280128479004,
      0.438884437084198,
      -0.09254732728004456,
      -0.32118842005729675,
      0.22859281301498413,
      -0.32386669516563416,
      -0.5830749869346619,
      0.15929116308689117,
      0.05745398625731468,
      -0.2644556164741516,
      -0.08282327651977539,
      0.21467824280261993,
      -0.7555058002471924,
      1.3470189571380615,
      -1.1886465549468994,
      0.39611291885375977,
      -0.27371299266815186,
      -1.1081091165542603,
      0.5944645404815674,
      0.43478313088417053,
      0.15621650218963623,
      -0.9955374598503113,
      -0.40579986572265625,
      -1.570183515548706,
      -0.24412284791469574,
      -1.2979137897491455,
      1.3903450965881348,
      -0.16149958968162537,
      0.9503333568572998,
      0.2150082290172577,
      0.6263118386268616,
      -0.3182999789714813,
      0.33197104930877686,
      -0.4474538266658783,
      0.8164418339729309,
      -0.2233116775751114,
      -0.38572952151298523,
      0.5099101662635803,
      0.8087325692176819,
      -1.4361528158187866,
      -0.03266341611742973,
      0.6053118705749512,
      1.318278193473816,
      -0.2961213290691376,
      0.47723594307899475,
      -0.23856739699840546,
      -0.019049130380153656,
      -0.0018306317506358027,
      0.011122412979602814,
      -1.088323950767517,
      -0.46301209926605225,
      0.03520689532160759,
      -0.8734635710716248,
      -0.6605981588363647,
      0.4345282316207886,
      1.3124250173568726,
      0.5771856307983398,
      -0.2610141634941101,
      0.46314737200737,
      0.07449891418218613,
      -1.0949630737304688,
      -0.13912619650363922,
      0.6442831158638,
      -0.8668261766433716,
      -0.03852328658103943,
      0.8908669948577881,
      -0.007815786637365818,
      0.7922847270965576,
      0.5046247839927673,
      -0.37345051765441895,
      -0.5686414241790771,
      0.6395615935325623,
      -0.1777789145708084,
      -0.09450814872980118,
      -0.37936243414878845,
      0.1963324099779129,
      -0.15567634999752045,
      0.49529701471328735,
      -0.35207197070121765,
      -0.6208328008651733,
      -0.6250185370445251,
      0.1693391054868698,
      0.08861949294805527,
      0.1435360312461853,
      -0.012791038490831852,
      -0.7738869190216064,
      0.07190416753292084,
      0.2993161976337433,
      -0.5614482164382935,
      0.5502164959907532,
      0.7782549262046814,
      0.2357427030801773,
      -0.42102038860321045,
      0.3210756480693817,
      0.3449767529964447,
      -0.7253451347351074,
      0.3747256398200989,
      0.5624068975448608,
      0.6747195720672607,
      -0.459911584854126,
      -1.3901207447052002,
      0.7332852482795715,
      0.2522902488708496,
      -0.057324521243572235,
      1.216833233833313,
      0.17198783159255981,
      0.4331541955471039,
      -0.3638395071029663,
      -1.09365713596344,
      -0.07134006917476654,
      -0.2310996949672699,
      0.12318968772888184,
      0.1485985368490219,
      -1.6907532215118408,
      0.508171021938324,
      -0.15285629034042358,
      -1.0729162693023682,
      -0.4495885372161865,
      0.2709012031555176,
      -0.46133145689964294,
      0.509889543056488,
      -0.5847867131233215,
      -0.09545012563467026,
      -0.8024608492851257,
      0.8586509823799133,
      0.2245129644870758,
      -0.30578547716140747,
      -0.24620723724365234,
      -0.7243697643280029,
      -0.92976313829422,
      -0.029491601511836052,
      -0.7446357607841492,
      0.7924360632896423,
      -0.5407636165618896,
      0.44821321964263916,
      -1.166274905204773,
      -0.9575653076171875,
      -1.6475985050201416,
      2.048262596130371,
      0.07585818320512772,
      -0.6432819962501526,
      -1.0219162702560425,
      -0.11948202550411224,
      -0.0747312679886818,
      0.8061395287513733,
      -0.06519561260938644,
      0.2913297414779663,
      0.07493142783641815,
      1.4073468446731567,
      2.0592525005340576,
      0.3956032693386078,
      0.533193826675415,
      -0.6323976516723633,
      0.2683444321155548,
      0.5755492448806763,
      -0.46207132935523987,
      -0.08457835018634796,
      -0.9893810153007507,
      -0.6430966258049011
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SL",
      "level3": "IC-2",
      "leafContractCategory": "SAM(Level-3)",
      "rootCause": "Missing Options",
      "effect": "Crash",
      "mlLibrary": "Pytorch",
      "contractViolationLocation": "Model Initialization",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): Hybrid\nThe problem involves multiple method calls in combination, specifically the interaction between data preparation (TensorDataset) and model usage. This represents a hybrid scenario involving multiple API calls.\n\nLevel 2: SL (Selection)\nThe violation stems from selecting mismatched data types without proper compatibility checks, leading to tensor type mismatches.\n\nLevel 3 (Hybrid Patterns): IC-2 (Inter-argument Contract)\nThe error explicitly arises because two tensors (X and Y) passed simultaneously into the same API call (TensorDataset) have incompatible types (one tensor is DoubleTensor, the other implicitly converted FloatTensor).\n\nLeaf Contract Category: SAM (Level-3)\nAt the leaf level, the contract violation specifically occurs during a single API method (TensorDataset) call, due to inconsistent tensor data types among arguments.\n\nRoot Cause: Missing Options\nThe root cause is that required explicit options for ensuring data type compatibility were omitted. Specifically, the user did not specify or harmonize tensor data types across both the input data and the model parameters, causing the mismatch.\n\nEffect: Crash\nThe incompatible data types lead directly to a runtime exception (a crash), stopping the execution of the program.\n\nML Library: PyTorch\nThe issue specifically relates to PyTorch and its tensor management system within the torch.utils.data.TensorDataset API.\n\nContract Violation Location: Model Initialization\nThe error occurs at the model initialization stage, specifically when the prepared dataset is initially passed into the model for training or inference.\n\nDetection Technique: Static\nThe contract violation can be identified through static analysis since it pertains to incorrect argument types and method usage that can be detected by analyzing the source code."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/39467496",
    "title": "",
    "question": "i'm learning keras these days, and i met an error when using scikit-learn API.Here are something maybe useful:\n\nENVIRONMENT:\n\npython:3.5.2  \nkeras:1.0.5  \nscikit-learn:0.17.1\nCODE\n\nimport pandas as pd\nfrom keras.layers import Input, Dense\nfrom keras.models import Model\nfrom keras.models import Sequential\nfrom keras.wrappers.scikit_learn import KerasRegressor\nfrom sklearn.cross_validation import train_test_split\nfrom sklearn.cross_validation import cross_val_score\nfrom sqlalchemy import create_engine\nfrom sklearn.cross_validation import KFold\n\ndef read_db():\n    \"get prepared data from mysql.\"\n    con_str = \"mysql+mysqldb://root:0000@localhost/nbse?charset=utf8\"\n    engine = create_engine(con_str)\n    data = pd.read_sql_table('data_ml', engine)\n    return data\n\ndef nn_model():\n    \"create a model.\"\n    model = Sequential()\n    model.add(Dense(output_dim=100, input_dim=105, activation='softplus'))\n    model.add(Dense(output_dim=1, input_dim=100, activation='softplus'))\n    model.compile(loss='mean_squared_error', optimizer='adam')\n    return model\n\ndata = read_db()\ny = data.pop('PRICE').as_matrix()\nx = data.as_matrix()\nmodel = nn_model()\nmodel = KerasRegressor(build_fn=model, nb_epoch=2)\nmodel.fit(x,y)  #something wrong here!\nERROR\n\nTraceback (most recent call last):\n  File \"C:/Users/Administrator/PycharmProjects/forecast/gridsearch.py\", line 43, in \n    model.fit(x,y)\n  File \"D:\\Program Files\\Python35\\lib\\site-packages\\keras\\wrappers\\scikit_learn.py\", line 135, in fit\n    **self.filter_sk_params(self.build_fn.__call__))\nTypeError: __call__() missing 1 required positional argument: 'x'\n\nProcess finished with exit code 1\n??the model works well without packaging with kerasRegressor, but i wanna using sk_learn's gridSearch after this, so i'm here for help. I tried but still have no idea.\n\nsomething maybe helpful:\n\nkeras.warappers.scikit_learn.py  \n\nclass BaseWrapper(object):  \n\n    def __init__(self, build_fn=None, **sk_params):\n        self.build_fn = build_fn\n        self.sk_params = sk_params\n        self.check_params(sk_params)  \n\n    def fit(self, X, y, **kwargs):\n        '''Construct a new model with build_fn and fit the model according\n        to the given training data.\n    # Arguments\n        X : array-like, shape `(n_samples, n_features)`\n            Training samples where n_samples in the number of samples\n            and n_features is the number of features.\n        y : array-like, shape `(n_samples,)` or `(n_samples, n_outputs)`\n            True labels for X.\n        kwargs: dictionary arguments\n            Legal arguments are the arguments of `Sequential.fit`\n\n    # Returns\n        history : object\n            details about the training history at each epoch.\n    '''\n\n    if self.build_fn is None:\n        self.model = self.__call__(**self.filter_sk_params(self.__call__))\n    elif not isinstance(self.build_fn, types.FunctionType):\n        self.model = self.build_fn(\n            **self.filter_sk_params(self.build_fn.__call__))\n    else:\n        self.model = self.build_fn(**self.filter_sk_params(self.build_fn))\n\n    loss_name = self.model.loss\n    if hasattr(loss_name, '__name__'):\n        loss_name = loss_name.__name__\n    if loss_name == 'categorical_crossentropy' and len(y.shape) != 2:\n        y = to_categorical(y)\n\n    fit_args = copy.deepcopy(self.filter_sk_params(Sequential.fit))\n    fit_args.update(kwargs)\n\n    history = self.model.fit(X, y, **fit_args)\n\n    return history\n??error occored in this line:\n\n    self.model = self.build_fn(\n        **self.filter_sk_params(self.build_fn.__call__))\nself.build_fn here is keras.models.Sequential\n\nmodels.py  \n\nclass Sequential(Model):\n\n    def call(self, x, mask=None):\n        if not self.built:\n            self.build()\n        return self.model.call(x, mask)\nSo, what's that x mean and how to fix this error?\nThanks!",
    "answer": "13\n\nxiao, I ran into the same issue! Hopefully this helps:\n\nBackground and The Issue\nThe documentation for Keras states that, when implementing Wrappers for scikit-learn, there are two arguments. The first is the build function, which is a \"callable function or class instance\". Specifically, it states that:\n\nbuild_fn should construct, compile and return a Keras model, which will then be used to fit/predict. One of the following three values could be passed to build_fn:\n\nA function\nAn instance of a class that implements the call method\nNone. This means you implement a class that inherits from either KerasClassifier or KerasRegressor. The call method of the present class will then be treated as the default build_fn.\nIn your code, you create the model, and then pass the model as the value for the argument build_fn when creating the KerasRegressor wrapper:\n\nmodel = nn_model()\nmodel = KerasRegressor(build_fn=model, nb_epoch=2)\nHerein lies the issue. Rather than passing your nn_model function as the build_fn, you pass an actual instance of the Keras Sequential model. For this reason, when fit() is called, it cannot find the call method, because it is not implemented in the class you returned.\n\nProposed Solution\nWhat I did to make things work is pass the function as build_fn, rather than an actual model:\n\ndata = read_db()\ny = data.pop('PRICE').as_matrix()\nx = data.as_matrix()\n# model = nn_model() # Don't do this!\n# set build_fn equal to the nn_model function\nmodel = KerasRegressor(build_fn=nn_model, nb_epoch=2) # note that you do not call the function!\nmodel.fit(x,y)  # fixed!\nThis is not the only solution (you could set build_fn to a class that implements the call method appropriately), but the one that worked for me. I hope it helps you!",
    "mlApiName": "keras.wrappers.scikit_learn.KerasRegressor",
    "embedding": [
      0.06120260804891586,
      0.13618572056293488,
      -1.9311399459838867,
      -1.036051869392395,
      1.2773783206939697,
      0.6901286244392395,
      -0.3801162838935852,
      0.29802122712135315,
      0.055757541209459305,
      -0.9585775136947632,
      0.15180504322052002,
      0.15554508566856384,
      2.030167579650879,
      -0.05290008708834648,
      -0.47277042269706726,
      -0.39395177364349365,
      0.7429023385047913,
      0.033015865832567215,
      -0.07982123643159866,
      1.1771260499954224,
      -0.6902907490730286,
      -0.4667750597000122,
      0.03495463356375694,
      -0.07730304449796677,
      1.700906753540039,
      -0.19324108958244324,
      -0.4306800067424774,
      0.49106720089912415,
      0.14861755073070526,
      0.4491630792617798,
      0.833778440952301,
      -0.013697144575417042,
      0.03736604005098343,
      -0.6697861552238464,
      -1.3849384784698486,
      -0.959931492805481,
      0.31298112869262695,
      -0.4666058421134949,
      -0.4253304898738861,
      -0.08609703928232193,
      0.13835874199867249,
      0.028792547062039375,
      0.5881555676460266,
      0.5850771069526672,
      0.607326328754425,
      -0.501529335975647,
      0.8090028166770935,
      0.445254921913147,
      0.7046858668327332,
      -0.28778499364852905,
      0.5780476927757263,
      -0.22060711681842804,
      0.25054046511650085,
      0.35091039538383484,
      1.1864287853240967,
      0.8164052963256836,
      0.36342987418174744,
      0.6664249897003174,
      0.6478833556175232,
      -0.7694199681282043,
      0.5406391024589539,
      1.0306750535964966,
      -0.4469826817512512,
      0.9859419465065002,
      0.26668694615364075,
      -0.48487165570259094,
      -0.39855140447616577,
      1.4042035341262817,
      -0.7394704818725586,
      0.06041957437992096,
      1.0408273935317993,
      0.5215786099433899,
      0.728715181350708,
      -0.13054820895195007,
      -0.865114688873291,
      0.4272318184375763,
      -0.5121199488639832,
      -0.3948710262775421,
      -0.7582374811172485,
      0.7098500728607178,
      -0.26345714926719666,
      1.2311947345733643,
      0.7263078689575195,
      -0.005871259141713381,
      -0.4076780676841736,
      -0.024720696732401848,
      -1.169797420501709,
      -0.7133884429931641,
      -0.5016080141067505,
      0.8731865286827087,
      -0.5129628777503967,
      -0.15443995594978333,
      0.06679963320493698,
      0.41944876313209534,
      -0.6688165068626404,
      -0.5202473998069763,
      -0.06992872059345245,
      0.05712122097611427,
      -0.6736190915107727,
      0.658581554889679,
      -0.6956579685211182,
      0.019189758226275444,
      -0.025559622794389725,
      -0.5507619976997375,
      0.2487310916185379,
      0.9131764769554138,
      -0.10373103618621826,
      -0.06496703624725342,
      0.5037281513214111,
      -0.5416077375411987,
      -0.10093776881694794,
      0.403473824262619,
      -0.061780139803886414,
      -0.6524143218994141,
      0.33856645226478577,
      0.06671629101037979,
      0.23642182350158691,
      -0.39962267875671387,
      0.5680097341537476,
      0.26029255986213684,
      -0.6275873184204102,
      -0.6360528469085693,
      0.23958177864551544,
      0.3577306270599365,
      0.12817439436912537,
      0.7089091539382935,
      -0.21151697635650635,
      0.03236685320734978,
      -0.48344963788986206,
      -0.4863784909248352,
      -0.07712956517934799,
      -0.7182949781417847,
      -0.7695899605751038,
      0.321320116519928,
      0.8342822194099426,
      0.9376110434532166,
      -0.23051847517490387,
      -0.6985831260681152,
      0.79222172498703,
      0.009176816791296005,
      0.2173180729150772,
      0.5522371530532837,
      0.09052607417106628,
      -0.7577353119850159,
      0.2734328806400299,
      -0.31229114532470703,
      0.3532787561416626,
      -0.846885621547699,
      -0.6430023312568665,
      -0.14825348556041718,
      -0.12292871624231339,
      0.530149519443512,
      -0.9479432106018066,
      1.0906131267547607,
      0.27056312561035156,
      -0.647010326385498,
      0.20808587968349457,
      0.26469293236732483,
      0.9099582433700562,
      -0.5577993392944336,
      1.0011812448501587,
      0.11131163686513901,
      -0.5481733083724976,
      0.4651789665222168,
      -0.6921704411506653,
      -0.22935640811920166,
      0.2900626063346863,
      0.051693860441446304,
      -0.10617130994796753,
      0.3155815899372101,
      -0.6151927709579468,
      -0.7781537175178528,
      0.34703993797302246,
      -0.25397196412086487,
      -0.02983706071972847,
      1.1813303232192993,
      0.688083827495575,
      -0.9473490715026855,
      0.6817971467971802,
      0.3680230975151062,
      0.8463796377182007,
      -0.1377982646226883,
      0.11298931390047073,
      0.13438153266906738,
      -0.6172574758529663,
      0.040731772780418396,
      -0.23688890039920807,
      0.02386067993938923,
      0.1581396460533142,
      -0.7648739218711853,
      1.2064505815505981,
      0.05520071089267731,
      -0.707482099533081,
      -1.0613938570022583,
      -0.40195468068122864,
      -0.8027438521385193,
      -0.19421465694904327,
      -0.3853673040866852,
      0.613079845905304,
      0.19256629049777985,
      -0.2168666422367096,
      0.8067750930786133,
      -0.9278210401535034,
      0.21912433207035065,
      -0.7759478092193604,
      0.3662220239639282,
      -0.2997480630874634,
      0.1903258115053177,
      -0.22890561819076538,
      0.4989122450351715,
      0.7535878419876099,
      -0.15330106019973755,
      -0.3280755579471588,
      0.4163162410259247,
      0.29049718379974365,
      0.09883664548397064,
      0.30595991015434265,
      0.06179175153374672,
      -0.3432939052581787,
      -0.0905853658914566,
      0.09288237243890762,
      -0.46446189284324646,
      0.13240639865398407,
      -0.23116087913513184,
      0.7174058556556702,
      -0.8241690397262573,
      -0.16444414854049683,
      0.04261638596653938,
      -0.4333347678184509,
      -0.24444179236888885,
      -1.1977579593658447,
      -1.3902702331542969,
      0.19348078966140747,
      0.7116989493370056,
      0.7376039624214172,
      0.7848299145698547,
      0.6191259622573853,
      0.7171987295150757,
      -0.21173006296157837,
      -0.0621088445186615,
      -0.10310843586921692,
      0.19941066205501556,
      0.10970602929592133,
      -0.19901148974895477,
      -0.07149092108011246,
      0.5544916391372681,
      -0.19024373590946198,
      -0.7072367072105408,
      -0.24124036729335785,
      0.6224551796913147,
      0.09574852883815765,
      0.8889825344085693,
      0.08240768313407898,
      0.25616487860679626,
      1.2441481351852417,
      -0.03931163251399994,
      0.07908714562654495,
      -0.43612435460090637,
      0.35310325026512146,
      -0.529119074344635,
      0.9769695997238159,
      0.2112053483724594,
      -0.35904431343078613,
      -0.5875727534294128,
      -0.026696790009737015,
      -0.3171764016151428,
      -0.6055406928062439,
      0.24996592104434967,
      0.350761741399765,
      -0.07420565187931061,
      -0.670583963394165,
      0.015986457467079163,
      1.051229476928711,
      0.4039459526538849,
      0.41766905784606934,
      0.36001524329185486,
      -0.3888920545578003,
      -0.2625555694103241,
      -0.13424518704414368,
      0.12417428940534592,
      -0.7253307700157166,
      -1.225437879562378,
      -0.3362366855144501,
      0.08470042049884796,
      -0.2342962920665741,
      0.09025684744119644,
      -0.3050546944141388,
      -0.03404349833726883,
      0.20481884479522705,
      -0.09347860515117645,
      -0.0634281262755394,
      0.33706527948379517,
      -0.1905404031276703,
      0.46101683378219604,
      -0.1583913266658783,
      0.4880598187446594,
      0.38454529643058777,
      0.32271069288253784,
      -0.10360444337129593,
      -0.8839792013168335,
      1.2613009214401245,
      1.2934082746505737,
      0.568880558013916,
      -0.08769768476486206,
      -0.0014323346549645066,
      -0.050954632461071014,
      0.23088736832141876,
      -0.005089500453323126,
      0.3043406903743744,
      -0.3904362916946411,
      -0.36320579051971436,
      -0.04455404728651047,
      -0.38604721426963806,
      0.5232274532318115,
      -0.5378209352493286,
      0.2681063115596771,
      -0.18128253519535065,
      0.06685607135295868,
      0.04109150543808937,
      -0.2817220687866211,
      0.36220625042915344,
      -0.6661521792411804,
      0.03266030177474022,
      0.24992439150810242,
      -0.5633944869041443,
      0.3884877860546112,
      -0.8017390966415405,
      0.197426438331604,
      0.8690136075019836,
      -0.6274603009223938,
      0.39398080110549927,
      0.49085983633995056,
      0.2583974301815033,
      -0.9773685336112976,
      -1.1551464796066284,
      -0.017134832218289375,
      0.014325088821351528,
      0.0989016443490982,
      0.162222757935524,
      1.0860546827316284,
      0.16653837263584137,
      -0.4076530635356903,
      0.6850472688674927,
      -0.31034213304519653,
      -0.6316937208175659,
      0.21329167485237122,
      -0.9260951280593872,
      -0.7932714819908142,
      0.7833637595176697,
      0.45354241132736206,
      0.0521257147192955,
      0.48201167583465576,
      -0.33413925766944885,
      0.12307628989219666,
      -0.2897023856639862,
      0.47550055384635925,
      0.24936240911483765,
      -0.192093163728714,
      0.0256232600659132,
      0.18783977627754211,
      1.007348656654358,
      -0.02259841188788414,
      -0.17948806285858154,
      -0.16879302263259888,
      0.1552865207195282,
      0.5550563335418701,
      0.6965929865837097,
      0.43837970495224,
      0.9549256563186646,
      -0.04694949463009834,
      -0.2179580181837082,
      -0.021967515349388123,
      -0.17711327970027924,
      -0.05774730071425438,
      -0.025890804827213287,
      -0.7575094699859619,
      -0.7536702156066895,
      0.26722049713134766,
      -0.36963438987731934,
      0.41693422198295593,
      0.1551760584115982,
      -0.5174475312232971,
      -0.46442458033561707,
      -0.022252919152379036,
      0.6811010241508484,
      1.2870367765426636,
      0.7301880717277527,
      -0.43002548813819885,
      -0.17838458716869354,
      1.198986291885376,
      0.25904610753059387,
      -0.05752939730882645,
      -0.01465518120676279,
      0.2102525234222412,
      0.6141180396080017,
      -1.2400352954864502,
      0.5486592054367065,
      -0.021198827773332596,
      -0.3102481961250305,
      0.564868152141571,
      -1.4394513368606567,
      -0.6069866418838501,
      0.1658492237329483,
      -0.3531590700149536,
      -0.3783978223800659,
      -0.21003563702106476,
      -0.12506736814975739,
      -0.10717883706092834,
      0.07209991663694382,
      0.23415084183216095,
      0.24131430685520172,
      0.1385049819946289,
      0.07044676691293716,
      -1.1760190725326538,
      0.4318118393421173,
      0.7434459328651428,
      0.37930843234062195,
      0.8425907492637634,
      -0.9333749413490295,
      -0.9235168695449829,
      -0.047042980790138245,
      0.33419767022132874,
      0.047428593039512634,
      -0.358127236366272,
      1.0979316234588623,
      0.5901926755905151,
      0.381231427192688,
      1.0599640607833862,
      0.3265829384326935,
      -1.7102378606796265,
      -0.303696870803833,
      0.4077959358692169,
      0.44792377948760986,
      0.35323208570480347,
      -0.6866190433502197,
      -0.45634907484054565,
      -0.2153460681438446,
      0.18544656038284302,
      0.05006328225135803,
      1.4698537588119507,
      0.18107984960079193,
      -0.23923859000205994,
      -1.111509084701538,
      -0.7417439818382263,
      0.30285918712615967,
      0.5207154750823975,
      0.9045596122741699,
      -0.7395114898681641,
      -0.8665122985839844,
      0.9542516469955444,
      0.025714533403515816,
      -0.37832698225975037,
      -0.030854467302560806,
      0.8691495656967163,
      1.1615537405014038,
      -0.5344371199607849,
      -0.35275229811668396,
      -0.31230995059013367,
      -0.30779600143432617,
      0.35294076800346375,
      0.27304577827453613,
      -0.2561539113521576,
      -0.906326413154602,
      0.3381359577178955,
      -0.14057786762714386,
      -0.09002361446619034,
      -0.18041110038757324,
      -0.8500044345855713,
      0.41777002811431885,
      1.1481783390045166,
      -0.5100507140159607,
      0.35350438952445984,
      0.6005640029907227,
      -0.1305576115846634,
      -0.32511216402053833,
      0.12349959462881088,
      0.2215961068868637,
      0.31351158022880554,
      0.3687628507614136,
      0.6363380551338196,
      0.047070566564798355,
      -1.1500593423843384,
      -0.8072144985198975,
      -0.5946577191352844,
      0.11785376071929932,
      0.7539044618606567,
      0.3129572868347168,
      -0.05936136469244957,
      0.3246682584285736,
      0.050687577575445175,
      0.9088810086250305,
      -0.4826779365539551,
      0.17190757393836975,
      -0.16678999364376068,
      0.233724907040596,
      0.18061262369155884,
      0.3095448911190033,
      0.5742308497428894,
      0.6326438784599304,
      0.8703600764274597,
      -0.1541246622800827,
      0.023206964135169983,
      -0.4955190420150757,
      -0.11840096116065979,
      0.7370588779449463,
      -0.06778688728809357,
      1.3177330493927002,
      -0.6501254439353943,
      -0.7594576478004456,
      -0.8847770094871521,
      0.6541174054145813,
      -0.3983273208141327,
      0.8919912576675415,
      1.0244874954223633,
      0.798389196395874,
      -0.5716398358345032,
      0.09752260148525238,
      0.4277587831020355,
      -0.7129809856414795,
      -0.2443932294845581,
      0.22770850360393524,
      -0.4496121108531952,
      -0.5458701252937317,
      -0.40755563974380493,
      -0.5842637419700623,
      0.3545744717121124,
      0.3976508378982544,
      -1.2541347742080688,
      0.41976597905158997,
      0.30581530928611755,
      0.7761422991752625,
      0.2643532454967499,
      -1.0444780588150024,
      0.061188604682683945,
      0.4572658836841583,
      -0.28839170932769775,
      -1.1106184720993042,
      1.0712785720825195,
      -0.16546310484409332,
      -0.2583163380622864,
      0.13123105466365814,
      0.7062268853187561,
      0.25298452377319336,
      -1.0422950983047485,
      -0.7193727493286133,
      0.142035573720932,
      -0.007383490446954966,
      0.21416686475276947,
      0.4911894202232361,
      -0.9486410021781921,
      0.5914786458015442,
      -0.7156245708465576,
      -0.47283121943473816,
      -1.2174464464187622,
      0.3622676730155945,
      -0.8893694877624512,
      -0.6106466054916382,
      -0.4527684152126312,
      -0.8695394396781921,
      -1.1609047651290894,
      -0.7314601540565491,
      -0.20817174017429352,
      1.2090606689453125,
      0.7567044496536255,
      -0.43328216671943665,
      -0.015130922198295593,
      -0.5257688164710999,
      0.6551153659820557,
      0.24994920194149017,
      -0.12689076364040375,
      -0.07780695706605911,
      -1.0557132959365845,
      0.3549453020095825,
      -0.29539793729782104,
      -0.591949462890625,
      -0.011070256121456623,
      0.746941089630127,
      0.2773251533508301,
      -0.4564485549926758,
      -0.6356875896453857,
      0.7698180675506592,
      -1.1554725170135498,
      0.23505516350269318,
      0.6982710361480713,
      -0.018872173503041267,
      0.1957794427871704,
      0.21937136352062225,
      -0.38572758436203003,
      0.3915359675884247,
      0.15092013776302338,
      -0.38119742274284363,
      -0.5551661849021912,
      0.5255718231201172,
      -0.12427037209272385,
      -0.171732559800148,
      0.12549670040607452,
      -0.3571047782897949,
      0.12594984471797943,
      -0.5935544371604919,
      -1.4363731145858765,
      -0.11975789070129395,
      0.3065089285373688,
      1.4469667673110962,
      -1.4565330743789673,
      -0.04664517566561699,
      0.4544619619846344,
      -0.5842705368995667,
      0.1439496874809265,
      0.23944632709026337,
      0.18482209742069244,
      0.11666736006736755,
      -0.08363846689462662,
      -0.0954289361834526,
      0.30492162704467773,
      0.27832281589508057,
      -1.3510253429412842,
      1.169871211051941,
      -0.17166367173194885,
      -0.559194803237915,
      -0.6766939759254456,
      -0.35079872608184814,
      -0.02171030454337597,
      0.5677021741867065,
      -0.8212426900863647,
      0.22159086167812347,
      -0.7428772449493408,
      -0.5681439638137817,
      -0.014716362580657005,
      0.48130473494529724,
      0.7211381793022156,
      -1.5414315462112427,
      0.26631394028663635,
      -1.9138785600662231,
      -0.7121059894561768,
      -0.8807585835456848,
      1.375856637954712,
      -0.15197788178920746,
      0.6683545708656311,
      0.13957548141479492,
      0.8279013633728027,
      0.057843029499053955,
      -0.402331680059433,
      -0.3322872221469879,
      0.3372666537761688,
      -0.2358846366405487,
      -0.6184704899787903,
      0.20054744184017181,
      0.4104365110397339,
      -0.3128020167350769,
      -0.3132672905921936,
      1.2883507013320923,
      0.838472843170166,
      -0.050425831228494644,
      -0.11315947026014328,
      0.22414635121822357,
      -0.3575635850429535,
      0.6365283727645874,
      -0.6483122706413269,
      -0.24611718952655792,
      -0.6515601277351379,
      0.029336625710129738,
      -0.9455050230026245,
      -0.47922417521476746,
      -0.3829439580440521,
      0.9804621934890747,
      0.24661174416542053,
      -0.39202436804771423,
      0.8607608079910278,
      -0.38813516497612,
      -0.6283183693885803,
      -0.04628302901983261,
      0.5073372721672058,
      -0.13666586577892303,
      0.35549622774124146,
      0.12998294830322266,
      -0.4890047609806061,
      1.2728606462478638,
      1.107539415359497,
      0.11153338104486465,
      -0.645278811454773,
      0.21550464630126953,
      -0.07000988721847534,
      0.3822098970413208,
      0.20776470005512238,
      0.45304974913597107,
      -1.2436245679855347,
      0.19544991850852966,
      -0.9763692021369934,
      0.11653051525354385,
      0.03764602914452553,
      0.043455563485622406,
      0.09836123883724213,
      0.4058080017566681,
      -0.015484611503779888,
      -0.029623664915561676,
      0.11246821284294128,
      0.10776691138744354,
      -0.20980924367904663,
      0.2985875904560089,
      0.5580970644950867,
      0.2695385813713074,
      -0.3929271101951599,
      0.11949236690998077,
      0.6053901314735413,
      0.19154474139213562,
      0.2459898591041565,
      0.2645185589790344,
      -0.21592079102993011,
      -0.41723233461380005,
      -0.5223344564437866,
      -0.126180037856102,
      0.24522222578525543,
      -0.34627771377563477,
      1.137180209159851,
      0.5078911185264587,
      0.8454926609992981,
      0.20931625366210938,
      0.124160036444664,
      -0.1778477132320404,
      -0.4994702935218811,
      -0.39723241329193115,
      -0.15761366486549377,
      -1.0123369693756104,
      0.47828394174575806,
      -0.20398972928524017,
      -0.34682998061180115,
      -0.10099171847105026,
      -0.349863737821579,
      -0.6848019361495972,
      0.02214696630835533,
      -0.7530115842819214,
      0.6774744987487793,
      -1.4142941236495972,
      0.5422426462173462,
      -0.44418731331825256,
      -0.26728731393814087,
      -0.6875600814819336,
      -1.1796000003814697,
      -1.1252721548080444,
      -0.03322669863700867,
      -0.5544812679290771,
      0.6139895915985107,
      0.821643054485321,
      0.6547943949699402,
      -0.5306617021560669,
      -0.9771783947944641,
      -0.47096750140190125,
      1.076210379600525,
      0.7781679034233093,
      -0.08757678419351578,
      0.06011217087507248,
      0.07709614932537079,
      -0.8548530340194702,
      0.681445300579071,
      -0.32910799980163574,
      0.09614867717027664,
      -0.3616042137145996,
      0.49307945370674133,
      0.8843383193016052,
      0.52564936876297,
      -0.3569432497024536,
      -0.48682600259780884,
      0.17971529066562653,
      0.2920607924461365,
      -0.3209255039691925,
      -0.7174704074859619,
      0.13300104439258575,
      -0.3143783211708069
    ],
    "label": {
      "level1": "SAM",
      "level2": "DT",
      "level3": "RT",
      "leafContractCategory": "RT",
      "rootCause": "Unacceptable Input Type",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): SAM (Single API Method)\nThis issue involves misuse of a single API method, specifically the KerasRegressor constructor, classifying it as a SAM violation.\n\nLevel 2: DT (Data Type)\nThe issue is clearly related to data type expectations. The KerasRegressor expects a callable (such as a function or a class instance with a callable method), but an instance of a model (Sequential) is provided instead.\n\nLevel 3 (Hybrid Patterns): RT (Reference Type)\nThe problem stems from passing the incorrect reference type to the method�passing an instance instead of a reference to the callable function itself.\n\nLeaf Contract Category: RT (Reference Type)\nAt the leaf level, the specific error is a reference-type issue, as explicitly highlighted by the stack trace, indicating the incorrect reference provided to the build_fn parameter.\n\nRoot Cause: Unacceptable Input Type\nThe root cause of the issue is clearly due to providing an instance of a Sequential model instead of a function or class implementing the required callable interface. Hence, the input type is unacceptable for this method call.\n\nEffect: Crash\nDue to the improper usage, the Keras model construction crashes, raising a TypeError.\n\nML Library: Keras\nThe error specifically relates to Keras's scikit-learn wrapper API, highlighting integration issues between Keras and scikit-learn.\n\nContract Violation Location: Model Construction\nThe error occurred during model construction phase, specifically at the point of instantiating the KerasRegressor class.\n\nDetection Technique: Static\nThe issue is detectable through static code analysis since the problem arises from improper API usage, and can be identified by code inspection without needing runtime execution."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/36210887",
    "title": "",
    "question": "34\n\nI am trying to save Nueral Network weights into a file and then restoring those weights by initializing the network instead of random initialization. My code works fine with random initialization. But, when i initialize weights from file it is showing me an error TypeError: Input 'b' of 'MatMul' Op has type float64 that does not match type float32 of argument 'a'. I don't know how do i solve this issue.Here is my code:\n\nModel Initialization\n\n# Parameters\ntraining_epochs = 5\nbatch_size = 64\ndisplay_step = 5\nbatch = tf.Variable(0, trainable=False)\nregualarization =  0.008\n\n# Network Parameters\nn_hidden_1 = 300 # 1st layer num features\nn_hidden_2 = 250 # 2nd layer num features\n\nn_input = model.layer1_size # Vector input (sentence shape: 30*10)\nn_classes = 12 # Sentence Category detection total classes (0-11 categories)\n\n#History storing variables for plots\nloss_history = []\ntrain_acc_history = []\nval_acc_history = []\n\n# tf Graph input\nx = tf.placeholder(\"float\", [None, n_input])\ny = tf.placeholder(\"float\", [None, n_classes])\nModel parameters\n\n#loading Weights\ndef weight_variable(fan_in, fan_out, filename):\n    stddev = np.sqrt(2.0/fan_in)\n    if (filename == \"\"):\n        initial  = tf.random_normal([fan_in,fan_out], stddev=stddev)\n    else:\n        initial  = np.loadtxt(filename)\n    print initial.shape\n    return tf.Variable(initial)\n\n#loading Biases\ndef bias_variable(shape, filename):\n    if (filename == \"\"):\n     initial = tf.constant(0.1, shape=shape)\n    else:\n     initial  = np.loadtxt(filename)  \n    print initial.shape\n    return tf.Variable(initial)\n\n# Create model\ndef multilayer_perceptron(_X, _weights, _biases):\n    layer_1 = tf.nn.relu(tf.add(tf.matmul(_X, _weights['h1']), _biases['b1'])) \n    layer_2 = tf.nn.relu(tf.add(tf.matmul(layer_1, _weights['h2']), _biases['b2'])) \n    return tf.matmul(layer_2, weights['out']) + biases['out']  \n\n# Store layers weight & bias\nweights = {\n'h1':  w2v_utils.weight_variable(n_input, n_hidden_1,    filename=\"weights_h1.txt\"),\n'h2':  w2v_utils.weight_variable(n_hidden_1, n_hidden_2, filename=\"weights_h2.txt\"),\n'out': w2v_utils.weight_variable(n_hidden_2, n_classes,  filename=\"weights_out.txt\") \n}\n\n biases = {\n'b1': w2v_utils.bias_variable([n_hidden_1], filename=\"biases_b1.txt\"),\n'b2': w2v_utils.bias_variable([n_hidden_2], filename=\"biases_b2.txt\"),\n'out': w2v_utils.bias_variable([n_classes], filename=\"biases_out.txt\")\n}\n\n# Define loss and optimizer\n#learning rate\n# Optimizer: set up a variable that's incremented once per batch and\n# controls the learning rate decay.\nlearning_rate = tf.train.exponential_decay(\n    0.02*0.01,           # Base learning rate. #0.002\n    batch * batch_size,  # Current index into the dataset.\n    X_train.shape[0],    # Decay step.\n    0.96,                # Decay rate.\n    staircase=True)\n\n# Construct model\npred = tf.nn.relu(multilayer_perceptron(x, weights, biases))\n\n#L2 regularization\nl2_loss = tf.add_n([tf.nn.l2_loss(v) for v in tf.trainable_variables()])\n\n#Softmax loss\ncost = tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(pred, y)) \n\n#Total_cost\ncost = cost+ (regualarization*0.5*l2_loss)\n\n# Adam Optimizer\noptimizer = tf.train.AdamOptimizer(learning_rate=learning_rate).minimize(cost,global_step=batch)\n\n# Add ops to save and restore all the variables.\nsaver = tf.train.Saver()\n\n# Initializing the variables\ninit = tf.initialize_all_variables()\n\nprint \"Network Initialized!\"\nERROR DETAILS enter image description here",
    "answer": "58\n\nThe tf.matmul() op does not perform automatic type conversions, so both of its inputs must have the same element type. The error message you are seeing indicates that you have a call to tf.matmul() where the first argument has type tf.float32, and the second argument has type tf.float64. You must convert one of the inputs to match the other, for example using tf.cast(x, tf.float32).\n\nLooking at your code, I don't see anywhere that a tf.float64 tensor is explicitly created (the default dtype for floating-point values in the TensorFlow Python API�e.g. for tf.constant(37.0)�is tf.float32). I would guess that the errors are caused by the np.loadtxt(filename) calls, which might be loading an np.float64 array. You can explicitly change them to load np.float32 arrays (which are converted to tf.float32 tensors) as follows:\n\ninitial = np.loadtxt(filename).astype(np.float32)",
    "mlApiName": "tf.linalg.matmul",
    "embedding": [
      1.0708482265472412,
      0.9100096225738525,
      -2.5600764751434326,
      -1.1630114316940308,
      1.5201008319854736,
      -0.03190452232956886,
      0.4318334758281708,
      -0.1248520165681839,
      -1.6932117938995361,
      -1.002517580986023,
      -1.127076268196106,
      0.6335911154747009,
      0.879069447517395,
      0.18705183267593384,
      -0.41590964794158936,
      -0.13556094467639923,
      0.3619035482406616,
      -0.6248626112937927,
      0.12215228378772736,
      0.30164244771003723,
      0.2771512269973755,
      -0.03474002704024315,
      -0.04353693500161171,
      -0.6565093994140625,
      1.1076291799545288,
      0.4925575852394104,
      -0.4440181851387024,
      0.04046415910124779,
      -0.703674852848053,
      0.5310665369033813,
      1.107202172279358,
      -0.40235069394111633,
      -0.2621634900569916,
      -0.9358024597167969,
      -1.3538577556610107,
      -0.0649459958076477,
      0.7113187313079834,
      -0.07618003338575363,
      0.3098456561565399,
      0.22972643375396729,
      -0.12926113605499268,
      0.12037473917007446,
      0.18295717239379883,
      0.4812411963939667,
      0.07559803873300552,
      0.46795105934143066,
      0.8485961556434631,
      0.026021262630820274,
      0.42463529109954834,
      -0.3309079706668854,
      0.6939516067504883,
      0.25123825669288635,
      0.08285081386566162,
      0.05176249518990517,
      1.1780140399932861,
      0.5092059373855591,
      -1.0317809581756592,
      -0.08674615621566772,
      0.07109284400939941,
      0.1204075962305069,
      1.1513615846633911,
      1.06937837600708,
      -1.742584228515625,
      0.8275561332702637,
      -0.46710702776908875,
      0.293285995721817,
      -0.7153130173683167,
      0.23713578283786774,
      0.002317112172022462,
      -0.1314764767885208,
      0.8675642013549805,
      0.37090420722961426,
      0.22616936266422272,
      0.2923409640789032,
      -0.3588395118713379,
      0.2944331765174866,
      -0.4290120303630829,
      -0.5059504508972168,
      -0.18105286359786987,
      0.5611425042152405,
      -0.23382432758808136,
      0.5028379559516907,
      0.8862994313240051,
      0.2154892385005951,
      0.270344078540802,
      0.30612918734550476,
      -0.7512730956077576,
      -0.0014666749630123377,
      -0.8414731621742249,
      1.1079922914505005,
      0.03913160040974617,
      -0.30934226512908936,
      0.6071757078170776,
      0.11664017289876938,
      -0.6106505393981934,
      0.059244029223918915,
      -0.012293346226215363,
      0.7972951531410217,
      -0.6006924510002136,
      -0.6513646841049194,
      0.1666344553232193,
      0.03188463672995567,
      -0.21058383584022522,
      -0.23777922987937927,
      -0.3857065737247467,
      1.3151686191558838,
      0.37977007031440735,
      0.35803353786468506,
      -0.34261736273765564,
      -0.1626225858926773,
      -0.492946982383728,
      0.22548386454582214,
      -0.273696631193161,
      -0.34266743063926697,
      -0.5545947551727295,
      -0.49908313155174255,
      0.8780202269554138,
      -0.6184243559837341,
      -0.21288710832595825,
      0.12903563678264618,
      -0.5560866594314575,
      -1.4262233972549438,
      0.057246070355176926,
      0.4965711534023285,
      0.4597507417201996,
      0.8553628325462341,
      -0.2515568733215332,
      0.32060015201568604,
      0.8367820978164673,
      -1.1983999013900757,
      0.0628669261932373,
      -0.15573851764202118,
      -0.6041562557220459,
      0.0036460566334426403,
      0.5847887992858887,
      0.5368860363960266,
      -0.731096625328064,
      -0.5901162028312683,
      0.3690452575683594,
      -0.09617023169994354,
      0.001963741844519973,
      -0.4448866844177246,
      0.544874370098114,
      -0.4759845733642578,
      0.6514099836349487,
      -0.3855949938297272,
      0.369389146566391,
      -0.41493380069732666,
      -0.5512884855270386,
      0.37676891684532166,
      -0.2975125312805176,
      0.8800913691520691,
      -0.952002763748169,
      0.09999081492424011,
      0.2937062382698059,
      -0.6935604810714722,
      0.6149689555168152,
      0.06795300543308258,
      0.7698972225189209,
      0.16526371240615845,
      1.0718810558319092,
      0.012396026402711868,
      -0.29744693636894226,
      0.4005652368068695,
      -0.011166977696120739,
      -0.40227434039115906,
      0.4247431755065918,
      0.6730853319168091,
      -0.12935848534107208,
      -0.16361597180366516,
      -0.40714988112449646,
      -0.21382372081279755,
      0.00564551493152976,
      -0.5733959674835205,
      0.18387937545776367,
      0.7642953991889954,
      -0.056353140622377396,
      -0.7294226884841919,
      0.30077072978019714,
      -0.2427697330713272,
      0.5005466341972351,
      -0.5786988735198975,
      1.0076320171356201,
      -0.3849312365055084,
      -0.033355578780174255,
      0.10722049325704575,
      -0.09710121899843216,
      0.5489952564239502,
      -0.7723976969718933,
      -0.07437864691019058,
      0.18925108015537262,
      0.6348519921302795,
      -1.297352910041809,
      -0.1837148368358612,
      -0.37081679701805115,
      -0.28356558084487915,
      1.4535224437713623,
      0.2313111573457718,
      0.143412783741951,
      0.03246093913912773,
      -0.06861866265535355,
      -0.48140791058540344,
      -0.8355463743209839,
      0.46898534893989563,
      -0.9277843832969666,
      0.1965356022119522,
      -0.26778462529182434,
      0.6481220722198486,
      -0.5697478652000427,
      0.5644662976264954,
      0.3574223220348358,
      0.16334082186222076,
      -0.5017958283424377,
      0.033968307077884674,
      0.3580891191959381,
      0.26878541707992554,
      0.5049948692321777,
      -0.18454039096832275,
      -0.701474666595459,
      -0.29745855927467346,
      -0.013875340111553669,
      -0.3141331076622009,
      0.572343647480011,
      0.16269949078559875,
      0.6404240131378174,
      -1.0169302225112915,
      0.1635320782661438,
      0.14351311326026917,
      0.11002037674188614,
      -0.35243186354637146,
      -0.10598952323198318,
      -0.24234163761138916,
      0.4578474760055542,
      0.3810928761959076,
      -0.07396389544010162,
      0.16388463973999023,
      0.30890318751335144,
      1.0182385444641113,
      -0.2559185028076172,
      -0.18509797751903534,
      -0.39705929160118103,
      1.4396661520004272,
      0.03235451877117157,
      0.13821794092655182,
      -1.0725383758544922,
      0.4678378105163574,
      -0.10693926364183426,
      -0.7278147339820862,
      0.11396241933107376,
      0.5023368000984192,
      -0.1266496628522873,
      0.12538014352321625,
      0.5785079002380371,
      0.20428258180618286,
      0.1942860633134842,
      -0.10591215640306473,
      -0.7016717791557312,
      -0.7006376385688782,
      0.06953977048397064,
      -0.4256429970264435,
      0.5414229035377502,
      0.3760049045085907,
      -0.08943169564008713,
      -0.27831465005874634,
      -0.7471644878387451,
      -0.7773032188415527,
      -0.28610268235206604,
      0.19867293536663055,
      -0.06832170486450195,
      -0.08826151490211487,
      0.07546553760766983,
      0.6189420819282532,
      0.8836300373077393,
      0.6295076012611389,
      0.4609296917915344,
      0.5935850143432617,
      -0.1456083208322525,
      0.04436705633997917,
      -0.4122465252876282,
      0.4028581976890564,
      -0.9345473647117615,
      -0.8752367496490479,
      -1.0928643941879272,
      0.0370640866458416,
      0.21782808005809784,
      -0.5240626335144043,
      1.1405893564224243,
      0.10461530834436417,
      0.17978286743164062,
      0.11897405982017517,
      0.6740942001342773,
      0.5826593041419983,
      -0.2353532314300537,
      0.07020942866802216,
      0.8372030258178711,
      0.3883212208747864,
      0.37095195055007935,
      0.3829845190048218,
      -0.3484228551387787,
      -0.3228451907634735,
      0.09997393190860748,
      1.2567745447158813,
      0.8080428242683411,
      -0.03460320457816124,
      -0.42396706342697144,
      -0.40046849846839905,
      -0.3695555031299591,
      -0.11357082426548004,
      0.3344481885433197,
      0.0487891361117363,
      -1.1314114332199097,
      0.2822496294975281,
      -0.87245112657547,
      0.3299718201160431,
      -0.23281727731227875,
      0.1808309108018875,
      0.38744086027145386,
      0.3942701816558838,
      0.15228556096553802,
      -0.7833987474441528,
      -1.0498003959655762,
      -0.47012725472450256,
      0.2449713498353958,
      0.013868235051631927,
      -0.42338404059410095,
      0.6953690052032471,
      -0.10033081471920013,
      1.437193512916565,
      0.10059341043233871,
      -0.07059603929519653,
      1.1053037643432617,
      0.17842869460582733,
      0.2774893045425415,
      -0.5695962905883789,
      -0.5321598052978516,
      0.23108814656734467,
      -0.2842128872871399,
      0.5075697898864746,
      0.41822290420532227,
      0.4038202464580536,
      0.3035234808921814,
      0.0833122581243515,
      0.4037764370441437,
      -1.278157114982605,
      -0.3457123935222626,
      0.4845276474952698,
      -1.0222523212432861,
      -0.5611073970794678,
      0.30094680190086365,
      0.6315046548843384,
      0.15785068273544312,
      0.29219624400138855,
      0.5975926518440247,
      0.10965676605701447,
      0.4206993877887726,
      0.2128169685602188,
      0.5987400412559509,
      -0.21834538877010345,
      -0.100993812084198,
      -0.4791394770145416,
      -0.16889330744743347,
      -0.6405658721923828,
      -0.5863379836082458,
      0.22346395254135132,
      -0.19555290043354034,
      0.853724479675293,
      0.6968094110488892,
      0.43255725502967834,
      0.4368017613887787,
      -0.5440359711647034,
      0.1852295696735382,
      0.2789190113544464,
      0.35165783762931824,
      -0.11893569678068161,
      -0.6531578898429871,
      -0.07807119190692902,
      -0.9020282030105591,
      -0.594211757183075,
      -0.22904644906520844,
      0.8453090786933899,
      0.17204709351062775,
      -1.534969449043274,
      -0.019581986591219902,
      -0.5400099158287048,
      1.0896408557891846,
      0.16174350678920746,
      0.21948519349098206,
      -0.29860618710517883,
      0.7036461234092712,
      0.4059128165245056,
      -0.17509540915489197,
      0.2636832296848297,
      -0.5524190664291382,
      -0.17241784930229187,
      0.7095546722412109,
      -0.00416441960260272,
      1.0024667978286743,
      1.0189992189407349,
      0.08092804253101349,
      -0.030814161524176598,
      -0.7067102789878845,
      -0.8756362199783325,
      0.2854216396808624,
      -0.458482950925827,
      -0.3551442325115204,
      0.23356454074382782,
      -0.1937648206949234,
      -0.31760239601135254,
      0.271516889333725,
      0.20365293323993683,
      0.6017690300941467,
      0.40518423914909363,
      0.25081583857536316,
      -1.0219717025756836,
      0.7088333368301392,
      -0.05140909552574158,
      1.2075937986373901,
      0.9262201189994812,
      -0.08212199062108994,
      -1.0924475193023682,
      -0.08032041043043137,
      0.4907535910606384,
      -0.2686019241809845,
      0.10912779718637466,
      0.9125954508781433,
      0.18559324741363525,
      1.0566586256027222,
      0.7969644069671631,
      0.5657561421394348,
      -1.5592318773269653,
      0.2105223387479782,
      0.9504972696304321,
      0.41176488995552063,
      -0.11632873117923737,
      -0.3096853196620941,
      -0.25672203302383423,
      0.43843117356300354,
      0.4146451950073242,
      -0.39090749621391296,
      1.0668237209320068,
      0.8025813102722168,
      -0.548488438129425,
      -0.9413174986839294,
      -0.3656042516231537,
      0.5197319388389587,
      1.2348557710647583,
      1.1525883674621582,
      -1.0031131505966187,
      -0.7802504301071167,
      1.6600865125656128,
      -0.12009959667921066,
      0.11313097923994064,
      0.9250093102455139,
      -0.027372511103749275,
      1.8925431966781616,
      -0.43539929389953613,
      -0.11575139313936234,
      0.5339170098304749,
      0.4298611581325531,
      0.19229593873023987,
      0.7626094818115234,
      0.9023674726486206,
      -0.9660096168518066,
      0.20053884387016296,
      -1.0085662603378296,
      -0.818376362323761,
      0.23054228723049164,
      -0.5658799409866333,
      0.8479635119438171,
      0.24122501909732819,
      -0.5966494679450989,
      -0.5065374970436096,
      0.2868764102458954,
      0.1802644282579422,
      -0.17772617936134338,
      0.34104785323143005,
      0.42661091685295105,
      -0.15755458176136017,
      0.11404099315404892,
      0.3784799575805664,
      -0.1403152346611023,
      -1.0992944240570068,
      -0.4526347815990448,
      0.07338515669107437,
      0.0022340123541653156,
      1.7202039957046509,
      -0.6569821834564209,
      -0.39311617612838745,
      0.22837239503860474,
      -0.11045920848846436,
      0.020427322015166283,
      -0.48317182064056396,
      0.40453654527664185,
      0.19407710433006287,
      -0.28704527020454407,
      -0.6956542134284973,
      0.2380717694759369,
      0.5973960757255554,
      0.5421224236488342,
      -0.41259765625,
      -0.37793686985969543,
      0.18619664013385773,
      -0.4101574122905731,
      -0.18178771436214447,
      0.9902668595314026,
      -0.3996308445930481,
      0.4118049442768097,
      -0.2700096666812897,
      -0.5556972026824951,
      0.19790609180927277,
      -0.34895873069763184,
      -0.25160324573516846,
      0.6372881531715393,
      -0.15119829773902893,
      1.0293222665786743,
      -1.2781798839569092,
      0.7959572076797485,
      0.6225400567054749,
      -0.5389758944511414,
      -0.30673491954803467,
      0.24899709224700928,
      -0.7989168763160706,
      0.13078461587429047,
      -0.11595720797777176,
      -1.0447336435317993,
      0.5611903071403503,
      -0.1278042495250702,
      -1.6132941246032715,
      0.6202081441879272,
      -0.1056123822927475,
      -0.08716563135385513,
      -0.17474626004695892,
      -0.7910718321800232,
      -0.33438029885292053,
      -0.04144907742738724,
      0.02898477390408516,
      0.33469200134277344,
      0.9895907044410706,
      -0.11938755959272385,
      0.3027327358722687,
      0.143187016248703,
      0.8312045931816101,
      -0.5616049766540527,
      0.3319767117500305,
      -0.3441382348537445,
      -0.06563626974821091,
      0.35993170738220215,
      0.558384895324707,
      -0.20240677893161774,
      -1.5527164936065674,
      0.09922824800014496,
      -0.44341757893562317,
      0.037873949855566025,
      -0.6729332804679871,
      0.8364059329032898,
      -0.20502780377864838,
      -0.8270636200904846,
      -0.5335778594017029,
      -1.0827127695083618,
      -0.015344318933784962,
      -0.7255581021308899,
      0.17661380767822266,
      0.8212414979934692,
      -0.11357415467500687,
      0.2652345299720764,
      -0.25097864866256714,
      0.1538282334804535,
      -0.08644187450408936,
      -0.003707817057147622,
      -0.14483462274074554,
      0.10370413959026337,
      -0.5257043242454529,
      -0.44679197669029236,
      -0.46451231837272644,
      0.06005608290433884,
      0.08173104375600815,
      0.4835771322250366,
      0.6007360816001892,
      -0.6165875196456909,
      -0.7537931203842163,
      -0.11653472483158112,
      -0.8775115609169006,
      -0.018156597390770912,
      0.0035282731987535954,
      -1.0653055906295776,
      -0.49796637892723083,
      -0.5703027248382568,
      -0.7846832871437073,
      0.12802891433238983,
      -0.7866456508636475,
      -0.5277487635612488,
      0.017516355961561203,
      -0.07157143950462341,
      -0.3961143493652344,
      -0.3137904703617096,
      0.6546623706817627,
      -0.5996394753456116,
      -0.4698094129562378,
      -0.11965065449476242,
      -1.1428561210632324,
      0.3957073986530304,
      0.7511102557182312,
      1.414884090423584,
      -1.0198264122009277,
      -0.7771089673042297,
      1.0931577682495117,
      -0.6975496411323547,
      0.7765143513679504,
      -0.30357658863067627,
      0.33286193013191223,
      0.14205043017864227,
      -0.2363196462392807,
      -0.5972649455070496,
      0.2360049933195114,
      0.45712676644325256,
      -0.9916359186172485,
      0.38900622725486755,
      0.17611812055110931,
      -0.7984768748283386,
      -0.07347236573696136,
      0.540699303150177,
      -0.5315616726875305,
      1.4403290748596191,
      -0.8950787782669067,
      0.9501452445983887,
      -0.0038854843005537987,
      -0.6591864824295044,
      0.14619888365268707,
      0.4399712085723877,
      -0.42042264342308044,
      -0.617023229598999,
      0.18332624435424805,
      -1.4464454650878906,
      0.10499497503042221,
      -1.3247987031936646,
      1.2085225582122803,
      -0.2440265417098999,
      0.8587961792945862,
      0.16750693321228027,
      0.8517997860908508,
      -0.03936649113893509,
      0.6858501434326172,
      -0.49374517798423767,
      -0.4243612587451935,
      0.30373379588127136,
      -0.5075377821922302,
      0.9838358759880066,
      0.5665385723114014,
      -0.37891697883605957,
      -0.08567921817302704,
      0.311893105506897,
      1.8458195924758911,
      0.5024399757385254,
      0.21615839004516602,
      -0.03526116535067558,
      0.6209034323692322,
      0.7406823039054871,
      -0.6932921409606934,
      -1.30767822265625,
      -0.6534028649330139,
      -0.6134747266769409,
      -0.3581392467021942,
      -0.3191022276878357,
      -1.1624932289123535,
      1.1858313083648682,
      0.17617367208003998,
      0.24687334895133972,
      -0.8318437337875366,
      -0.2649337947368622,
      -0.436977356672287,
      -0.05381179600954056,
      0.3918083906173706,
      -0.12151969969272614,
      0.6594473719596863,
      0.7539107203483582,
      0.6057126522064209,
      0.9464946985244751,
      1.1184130907058716,
      -0.2478495091199875,
      -0.17390906810760498,
      0.21201029419898987,
      -0.5614948868751526,
      -0.1380213499069214,
      -0.24566859006881714,
      0.29917892813682556,
      -0.6616015434265137,
      -0.10900820791721344,
      0.054267264902591705,
      -0.06150390952825546,
      -0.014699793420732021,
      -0.6373371481895447,
      0.7010146975517273,
      0.26619067788124084,
      0.19144763052463531,
      -0.7749210000038147,
      0.9428064823150635,
      -0.09625248610973358,
      0.3666652739048004,
      0.4948224127292633,
      0.4829287827014923,
      -0.2264658808708191,
      -0.401958167552948,
      -0.7320402264595032,
      0.025235116481781006,
      0.1406642347574234,
      0.2982653081417084,
      -0.21709854900836945,
      0.17421381175518036,
      -0.4368920624256134,
      -0.836901068687439,
      0.24357514083385468,
      0.09653296321630478,
      -0.47634249925613403,
      1.273850917816162,
      0.46563246846199036,
      0.12270497530698776,
      -0.2353912740945816,
      -1.0378592014312744,
      -0.6360481381416321,
      -0.1349925845861435,
      0.5205230712890625,
      -0.22502191364765167,
      -1.2206497192382812,
      0.33653995394706726,
      -0.34622305631637573,
      -0.6583887934684753,
      -0.4367067217826843,
      -0.2166028767824173,
      -0.47190797328948975,
      -0.23816710710525513,
      -1.0862239599227905,
      -0.8116718530654907,
      -1.0523074865341187,
      0.6106413006782532,
      0.10811546444892883,
      0.042783115059137344,
      0.22163105010986328,
      -0.13408702611923218,
      -0.30089524388313293,
      -0.5788841843605042,
      -0.31147342920303345,
      0.9403868317604065,
      0.21081532537937164,
      -0.31798481941223145,
      -0.03112744726240635,
      -0.11427038908004761,
      -1.1503576040267944,
      0.7228791117668152,
      -0.6725733876228333,
      -0.6936917304992676,
      0.3569817543029785,
      -0.27843666076660156,
      -0.649094820022583,
      1.140032410621643,
      -0.5532563924789429,
      0.428590327501297,
      -0.18817733228206635,
      1.2946478128433228,
      1.4113807678222656,
      -1.1777125597000122,
      0.4906742572784424,
      -1.0739895105361938,
      -0.0681287944316864,
      1.0037776231765747,
      -0.6203633546829224,
      -0.1497693955898285,
      0.1472802609205246,
      -0.14489345252513885
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-2",
      "leafContractCategory": "IC-2",
      "rootCause": "Missing Input Value/Type Dependency",
      "effect": "Crash",
      "mlLibrary": "TensorFlow",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): SAM (Single API Method)\nThe issue arises from the incorrect use of a single TensorFlow API method (tf.matmul), clearly indicating a SAM category.\n\nLevel 2: BET (Boolean Expression Type)\nThe labeling as Boolean Expression Type (BET) is appropriate because the issue emerges from an implicit type compatibility check internally done by TensorFlow, where it checks if input tensors have matching types before the operation is executed.\n\nLevel 3 (Hybrid Patterns): IC-2 (Inter-argument Contract)\nThis issue pertains specifically to a mismatch between argument types (data types of two tensors involved), thus making it an Inter-argument Contract issue. The arguments to tf.matmul must match in their data type, and the mismatch leads directly to a violation.\n\nLeaf Contract Category: IC-2 (Inter-argument Contract)\nThis specific category precisely describes the violation because the two arguments (a and b) of the tf.matmul function are interdependent, requiring a consistent type. The failure arises directly from the conflict between the input argument data types.\n\nRoot Cause: Missing Input Value/Type Dependency\nThe root cause is the absence of explicit data type handling or conversions when loading weights from a file (np.loadtxt). TensorFlow requires both tensors passed to tf.matmul to be the same type. However, loading data directly from files resulted in inconsistent types (float32 vs float64).\n\nEffect: Crash\nDue to incompatible tensor types, the TensorFlow computation graph construction crashes with a TypeError.\n\nML Library: TensorFlow\nThe error is directly tied to TensorFlow�s API (tf.matmul), making TensorFlow the relevant ML library.\n\nContract Violation Location: Model Construction\nThis error specifically occurs during the construction of the TensorFlow computational graph, when attempting to initialize neural network parameters from file, which affects how tf.matmul operations are defined in the model.\n\nDetection Technique: Static\nThe problem is detectable via static analysis, as the issue emerges from incorrect API usage clearly identifiable through the code structure, without needing execution at runtime."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/42521400",
    "title": "",
    "question": "9\n\nI am having a hard time with calculating cross entropy in tensorflow. In particular, I am using the function:\n\ntf.nn.softmax_cross_entropy_with_logits()\nUsing what is seemingly simple code, I can only get it to return a zero\n\nimport tensorflow as tf\nimport numpy as np\n\nsess = tf.InteractiveSession()\n\na = tf.placeholder(tf.float32, shape =[None, 1])\nb = tf.placeholder(tf.float32, shape = [None, 1])\nsess.run(tf.global_variables_initializer())\nc = tf.nn.softmax_cross_entropy_with_logits(\n    logits=b, labels=a\n).eval(feed_dict={b:np.array([[0.45]]), a:np.array([[0.2]])})\nprint c\nreturns\n\n0\nMy understanding of cross entropy is as follows:\n\nH(p,q) = p(x)*log(q(x))\nWhere p(x) is the true probability of event x and q(x) is the predicted probability of event x.\n\nThere if input any two numbers for p(x) and q(x) are used such that\n\n0<p(x)<1 AND 0<q(x)<1\nthere should be a nonzero cross entropy. I am expecting that I am using tensorflow incorrectly. Thanks in advance for any help.",
    "answer": "14\n\nLike they say, you can't spell \"softmax_cross_entropy_with_logits\" without \"softmax\". Softmax of [0.45] is [1], and log(1) is 0.\n\nMeasures the probability error in discrete classification tasks in which the classes are mutually exclusive (each entry is in exactly one class). For example, each CIFAR-10 image is labeled with one and only one label: an image can be a dog or a truck, but not both.\n\nNOTE: While the classes are mutually exclusive, their probabilities need not be. All that is required is that each row of labels is a valid probability distribution. If they are not, the computation of the gradient will be incorrect.\n\nIf using exclusive labels (wherein one and only one class is true at a time), see sparse_softmax_cross_entropy_with_logits.\n\nWARNING: This op expects unscaled logits, since it performs a softmax on logits internally for efficiency. Do not call this op with the output of softmax, as it will produce incorrect results.\n\nlogits and labels must have the same shape [batch_size, num_classes] and the same dtype (either float16, float32, or float64).",
    "mlApiName": "tf.nn.softmax_cross_entropy_with_logits",
    "embedding": [
      0.4013979732990265,
      1.0554250478744507,
      -2.4206440448760986,
      -1.4835104942321777,
      1.079789638519287,
      -0.2879447937011719,
      0.7519146203994751,
      0.7113209962844849,
      -1.1316912174224854,
      -0.26279789209365845,
      -0.6338867545127869,
      0.4360368549823761,
      1.6195461750030518,
      -1.1552916765213013,
      -0.4099671244621277,
      0.34241917729377747,
      0.017154576256871223,
      -0.23208101093769073,
      0.4246261715888977,
      0.5218057632446289,
      -1.0251895189285278,
      0.8357387781143188,
      0.651077926158905,
      -0.9074450135231018,
      0.9016148447990417,
      0.9387590885162354,
      -0.9337865114212036,
      0.297062486410141,
      -1.3965377807617188,
      0.0017999738920480013,
      1.245660662651062,
      0.5629231929779053,
      -1.041030764579773,
      -0.9369054436683655,
      -1.8846616744995117,
      -0.0522916316986084,
      0.27954432368278503,
      -0.49915313720703125,
      0.6669462323188782,
      0.31564566493034363,
      -0.21531309187412262,
      0.679205596446991,
      0.05406281724572182,
      -0.6588515043258667,
      0.3533031940460205,
      0.010356096550822258,
      1.0438019037246704,
      0.13185423612594604,
      0.1678205132484436,
      -1.3178035020828247,
      -0.3669486939907074,
      0.7564482688903809,
      0.4068150818347931,
      0.2193058580160141,
      1.4747804403305054,
      0.05209575966000557,
      -0.394837349653244,
      0.0006201699725352228,
      1.2313947677612305,
      0.1001686230301857,
      0.4171440899372101,
      0.9616929888725281,
      -0.5384401082992554,
      0.4253634214401245,
      1.0836479663848877,
      -0.16685989499092102,
      -1.2266566753387451,
      0.08448585122823715,
      0.43899866938591003,
      -0.025898480787873268,
      0.47945916652679443,
      0.5111328363418579,
      0.10678794980049133,
      0.4770793914794922,
      -0.15589062869548798,
      0.6480002403259277,
      0.25481846928596497,
      -0.2913496792316437,
      0.4133181571960449,
      0.6602679491043091,
      -0.4012775123119354,
      0.15013183653354645,
      0.8813126087188721,
      0.11117980629205704,
      0.8029763698577881,
      0.47362348437309265,
      -0.4027785360813141,
      -0.05309681221842766,
      -0.979698896408081,
      2.375302314758301,
      -0.788779616355896,
      0.21449004113674164,
      0.4779249131679535,
      -0.016817979514598846,
      -0.6048736572265625,
      0.3732559382915497,
      -0.40685591101646423,
      0.2762555480003357,
      -0.3968748152256012,
      -0.5289775133132935,
      -0.09356629848480225,
      0.07846909016370773,
      -0.5007407069206238,
      -0.28913751244544983,
      -0.23897971212863922,
      -0.09046732634305954,
      -0.3168090581893921,
      0.28418439626693726,
      -0.43797802925109863,
      0.2645009160041809,
      -1.0076937675476074,
      0.5213948488235474,
      0.031784895807504654,
      -0.06427020579576492,
      0.04458901658654213,
      -0.6872900128364563,
      0.904298722743988,
      0.08172369748353958,
      0.3348361849784851,
      0.5709983110427856,
      0.23221173882484436,
      -0.43974363803863525,
      0.09443101286888123,
      0.5880969166755676,
      -0.4586745500564575,
      0.715765118598938,
      -0.5676228404045105,
      -0.02542969211935997,
      0.6088791489601135,
      -1.0012890100479126,
      0.4985353648662567,
      0.020411435514688492,
      -0.22894905507564545,
      0.4172835350036621,
      -0.113833487033844,
      1.145066499710083,
      -1.0954192876815796,
      0.06195667013525963,
      0.17598021030426025,
      -0.14872457087039948,
      -0.06665552407503128,
      0.2533641457557678,
      0.0936579778790474,
      0.050850555300712585,
      0.20873866975307465,
      -1.7138853073120117,
      -0.5142771601676941,
      -0.689873218536377,
      -0.5412710905075073,
      -0.3637208640575409,
      0.6795108318328857,
      1.1222885847091675,
      -0.4211690425872803,
      -0.19925732910633087,
      0.2754635512828827,
      -0.289732962846756,
      0.9307346940040588,
      -0.3565744459629059,
      0.22739683091640472,
      0.6923173666000366,
      0.84995037317276,
      0.5273902416229248,
      0.05051854997873306,
      0.4218135178089142,
      -0.6488535404205322,
      -0.8170323371887207,
      0.8343608379364014,
      -0.5386602282524109,
      0.1795845478773117,
      -0.30661827325820923,
      -1.2835198640823364,
      -0.49178260564804077,
      0.6257990002632141,
      -0.8394982218742371,
      0.19760504364967346,
      0.6680009365081787,
      0.3202762305736542,
      -1.0652333498001099,
      0.46866464614868164,
      0.19866561889648438,
      0.42031043767929077,
      0.223327174782753,
      1.3030905723571777,
      0.3248753249645233,
      -0.06188058480620384,
      -0.4717397093772888,
      -0.20176240801811218,
      -0.015835942700505257,
      -0.7384756207466125,
      -0.20923547446727753,
      0.6824669241905212,
      0.5306912660598755,
      -1.3004512786865234,
      -0.7747215032577515,
      -0.1930423229932785,
      -0.5231651663780212,
      0.7989938259124756,
      -0.7477359771728516,
      0.7412422895431519,
      -0.12651969492435455,
      -0.5129950046539307,
      0.10447868704795837,
      -0.6525664329528809,
      0.32989630103111267,
      -0.8620800971984863,
      0.8261469006538391,
      0.12553946673870087,
      0.5629704594612122,
      0.2845531105995178,
      0.5116347074508667,
      -0.43794652819633484,
      0.03849358856678009,
      -0.8194041848182678,
      0.8461523652076721,
      -0.6112399697303772,
      -0.35084500908851624,
      0.3093872666358948,
      -0.573007345199585,
      -1.299484133720398,
      0.037666235119104385,
      0.12473035603761673,
      0.26844522356987,
      0.835139274597168,
      0.40523040294647217,
      0.5790798664093018,
      0.1616821438074112,
      -1.0165551900863647,
      0.20807267725467682,
      -0.037982746958732605,
      0.1703437864780426,
      -0.8023713827133179,
      -0.21129031479358673,
      0.3331151008605957,
      -0.12645089626312256,
      -0.0653684213757515,
      0.0945511981844902,
      0.5828796029090881,
      1.0868779420852661,
      0.25794050097465515,
      0.1849311739206314,
      0.10705159604549408,
      0.43586090207099915,
      -0.5922015905380249,
      0.3611976206302643,
      -0.7133625745773315,
      -0.3588601052761078,
      -0.37551286816596985,
      -1.298043966293335,
      0.49276649951934814,
      0.44567909836769104,
      -0.11425995826721191,
      0.4791524410247803,
      0.2621595859527588,
      -0.31911030411720276,
      -0.08270283788442612,
      0.2458183765411377,
      -0.8590814471244812,
      -0.38705021142959595,
      0.03245977684855461,
      -0.23613019287586212,
      0.7157040238380432,
      0.9840301871299744,
      0.9476021528244019,
      -0.8187247514724731,
      -0.9801528453826904,
      -1.0624425411224365,
      -0.25655925273895264,
      -0.32223737239837646,
      0.2310754358768463,
      -0.3534972667694092,
      -0.17028385400772095,
      0.6970394849777222,
      1.0584193468093872,
      0.3845837116241455,
      0.4595147371292114,
      0.4873838722705841,
      0.03170952573418617,
      0.20721128582954407,
      -0.2980978488922119,
      0.25258636474609375,
      -0.9679320454597473,
      -0.19206035137176514,
      -0.10366243869066238,
      -0.12304531037807465,
      0.13108785450458527,
      -0.5230292677879333,
      1.17412269115448,
      0.491473525762558,
      0.8620396256446838,
      0.974377453327179,
      0.45322978496551514,
      0.2867824137210846,
      -0.3927111327648163,
      0.13724413514137268,
      0.33440878987312317,
      0.9485431909561157,
      0.7939820885658264,
      -0.9772526621818542,
      0.28760388493537903,
      -0.8184801936149597,
      0.09002517908811569,
      1.3104557991027832,
      1.2733227014541626,
      1.0218229293823242,
      -0.5993676781654358,
      -0.2486143559217453,
      -0.5391616821289062,
      -0.4659169912338257,
      0.3474216163158417,
      0.2984079122543335,
      -0.7775163650512695,
      -0.00681718997657299,
      -0.08022590726613998,
      0.10589855909347534,
      0.04036226123571396,
      0.08904280513525009,
      0.6813898086547852,
      0.6175835132598877,
      0.5482236742973328,
      -0.4240790903568268,
      0.8664959669113159,
      -0.6437561511993408,
      0.22546200454235077,
      -0.5721885561943054,
      -0.07051432877779007,
      0.1750505566596985,
      -0.2825215458869934,
      0.7901695966720581,
      0.23513954877853394,
      -0.037003468722105026,
      0.9859923720359802,
      0.2100481390953064,
      0.47426173090934753,
      -0.6847946047782898,
      -1.171055555343628,
      -0.14852961897850037,
      -0.028569817543029785,
      0.07829684764146805,
      0.6459688544273376,
      0.17551888525485992,
      0.5116608738899231,
      -0.4560524523258209,
      0.14632797241210938,
      -0.5149810314178467,
      -0.38332563638687134,
      0.590951681137085,
      -1.3558796644210815,
      -0.5876977443695068,
      0.06378834694623947,
      0.5435964465141296,
      0.046329475939273834,
      -0.46957945823669434,
      -0.03517327085137367,
      0.5049619078636169,
      0.870272159576416,
      0.3440023362636566,
      0.866040050983429,
      -0.12468168884515762,
      0.473964661359787,
      0.1751357614994049,
      0.9029337763786316,
      -0.7145247459411621,
      -0.1886444091796875,
      -0.43908241391181946,
      -0.8070188760757446,
      -0.19485628604888916,
      0.7270821332931519,
      0.5110840797424316,
      0.6083590984344482,
      0.006348861381411552,
      -0.081978939473629,
      -0.6520740985870361,
      -0.9880998730659485,
      0.7899163961410522,
      -0.7143187522888184,
      -0.6811677813529968,
      -0.17389652132987976,
      -0.13541454076766968,
      -0.6630150079727173,
      0.18084874749183655,
      0.8822742104530334,
      -0.24463169276714325,
      -0.35488060116767883,
      -0.15784350037574768,
      0.677676796913147,
      -0.12388154119253159,
      0.08743862062692642,
      -1.2853864431381226,
      0.2571842670440674,
      0.3849324584007263,
      0.49048539996147156,
      -0.0788952112197876,
      -0.7514093518257141,
      -0.07126244902610779,
      0.7531896233558655,
      -0.6856721043586731,
      1.5798901319503784,
      0.5813089609146118,
      -0.5449241399765015,
      0.11267934739589691,
      -0.17648997902870178,
      -0.8742899298667908,
      0.3264829218387604,
      -1.062133550643921,
      -0.07613401859998703,
      -0.675777018070221,
      -0.4009914696216583,
      0.5915188193321228,
      -0.31105276942253113,
      -0.12527383863925934,
      0.45420414209365845,
      0.3561517894268036,
      0.2912864685058594,
      -1.0976251363754272,
      1.1226685047149658,
      -0.05617319792509079,
      1.0605058670043945,
      -0.12553368508815765,
      -0.9526798725128174,
      -0.9044885039329529,
      0.9778607487678528,
      0.08432095497846603,
      -0.12856465578079224,
      0.31604036688804626,
      -0.16990430653095245,
      0.0779484361410141,
      0.8062102794647217,
      0.9244787096977234,
      -0.41811060905456543,
      -0.9903753995895386,
      0.04412331432104111,
      1.0684946775436401,
      -0.08565378934144974,
      0.18624071776866913,
      -0.006423231679946184,
      1.4274365901947021,
      -0.25557413697242737,
      0.8598465919494629,
      -0.07180196791887283,
      1.218137502670288,
      0.619145929813385,
      -0.7641828656196594,
      -0.19749200344085693,
      -0.233732208609581,
      -0.053918078541755676,
      1.255399465560913,
      0.9235758781433105,
      -1.7710554599761963,
      -1.8617181777954102,
      0.13868339359760284,
      -0.2737696170806885,
      0.700478732585907,
      0.15388526022434235,
      0.22518450021743774,
      1.599426031112671,
      -0.2513332962989807,
      0.5790178179740906,
      0.8137275576591492,
      0.02815176360309124,
      0.057457372546195984,
      0.1709161102771759,
      -0.2775050401687622,
      -1.0389480590820312,
      -0.8466264605522156,
      -0.06364225596189499,
      0.5304402709007263,
      -0.3642595410346985,
      0.3730754256248474,
      0.3829047977924347,
      0.2906965911388397,
      -0.7549843788146973,
      0.5269780158996582,
      -0.09786730259656906,
      0.5358438491821289,
      -0.722428023815155,
      0.6649808883666992,
      0.740013837814331,
      0.419450968503952,
      0.28808093070983887,
      0.49713531136512756,
      0.12658338248729706,
      -0.7108984589576721,
      -0.46330884099006653,
      -0.5689050555229187,
      -0.03237764537334442,
      1.0222285985946655,
      -0.6581218242645264,
      -0.1991529017686844,
      0.26366695761680603,
      0.05351309850811958,
      0.041956789791584015,
      0.31468644738197327,
      0.30356529355049133,
      0.3112901747226715,
      -1.1955941915512085,
      -0.562756359577179,
      0.7928665280342102,
      -0.014165708795189857,
      0.12864162027835846,
      -0.2635936141014099,
      -0.9661465883255005,
      0.603783905506134,
      -0.8528318405151367,
      -0.018267367035150528,
      0.6007281541824341,
      0.01761028915643692,
      0.39935582876205444,
      -1.4030393362045288,
      0.04730549454689026,
      0.9072288274765015,
      0.1868809312582016,
      0.20912545919418335,
      0.6969812512397766,
      0.11314919590950012,
      0.4575703740119934,
      -1.0865155458450317,
      0.16710086166858673,
      -0.4245707094669342,
      -0.8135821223258972,
      -0.2254396229982376,
      1.6609127521514893,
      -0.12712183594703674,
      0.20491965115070343,
      -0.667227566242218,
      -1.0285463333129883,
      -0.10613023489713669,
      -0.5993852615356445,
      -0.9467306733131409,
      0.38256552815437317,
      0.33063846826553345,
      0.004114550072699785,
      -0.43970733880996704,
      -0.604393482208252,
      0.09532908350229263,
      0.319429486989975,
      -0.7776786684989929,
      -0.1747157722711563,
      0.5777823328971863,
      0.05879776552319527,
      -0.19910217821598053,
      0.5637653470039368,
      0.45109760761260986,
      -1.0227885246276855,
      0.09064815193414688,
      -0.7452324628829956,
      -0.4391045868396759,
      -0.14415165781974792,
      -0.06209185719490051,
      -0.20576709508895874,
      -1.7008955478668213,
      0.5383781790733337,
      -0.4217589795589447,
      0.29998838901519775,
      -0.8382537364959717,
      1.7328128814697266,
      -0.011975979432463646,
      -0.8142223358154297,
      -1.0990525484085083,
      -0.5545392036437988,
      -0.475630521774292,
      -0.1179150640964508,
      -0.11870657652616501,
      1.0321956872940063,
      0.48138299584388733,
      0.023498091846704483,
      -0.4710492193698883,
      0.0815560445189476,
      -0.14629006385803223,
      0.0021399676334112883,
      0.88763827085495,
      0.8980237245559692,
      -0.14486314356327057,
      0.5227470993995667,
      -0.46325790882110596,
      0.5637432336807251,
      -0.23939035832881927,
      0.29748132824897766,
      -0.09939010441303253,
      -0.3780940771102905,
      -1.4094897508621216,
      -0.14554640650749207,
      -0.22220388054847717,
      0.4010479152202606,
      -0.1472422033548355,
      -0.2884117066860199,
      0.5313461422920227,
      -0.6359218955039978,
      -1.1681064367294312,
      0.34377118945121765,
      -0.11276128143072128,
      -1.0162135362625122,
      -0.41578730940818787,
      0.23531047999858856,
      -0.8744856715202332,
      -0.39808228611946106,
      -0.39386263489723206,
      -0.6766830086708069,
      -0.14910651743412018,
      -1.0574727058410645,
      -0.9945071339607239,
      -0.5617311596870422,
      0.7370420694351196,
      1.0714738368988037,
      -1.304010033607483,
      -0.14801420271396637,
      1.4877222776412964,
      -0.8887023329734802,
      0.7332849502563477,
      -0.47889697551727295,
      0.2587946951389313,
      -0.6243817210197449,
      0.2096540331840515,
      0.17308692634105682,
      -0.12463537603616714,
      -0.011172357015311718,
      -0.9618864059448242,
      0.4270980954170227,
      -0.1500287503004074,
      -0.05599934235215187,
      -0.49229857325553894,
      -0.14531265199184418,
      -1.3394588232040405,
      0.8561215996742249,
      -0.5415682196617126,
      0.5745365023612976,
      0.6441887617111206,
      -0.19956713914871216,
      0.02164730615913868,
      0.2588691711425781,
      0.5419281721115112,
      -1.1710742712020874,
      0.8723030090332031,
      -0.5668926239013672,
      0.21850095689296722,
      -1.2917815446853638,
      0.9015318155288696,
      -1.1227061748504639,
      0.5508195757865906,
      1.1224467754364014,
      0.8158100247383118,
      -0.26351627707481384,
      -0.03921031951904297,
      -0.014546004123985767,
      -0.011345721781253815,
      0.4936423897743225,
      -0.062380652874708176,
      0.6241937875747681,
      0.5962231159210205,
      -0.6163966655731201,
      -0.16455614566802979,
      0.6913170218467712,
      1.3981260061264038,
      0.40359383821487427,
      0.2306540459394455,
      -0.7657203078269958,
      0.7439486384391785,
      0.15316742658615112,
      -0.7762656211853027,
      -0.8165646195411682,
      0.5807629823684692,
      0.13999541103839874,
      -0.18862533569335938,
      -0.7135576605796814,
      0.06325223296880722,
      1.0506380796432495,
      -0.33123892545700073,
      0.26704689860343933,
      -0.11600030213594437,
      -0.6030371785163879,
      -1.447069764137268,
      0.35977476835250854,
      0.11135154962539673,
      -0.6681962013244629,
      0.6748740673065186,
      0.9298360347747803,
      -0.24310241639614105,
      0.13573311269283295,
      1.430252194404602,
      0.6639323234558105,
      0.6344061493873596,
      0.21856611967086792,
      -0.01968720369040966,
      -0.660125732421875,
      -0.33491265773773193,
      -0.23409268260002136,
      0.10614845901727676,
      -0.42858028411865234,
      0.14857637882232666,
      -0.3475862443447113,
      -0.19284041225910187,
      -0.5797069668769836,
      -0.5309749841690063,
      0.5145005583763123,
      -0.629912793636322,
      -0.49094662070274353,
      1.1336605548858643,
      -0.09089669585227966,
      0.3486131429672241,
      0.6101864576339722,
      0.5580596327781677,
      0.3329676389694214,
      0.43868526816368103,
      -0.5160072445869446,
      -0.11675109714269638,
      0.3402236998081207,
      0.6139378547668457,
      -0.45655182003974915,
      -0.3812110424041748,
      0.2107161581516266,
      -0.5456271767616272,
      -0.26698821783065796,
      0.5831629037857056,
      -0.3682706654071808,
      -0.10573503375053406,
      0.30855312943458557,
      0.4681873023509979,
      -0.4337826073169708,
      -1.6230539083480835,
      -0.3478522002696991,
      0.48828116059303284,
      -0.23296211659908295,
      0.09704475849866867,
      -1.6706892251968384,
      0.264913409948349,
      0.37238478660583496,
      -0.746052086353302,
      -1.1074789762496948,
      -0.11827684193849564,
      -0.2804320156574249,
      0.7658944725990295,
      -0.040964871644973755,
      -0.7622144818305969,
      -0.21954257786273956,
      0.8517963886260986,
      -0.2184004932641983,
      0.11532338708639145,
      0.4028245806694031,
      -1.163892388343811,
      0.0779198706150055,
      -0.06608150899410248,
      -0.7964017391204834,
      0.6194769740104675,
      0.18662084639072418,
      -0.7182576656341553,
      -0.9544427990913391,
      -0.7279629111289978,
      -0.8329172134399414,
      0.7276878952980042,
      0.237266406416893,
      -1.171222448348999,
      0.5385195016860962,
      -0.9486072063446045,
      0.10947423428297043,
      0.3920626640319824,
      0.18332551419734955,
      0.12705057859420776,
      0.09982720017433167,
      0.9886673092842102,
      1.758803129196167,
      0.4000959098339081,
      0.5710755586624146,
      -0.2978377640247345,
      0.5600384473800659,
      0.45728784799575806,
      -0.7718212604522705,
      -0.1438453197479248,
      -1.0543721914291382,
      -0.15481778979301453
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-2",
      "leafContractCategory": "IC-2",
      "rootCause": "Missing Input Value/Type Dependency",
      "effect": "IF",
      "mlLibrary": "TensorFlow",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): SAM (Single API Method)\nThe issue specifically involves improper usage of a single TensorFlow API method (tf.nn.softmax_cross_entropy_with_logits), thus clearly indicating a Single API Method (SAM) violation.\n\nLevel 2: BET (Boolean Expression Type)\nThe issue stems from a logical constraint or expectation within the TensorFlow method regarding inputs. The function implicitly applies a softmax and expects logits representing unscaled scores for multiple classes. Since this logic wasn't correctly reflected in the input, it fits a BET violation scenario, relating to implicit TensorFlow's internal logic requirements.\n\nLevel 3 (Hybrid Patterns): IC-2 (Inter-argument Contract)\nThis label accurately describes the violation as it involves the interdependence between two arguments (logits and labels). The API expects them to be structured as a distribution over multiple classes (probabilities summing to 1), and this requirement was violated because the input was only a single value and not a valid distribution.\n\nLeaf Contract Category: IC-2 (Inter-argument Contract)\nThis category explicitly matches the Level 3 pattern. It highlights the requirement that labels and logits inputs must form a proper probability distribution for meaningful cross-entropy computation, which was not satisfied here.\n\nRoot Cause: Missing Input Value/Type Dependency\nThe main reason for the problem is the misunderstanding or lack of proper input format and dependency. The function tf.nn.softmax_cross_entropy_with_logits internally expects inputs in the form of logits over multiple classes, and labels that represent a distribution (such as one-hot encoded vectors). A single numeric value does not fulfill these requirements.\n\nEffect: IF (Incorrect Functionality)\nAlthough the TensorFlow API does not crash, it returns an incorrect output (zero), indicating incorrect functionality instead of expected results. The operation completes without errors but with unintended results due to incorrect inputs.\n\nML Library: TensorFlow\nThe specific API function (tf.nn.softmax_cross_entropy_with_logits) is from TensorFlow, making it the clearly identified ML library.\n\nContract Violation Location: Model Construction\nThe issue arises during the definition and initial computation of the model (the cross-entropy calculation), thus occurring during the construction of the computational graph in TensorFlow.\n\nDetection Technique: Static\nThe incorrect input format for softmax_cross_entropy_with_logits can be detected through static analysis by inspecting the provided source code and API documentation without needing to execute the code."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/33474424",
    "title": "",
    "question": "11\n\nI'm using the Keras library to create a neural network. I have a iPython Notebook in order to load the training data, initializing the network and \"fit\" the weights of the neural network. Finally, I save the weights using the save_weights() method. Code is below :\n\nfrom keras.models import Sequential\nfrom keras.layers.core import Dense, Dropout, Activation\nfrom keras.optimizers import SGD\nfrom keras.regularizers import l2\nfrom keras.callbacks import History\n\n[...]\n\ninput_size = data_X.shape[1]\noutput_size = data_Y.shape[1]\nhidden_size = 100\nlearning_rate = 0.01\nnum_epochs = 100\nbatch_size = 75\n\nmodel = Sequential()\nmodel.add(Dense(hidden_size, input_dim=input_size, init='uniform'))\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(hidden_size))\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(output_size))\nmodel.add(Activation('tanh'))\n\nsgd = SGD(lr=learning_rate, decay=1e-6, momentum=0.9, nesterov=True)\nmodel.compile(loss='mse', optimizer=sgd)\n\nmodel.fit(X_NN_part1, Y_NN_part1, batch_size=batch_size, nb_epoch=num_epochs, validation_data=(X_NN_part2, Y_NN_part2), callbacks=[history])\n\ny_pred = model.predict(X_NN_part2) # works well\n\nmodel.save_weights('keras_w')\nThen, in another iPython Notebook, I just want to use these weights and predict some outputs values given inputs. I initialize the same neural network, and then load the weights.\n\n# same headers\ninput_size = 37\noutput_size = 40\nhidden_size = 100\n\nmodel = Sequential()\nmodel.add(Dense(hidden_size, input_dim=input_size, init='uniform'))\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(hidden_size))\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(output_size))\nmodel.add(Activation('tanh'))\n\nmodel.load_weights('keras_w') \n#no error until here\n\ny_pred = model.predict(X_nn)\nThe problem is that apparently, the load_weights method is not enough to have a functional model. I'm getting an error :\n\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n in ()\n  1 \n----> 2 y_pred = model.predict(X_nn)\nC:\\XXXXXXX\\Local\\Continuum\\Anaconda\\lib\\site-packages\\keras\\models.pyc in predict(self, X, batch_size, verbose)\n491     def predict(self, X, batch_size=128, verbose=0):\n492         X = standardize_X(X)\n--> 493         return self._predict_loop(self._predict, X, batch_size, verbose)[0]\n494 \n495     def predict_proba(self, X, batch_size=128, verbose=1):\n\nAttributeError: 'Sequential' object has no attribute '_predict'\nAny idea? Thanks a lot.",
    "answer": "14\n\nYou need to call model.compile. This can be done either before or after the model.load_weights call but must be after the model architecture is specified and before the model.predict call.",
    "mlApiName": " keras.layers.model.compile, keras.models.load_weights, keras.models.predict,keras.layers.add",
    "embedding": [
      0.4254308342933655,
      1.0802007913589478,
      -2.4509048461914062,
      -1.1296048164367676,
      1.4361697435379028,
      0.043405286967754364,
      -0.1553608626127243,
      0.19610147178173065,
      -1.1956405639648438,
      -1.0681148767471313,
      -0.9015732407569885,
      0.3304394781589508,
      2.165193796157837,
      0.3376094400882721,
      -0.3063543438911438,
      -0.07369212061166763,
      0.5153948664665222,
      -0.21634341776371002,
      0.08907727897167206,
      0.3892498314380646,
      -0.35417863726615906,
      -0.45951199531555176,
      0.12967416644096375,
      -0.38466745615005493,
      1.1150299310684204,
      0.8147792220115662,
      -0.797451376914978,
      0.7707850933074951,
      -0.2779480516910553,
      0.5585442185401917,
      0.6749520301818848,
      -1.310922384262085,
      -0.302278071641922,
      -0.9930676817893982,
      -1.6318016052246094,
      -0.7498028874397278,
      1.0347833633422852,
      -0.2491098940372467,
      -0.06753727048635483,
      -0.3251117169857025,
      0.8624956011772156,
      0.0013347305357456207,
      -0.025889918208122253,
      0.41552841663360596,
      0.05044351890683174,
      0.14198608696460724,
      1.3867006301879883,
      0.30439093708992004,
      1.1515191793441772,
      -0.07957775145769119,
      0.7104240655899048,
      0.355439692735672,
      -0.29037222266197205,
      0.05475040525197983,
      1.9923641681671143,
      0.9037744998931885,
      0.5626212954521179,
      0.313646525144577,
      0.31225061416625977,
      -1.0212388038635254,
      0.9926772117614746,
      0.8197875022888184,
      -1.091636300086975,
      1.3104746341705322,
      0.5039305090904236,
      -0.4089621603488922,
      -0.42242497205734253,
      0.8750129342079163,
      -0.1536073386669159,
      0.2112913429737091,
      0.5071440935134888,
      0.5790972113609314,
      0.06981959193944931,
      0.2442629337310791,
      -0.304629385471344,
      0.5196869373321533,
      -0.5620858073234558,
      0.056750040501356125,
      -0.3757142722606659,
      0.4141773581504822,
      0.04542461410164833,
      1.2096130847930908,
      1.3319052457809448,
      -0.5612235069274902,
      0.029942387714982033,
      0.5059811472892761,
      -1.099725365638733,
      -0.4486572742462158,
      -0.5381960868835449,
      1.7307921648025513,
      0.1490563303232193,
      -0.05018875002861023,
      0.3186332583427429,
      0.7375732064247131,
      -0.5813241600990295,
      -0.6202331185340881,
      -0.4009326994419098,
      0.34740668535232544,
      -0.7410066723823547,
      -0.4671555757522583,
      -0.20192787051200867,
      0.6211037635803223,
      -0.4217359125614166,
      -1.6172642707824707,
      -0.2315351814031601,
      1.283425211906433,
      -0.28038766980171204,
      0.00404497841373086,
      0.21724385023117065,
      -0.3367776870727539,
      -0.952031135559082,
      -0.3094179034233093,
      0.4058119058609009,
      0.05093300715088844,
      -0.6705808639526367,
      -0.5472480654716492,
      0.4095616638660431,
      -0.2983657121658325,
      0.20015603303909302,
      0.046084631234407425,
      -0.1420964151620865,
      -0.705295205116272,
      0.7685403823852539,
      -0.23023124039173126,
      -0.04207080975174904,
      1.0937073230743408,
      -0.6348163485527039,
      -0.03815913945436478,
      -0.15470470488071442,
      -1.3778207302093506,
      0.5418092012405396,
      -0.11455892771482468,
      -0.7278850674629211,
      0.22504527866840363,
      1.0783902406692505,
      1.3883403539657593,
      -1.1112241744995117,
      -1.0777082443237305,
      0.17864684760570526,
      0.20548249781131744,
      0.6652863025665283,
      0.3587094247341156,
      0.20275606215000153,
      -0.93184894323349,
      0.30073535442352295,
      -0.49568378925323486,
      0.6192938089370728,
      -0.7684149146080017,
      -0.8502982258796692,
      0.2274787425994873,
      -0.19067461788654327,
      1.0155564546585083,
      -1.3356807231903076,
      0.20546682178974152,
      0.5646898746490479,
      -0.8370317816734314,
      0.5178734064102173,
      0.3500131070613861,
      0.45519310235977173,
      -0.27546125650405884,
      1.5163651704788208,
      0.16362540423870087,
      0.11121803522109985,
      0.6203120946884155,
      -0.5936070084571838,
      -0.8023320436477661,
      0.15202854573726654,
      0.3698040246963501,
      -0.036286160349845886,
      0.600227952003479,
      -0.9820059537887573,
      -0.6561482548713684,
      0.240597665309906,
      0.3000672161579132,
      0.20430123805999756,
      0.6040802597999573,
      1.4416894912719727,
      -0.3255491554737091,
      0.7323821187019348,
      -0.0925063043832779,
      1.0015909671783447,
      -0.5354845523834229,
      0.9560059905052185,
      -0.09842712432146072,
      -1.0980708599090576,
      0.37002211809158325,
      0.3968936800956726,
      0.24237415194511414,
      -0.18948780000209808,
      -0.7868921756744385,
      0.6378390192985535,
      0.2755129635334015,
      -0.06751085817813873,
      -0.27612850069999695,
      -0.3197912573814392,
      -0.07064884901046753,
      0.7308030128479004,
      -1.0562126636505127,
      1.1119050979614258,
      0.02701273001730442,
      0.40836623311042786,
      0.6127307415008545,
      -1.1531157493591309,
      0.5235685110092163,
      -1.026801586151123,
      0.642166256904602,
      -0.3007863163948059,
      0.44034135341644287,
      0.14125484228134155,
      0.054762545973062515,
      0.3285040855407715,
      -0.11804956942796707,
      -0.03334629535675049,
      0.2744908928871155,
      0.5357711315155029,
      -0.29720184206962585,
      0.25041288137435913,
      0.09405452013015747,
      -0.47415632009506226,
      0.23210971057415009,
      0.20149549841880798,
      -0.4780222773551941,
      1.0829691886901855,
      0.12004107236862183,
      0.4854554533958435,
      -0.9316866993904114,
      0.38915109634399414,
      0.18819314241409302,
      -0.38752177357673645,
      -0.38797512650489807,
      -0.46306973695755005,
      -0.8642469644546509,
      0.308047354221344,
      0.22618745267391205,
      0.17044401168823242,
      1.2616918087005615,
      1.1552178859710693,
      0.9068565368652344,
      -0.5401281714439392,
      0.41294243931770325,
      0.5674235820770264,
      0.7532562017440796,
      0.4965348243713379,
      0.13814617693424225,
      -1.2771285772323608,
      0.12966838479042053,
      0.1582830399274826,
      -0.5883188843727112,
      -0.11263594776391983,
      0.8584871888160706,
      0.07334877550601959,
      0.34517890214920044,
      0.43083199858665466,
      -0.29226982593536377,
      1.4051907062530518,
      -0.18683628737926483,
      -0.33273544907569885,
      -0.42923927307128906,
      0.44663599133491516,
      -0.6842675805091858,
      0.5791139006614685,
      -0.1098627969622612,
      -0.10838454961776733,
      -0.13001319766044617,
      -0.6706599593162537,
      -0.6534542441368103,
      -0.4350361227989197,
      -0.27740469574928284,
      0.5136597752571106,
      -0.15058130025863647,
      -0.11312158405780792,
      0.02404848113656044,
      1.009749412536621,
      0.8975657820701599,
      0.7847951054573059,
      0.4657745063304901,
      -0.3295551538467407,
      0.03635632246732712,
      0.2147614061832428,
      0.05323513597249985,
      -1.0042870044708252,
      -1.0770455598831177,
      -0.6690018177032471,
      -0.09850618988275528,
      -0.48522576689720154,
      -0.14748501777648926,
      0.3178880512714386,
      0.2858985662460327,
      0.48945364356040955,
      0.13041158020496368,
      0.07901740819215775,
      0.21094374358654022,
      -0.20477361977100372,
      0.0230000801384449,
      0.45599886775016785,
      0.6813628673553467,
      1.0446398258209229,
      -0.1112048402428627,
      -0.27843448519706726,
      -0.7009046077728271,
      0.4065404236316681,
      0.6022452116012573,
      0.9080755114555359,
      0.2911286950111389,
      0.027748068794608116,
      -0.08953044563531876,
      -0.4249277114868164,
      0.4955756366252899,
      0.28579339385032654,
      -0.4453997313976288,
      -0.9789105653762817,
      -0.04234777018427849,
      -0.03405066952109337,
      0.6674777865409851,
      -0.4639090299606323,
      0.05122518911957741,
      0.6017672419548035,
      -0.08616446703672409,
      0.4793257713317871,
      -0.869825005531311,
      -0.09674794226884842,
      -0.3083164393901825,
      0.018351923674345016,
      0.13544313609600067,
      -0.573958158493042,
      0.783899188041687,
      -0.15440014004707336,
      0.7722354531288147,
      0.40517905354499817,
      -0.27099940180778503,
      0.770620584487915,
      0.42958489060401917,
      0.283611536026001,
      -1.0746867656707764,
      -0.6166439056396484,
      -0.454510360956192,
      -0.20918895304203033,
      0.18185411393642426,
      0.14692546427249908,
      1.21940016746521,
      -0.6015846133232117,
      0.11731930077075958,
      0.8006377220153809,
      -0.423654705286026,
      -0.8738765120506287,
      -0.1217903196811676,
      -1.1255874633789062,
      -0.8654863834381104,
      0.4443000257015228,
      -0.03051372803747654,
      -0.2846328020095825,
      0.11333347856998444,
      -0.14993137121200562,
      -0.262290358543396,
      -0.05991978198289871,
      -0.11742200702428818,
      0.8599927425384521,
      0.06897079199552536,
      0.1300422102212906,
      0.33053091168403625,
      0.9298784732818604,
      -0.12947578728199005,
      0.1076393872499466,
      -0.18177002668380737,
      -0.30817022919654846,
      0.3125340938568115,
      0.7040243744850159,
      0.21802599728107452,
      1.0344959497451782,
      -0.0034030615352094173,
      0.2925928235054016,
      -0.45225727558135986,
      -0.3169204294681549,
      0.14495985209941864,
      -0.31466391682624817,
      0.09807351976633072,
      -0.8023419380187988,
      -0.2665637135505676,
      -0.8261634707450867,
      0.38668087124824524,
      -0.06790737062692642,
      -1.0877965688705444,
      -0.3201073408126831,
      -0.06861985474824905,
      0.32943588495254517,
      0.6518343687057495,
      0.49287548661231995,
      -0.6683748364448547,
      0.031668972223997116,
      1.108386754989624,
      0.16238658130168915,
      -0.5694135427474976,
      -0.6659660935401917,
      -0.5763422846794128,
      0.7211998701095581,
      -0.179313063621521,
      1.4287497997283936,
      -0.1369737982749939,
      0.005816716700792313,
      0.310513436794281,
      -1.3613752126693726,
      -0.150999054312706,
      0.12187936156988144,
      -0.3253754675388336,
      -0.4817717671394348,
      0.06410154700279236,
      0.27593153715133667,
      -0.2622712254524231,
      0.27052944898605347,
      0.40118408203125,
      0.5307997465133667,
      0.4563107490539551,
      0.22696489095687866,
      -1.1160551309585571,
      0.42552804946899414,
      -0.5089985132217407,
      0.5039026737213135,
      0.8988932371139526,
      -0.6227042078971863,
      -0.8037900328636169,
      -0.35766544938087463,
      0.6888933777809143,
      -0.2273094207048416,
      -0.5674704909324646,
      0.9915276765823364,
      0.3973962068557739,
      0.277887761592865,
      1.1627107858657837,
      0.2537875771522522,
      -1.741371989250183,
      0.10032299160957336,
      0.44848519563674927,
      0.6858814358711243,
      -0.2886675298213959,
      -0.35735058784484863,
      0.41949665546417236,
      0.468431681394577,
      0.5198327898979187,
      -0.5439128279685974,
      0.6026431322097778,
      0.7423916459083557,
      0.08482631295919418,
      -1.0514559745788574,
      -0.5518726706504822,
      0.09351036697626114,
      0.8027818202972412,
      0.4345339238643646,
      -0.9243600368499756,
      -1.1852647066116333,
      1.180909514427185,
      0.06303867697715759,
      0.09815005213022232,
      0.6348063945770264,
      0.21555127203464508,
      1.5742065906524658,
      -0.20288020372390747,
      0.10264629870653152,
      0.41843125224113464,
      0.1753326803445816,
      0.42760205268859863,
      0.3055688142776489,
      0.5793120861053467,
      -1.1637141704559326,
      0.11662318557500839,
      -0.8095809817314148,
      -1.4387980699539185,
      0.00905083492398262,
      -0.5383901000022888,
      0.8361985087394714,
      0.9174319505691528,
      -0.5255798101425171,
      -0.41506606340408325,
      0.6030542850494385,
      -0.42284613847732544,
      0.2799643874168396,
      0.1397809535264969,
      0.4212694466114044,
      -0.19897609949111938,
      0.8094280362129211,
      1.1211445331573486,
      0.43191102147102356,
      -1.3256134986877441,
      -1.1740585565567017,
      -0.6385909914970398,
      -0.13907203078269958,
      1.5307953357696533,
      0.3969977796077728,
      0.25350436568260193,
      0.5759806632995605,
      0.27886271476745605,
      0.6681993007659912,
      -0.004065625835210085,
      -0.4235265254974365,
      -0.15067656338214874,
      -0.10595563054084778,
      0.2802005112171173,
      -0.07289368659257889,
      1.318068265914917,
      0.24137216806411743,
      0.16681869328022003,
      0.19313958287239075,
      0.26563766598701477,
      -0.38434451818466187,
      -0.2189355045557022,
      0.6093229055404663,
      -0.15605342388153076,
      0.8798521757125854,
      -0.6043164730072021,
      -0.2574034631252289,
      -0.49980631470680237,
      0.04411223903298378,
      0.14474131166934967,
      0.507891833782196,
      0.10208024829626083,
      0.31117016077041626,
      -1.0033196210861206,
      0.7403362393379211,
      0.14239870011806488,
      -0.7372090816497803,
      -0.053935278207063675,
      0.11915605515241623,
      -0.4966849982738495,
      0.016000406816601753,
      -0.46399012207984924,
      -0.9704810976982117,
      0.21814361214637756,
      0.4976188540458679,
      -1.8764674663543701,
      0.29403820633888245,
      -0.4364481270313263,
      0.32487523555755615,
      -0.2398230880498886,
      -0.9133902788162231,
      -0.00238452828489244,
      0.3693126142024994,
      -0.3220130503177643,
      -0.4562535881996155,
      0.9464129209518433,
      -0.18606413900852203,
      -0.7332574129104614,
      0.5486580729484558,
      1.068402886390686,
      -0.1267634928226471,
      -0.12785936892032623,
      -0.3577145040035248,
      0.3105759024620056,
      0.03447116166353226,
      0.6943109631538391,
      0.3670819401741028,
      -0.982022762298584,
      -0.31095901131629944,
      -0.5095219612121582,
      0.1883877068758011,
      -0.6456010937690735,
      0.04251448065042496,
      -0.7090504169464111,
      -0.4314943850040436,
      -0.4625638723373413,
      -0.6755776405334473,
      -0.42979738116264343,
      -0.9929245114326477,
      0.09871790558099747,
      1.4720735549926758,
      -0.12818080186843872,
      -0.3408984839916229,
      -0.2031744122505188,
      -1.1619007587432861,
      0.7643893361091614,
      0.6880866289138794,
      0.5512861609458923,
      -0.17995207011699677,
      -1.0576173067092896,
      0.05887097120285034,
      0.379523366689682,
      -0.19010858237743378,
      -0.27332720160484314,
      1.2198437452316284,
      0.04932643845677376,
      -0.4267624318599701,
      -0.9377222657203674,
      0.30519407987594604,
      -1.264918327331543,
      -0.14195837080478668,
      0.060625672340393066,
      0.10374473035335541,
      0.2795315682888031,
      0.10566603392362595,
      -0.4948217272758484,
      0.5909090042114258,
      -0.09108727425336838,
      -0.6093617677688599,
      -0.39003637433052063,
      0.596821129322052,
      -0.8376152515411377,
      0.23543810844421387,
      0.0239504873752594,
      -0.7785731554031372,
      -0.2798813283443451,
      -0.2876873314380646,
      -0.718712568283081,
      0.23530064523220062,
      0.8293051719665527,
      1.4203741550445557,
      -1.4855449199676514,
      -0.032907504588365555,
      1.2115267515182495,
      -0.806143045425415,
      0.316177099943161,
      -0.558361828327179,
      0.4785572588443756,
      -0.1101904958486557,
      -0.18931326270103455,
      0.17573784291744232,
      0.3478277623653412,
      0.660274863243103,
      -1.3584027290344238,
      1.212438941001892,
      0.1762462556362152,
      -0.7254099249839783,
      -0.2994919419288635,
      -0.4101698398590088,
      -0.7991592884063721,
      1.1945151090621948,
      -1.1384466886520386,
      0.5949613451957703,
      -0.9817683100700378,
      -0.9301237463951111,
      0.014936665073037148,
      0.327444463968277,
      0.08713490515947342,
      -1.3958057165145874,
      0.19052815437316895,
      -2.1623075008392334,
      0.14599600434303284,
      -1.1871479749679565,
      1.567912220954895,
      0.19722484052181244,
      0.6803154349327087,
      0.3678261935710907,
      0.27333006262779236,
      -0.25622352957725525,
      -0.021781671792268753,
      -0.8594871163368225,
      0.6889809966087341,
      0.10330800712108612,
      -0.9107167720794678,
      0.7721372842788696,
      0.8909813165664673,
      0.35939136147499084,
      -0.4003465175628662,
      0.9345104098320007,
      0.9252786636352539,
      0.7669082880020142,
      -0.48012927174568176,
      0.2891896665096283,
      -0.46317875385284424,
      0.35722652077674866,
      -0.810883104801178,
      -0.8401995897293091,
      -0.28130221366882324,
      0.12743216753005981,
      -0.7536447644233704,
      -0.6598166227340698,
      -0.5810477137565613,
      0.4039391875267029,
      -0.062099918723106384,
      -0.5541606545448303,
      -0.2374090999364853,
      -0.4913441240787506,
      -0.9415494799613953,
      0.16048257052898407,
      0.5005888938903809,
      -0.1592487394809723,
      0.40059682726860046,
      0.3041352927684784,
      -0.13279740512371063,
      1.013353943824768,
      0.5944726467132568,
      -0.2031455934047699,
      -0.4191875159740448,
      0.3310083746910095,
      0.25676044821739197,
      0.11327072978019714,
      0.4690844416618347,
      0.6864451766014099,
      -1.1687816381454468,
      0.5068883895874023,
      -1.411696195602417,
      0.12604071199893951,
      0.026111865416169167,
      -0.12706132233142853,
      0.2451302856206894,
      0.7000320553779602,
      -0.14295493066310883,
      -0.8888638019561768,
      0.7821836471557617,
      -0.21705493330955505,
      -0.7788898944854736,
      0.8991562128067017,
      0.9079057574272156,
      0.12039872258901596,
      -0.12094287574291229,
      -0.182184636592865,
      0.5969864130020142,
      -0.3851228952407837,
      -0.04351627081632614,
      0.05524057522416115,
      0.01556764729321003,
      -0.534746527671814,
      -0.688841700553894,
      -0.24047905206680298,
      0.13997435569763184,
      -0.6768575310707092,
      1.4697411060333252,
      -0.3743112087249756,
      0.46210506558418274,
      0.41053634881973267,
      -0.3629191517829895,
      -0.4009081721305847,
      -0.27867406606674194,
      -0.21064870059490204,
      -0.8513319492340088,
      -1.0951762199401855,
      0.4233066439628601,
      -0.9096344113349915,
      -0.8632853627204895,
      -0.1520775854587555,
      -0.17246994376182556,
      -0.8475736975669861,
      0.17578449845314026,
      -1.4360660314559937,
      -0.6378646492958069,
      -1.95252525806427,
      0.8090845942497253,
      -0.2588851749897003,
      -0.06410151720046997,
      -1.1417948007583618,
      -0.07492532581090927,
      -0.9254084825515747,
      -0.11056715995073318,
      -0.955119788646698,
      0.5265675187110901,
      0.6333068609237671,
      -0.09383063018321991,
      -0.0837949812412262,
      -0.17177744209766388,
      -0.5588506460189819,
      1.3147765398025513,
      0.23445655405521393,
      -0.2793237864971161,
      0.27183347940444946,
      -0.03822215273976326,
      -0.5635265111923218,
      0.4320123493671417,
      -0.6217859387397766,
      0.3156973123550415,
      -0.5761626958847046,
      0.979148268699646,
      1.0520503520965576,
      0.016995538026094437,
      -0.0513179674744606,
      -0.7286844849586487,
      0.2466212511062622,
      0.5089056491851807,
      -0.07631418108940125,
      -0.6285770535469055,
      0.33870577812194824,
      -0.339339941740036
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SL",
      "level3": "F,F",
      "leafContractCategory": "AMO(Level-2)",
      "rootCause": "Missing Options",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Prediction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): Hybrid Multiple Keras API methods (model.compile, model.load_weights, model.predict, and layers.add) interact, leading to a hybrid contract violation.\n\nLevel 2: SL (Sequence of Calls) The problem arises due to incorrect sequence or omission of calls (model.compile not called before model.predict).\n\nLevel 3 (Hybrid Patterns): F, F (Functionality) The issue relates explicitly to functionality�methods (load_weights and compile) must be used together correctly to ensure the model can predict.\n\nLeaf Contract Category: AMO(Level-2) Violation occurs at AMO Level-2 since the necessary method (compile) is missing when using previously saved weights for predictions.\n\nRoot Cause: Missing Options Essential method (compile) and associated options (optimizer and loss function) weren't provided, causing the model's functionality to fail.\n\nEffect: Crash Missing the compile call causes the program to crash with an AttributeError.\n\nML Library: Keras The APIs involved belong explicitly to the Keras framework.\n\nContract Violation Location: Prediction The error manifests when attempting prediction without proper initialization (compile).\n\nDetection Technique: Static This error could be detected statically by identifying the absence of the required compile call after weight loading."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/48547688",
    "title": "",
    "question": "38\n\nUsing Keras from Tensorflow 1.4.1, how does one copy weights from one model to another?\n\nAs some background, I'm trying to implement a deep-q network (DQN) for Atari games following the DQN publication by DeepMind. My understanding is that the implementation uses two networks, Q and Q'. The weights of Q are trained using gradient descent, and then the weights are copied periodically to Q'.\n\nHere's how I build Q and Q':\n\nACT_SIZE   = 4\nLEARN_RATE = 0.0025\nOBS_SIZE   = 128\n\ndef buildModel():\n  model = tf.keras.models.Sequential()\n\n  model.add(tf.keras.layers.Lambda(lambda x: x / 255.0, input_shape=OBS_SIZE))\n  model.add(tf.keras.layers.Dense(128, activation=\"relu\"))\n  model.add(tf.keras.layers.Dense(128, activation=\"relu\"))\n  model.add(tf.keras.layers.Dense(ACT_SIZE, activation=\"linear\"))\n  opt = tf.keras.optimizers.RMSprop(lr=LEARN_RATE)\n\n  model.compile(loss=\"mean_squared_error\", optimizer=opt)\n\n  return model\nI call that twice to get Q and Q'.\n\nI have an updateTargetModel method below that is my attempt at copying weights. The code runs fine, but my overall DQN implementation is failing. I'm really just trying to verify if this is a valid way of copying weights from one network to another.\n\ndef updateTargetModel(model, targetModel):\n  modelWeights       = model.trainable_weights\n  targetModelWeights = targetModel.trainable_weights\n\n  for i in range(len(targetModelWeights)):\n    targetModelWeights[i].assign(modelWeights[i])\nThere's another question here that discusses saving and loading weights to and from disk (Tensorflow Copy Weights Issue), but there's no accepted answer. There is also a question about loading weights from individual layers (Copying weights from one Conv2D layer to another), but I'm wanting to copy the entire model's weights.",
    "answer": "82\n\nActually what you've done is much more than simply copying weights. You made these two models identical all the time. Every time you update one model - the second one is also updated - as both models have the same weights variables.\n\nIf you want to just copy weights - the simplest way is by this command:\n\ntarget_model.set_weights(model.get_weights())",
    "mlApiName": "keras.models.model.target_model.set_weights",
    "embedding": [
      -0.06876681745052338,
      0.3333704471588135,
      -3.2923402786254883,
      -1.0818721055984497,
      1.609014630317688,
      0.4054293930530548,
      -0.056403737515211105,
      -0.030339321121573448,
      -1.7053806781768799,
      0.16109241545200348,
      -1.3657201528549194,
      0.5986465215682983,
      1.4642984867095947,
      -0.6706196069717407,
      -1.305955410003662,
      0.22108137607574463,
      0.3558078110218048,
      -0.2783162593841553,
      0.4284793436527252,
      0.38794490694999695,
      0.06148051843047142,
      -1.0008864402770996,
      0.11173306405544281,
      -1.3607420921325684,
      0.940349280834198,
      -0.00653657503426075,
      -0.23147018253803253,
      0.47152063250541687,
      -0.5955198407173157,
      0.346720814704895,
      0.5087647438049316,
      -1.4274842739105225,
      0.2269466072320938,
      -1.4405676126480103,
      -1.0909509658813477,
      -0.37935057282447815,
      1.0610777139663696,
      -0.5725737810134888,
      -0.3148459494113922,
      0.09881170839071274,
      0.5691748857498169,
      0.4003772735595703,
      -0.3744117319583893,
      -0.14964523911476135,
      0.43438634276390076,
      -0.2902931272983551,
      1.1856260299682617,
      -0.02782556787133217,
      0.9508349299430847,
      -0.894450843334198,
      0.2536027431488037,
      0.3868662714958191,
      -0.35181817412376404,
      -0.08440905064344406,
      1.4986919164657593,
      0.6363593935966492,
      -0.11645017564296722,
      0.7422221302986145,
      0.9428483247756958,
      -1.309049367904663,
      0.44034427404403687,
      1.3712302446365356,
      -0.9572513103485107,
      1.019904375076294,
      0.07569050043821335,
      0.1451338827610016,
      -0.2546998858451843,
      1.0826013088226318,
      -0.44290685653686523,
      -0.5017910599708557,
      0.10432031005620956,
      0.6300591230392456,
      -0.15903253853321075,
      -0.6088971495628357,
      -0.033995844423770905,
      -0.03374021500349045,
      -0.14581333100795746,
      -0.6198631525039673,
      -0.4812559187412262,
      0.1782609522342682,
      -0.43240001797676086,
      0.9039997458457947,
      1.5455502271652222,
      0.23721395432949066,
      0.5219404697418213,
      0.8979976773262024,
      -1.5061942338943481,
      0.5878124833106995,
      -0.5156644582748413,
      1.7055763006210327,
      0.1225251704454422,
      -0.22212225198745728,
      0.8028081655502319,
      1.0319525003433228,
      -0.7423030138015747,
      -1.025125503540039,
      -0.6311110258102417,
      0.32972633838653564,
      -0.7424103021621704,
      -0.011817826889455318,
      -0.12948668003082275,
      0.35814836621284485,
      -0.22287189960479736,
      -1.0362852811813354,
      -0.5612296462059021,
      1.2400434017181396,
      0.7107789516448975,
      0.7914858460426331,
      0.2745305597782135,
      0.5005899667739868,
      -0.5129529237747192,
      -0.372458279132843,
      0.3362608850002289,
      0.0751115158200264,
      -0.5709221363067627,
      -0.2385825365781784,
      0.06133390963077545,
      -0.11801712960004807,
      -0.3472939729690552,
      0.3518054783344269,
      0.013352516107261181,
      -0.8038593530654907,
      0.49934977293014526,
      -0.1934303343296051,
      -0.23958700895309448,
      -0.2877558469772339,
      -1.2520248889923096,
      0.002872855169698596,
      -0.5089420080184937,
      -0.8208343386650085,
      0.17857186496257782,
      -0.21883516013622284,
      -0.27774715423583984,
      0.4378942549228668,
      0.12562227249145508,
      0.5887135863304138,
      -0.6715152263641357,
      -1.1231632232666016,
      0.6708763837814331,
      -0.35333842039108276,
      0.3106412887573242,
      0.33488529920578003,
      -0.12999242544174194,
      -0.8294230699539185,
      0.42746302485466003,
      -0.35757148265838623,
      0.2643281817436218,
      -1.0130664110183716,
      -1.1812788248062134,
      0.3426273465156555,
      0.6606388092041016,
      0.7442042827606201,
      -1.0519754886627197,
      -0.32972586154937744,
      1.1489650011062622,
      -0.8853740692138672,
      0.5698360204696655,
      -0.01881597377359867,
      0.407402902841568,
      0.1254207044839859,
      0.9192376732826233,
      0.0776103064417839,
      0.861554741859436,
      0.037841733545064926,
      0.41119706630706787,
      -0.5789850354194641,
      0.3265979290008545,
      0.6810851693153381,
      0.5769355893135071,
      0.8200287222862244,
      -1.1978365182876587,
      -0.6190478801727295,
      -0.1244393140077591,
      0.143252432346344,
      0.055082764476537704,
      0.8661015629768372,
      1.2547305822372437,
      -0.26591619849205017,
      0.17245988547801971,
      -0.5811601281166077,
      0.9120127558708191,
      -0.3116379380226135,
      1.2581018209457397,
      0.13451620936393738,
      -0.8947481513023376,
      0.7936789989471436,
      0.18075372278690338,
      -0.4359853267669678,
      0.6016347408294678,
      -0.33428406715393066,
      0.023872343823313713,
      -0.04063822329044342,
      0.028782496228814125,
      0.4606846570968628,
      0.10531945526599884,
      -0.4273352026939392,
      0.8085483312606812,
      -0.8681873679161072,
      1.10072660446167,
      0.5439245700836182,
      0.13315260410308838,
      0.518090009689331,
      -0.7705978155136108,
      0.26713258028030396,
      -0.7686798572540283,
      1.3303405046463013,
      -0.5127503275871277,
      0.4624844789505005,
      0.4967480003833771,
      -0.01156020537018776,
      0.14039388298988342,
      0.14205773174762726,
      0.5365338921546936,
      -0.2018888145685196,
      0.6326740384101868,
      -0.22988297045230865,
      0.2717899978160858,
      0.09821253269910812,
      -0.15172578394412994,
      -0.3513120412826538,
      0.2171698659658432,
      0.22890682518482208,
      1.316037893295288,
      -0.4503975212574005,
      0.6287998557090759,
      -0.5850899815559387,
      -0.3199477195739746,
      -0.08694424480199814,
      -0.22796089947223663,
      -0.0057737682946026325,
      -0.11081819236278534,
      -0.6002311110496521,
      0.2636251747608185,
      -0.19800356030464172,
      0.17205320298671722,
      1.2164019346237183,
      0.8044976592063904,
      1.3062063455581665,
      -0.21682904660701752,
      0.10809910297393799,
      0.6704216003417969,
      0.22098292410373688,
      0.12390979379415512,
      0.5743058919906616,
      -1.4449363946914673,
      0.5398831963539124,
      -0.0209394209086895,
      -1.2880163192749023,
      -0.023130694404244423,
      1.0325546264648438,
      0.12404187768697739,
      0.008136630058288574,
      0.11507324129343033,
      0.3256303369998932,
      1.3296242952346802,
      -0.6737594604492188,
      -0.11604658514261246,
      -0.24761971831321716,
      0.45651760697364807,
      -0.6101446151733398,
      0.189855694770813,
      0.2992043197154999,
      -0.20327498018741608,
      -0.24283507466316223,
      -0.6280319690704346,
      -1.1300415992736816,
      -0.11943875998258591,
      -0.5460030436515808,
      0.1346995234489441,
      0.2790006995201111,
      -0.06253593415021896,
      0.6740480661392212,
      1.2967137098312378,
      1.4850066900253296,
      0.19064994156360626,
      0.3618994355201721,
      0.30087947845458984,
      -0.7339305281639099,
      -0.061538949608802795,
      -0.5417615175247192,
      -0.2917170822620392,
      -0.9054334759712219,
      -1.0913360118865967,
      -0.6368459463119507,
      -0.14613349735736847,
      -0.7477766871452332,
      -0.042003341019153595,
      0.33510157465934753,
      0.27941545844078064,
      0.1560424268245697,
      0.028563857078552246,
      0.0702877938747406,
      0.43878525495529175,
      -0.4862256646156311,
      0.052455123513936996,
      1.2509490251541138,
      0.8582459688186646,
      -0.5769429206848145,
      -0.25037938356399536,
      -0.7036977410316467,
      0.23888790607452393,
      1.137199878692627,
      0.921841025352478,
      0.5310840606689453,
      0.48611971735954285,
      0.530057430267334,
      -0.055305786430835724,
      0.5289691686630249,
      0.5097181797027588,
      0.18870607018470764,
      -0.18221904337406158,
      0.1680610477924347,
      0.007208785507827997,
      1.1162467002868652,
      -0.5188754200935364,
      -0.8314374089241028,
      0.7501190900802612,
      -0.28184208273887634,
      0.4928814470767975,
      -1.5166676044464111,
      -0.47223803400993347,
      -0.590768575668335,
      0.2841320335865021,
      0.254969984292984,
      -0.41292721033096313,
      1.3229578733444214,
      -1.021640658378601,
      0.9235684275627136,
      0.2314072549343109,
      0.11483683437108994,
      0.99786376953125,
      0.6830602884292603,
      0.13375812768936157,
      -1.4266573190689087,
      -1.1897691488265991,
      -0.20222677290439606,
      -0.07610761374235153,
      0.31627121567726135,
      0.32678696513175964,
      1.187178134918213,
      0.0034990799613296986,
      0.47196200489997864,
      0.4328702986240387,
      0.11459717899560928,
      -0.06347686797380447,
      0.42031270265579224,
      -0.42273470759391785,
      -0.23896609246730804,
      0.5368682742118835,
      -0.2709003984928131,
      -0.5200197696685791,
      0.09101684391498566,
      -0.10948380082845688,
      0.37175148725509644,
      0.08451847732067108,
      -0.594495952129364,
      0.20295272767543793,
      0.1825381964445114,
      0.3781852126121521,
      0.639712929725647,
      1.28607976436615,
      0.11639972776174545,
      0.8086804151535034,
      0.031472671777009964,
      0.27919694781303406,
      0.31896334886550903,
      0.7109336853027344,
      -0.7319477200508118,
      0.5832432508468628,
      0.13789179921150208,
      0.008691778406500816,
      -0.7388397455215454,
      -0.8318270444869995,
      0.11585436761379242,
      -0.2839999496936798,
      0.5260995030403137,
      -0.6944577097892761,
      0.045424122363328934,
      -0.22829294204711914,
      0.5243919491767883,
      -0.062107160687446594,
      -0.8277158737182617,
      -0.5977873206138611,
      -0.3817615807056427,
      0.6910760998725891,
      0.7981663346290588,
      0.1878257840871811,
      -1.096483588218689,
      0.17812670767307281,
      0.78816157579422,
      0.30543291568756104,
      -0.7249947786331177,
      -0.7543250322341919,
      0.05970843508839607,
      1.6631767749786377,
      -0.042886290699243546,
      1.1128113269805908,
      0.08066724240779877,
      0.1609552949666977,
      0.4363194704055786,
      -1.2799389362335205,
      -0.35409995913505554,
      -0.10165439546108246,
      -0.7863759398460388,
      -0.8966827392578125,
      0.21052901446819305,
      -0.2524048089981079,
      -0.05517435818910599,
      0.20341026782989502,
      0.9452990293502808,
      0.202177494764328,
      0.07251939177513123,
      0.13627862930297852,
      -0.882139265537262,
      0.7098684310913086,
      -0.15034708380699158,
      0.3155803978443146,
      1.4865100383758545,
      -0.8678637146949768,
      -0.7365001440048218,
      -0.5051576495170593,
      0.6927629709243774,
      -0.09743119031190872,
      -0.07784545421600342,
      0.8934362530708313,
      0.7507286667823792,
      0.5440932512283325,
      1.196184515953064,
      0.8131430149078369,
      -2.26289963722229,
      0.10701896250247955,
      0.7611597776412964,
      0.8870877027511597,
      0.1069781631231308,
      0.13519702851772308,
      -0.4545265734195709,
      0.574626088142395,
      0.5878466367721558,
      -0.2662106454372406,
      0.6134288311004639,
      1.2804332971572876,
      -0.16616232693195343,
      -1.565029263496399,
      -0.39394310116767883,
      0.5503905415534973,
      0.7366827130317688,
      0.3432486057281494,
      -0.5979353785514832,
      -1.130654215812683,
      0.9174298048019409,
      0.06214221939444542,
      0.015300985425710678,
      0.7774039506912231,
      0.6650038957595825,
      1.5162732601165771,
      -0.06656483560800552,
      0.7219205498695374,
      0.32364413142204285,
      0.48988595604896545,
      -0.1143803521990776,
      0.6602145433425903,
      0.7166557312011719,
      -0.2595484256744385,
      -0.4884842038154602,
      -0.760716438293457,
      -1.5330902338027954,
      -0.4066765010356903,
      0.29573842883110046,
      0.7359252572059631,
      1.1369372606277466,
      -0.19104138016700745,
      -0.08493395149707794,
      0.2127806544303894,
      0.05993381887674332,
      -0.11585142463445663,
      0.0038884575478732586,
      -0.13838087022304535,
      -0.25359290838241577,
      0.9477025270462036,
      0.6664130687713623,
      0.14907336235046387,
      -1.4855395555496216,
      -1.0478861331939697,
      -1.0670480728149414,
      -0.551179826259613,
      1.340216875076294,
      -0.14253896474838257,
      -0.1948801726102829,
      0.6503737568855286,
      0.4923735558986664,
      0.5325758457183838,
      -0.018366841599345207,
      0.2564420998096466,
      0.34895285964012146,
      -0.5077917575836182,
      -0.0785851776599884,
      0.13734519481658936,
      0.9840595126152039,
      0.38501760363578796,
      -0.3462165892124176,
      0.819365918636322,
      0.8329899907112122,
      0.1748906821012497,
      0.1846344769001007,
      0.49737006425857544,
      -0.350807249546051,
      1.0285427570343018,
      -0.8442360162734985,
      -0.3220582604408264,
      0.1787877380847931,
      -0.3085722327232361,
      0.14528675377368927,
      -0.43729230761528015,
      -0.17992320656776428,
      0.8003567457199097,
      -1.6175998449325562,
      0.21283994615077972,
      0.05851542204618454,
      -0.6863190531730652,
      -0.40659505128860474,
      0.2945875823497772,
      -0.6486650705337524,
      -0.4545115530490875,
      -0.5585497617721558,
      -1.178774118423462,
      0.149478018283844,
      -0.3027443289756775,
      -1.6497766971588135,
      -0.26751309633255005,
      -0.49679094552993774,
      0.49134641885757446,
      0.48628342151641846,
      -1.364641547203064,
      0.406442791223526,
      -0.3177337050437927,
      -0.5508191585540771,
      -0.16147011518478394,
      0.8133584260940552,
      -0.1634032130241394,
      -0.44434264302253723,
      1.1217942237854004,
      0.457786500453949,
      0.07374709099531174,
      0.23719951510429382,
      -0.8564475774765015,
      -0.44688066840171814,
      0.13416896760463715,
      0.031219294294714928,
      0.7837526202201843,
      -0.809005081653595,
      -0.06583945453166962,
      -0.49203556776046753,
      1.2890523672103882,
      -0.6651533842086792,
      0.6058655381202698,
      -0.9054633378982544,
      -1.4413591623306274,
      -0.4895187318325043,
      -1.1938591003417969,
      -0.266613245010376,
      -0.3437592089176178,
      0.8397923707962036,
      1.4988157749176025,
      -0.43662309646606445,
      -0.26662108302116394,
      -0.7838924527168274,
      -1.0843385457992554,
      0.21673935651779175,
      0.389106422662735,
      0.6160217523574829,
      0.02354312315583229,
      -1.0194411277770996,
      -0.6219969391822815,
      0.09977705031633377,
      -0.22702112793922424,
      0.1029050424695015,
      0.14284703135490417,
      0.08121057599782944,
      -1.146708369255066,
      -1.0091017484664917,
      0.07608821243047714,
      -1.64739990234375,
      -0.33704811334609985,
      0.2256007045507431,
      -0.08586166054010391,
      1.1261320114135742,
      -0.3697269558906555,
      -0.9029643535614014,
      0.8434537053108215,
      0.039608150720596313,
      -1.0489088296890259,
      -0.4982725977897644,
      0.18315687775611877,
      0.034304387867450714,
      -0.05600187927484512,
      -0.13785900175571442,
      -0.16999061405658722,
      0.6093994975090027,
      -0.6999398469924927,
      -1.4066100120544434,
      -0.24262529611587524,
      0.524188756942749,
      1.82394278049469,
      -2.015801429748535,
      -0.10586290061473846,
      1.985542893409729,
      -0.7569725513458252,
      0.23404568433761597,
      -0.24038581550121307,
      0.8090287446975708,
      -0.33428657054901123,
      -0.06291733682155609,
      -0.032012488692998886,
      -0.3335953652858734,
      0.6594703793525696,
      -1.0198334455490112,
      0.7747310400009155,
      0.13632924854755402,
      -1.287968635559082,
      -0.820838212966919,
      -0.6717265248298645,
      -1.2828545570373535,
      0.6528705358505249,
      -1.3493636846542358,
      0.2724049687385559,
      -0.295699805021286,
      -0.7280354499816895,
      -0.0074864462949335575,
      0.14420142769813538,
      0.617404043674469,
      -1.2628521919250488,
      -0.05285527557134628,
      -1.3976863622665405,
      -0.04801599681377411,
      -1.4006400108337402,
      1.8991808891296387,
      0.5100212097167969,
      1.6201683282852173,
      -0.2987501323223114,
      0.4598414897918701,
      0.3508455753326416,
      -0.036936674267053604,
      -0.9304860234260559,
      0.18983052670955658,
      0.1769113540649414,
      -1.04263436794281,
      1.1722006797790527,
      0.9184627532958984,
      0.35366421937942505,
      0.5097991228103638,
      0.22863352298736572,
      0.24434572458267212,
      -0.181289941072464,
      -0.2633696496486664,
      0.7659457325935364,
      -0.03643712401390076,
      0.16820380091667175,
      -0.24562212824821472,
      -0.9949866533279419,
      -0.17370977997779846,
      -0.7504176497459412,
      -0.6940039992332458,
      -0.47309166193008423,
      -0.24847212433815002,
      0.5727259516716003,
      -0.13611695170402527,
      -0.06775861233472824,
      -0.5071796178817749,
      -0.47695407271385193,
      -0.5277653336524963,
      0.7192257642745972,
      0.30880728363990784,
      -0.4580703377723694,
      0.25202977657318115,
      0.2677702307701111,
      -0.1655643731355667,
      0.7921848297119141,
      0.8733687996864319,
      -0.024374360218644142,
      0.14877314865589142,
      0.44008374214172363,
      -0.23249690234661102,
      0.8166669011116028,
      0.20260614156723022,
      0.4928854703903198,
      -0.575236439704895,
      0.09019973874092102,
      -0.5699324607849121,
      -0.18635421991348267,
      -0.7275003790855408,
      -0.5972371101379395,
      -0.038577888160943985,
      0.4811707139015198,
      -0.030771778896450996,
      -0.6185441017150879,
      1.2862548828125,
      -0.12490967661142349,
      -0.6411902904510498,
      0.7043867111206055,
      1.5324796438217163,
      0.7864581942558289,
      -0.382455438375473,
      -0.022075070068240166,
      0.31491968035697937,
      0.42098385095596313,
      0.3094159662723541,
      0.16210363805294037,
      -0.1243036687374115,
      -0.09563662856817245,
      -1.069945216178894,
      -0.5503092408180237,
      -0.06504424661397934,
      -0.6597076654434204,
      1.0541927814483643,
      0.44894492626190186,
      0.2803882956504822,
      0.044641561806201935,
      -0.3121698200702667,
      -0.25200968980789185,
      -0.5895954370498657,
      0.5430936217308044,
      -0.22581307590007782,
      -1.0584781169891357,
      -0.10837484896183014,
      -0.8874462842941284,
      -0.6375689506530762,
      0.14141757786273956,
      -1.2204264402389526,
      -0.28489720821380615,
      0.46738338470458984,
      -0.6436737179756165,
      -0.5178200602531433,
      -2.037832498550415,
      0.8951995372772217,
      0.4191676080226898,
      -0.023160500451922417,
      -0.5982139706611633,
      0.1735338568687439,
      -0.6852880716323853,
      -0.46637412905693054,
      -0.8467081189155579,
      1.081169605255127,
      0.423475980758667,
      0.6241658926010132,
      -0.616878867149353,
      -0.2199901044368744,
      -1.506247639656067,
      1.1937731504440308,
      0.12410379946231842,
      -0.6358205080032349,
      0.3756445348262787,
      -0.028108688071370125,
      -1.0757639408111572,
      0.42319455742836,
      -0.9272348284721375,
      -0.09508153796195984,
      -0.15088459849357605,
      1.0202738046646118,
      1.3860760927200317,
      0.3898768424987793,
      -0.5210466980934143,
      -1.0806909799575806,
      0.036756739020347595,
      0.5046434998512268,
      -0.4911704957485199,
      -0.2249794900417328,
      0.2797628343105316,
      0.664218544960022
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Unknown",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): SAM (Single API Method)\nThe violation relates specifically to misuse of a single Keras API method (set_weights), thus fitting a SAM contract violation.\n\nLevel 2: BET (Behavioral Error Type)\nThe error is related to incorrect behavior or usage of the set_weights API call due to misunderstanding how weights assignment should be done in Keras.\n\nLevel 3 (Hybrid Patterns): IC-1 (Internal Call-1)\nThe error emerges from the incorrect internal use of TensorFlow variables and assignment operation instead of the Keras-specific method (get_weights() and set_weights()).\n\nLeaf Contract Category: IC-1 (Internal Call-1)\nThe leaf category specifically reflects the incorrect internal call operation used directly on the TensorFlow variables (assign method) instead of using the higher-level Keras methods (set_weights, get_weights).\n\nRoot Cause: Unacceptable Input Value\nThe root cause is passing TensorFlow internal weight variables directly (instead of Keras weight arrays) to the assign operation, causing unintended sharing of variables rather than a one-time copying of weights.\n\nEffect: Unknown\nThe exact effect isn't clearly described as a crash or infinite loop, hence labeled as \"Unknown.\"\n\nML Library: Keras\nIssue pertains specifically to the Keras framework.\n\nContract Violation Location: Model Construction\nThe error occurs during model construction or initialization, as the issue involves initializing weights from one model to another incorrectly.\n\nDetection Technique: Static\nThe issue can be identified via static analysis by inspecting the incorrect usage patterns (assign rather than set_weights/get_weights).\n\n\n\n"
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/51109639",
    "title": "",
    "question": "7\n\nWhenever I try out LSTM models on Keras, it seems that the model is impossible to train due to long training time.\n\nFor instance, a model like this takes 80 seconds per step to train.:\n\ndef create_model(self):\n        inputs = {}\n        inputs['input'] = []\n        lstm = []\n        placeholder = {}\n        for tf, v in self.env.timeframes.items():\n            inputs[tf] = Input(shape = v['shape'], name = tf)\n            lstm.append(LSTM(8)(inputs[tf]))\n            inputs['input'].append(inputs[tf])\n        account = Input(shape = (3,), name = 'account')\n        account_ = Dense(8, activation = 'relu')(account)\n        dt = Input(shape = (7,), name = 'dt')\n        dt_ = Dense(16, activation = 'relu')(dt)\n        inputs['input'].extend([account, dt])\n\n        data = Concatenate(axis = 1)(lstm)\n        data = Dense(128, activation = 'relu')(data)\n        y = Concatenate(axis = 1)([data, account, dt])\n        y = Dense(256, activation = 'relu')(y)\n        y = Dense(64, activation = 'relu')(y)\n        y = Dense(16, activation = 'relu')(y)\n        output = Dense(3, activation = 'linear')(y)\n\n        model = Model(inputs = inputs['input'], outputs = output)\n        model.compile(loss = 'mse', optimizer = 'adam', metrics = ['mae'])\n        return model\nWhereas model which has LSTM substituded with Flatten + Dense like this:\n\ndef create_model(self):\n        inputs = {}\n        inputs['input'] = []\n        lstm = []\n        placeholder = {}\n        for tf, v in self.env.timeframes.items():\n            inputs[tf] = Input(shape = v['shape'], name = tf)\n            #lstm.append(LSTM(8)(inputs[tf]))\n            placeholder[tf] = Flatten()(inputs[tf])\n            lstm.append(Dense(32, activation = 'relu')(placeholder[tf]))\n            inputs['input'].append(inputs[tf])\n        account = Input(shape = (3,), name = 'account')\n        account_ = Dense(8, activation = 'relu')(account)\n        dt = Input(shape = (7,), name = 'dt')\n        dt_ = Dense(16, activation = 'relu')(dt)\n        inputs['input'].extend([account, dt])\n\n        data = Concatenate(axis = 1)(lstm)\n        data = Dense(128, activation = 'relu')(data)\n        y = Concatenate(axis = 1)([data, account, dt])\n        y = Dense(256, activation = 'relu')(y)\n        y = Dense(64, activation = 'relu')(y)\n        y = Dense(16, activation = 'relu')(y)\n        output = Dense(3, activation = 'linear')(y)\n\n        model = Model(inputs = inputs['input'], outputs = output)\n        model.compile(loss = 'mse', optimizer = 'adam', metrics = ['mae'])\n        return model\ntakes 45-50 ms per step to train.\n\nIs there something wrong in the model that is causing this? Or is this as fast as this model will run?\n\n-- self.env.timeframes looks like this: dictionary with 9 items\n\ntimeframes = {\n            's1': {\n                'lookback': 86400,\n                'word': '1 s',\n                'unit': 1,\n                'offset': 12\n                },\n            's5': {\n                'lookback': 200,\n                'word': '5 s',\n                'unit': 5,\n                'offset': 2\n                },\n            'm1': {\n                'lookback': 100,\n                'word': '1 min',\n                'unit': 60,\n                'offset': 0\n                },\n            'm5': {\n                'lookback': 100,\n                'word': '5 min',\n                'unit': 300,\n                'offset': 0\n                },\n            'm30': {\n                'lookback': 100,\n                'word': '30 min',\n                'unit': 1800,\n                'offset': 0\n                },\n            'h1': {\n                'lookback': 200,\n                'word': '1 h',\n                'unit': 3600,\n                'offset': 0\n                },\n            'h4': {\n                'lookback': 200,\n                'word': '4 h',\n                'unit': 14400,\n                'offset': 0\n                },\n            'h12': {\n                'lookback': 100,\n                'word': '12 h',\n                'unit': 43200,\n                'offset': 0\n                },\n            'd1': {\n                'lookback': 200,\n                'word': '1 d',\n                'unit': 86400,\n                'offset': 0\n                }\n            }\nGPU info from prompt -\n\n2018-06-30 07:35:16.204320: I T:\\src\\github\\tensorflow\\tensorflow\\core\\platform\\cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2\n2018-06-30 07:35:16.495832: I T:\\src\\github\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1356] Found device 0 with properties:\nname: GeForce GTX 1080 major: 6 minor: 1 memoryClockRate(GHz): 1.86\npciBusID: 0000:01:00.0\ntotalMemory: 8.00GiB freeMemory: 6.59GiB\n2018-06-30 07:35:16.495981: I T:\\src\\github\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:1435] Adding visible gpu devices: 0\n2018-06-30 07:35:16.956743: I T:\\src\\github\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:\n2018-06-30 07:35:16.956827: I T:\\src\\github\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:929]      0\n2018-06-30 07:35:16.957540: I T:\\src\\github\\tensorflow\\tensorflow\\core\\common_runtime\\gpu\\gpu_device.cc:942] 0:   N\n2018-06-30 07:35:16.957865: I T:\\src\\github\\tensorflow\\tensorflow\\core\\common_runtime",
    "answer": "9\n\nIf you are using GPU please replace all LSTM layers with CuDNNLSTM layers. You can import it from keras.layers:\n\nfrom keras.layers import  CuDNNLSTM\n\ndef create_model(self):\n    inputs = {}\n    inputs['input'] = []\n    lstm = []\n    placeholder = {}\n    for tf, v in self.env.timeframes.items():\n        inputs[tf] = Input(shape = v['shape'], name = tf)\n        lstm.append(CuDNNLSTM(8)(inputs[tf]))\n        inputs['input'].append(inputs[tf])\n    account = Input(shape = (3,), name = 'account')\n    account_ = Dense(8, activation = 'relu')(account)\n    dt = Input(shape = (7,), name = 'dt')\n    dt_ = Dense(16, activation = 'relu')(dt)\n    inputs['input'].extend([account, dt])\n\n    data = Concatenate(axis = 1)(lstm)\n    data = Dense(128, activation = 'relu')(data)\n    y = Concatenate(axis = 1)([data, account, dt])\n    y = Dense(256, activation = 'relu')(y)\n    y = Dense(64, activation = 'relu')(y)\n    y = Dense(16, activation = 'relu')(y)\n    output = Dense(3, activation = 'linear')(y)\n\n    model = Model(inputs = inputs['input'], outputs = output)\n    model.compile(loss = 'mse', optimizer = 'adam', metrics = ['mae'])\n    return model\nHere is more information: https://keras.io/layers/recurrent/#cudnnlstm\n\nThis will significantly speed up the model =)",
    "mlApiName": "keras.layers.CuDNNLSTM",
    "embedding": [
      -0.05568568781018257,
      1.4972665309906006,
      -2.6315371990203857,
      -0.29133307933807373,
      1.2259629964828491,
      0.06364968419075012,
      0.4847555458545685,
      0.5471365451812744,
      -0.3934065103530884,
      -0.555969774723053,
      -0.7661260962486267,
      0.3277164697647095,
      1.5040476322174072,
      0.44681790471076965,
      -0.1645820587873459,
      -0.2577997148036957,
      0.5177937746047974,
      -0.20299489796161652,
      -0.15375147759914398,
      0.587803065776825,
      -0.02119283750653267,
      -0.2814566493034363,
      0.5238842964172363,
      -0.9487519264221191,
      1.3736375570297241,
      0.11686836183071136,
      -0.465239942073822,
      0.09902362525463104,
      0.28343695402145386,
      0.6568868160247803,
      1.5332328081130981,
      -1.2289997339248657,
      -0.26731446385383606,
      -0.7920161485671997,
      -0.6554524302482605,
      -0.6758240461349487,
      0.4288756251335144,
      -0.37629470229148865,
      0.13677774369716644,
      0.15393751859664917,
      1.3665353059768677,
      -0.27601632475852966,
      0.388602614402771,
      0.010448865592479706,
      0.05704362690448761,
      -0.3217029273509979,
      1.2951375246047974,
      0.05428777262568474,
      -0.15470680594444275,
      -0.8892401456832886,
      0.3968718349933624,
      0.28500381112098694,
      0.023036135360598564,
      0.06092947721481323,
      1.2181897163391113,
      0.936816394329071,
      -0.5749008059501648,
      0.5523360967636108,
      0.31333136558532715,
      -1.1001468896865845,
      0.4371459186077118,
      0.9099717140197754,
      -0.8514352440834045,
      0.7387109398841858,
      0.618301272392273,
      -0.021946759894490242,
      -0.17021702229976654,
      0.46333080530166626,
      0.23680302500724792,
      -0.00982716679573059,
      0.04935985431075096,
      0.19343045353889465,
      -0.2880632281303406,
      -0.25020310282707214,
      -0.2605331242084503,
      0.3083869516849518,
      -0.6305805444717407,
      -0.6371180415153503,
      -0.04777485132217407,
      0.5529788136482239,
      -0.2580334544181824,
      1.1791374683380127,
      0.277005136013031,
      -0.12201665341854095,
      0.3945557475090027,
      -0.31454429030418396,
      -1.125977635383606,
      0.256061851978302,
      -0.776776134967804,
      1.6471903324127197,
      -0.1696118414402008,
      -0.10566443204879761,
      0.36899232864379883,
      0.28576937317848206,
      -0.9288386702537537,
      -0.8192805647850037,
      -0.4637317657470703,
      0.42555707693099976,
      -0.6457120776176453,
      0.25728535652160645,
      -0.7586012482643127,
      0.13178540766239166,
      -0.3056619167327881,
      -1.3688087463378906,
      0.0821453332901001,
      0.8067805171012878,
      -0.3399392366409302,
      0.2796775996685028,
      0.07319580018520355,
      -0.32709231972694397,
      -0.13795749843120575,
      0.3416648209095001,
      -0.7830565571784973,
      0.6288963556289673,
      -0.39457088708877563,
      0.12889273464679718,
      -0.04787447303533554,
      -0.5628603100776672,
      -0.13675211369991302,
      -0.17214632034301758,
      -0.8620463013648987,
      -0.8131674528121948,
      0.1364155411720276,
      -0.06528196483850479,
      0.21604911983013153,
      0.8893610835075378,
      -0.4959131181240082,
      0.5186429023742676,
      -0.4014635384082794,
      -0.044737737625837326,
      0.3165145218372345,
      0.03724595904350281,
      -1.2637641429901123,
      0.049579594284296036,
      0.4916742146015167,
      1.757648229598999,
      -1.0003429651260376,
      -0.80182945728302,
      0.13665491342544556,
      0.14429110288619995,
      0.052508458495140076,
      0.1626897007226944,
      -0.0427493117749691,
      -0.8896332383155823,
      0.3108493685722351,
      -0.02341490611433983,
      0.2532123923301697,
      -0.3745003342628479,
      -0.8478816747665405,
      -0.401676207780838,
      0.00980526115745306,
      0.839009165763855,
      -0.3873184323310852,
      0.6555233597755432,
      0.8106138706207275,
      -0.41316884756088257,
      1.0087151527404785,
      0.2194719761610031,
      0.5039180517196655,
      -0.20195308327674866,
      1.261903166770935,
      0.04222657531499863,
      -0.3017212152481079,
      0.2406672090291977,
      0.09121966361999512,
      -0.59657883644104,
      0.1766306757926941,
      0.5459779500961304,
      0.25108563899993896,
      0.2898693382740021,
      -0.5685088038444519,
      -0.4951707124710083,
      -0.15604563057422638,
      -0.030000263825058937,
      -0.30844706296920776,
      0.6607372760772705,
      1.045219898223877,
      -0.7648637294769287,
      0.19905316829681396,
      -0.10562337934970856,
      0.9351106286048889,
      -0.6920278668403625,
      0.35661447048187256,
      -0.505066990852356,
      -0.702585756778717,
      -0.018835285678505898,
      0.11115677654743195,
      -0.029089901596307755,
      -0.4506765604019165,
      -0.9823223948478699,
      0.5953134894371033,
      -0.1561548113822937,
      -0.9079869985580444,
      -0.16506074368953705,
      0.40763726830482483,
      0.5405715703964233,
      1.0459702014923096,
      -0.7604994177818298,
      0.5538046956062317,
      0.1579677015542984,
      -0.18835555016994476,
      0.17581483721733093,
      -0.35834553837776184,
      0.5102936625480652,
      -0.5148439407348633,
      0.6642886400222778,
      -0.7996372580528259,
      0.8662721514701843,
      -0.3494938910007477,
      0.4039417505264282,
      0.7632100582122803,
      0.5552693605422974,
      -0.2417280077934265,
      0.9961491823196411,
      0.128464013338089,
      -0.9758106470108032,
      0.05037970840930939,
      -0.33576998114585876,
      -0.2666836380958557,
      0.15144212543964386,
      0.8853053450584412,
      -0.9804139733314514,
      0.33027949929237366,
      -0.08904921263456345,
      0.15222345292568207,
      -1.6804896593093872,
      -0.17718833684921265,
      -0.2166241854429245,
      -0.6579599976539612,
      0.21546661853790283,
      -0.38113826513290405,
      0.003965611103922129,
      0.056462664157152176,
      0.01330144889652729,
      -0.0884905606508255,
      0.16926421225070953,
      0.24908287823200226,
      0.8588759899139404,
      -0.7607720494270325,
      0.17984038591384888,
      0.41045859456062317,
      0.10638867318630219,
      0.08639267086982727,
      -0.13642269372940063,
      -0.8286147117614746,
      -0.680590033531189,
      -0.05563042685389519,
      -0.7827448844909668,
      -0.24266257882118225,
      0.5800536274909973,
      -0.13257001340389252,
      -0.047514401376247406,
      0.3052232563495636,
      -0.44295984506607056,
      1.0438019037246704,
      -0.6195063591003418,
      -0.3116489052772522,
      -0.08335144817829132,
      0.2371361404657364,
      -0.45793622732162476,
      0.2699968218803406,
      0.8232661485671997,
      0.34320348501205444,
      -0.3948415219783783,
      -0.7481497526168823,
      -0.28774452209472656,
      -0.5938524007797241,
      -0.3356110453605652,
      0.21344652771949768,
      -0.7161401510238647,
      -0.362861305475235,
      0.3712627589702606,
      0.5032464861869812,
      0.5513728260993958,
      -0.20584285259246826,
      0.28064432740211487,
      0.15121802687644958,
      -0.04454639181494713,
      -0.3572953939437866,
      0.16018861532211304,
      -0.6062679290771484,
      -1.2291066646575928,
      -0.25701433420181274,
      -0.23365257680416107,
      0.15970560908317566,
      -0.3408691883087158,
      0.016743065789341927,
      0.38757070899009705,
      0.2657785713672638,
      0.2599274218082428,
      -0.02210536226630211,
      0.8354265689849854,
      0.1159391850233078,
      0.6944593191146851,
      -0.04374859482049942,
      0.8512678146362305,
      0.04388837888836861,
      -0.5654061436653137,
      -0.29616570472717285,
      0.013980765827000141,
      0.6617274880409241,
      0.6569961905479431,
      0.7969996929168701,
      0.9978025555610657,
      -0.14549373090267181,
      -0.30409738421440125,
      0.5679283738136292,
      0.26465901732444763,
      -0.21775472164154053,
      -0.12030915915966034,
      0.14852015674114227,
      -0.09634920954704285,
      -0.28303396701812744,
      0.21140609681606293,
      -0.19888918101787567,
      -0.408892959356308,
      0.2000664919614792,
      -0.06851965188980103,
      0.50309157371521,
      -0.030681749805808067,
      0.10847440361976624,
      -0.5853581428527832,
      0.024486297741532326,
      0.07436346262693405,
      -0.003501898841932416,
      0.30051368474960327,
      -0.002084428211674094,
      0.33114758133888245,
      0.10132148861885071,
      -0.48188304901123047,
      1.0983585119247437,
      0.2268819659948349,
      0.8751530647277832,
      -0.5037227272987366,
      -0.7689551115036011,
      -0.4496228098869324,
      -0.3188003897666931,
      0.10837900638580322,
      -0.17353278398513794,
      0.21355263888835907,
      -0.5177386403083801,
      0.15842464566230774,
      0.3418003022670746,
      0.23666644096374512,
      -0.24384023249149323,
      0.15755335986614227,
      -1.1652470827102661,
      -1.090891718864441,
      0.8971924185752869,
      0.2451304942369461,
      -0.49551084637641907,
      0.3732420802116394,
      -0.1009591743350029,
      -0.6009429097175598,
      -0.1289762258529663,
      -0.3244619071483612,
      0.3045984208583832,
      0.22743652760982513,
      0.2419966608285904,
      -0.353988379240036,
      1.0011157989501953,
      0.5141584873199463,
      0.1257270723581314,
      -0.1170877069234848,
      0.029926439747214317,
      0.5220557451248169,
      0.9803642630577087,
      0.3339495062828064,
      1.0801334381103516,
      0.47355952858924866,
      -0.48316192626953125,
      -0.02984546311199665,
      -0.19781650602817535,
      -0.2000172883272171,
      0.04304540157318115,
      0.14525975286960602,
      -0.6704657077789307,
      0.31192392110824585,
      0.06537973135709763,
      0.4359058141708374,
      0.1667703241109848,
      -0.5454686284065247,
      -0.5528322458267212,
      -0.8107030987739563,
      0.36494168639183044,
      0.9088459610939026,
      0.6440268754959106,
      -1.0856112241744995,
      -0.30821260809898376,
      0.5805280208587646,
      -0.10614843666553497,
      -0.27239540219306946,
      -0.7994470000267029,
      -0.2701847553253174,
      0.5046451091766357,
      -1.0793617963790894,
      1.1067646741867065,
      0.31211012601852417,
      -0.04563029482960701,
      -0.0841125026345253,
      -0.6080952286720276,
      -0.7811322808265686,
      -0.7330752611160278,
      0.06593704968690872,
      -0.30976638197898865,
      0.11079197376966476,
      -0.1386277973651886,
      -0.07352255284786224,
      0.16011101007461548,
      0.10359813272953033,
      0.6266705989837646,
      0.6532155275344849,
      -0.10199294239282608,
      -0.9300628304481506,
      0.542726457118988,
      0.4349445402622223,
      0.8233622312545776,
      1.1802113056182861,
      -0.9773246645927429,
      -0.7783865332603455,
      0.023945828899741173,
      0.8220707178115845,
      0.4198175072669983,
      -0.3094264566898346,
      1.0937166213989258,
      1.0981847047805786,
      0.64030522108078,
      0.8722965717315674,
      0.03109550289809704,
      -1.8084412813186646,
      0.9714176058769226,
      0.012011628597974777,
      0.16739384829998016,
      0.10585787892341614,
      -0.5397292375564575,
      0.47923514246940613,
      0.8812521696090698,
      1.0301240682601929,
      0.03633658215403557,
      1.1249141693115234,
      1.082313895225525,
      -0.26519283652305603,
      -0.350022554397583,
      -0.7768357992172241,
      0.44863981008529663,
      0.08055532723665237,
      0.7669102549552917,
      -1.2006874084472656,
      -1.2882568836212158,
      0.3582209348678589,
      0.28360769152641296,
      0.5535831451416016,
      0.9010015726089478,
      0.3938729166984558,
      1.280068278312683,
      0.026002056896686554,
      -0.11336946487426758,
      0.48037442564964294,
      -0.01598210819065571,
      0.8596301674842834,
      -0.010322258807718754,
      0.10845871269702911,
      -0.4222688674926758,
      0.428888201713562,
      -0.6171193718910217,
      -1.0182619094848633,
      -0.24635069072246552,
      -0.23462441563606262,
      0.04089688882231712,
      0.537617027759552,
      -0.5020724534988403,
      -0.7017955183982849,
      0.3998959958553314,
      0.2527848482131958,
      -0.45299428701400757,
      -0.7793086767196655,
      0.035470448434352875,
      0.33234238624572754,
      0.7688229084014893,
      0.9089539647102356,
      0.17757317423820496,
      -0.7600739002227783,
      -0.8281008005142212,
      -0.8076425194740295,
      0.5763833522796631,
      1.450209140777588,
      0.3049064576625824,
      0.03142542392015457,
      -0.10584571212530136,
      -0.39784008264541626,
      0.7293297648429871,
      -0.2113407701253891,
      -0.4251580834388733,
      -0.5494384765625,
      -0.4145751893520355,
      0.23848623037338257,
      0.6431371569633484,
      0.588757336139679,
      0.09425770491361618,
      0.6284001469612122,
      -0.5063582062721252,
      0.39135077595710754,
      -0.022456111386418343,
      -0.3002814054489136,
      0.6700430512428284,
      0.29384395480155945,
      0.7085222601890564,
      -0.9128604531288147,
      -0.33803844451904297,
      -0.024518704041838646,
      -0.0799703523516655,
      0.4936766028404236,
      0.3924579918384552,
      0.05185731500387192,
      0.0694643184542656,
      -0.9854387044906616,
      0.018190434202551842,
      -0.011330993846058846,
      -0.6495980620384216,
      -0.6713619828224182,
      0.6807587146759033,
      -0.1590576320886612,
      -0.763597309589386,
      -0.1312611848115921,
      -1.4482576847076416,
      0.8851562142372131,
      0.22658568620681763,
      -1.2627472877502441,
      0.429653137922287,
      -0.33708456158638,
      0.6499157547950745,
      -0.4863662123680115,
      -0.9631293416023254,
      -0.37569308280944824,
      0.08690466731786728,
      0.29357990622520447,
      0.13316960632801056,
      0.627896249294281,
      0.42753076553344727,
      -0.5317543745040894,
      -0.011784782633185387,
      0.6729936599731445,
      0.051203373819589615,
      -0.0031810684595257044,
      0.28541040420532227,
      -0.4300071895122528,
      0.4310689866542816,
      0.6984831094741821,
      0.36188843846321106,
      -1.2848979234695435,
      -0.22686298191547394,
      -1.1743578910827637,
      0.6201158761978149,
      -0.8214172720909119,
      0.17938123643398285,
      0.03289227932691574,
      -1.2040684223175049,
      -0.9909421801567078,
      -1.130422830581665,
      -0.3859064280986786,
      -0.46549907326698303,
      0.6701280474662781,
      1.6989408731460571,
      0.02849607914686203,
      0.0961591973900795,
      -0.6831532120704651,
      -0.35096412897109985,
      0.8685188293457031,
      0.5801259279251099,
      0.06510955095291138,
      0.5988375544548035,
      -0.6808769702911377,
      0.19800561666488647,
      -0.039192404597997665,
      -0.5405892133712769,
      0.14546869695186615,
      0.43547749519348145,
      0.09995907545089722,
      -0.7907270193099976,
      -0.6898401379585266,
      0.07294077426195145,
      -1.436998724937439,
      0.21127809584140778,
      0.36917296051979065,
      0.4853411614894867,
      0.418678343296051,
      0.1898365467786789,
      -0.5248668789863586,
      0.6749944686889648,
      0.28434669971466064,
      -0.8529524803161621,
      -0.27634197473526,
      0.7863715291023254,
      -1.2539114952087402,
      0.5826380252838135,
      -0.06514496356248856,
      -0.3346520662307739,
      0.22629965841770172,
      -0.3228200078010559,
      -1.4407763481140137,
      -0.21909335255622864,
      0.5647806525230408,
      0.9532088041305542,
      -1.2301374673843384,
      -0.23129373788833618,
      1.239977478981018,
      -0.5514779686927795,
      0.32082709670066833,
      0.1032654419541359,
      0.6554715633392334,
      0.3522356450557709,
      -0.4684589207172394,
      -0.20846059918403625,
      -0.13531482219696045,
      -0.32038742303848267,
      -0.6640263199806213,
      1.194164514541626,
      0.6519032716751099,
      -0.35373660922050476,
      -0.4288772940635681,
      -0.24587401747703552,
      -0.2524046003818512,
      1.2110713720321655,
      -0.6933966279029846,
      0.20109908282756805,
      -0.5282198190689087,
      -0.7102890610694885,
      0.20870685577392578,
      -0.10973523557186127,
      0.15296444296836853,
      -0.6665245890617371,
      -0.3824700713157654,
      -2.030924081802368,
      0.3911592662334442,
      -0.5318002104759216,
      0.3400781452655792,
      -0.499938040971756,
      0.05314919352531433,
      0.5041521191596985,
      0.5240142345428467,
      0.2712000012397766,
      -0.4773394465446472,
      -0.6531281471252441,
      0.9026036858558655,
      0.18460100889205933,
      -1.269437313079834,
      0.5683460831642151,
      1.09296452999115,
      0.19573312997817993,
      -0.562873899936676,
      0.565426766872406,
      1.5156913995742798,
      -0.3776117265224457,
      -0.4171640872955322,
      0.6230218410491943,
      -0.97772216796875,
      -0.03675404563546181,
      -0.7432682514190674,
      -0.7381712198257446,
      -0.8517362475395203,
      -0.012896792031824589,
      -0.2820955216884613,
      -0.2685234844684601,
      -0.0934242233633995,
      0.5666045546531677,
      0.14575353264808655,
      -1.1369448900222778,
      0.7336314916610718,
      -0.3552933931350708,
      -0.5862248539924622,
      0.26133105158805847,
      0.16103927791118622,
      0.3450440466403961,
      0.2071860134601593,
      0.3301718533039093,
      -0.23747432231903076,
      0.5253534913063049,
      0.8252555727958679,
      -0.240647554397583,
      -0.4416128695011139,
      0.45121070742607117,
      0.23697569966316223,
      0.7717055678367615,
      0.8926776051521301,
      0.5725265741348267,
      -0.9367303252220154,
      0.553382158279419,
      -0.8207005858421326,
      -0.2915650010108948,
      -0.39471039175987244,
      0.04624092951416969,
      1.1223745346069336,
      0.02757193148136139,
      0.43073612451553345,
      -0.5580246448516846,
      0.8715770840644836,
      0.39242351055145264,
      -0.9434065222740173,
      0.6707209348678589,
      1.225577712059021,
      0.06753583997488022,
      0.24876908957958221,
      0.1820754110813141,
      0.7494855523109436,
      0.21001282334327698,
      0.14189501106739044,
      -0.1266777366399765,
      -0.0383145734667778,
      -0.10178231447935104,
      -0.3869760036468506,
      -0.1211250051856041,
      0.5924431085586548,
      -1.1726545095443726,
      0.5087319016456604,
      0.013343531638383865,
      0.18564292788505554,
      -0.1685362309217453,
      -0.21126337349414825,
      -1.0203696489334106,
      -0.11279793828725815,
      0.20687973499298096,
      -0.6561110019683838,
      -1.2920725345611572,
      0.2613888382911682,
      0.14971570670604706,
      -0.8250752091407776,
      0.297439306974411,
      -0.5996807217597961,
      -0.40975672006607056,
      0.17116834223270416,
      -0.7324796319007874,
      -0.02030535414814949,
      -1.1905674934387207,
      0.8516026735305786,
      -0.07798966765403748,
      -0.09660033881664276,
      -0.4055003523826599,
      -0.28521886467933655,
      -0.9248945116996765,
      -0.020085077732801437,
      -0.7995799779891968,
      0.05411629006266594,
      0.6070752739906311,
      0.616183340549469,
      0.06299340724945068,
      -0.4784279763698578,
      -0.34220266342163086,
      1.0893232822418213,
      -0.32326412200927734,
      -0.3906170725822449,
      0.6040061116218567,
      0.12277460843324661,
      -0.7002775073051453,
      -0.5871919989585876,
      -0.5534683465957642,
      0.13791458308696747,
      0.034569092094898224,
      1.0393099784851074,
      1.159652590751648,
      0.7346035242080688,
      -0.2301463931798935,
      -0.5432577729225159,
      0.6223422884941101,
      0.2731676399707794,
      -0.10230033844709396,
      -0.50225830078125,
      0.254509299993515,
      -0.6170648336410522
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "BP",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Runtime Checking",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): SAM (Single API Method)\nThe violation involves a specific misuse of a single Keras API method (CuDNNLSTM), fitting into the SAM category.\n\nLevel 2: BET (Behavioral Error Type)\nThe behavioral issue stems from incorrect usage or understanding of how LSTM layers should be implemented for GPU optimization, thus classified under BET.\n\nLevel 3 (Hybrid Patterns): IC-1 (Internal Call-1)\nThe error arises due to internal calls within the Keras framework�specifically, incorrect selection of LSTM layers that don't leverage GPU optimizations provided by CuDNNLSTM.\n\nLeaf Contract Category: IC-1 (Internal Call-1)\nThe leaf category is identical to Level 3, pinpointing the precise internal call misuse involving GPU-accelerated layer implementations.\n\nRoot Cause: Unacceptable Input Value\nThe root cause is using standard LSTM layers instead of GPU-optimized CuDNNLSTM, which drastically affects training performance. The input provided (standard LSTM parameters) isn't appropriate for optimal GPU computation.\n\nEffect: BP (Bad Performance)\nThe outcome is severe performance degradation (extremely long training times), explicitly indicating a performance-related issue.\n\nML Library: Keras\nIssue is specifically related to Keras' layer implementation.\n\nContract Violation Location: Model Construction\nThe violation occurs at the model construction phase, where the layers are chosen and set up incorrectly for GPU use.\n\nDetection Technique: Runtime Checking\nThe issue was detected via runtime behavior, as the significant performance bottleneck becomes apparent only when the model executes (trains)."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/51763983",
    "title": "",
    "question": "14\n\nI'm training a model to predict the stock price and input data is close price. I use 45 days data to predict the 46th day's close price and a economic Indicator to be second feature, here is the model:\n\nmodel = Sequential()\nmodel.add( LSTM( 512, input_shape=(45, 2), return_sequences=True))\nmodel.add( LSTM( 512, return_sequences=True))\nmodel.add( (Dense(1)))\nmodel.compile(loss='mse', optimizer='adam')\nhistory = model.fit( X_train, y_train, batch_size = batchSize, epochs=epochs, shuffle = False)\nWhen I run this I get the following error:\n\nValueError: Error when checking target: expected dense_1 to have 3 dimensions, but got array with shape (118, 1)\n\nHowever, I print the shape of data and they are:\n\nX_train:(118, 45, 2)\ny_train:(118, 1)\nI have no idea why the model is expecting a 3 dimensional output when y_train is (118, 1). Where am I wrong and what should I do?",
    "answer": "16\n\nYour second LSTM layer also returns sequences and Dense layers by default apply the kernel to every timestep also producing a sequence:\n\n# (bs, 45, 2)\nmodel.add( LSTM( 512, input_shape=(45, 2), return_sequences=True))\n# (bs, 45, 512)\nmodel.add( LSTM( 512, return_sequences=True))\n# (bs, 45, 512)\nmodel.add( (Dense(1)))\n# (bs, 45, 1)\nSo your output is shape (bs, 45, 1). To solve the problem you need to set return_sequences=False in your second LSTM layer which will compress sequence:\n\n# (bs, 45, 2)\nmodel.add( LSTM( 512, input_shape=(45, 2), return_sequences=True))\n# (bs, 45, 512)\nmodel.add( LSTM( 512, return_sequences=False)) # SET HERE\n# (bs, 512)\nmodel.add( (Dense(1)))\n# (bs, 1)\nAnd you'll get the desired output. Note bs is the batch size.",
    "mlApiName": "keras.models.fit",
    "embedding": [
      0.07928512990474701,
      0.7961517572402954,
      -2.562215566635132,
      -0.49510374665260315,
      1.2165005207061768,
      0.03267846629023552,
      0.4150349795818329,
      0.1388816386461258,
      -0.895235002040863,
      -1.1465562582015991,
      0.07416354864835739,
      0.42529162764549255,
      2.0868523120880127,
      0.22339650988578796,
      -0.1096731424331665,
      -0.3872547149658203,
      0.059661585837602615,
      -0.2982877790927887,
      -0.031143777072429657,
      0.7960532903671265,
      -0.08213218301534653,
      0.2936229705810547,
      -0.3151579201221466,
      -0.42986100912094116,
      0.6691049337387085,
      0.3924253284931183,
      -0.8383990526199341,
      0.2570892870426178,
      0.24163895845413208,
      0.6929541826248169,
      1.3978420495986938,
      -0.35826563835144043,
      -0.33427149057388306,
      -1.4005459547042847,
      -1.5250096321105957,
      -0.8587937951087952,
      0.9880092144012451,
      0.3567650318145752,
      0.37218400835990906,
      -0.39083346724510193,
      0.950555145740509,
      0.3229140341281891,
      -0.5040266513824463,
      0.7696192860603333,
      -0.004847006872296333,
      0.23921218514442444,
      1.29119873046875,
      0.28778108954429626,
      0.9765835404396057,
      -0.33946722745895386,
      0.28459057211875916,
      0.9417949914932251,
      -0.08093824982643127,
      -0.03662601858377457,
      1.6704086065292358,
      0.6846079230308533,
      -0.5634390115737915,
      0.9202069640159607,
      1.1710206270217896,
      -0.6911224722862244,
      0.5506283640861511,
      0.9216404557228088,
      -1.464277982711792,
      1.117370843887329,
      0.44124165177345276,
      -0.3458672761917114,
      -0.5939040184020996,
      0.5817888379096985,
      -0.3810938596725464,
      -0.16217464208602905,
      0.6543431282043457,
      -0.15912315249443054,
      0.06619736552238464,
      -0.07912813872098923,
      -0.4654027223587036,
      -0.08455748856067657,
      -0.4540345370769501,
      -0.23169466853141785,
      -1.1418172121047974,
      0.6226226091384888,
      0.2472827136516571,
      1.0132197141647339,
      0.7848929762840271,
      -0.06334608793258667,
      -0.45748287439346313,
      0.27648067474365234,
      -1.1660213470458984,
      0.37489473819732666,
      -0.2788741886615753,
      1.5600999593734741,
      -1.0164573192596436,
      0.20491942763328552,
      1.1165159940719604,
      1.1794625520706177,
      -0.9414936900138855,
      -0.5893502831459045,
      0.08919636160135269,
      0.5975484251976013,
      -0.5959000587463379,
      0.2311081439256668,
      -0.5028974413871765,
      1.1260929107666016,
      0.23039555549621582,
      -1.296480655670166,
      -0.6756036281585693,
      1.472442626953125,
      -0.18539562821388245,
      -0.12121858447790146,
      0.0413157120347023,
      -0.9099929332733154,
      -0.7921320199966431,
      -0.014079219661653042,
      -0.3866065442562103,
      -0.31967267394065857,
      -0.3598580062389374,
      0.3241839110851288,
      0.02674151584506035,
      -0.48296719789505005,
      0.455996572971344,
      -0.2385777235031128,
      0.27123111486434937,
      -1.1631968021392822,
      0.2781834006309509,
      0.22872915863990784,
      0.0172991044819355,
      0.7749027609825134,
      -1.132858395576477,
      0.7668673396110535,
      -0.3649561107158661,
      -0.374443918466568,
      0.011782930232584476,
      -0.33363205194473267,
      -0.6407626867294312,
      0.49621111154556274,
      0.7495239973068237,
      1.3512309789657593,
      -1.4065477848052979,
      -0.673759400844574,
      0.39478105306625366,
      1.4282710552215576,
      0.24959145486354828,
      0.13998299837112427,
      0.10910122096538544,
      -1.030587077140808,
      0.03968852385878563,
      -0.41357916593551636,
      0.38321739435195923,
      -0.7451978325843811,
      -1.0415898561477661,
      -0.3209396302700043,
      -0.7179978489875793,
      1.101934552192688,
      -1.016042947769165,
      0.3610987961292267,
      0.9151470065116882,
      -0.05606864392757416,
      0.39835256338119507,
      0.6296939253807068,
      0.5741771459579468,
      -0.11366620659828186,
      0.9961546063423157,
      -0.2883431315422058,
      -0.695798397064209,
      0.916205883026123,
      -0.41750770807266235,
      -0.7531392574310303,
      0.6910462975502014,
      0.07873626053333282,
      -0.4772001802921295,
      0.3425697088241577,
      -0.6843239068984985,
      -0.678268551826477,
      -0.02033831737935543,
      -0.2586442828178406,
      -0.26841872930526733,
      1.2460622787475586,
      1.5425453186035156,
      -0.47090891003608704,
      0.8895307779312134,
      -0.516169011592865,
      0.8085709810256958,
      0.08446072041988373,
      0.9249970316886902,
      -0.4528029263019562,
      -0.3182227611541748,
      -0.5589779615402222,
      0.6683651804924011,
      -0.1113392636179924,
      -0.0682089626789093,
      -0.2991923987865448,
      0.4603238105773926,
      0.08202453702688217,
      -0.17229877412319183,
      -0.30143868923187256,
      0.07113515585660934,
      -0.1265539526939392,
      1.3271361589431763,
      -0.7990336418151855,
      0.4403899610042572,
      0.22736908495426178,
      -0.24924497306346893,
      -0.021603437140583992,
      -0.23511964082717896,
      0.7164902091026306,
      -0.5944912433624268,
      0.7500390410423279,
      -0.21155667304992676,
      0.8129855990409851,
      -0.8484483957290649,
      0.8919968008995056,
      -0.4021497666835785,
      -0.22611254453659058,
      0.5010388493537903,
      0.1949280947446823,
      0.8345011472702026,
      -0.30659741163253784,
      0.9197417497634888,
      0.12034922093153,
      -0.20043164491653442,
      0.20612522959709167,
      0.29007670283317566,
      -0.5504102110862732,
      1.006751537322998,
      -0.18690627813339233,
      0.660930871963501,
      -0.80999755859375,
      0.6555206179618835,
      0.40449297428131104,
      -0.6665152311325073,
      -0.21304357051849365,
      -0.1599193960428238,
      -0.7281224727630615,
      0.21993619203567505,
      0.27729445695877075,
      -0.10563269257545471,
      -0.09572239965200424,
      0.23020383715629578,
      0.6370370984077454,
      -0.37899619340896606,
      0.2423124462366104,
      0.1260112076997757,
      0.8895152807235718,
      -0.030813755467534065,
      -0.3088349997997284,
      -0.6395555138587952,
      -0.06249962002038956,
      -0.09245585650205612,
      -0.8242024779319763,
      -0.2025066465139389,
      1.0473681688308716,
      -0.5838095545768738,
      0.6050741672515869,
      0.5309389233589172,
      -0.05464426055550575,
      1.3924953937530518,
      -0.9804829359054565,
      -0.6492571830749512,
      -0.27109700441360474,
      0.6539059281349182,
      -0.6960793733596802,
      0.3591257333755493,
      0.6634873151779175,
      0.23065400123596191,
      -0.20599733293056488,
      -0.894148051738739,
      -1.14500093460083,
      0.3544570207595825,
      -0.07173674553632736,
      -0.5094174146652222,
      -0.43952053785324097,
      -0.07829394936561584,
      -0.06133577227592468,
      0.9370258450508118,
      0.5871881246566772,
      0.6476503610610962,
      0.5600494742393494,
      0.6000263690948486,
      -0.3693045675754547,
      0.07873464375734329,
      -0.34049779176712036,
      -0.8156632781028748,
      -0.5484951138496399,
      -0.4471040368080139,
      0.3476025462150574,
      0.2331559807062149,
      -0.09906631708145142,
      -0.3084999620914459,
      0.5255201458930969,
      0.3920328617095947,
      0.5884990096092224,
      -0.5459922552108765,
      0.11808952689170837,
      -0.17668399214744568,
      0.5668718218803406,
      0.3202311396598816,
      0.46802979707717896,
      0.9337735772132874,
      -0.22027955949306488,
      0.6937288045883179,
      -0.964493453502655,
      0.1727844774723053,
      0.837473452091217,
      0.772890567779541,
      -0.3274664580821991,
      0.2657034695148468,
      -0.10067333281040192,
      0.5034905076026917,
      0.002256588311865926,
      -0.7074120044708252,
      -0.48915374279022217,
      -0.664261519908905,
      -0.33169132471084595,
      -0.4412861764431,
      0.18928958475589752,
      -0.5684664249420166,
      -0.4506818950176239,
      -0.10937515646219254,
      0.08588875830173492,
      0.0709058940410614,
      -0.4236895442008972,
      0.4777473211288452,
      -0.688408374786377,
      -0.23622046411037445,
      -0.4156136214733124,
      -0.5891699194908142,
      0.8651316165924072,
      -0.11927195638418198,
      -0.2362741082906723,
      0.3118942081928253,
      0.17045006155967712,
      0.5492086410522461,
      0.15539440512657166,
      -0.001300164614804089,
      -0.8879612684249878,
      -0.9044905304908752,
      -0.19856971502304077,
      -0.02756637893617153,
      0.19665829837322235,
      0.33091503381729126,
      0.4749256670475006,
      -0.4498571753501892,
      0.5479466319084167,
      0.7473561763763428,
      -0.8333826065063477,
      -0.05648712441325188,
      0.22480925917625427,
      -1.310834288597107,
      -0.3769833743572235,
      0.6662978529930115,
      0.3354753255844116,
      0.1254269778728485,
      0.11633278429508209,
      0.003444372210651636,
      -0.27631881833076477,
      0.07047756016254425,
      0.6387702226638794,
      0.6154460310935974,
      -0.06213245168328285,
      0.42675599455833435,
      0.212196484208107,
      0.872948408126831,
      -0.35428860783576965,
      -0.9838309288024902,
      -0.1971995234489441,
      0.2910231351852417,
      0.0900210291147232,
      1.0090575218200684,
      0.1686803251504898,
      1.4590116739273071,
      -0.21756379306316376,
      -0.4254988431930542,
      -0.23374080657958984,
      -0.11210988461971283,
      -0.16445183753967285,
      -0.1000397577881813,
      0.3876267075538635,
      -0.7150728702545166,
      0.32346296310424805,
      -0.5144002437591553,
      0.1377011090517044,
      0.8596511483192444,
      -0.20922639966011047,
      -0.04845568165183067,
      -0.6480569839477539,
      0.3268725872039795,
      0.18581485748291016,
      0.46433621644973755,
      -1.009199857711792,
      -0.6882458925247192,
      0.38050851225852966,
      0.0664273276925087,
      -0.8168020248413086,
      -0.9321791529655457,
      -0.34359651803970337,
      0.6090822219848633,
      -0.7390931248664856,
      0.8377045392990112,
      0.25427666306495667,
      -1.092708945274353,
      0.7165141105651855,
      -1.1079097986221313,
      -0.5186703205108643,
      -0.45237189531326294,
      -0.3397517204284668,
      -0.6604979038238525,
      -0.33619752526283264,
      0.2754175364971161,
      0.1716466099023819,
      0.24206893146038055,
      0.5348048806190491,
      0.2329740822315216,
      0.49173086881637573,
      -0.15696468949317932,
      -1.816850185394287,
      0.9822573065757751,
      -0.35288119316101074,
      0.7731115221977234,
      0.22784672677516937,
      -0.8723138570785522,
      -0.4130990505218506,
      -0.0571882389485836,
      0.9235345125198364,
      0.1706351786851883,
      -0.33135807514190674,
      0.9473240971565247,
      1.0803627967834473,
      0.3004738688468933,
      0.8870176672935486,
      0.3431161940097809,
      -1.2606834173202515,
      0.4438261389732361,
      0.29081764817237854,
      0.3389115333557129,
      0.35970231890678406,
      -0.4749050438404083,
      0.15163519978523254,
      -0.18119680881500244,
      1.0430126190185547,
      -0.4803510904312134,
      0.6930823922157288,
      0.05546991899609566,
      -0.18949688971042633,
      -0.8461902737617493,
      0.14692279696464539,
      0.4202081561088562,
      0.2995680570602417,
      0.459018737077713,
      -0.6656134724617004,
      -1.9091944694519043,
      1.4075332880020142,
      -0.23769423365592957,
      -0.22299160063266754,
      0.2624622583389282,
      0.7760794758796692,
      1.3991353511810303,
      -0.2915162146091461,
      -0.096226766705513,
      0.6645385026931763,
      0.2207610309123993,
      0.4271097779273987,
      -0.3958984613418579,
      0.3704927861690521,
      -1.117356777191162,
      0.2153216451406479,
      -0.1487446278333664,
      -1.2144790887832642,
      0.21839134395122528,
      -0.869307279586792,
      0.34838420152664185,
      1.3470760583877563,
      -1.0445095300674438,
      -0.5619562864303589,
      0.1619064211845398,
      0.007766792085021734,
      0.06616783142089844,
      0.5937121510505676,
      -0.42997288703918457,
      -0.054109565913677216,
      0.693382978439331,
      1.1685924530029297,
      0.41001248359680176,
      -2.042250633239746,
      -0.2622901201248169,
      -0.30532050132751465,
      0.21074073016643524,
      1.6719732284545898,
      0.5219204425811768,
      -0.1405327022075653,
      0.6108931303024292,
      0.23791393637657166,
      1.1699635982513428,
      -0.7355538010597229,
      0.3775768578052521,
      -0.28624534606933594,
      -0.9141221046447754,
      -0.004775360692292452,
      0.3294801712036133,
      0.48831474781036377,
      0.1040140762925148,
      0.3793194890022278,
      -0.19366410374641418,
      -0.6412915587425232,
      -0.47270479798316956,
      -0.015916598960757256,
      0.2029164582490921,
      -0.2600829303264618,
      0.920468807220459,
      -1.112120270729065,
      -0.1319434493780136,
      0.03742113709449768,
      0.46513116359710693,
      -0.2458203285932541,
      0.4034578800201416,
      -0.24594368040561676,
      0.11536358296871185,
      -1.826021671295166,
      0.9128447771072388,
      0.9697326421737671,
      0.009594460017979145,
      -0.0850515142083168,
      0.6203023791313171,
      -0.22353501617908478,
      -0.19793517887592316,
      -0.6371814608573914,
      -0.24007418751716614,
      0.27362826466560364,
      0.3321819305419922,
      -1.4513585567474365,
      0.3470006585121155,
      -0.5965911746025085,
      0.4110744595527649,
      -0.015941334888339043,
      -0.988766074180603,
      -0.1486998349428177,
      0.5945066809654236,
      0.31484097242355347,
      -0.03948613628745079,
      0.8791171312332153,
      1.3317748308181763,
      -0.5064358115196228,
      0.12389767915010452,
      0.8069384694099426,
      -0.5772267580032349,
      -0.21379882097244263,
      -0.3906189203262329,
      -0.3412679135799408,
      0.1288924217224121,
      0.5622165203094482,
      1.057079792022705,
      -0.7018927931785583,
      -0.1502724587917328,
      -0.8583251237869263,
      -0.060788217931985855,
      -0.9853142499923706,
      0.24512100219726562,
      -0.5794556736946106,
      -0.4070427417755127,
      -0.5241921544075012,
      -0.8346529603004456,
      -0.2379675805568695,
      -1.1826543807983398,
      0.17474155128002167,
      1.5943208932876587,
      0.31015264987945557,
      0.10859274119138718,
      -0.6746086478233337,
      -0.6074820160865784,
      0.5191439390182495,
      0.27555134892463684,
      0.17297446727752686,
      -0.02607516199350357,
      -1.3233201503753662,
      0.45643460750579834,
      0.6083899736404419,
      -0.44225943088531494,
      0.224315345287323,
      0.9489327669143677,
      -0.1998109072446823,
      -1.0098440647125244,
      -0.40225183963775635,
      0.10503794997930527,
      -1.257904052734375,
      0.16760548949241638,
      0.8368896842002869,
      0.13700631260871887,
      1.0572227239608765,
      -0.15620163083076477,
      -0.6692587733268738,
      -0.030733389779925346,
      0.08897692710161209,
      -1.4853624105453491,
      -0.2377103716135025,
      0.9194478392601013,
      -0.6072587370872498,
      0.32173752784729004,
      -0.7407698035240173,
      -0.6935309767723083,
      0.28284478187561035,
      -0.7875233888626099,
      -1.726999044418335,
      -0.07035700976848602,
      0.5677067041397095,
      1.4613821506500244,
      -1.4362627267837524,
      -0.06827662885189056,
      1.0346039533615112,
      -0.6289466023445129,
      0.17720024287700653,
      -0.12474716454744339,
      0.6178211569786072,
      0.27243590354919434,
      -0.15665508806705475,
      -0.15670230984687805,
      0.542220413684845,
      0.6064510941505432,
      -0.7326080799102783,
      1.0958564281463623,
      0.08795331418514252,
      0.07214492559432983,
      -0.7187436819076538,
      -0.29689377546310425,
      -0.7314661145210266,
      0.9439799785614014,
      -1.5223251581192017,
      0.5104100108146667,
      -0.8405479788780212,
      -0.6272381544113159,
      -0.1435755342245102,
      0.4595823884010315,
      0.5052029490470886,
      -1.4443515539169312,
      -0.1243307888507843,
      -1.7611523866653442,
      0.4208360016345978,
      -0.5150139927864075,
      0.9296286702156067,
      -0.7735055685043335,
      1.2622963190078735,
      0.3992000222206116,
      1.1852396726608276,
      0.05238810181617737,
      -0.06764227151870728,
      -0.6234334111213684,
      0.779144823551178,
      -0.7762491703033447,
      -1.1608068943023682,
      0.4410010278224945,
      0.980903148651123,
      0.1049090325832367,
      -0.0948321744799614,
      1.2558120489120483,
      1.3697587251663208,
      -0.41807591915130615,
      -0.3790475130081177,
      0.6750757098197937,
      -0.4163723886013031,
      -0.20625388622283936,
      -0.6607687473297119,
      -0.33962178230285645,
      -0.8300144672393799,
      -0.24082784354686737,
      -0.6131546497344971,
      -0.5739617347717285,
      -0.3558911383152008,
      0.8987489938735962,
      0.4727434515953064,
      -0.4184170663356781,
      0.284396767616272,
      -0.5134676694869995,
      -1.5737086534500122,
      -0.10897259414196014,
      0.6110655069351196,
      0.13848906755447388,
      0.8790803551673889,
      0.9288475513458252,
      0.00048167011118493974,
      0.6530574560165405,
      0.5619000792503357,
      0.6518927812576294,
      -0.5789341330528259,
      0.9615438580513,
      0.3799179196357727,
      0.9501743316650391,
      0.7807397246360779,
      -0.2682381272315979,
      -0.5515963435173035,
      0.1039016917347908,
      -1.2328699827194214,
      -0.3538276255130768,
      0.2123081386089325,
      0.19208019971847534,
      0.3136485517024994,
      0.19314616918563843,
      -0.047528691589832306,
      -1.0491327047348022,
      0.8841755390167236,
      -0.5327245593070984,
      -0.6685812473297119,
      0.5390019416809082,
      0.9143857955932617,
      0.07683528959751129,
      0.08527185022830963,
      0.5692712068557739,
      0.10774857550859451,
      -0.3882085084915161,
      -0.15258733928203583,
      0.41607198119163513,
      0.09502427279949188,
      -0.039705704897642136,
      -0.8574265241622925,
      -0.10813739150762558,
      0.16457125544548035,
      -0.31972140073776245,
      0.9737353920936584,
      -0.27779680490493774,
      0.3649107813835144,
      -0.47174155712127686,
      -1.0822076797485352,
      -0.5417642593383789,
      -1.2207765579223633,
      -0.3391067683696747,
      -0.0787757858633995,
      -1.0658670663833618,
      0.6467285752296448,
      -0.07048280537128448,
      -1.0408611297607422,
      -0.4644012451171875,
      -0.5356407165527344,
      -0.28149086236953735,
      0.5271425247192383,
      -1.3031253814697266,
      0.011886946856975555,
      -1.5612635612487793,
      0.778513491153717,
      0.5766707062721252,
      0.403734415769577,
      -0.5013245940208435,
      -0.16450488567352295,
      -0.9036989212036133,
      -0.2551651895046234,
      -0.7534883618354797,
      0.8564339876174927,
      0.505059540271759,
      -0.3102417290210724,
      -0.5327523946762085,
      -0.6552416682243347,
      -1.0979938507080078,
      1.3810185194015503,
      0.17975467443466187,
      -0.20465068519115448,
      0.07759539783000946,
      -0.23846130073070526,
      -0.7333220839500427,
      0.4876438081264496,
      -0.5105026960372925,
      0.42010217905044556,
      -0.15851277112960815,
      0.6896892189979553,
      1.1305688619613647,
      -0.5271784067153931,
      -0.16934415698051453,
      -0.6671223044395447,
      0.608303964138031,
      0.16735221445560455,
      0.5079808831214905,
      -0.5768712162971497,
      0.04987013339996338,
      -0.5658631324768066
    ],
    "label": {
      "level1": "SAM",
      "level2": "DT",
      "level3": "BIT",
      "leafContractCategory": "BIT",
      "rootCause": "Unacceptable Input Type",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Evaluation",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category):\n\nSAM (Single API Method): The problem specifically arises from misuse of a single API method (model.fit from Keras).\nLevel 2:\n\nDT (Data Type): The error is caused by an incompatibility in data shape and dimensionality between provided training labels (y_train) and what the model expects.\nLevel 3 (Hybrid Patterns):\n\nBIT (Built-in Type): The issue involves built-in data structures (tensors), specifically the shape of tensors fed into the neural network layers.\nLeaf Contract Category:\n\nBIT (Built-in Type): The core issue relates directly to built-in tensor types and their dimensional shapes expected by the model.\nRoot Cause:\n\nUnacceptable Input Type: The shape of y_train tensor is incorrect (2D) when a 3D tensor is expected due to improper configuration of LSTM layers (return_sequences=True).\nEffect:\n\nCrash: This input incompatibility directly results in a runtime crash (ValueError).\nML Library:\n\nKeras: The labeling pertains specifically to Keras methods (model.fit) in model training.\nContract Violation Location:\n\nModel Evaluation: The error emerges during model evaluation (training phase), specifically during the fitting of training data.\nDetection Technique:\n\nStatic: The error is statically detectable by simply reviewing the model architecture and data shape without executing the training process.\n\n"
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/42264649",
    "title": "",
    "question": "41\n\nI'm following this tutorial (section 6: Tying it All Together), with my own dataset. I can get the example in the tutorial working, no problem, with the sample dataset provided.\n\nI'm getting a binary cross-entropy error that is negative, and no improvements as epochs progress. I'm pretty sure binary cross-entropy should always be positive, and I should see some improvement in the loss. I've truncated the sample output (and code call) below to 5 epochs. Others seem to run into similar problems sometimes when training CNNs, but I didn't see a clear solution in my case. Does anyone know why this is happening?\n\nSample output:\n\nCreating TensorFlow device (/gpu:2) -> (device: 2, name: GeForce GTX TITAN Black, pci bus id: 0000:84:00.0)\n10240/10240 [==============================] - 2s - loss: -5.5378 - acc: 0.5000 - val_loss: -7.9712 - val_acc: 0.5000\nEpoch 2/5\n10240/10240 [==============================] - 0s - loss: -7.9712 - acc: 0.5000 - val_loss: -7.9712 - val_acc: 0.5000\nEpoch 3/5\n10240/10240 [==============================] - 0s - loss: -7.9712 - acc: 0.5000 - val_loss: -7.9712 - val_acc: 0.5000\nEpoch 4/5\n10240/10240 [==============================] - 0s - loss: -7.9712 - acc: 0.5000 - val_loss: -7.9712 - val_acc: 0.5000\nEpoch 5/5\n10240/10240 [==============================] - 0s - loss: -7.9712 - acc: 0.5000 - val_loss: -7.9712 - val_acc: 0.5000\nMy code:\n\nimport numpy as np\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense\n\ndataset = np.loadtxt('train_rows.csv', delimiter=\",\")\ntestset = np.loadtxt('test_rows.csv', delimiter=\",\")\n\n# split into input (X) and output (Y) variables\nX = dataset[:, :62]\nY = dataset[:, 62]\n\nX_test = testset[:, :62]\nY_test = testset[:, 62]\n\n### create model\nmodel = Sequential()\nmodel.add(Dense(100, input_dim=(62,), activation='relu'))\nmodel.add(Dense(50, activation='relu'))\nmodel.add(Dense(1, activation='sigmoid'))\n\nmodel.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])\n## Fit the model\nmodel.fit(X, Y, validation_data=(X_test, Y_test), epochs=5, batch_size=128)",
    "answer": "48\n\nI should have printed out my response variable. The categories were labelled as 1 and 2 instead of 0 and 1, which confused the classifier.",
    "mlApiName": "keras.models.fit",
    "embedding": [
      0.34750109910964966,
      -0.2117006778717041,
      -2.561061143875122,
      -1.0269677639007568,
      1.5367062091827393,
      0.9222545623779297,
      0.3749726712703705,
      0.6125372648239136,
      -0.9359434247016907,
      -0.7785244584083557,
      0.3889988958835602,
      0.8548874855041504,
      1.731247901916504,
      -0.3879818320274353,
      -0.03690669685602188,
      0.011080867610871792,
      0.4296002984046936,
      0.8981968760490417,
      -0.10497378557920456,
      1.3912713527679443,
      -0.2035122960805893,
      -0.02619166672229767,
      -0.08458627015352249,
      -0.7506915926933289,
      1.3407961130142212,
      0.8912926912307739,
      -0.5884124636650085,
      1.3000102043151855,
      -0.7189964056015015,
      0.8180878758430481,
      1.7942631244659424,
      0.19298309087753296,
      -0.5190538763999939,
      -1.1661887168884277,
      -2.5418224334716797,
      -0.32041504979133606,
      0.9465705156326294,
      -0.0232009869068861,
      0.6198376417160034,
      0.35310015082359314,
      1.476662039756775,
      -0.3373982310295105,
      0.68719482421875,
      0.6429611444473267,
      -0.07374092936515808,
      0.04322154074907303,
      1.787759780883789,
      0.046969883143901825,
      1.132778525352478,
      -0.9495437741279602,
      0.6482371687889099,
      0.5237682461738586,
      0.651365339756012,
      0.4126468896865845,
      1.7311773300170898,
      0.8507760763168335,
      -0.2391567826271057,
      0.3515757918357849,
      0.6576904654502869,
      -0.8349546194076538,
      0.09758350253105164,
      0.6568182706832886,
      -1.0690577030181885,
      1.245141863822937,
      -0.054198578000068665,
      -0.3555600941181183,
      -0.4811156988143921,
      0.6430951952934265,
      -0.2069101631641388,
      -0.536159098148346,
      0.26157844066619873,
      0.6101041436195374,
      0.44752037525177,
      0.3864821195602417,
      -0.48952701687812805,
      0.19626706838607788,
      -0.7857683300971985,
      -0.2624890208244324,
      -0.04604882746934891,
      0.4865996241569519,
      -0.2864464819431305,
      0.5238242745399475,
      1.100508689880371,
      0.36389410495758057,
      0.39403465390205383,
      0.0470937117934227,
      -0.8358314633369446,
      -0.3217386305332184,
      -1.2399632930755615,
      1.0339570045471191,
      -0.3054545819759369,
      -0.03580861911177635,
      0.6093341708183289,
      0.3031284511089325,
      -0.6338746547698975,
      -0.010649407282471657,
      -0.32513898611068726,
      0.36277294158935547,
      -0.9782738089561462,
      0.3620704412460327,
      0.10291430354118347,
      -0.19770540297031403,
      -0.29714301228523254,
      -0.5187855958938599,
      -0.6595486402511597,
      1.016282558441162,
      -0.15907880663871765,
      -0.28184974193573,
      -0.4096944332122803,
      -0.11196604371070862,
      -1.044963002204895,
      0.558100163936615,
      -0.4600810110569,
      -0.7307268977165222,
      0.5258817672729492,
      0.31487151980400085,
      0.5222524404525757,
      0.006409799680113792,
      -0.10095232725143433,
      -0.050735779106616974,
      0.07058490067720413,
      -0.45731115341186523,
      -0.11657720059156418,
      0.28989577293395996,
      -0.6989725828170776,
      0.9081854820251465,
      -1.017991542816162,
      0.3471085727214813,
      0.20213979482650757,
      -0.8618803024291992,
      -0.14945966005325317,
      -0.2782163619995117,
      -0.4572562873363495,
      0.24226614832878113,
      0.6535533666610718,
      0.8079647421836853,
      -0.7134778499603271,
      -0.397452712059021,
      0.7984974980354309,
      0.6143944263458252,
      0.4047567546367645,
      0.4528104364871979,
      0.4815601110458374,
      -0.6838502287864685,
      0.6913226842880249,
      -1.0249840021133423,
      -0.23487238585948944,
      -0.7337796092033386,
      -0.9577988982200623,
      -0.4011746644973755,
      -0.3407514989376068,
      0.5046108961105347,
      -0.35372158885002136,
      0.34702005982398987,
      -0.31482750177383423,
      -0.6016579270362854,
      -0.1868777871131897,
      -0.1271609216928482,
      0.17128179967403412,
      0.1638876348733902,
      0.9147742390632629,
      0.31539207696914673,
      -0.8679599761962891,
      0.7866064310073853,
      -0.033613722771406174,
      -0.2661316990852356,
      -0.09430909901857376,
      -0.013808895833790302,
      0.24950207769870758,
      0.2247420698404312,
      -0.9305958151817322,
      -0.9754312634468079,
      0.407498300075531,
      -0.7346353530883789,
      0.27486708760261536,
      1.4075651168823242,
      1.3239357471466064,
      -0.13644695281982422,
      0.9008975028991699,
      -0.5916532874107361,
      0.22744245827198029,
      0.14234599471092224,
      1.5103951692581177,
      0.17236490547657013,
      0.0910772755742073,
      -1.0419872999191284,
      -0.031067876145243645,
      1.1858105659484863,
      -0.8973149061203003,
      -0.8259370923042297,
      1.5357407331466675,
      0.03334861993789673,
      -1.3285304307937622,
      -0.4953571856021881,
      0.38932356238365173,
      -0.7970547080039978,
      0.7197361588478088,
      -0.7204949259757996,
      0.983513593673706,
      0.3316681981086731,
      -0.3029941916465759,
      0.3001999855041504,
      -0.6006254553794861,
      0.0766720250248909,
      -0.8399072289466858,
      0.5290906429290771,
      -0.31208401918411255,
      0.046746425330638885,
      -0.3787897527217865,
      0.7421460747718811,
      -0.6653711795806885,
      -0.043655555695295334,
      0.07549521327018738,
      0.43443575501441956,
      -0.28960463404655457,
      -0.8154709935188293,
      0.5327670574188232,
      -0.16519753634929657,
      -0.530321478843689,
      0.16038785874843597,
      -0.17507003247737885,
      -0.479776531457901,
      0.6827552914619446,
      -0.32212337851524353,
      0.8483421206474304,
      -0.6223466396331787,
      -0.26215413212776184,
      -0.3466307520866394,
      -0.7550064921379089,
      -0.5798806548118591,
      -0.28220468759536743,
      -0.028579939156770706,
      0.7408176064491272,
      0.1426633894443512,
      -0.6119707822799683,
      0.46014082431793213,
      1.2278481721878052,
      1.2125543355941772,
      -0.3814060389995575,
      -0.20705099403858185,
      -0.11780436336994171,
      0.3532039523124695,
      -0.592190146446228,
      0.7022233605384827,
      -0.6041020750999451,
      0.3809680938720703,
      -0.47090816497802734,
      -0.7187372446060181,
      -0.22079069912433624,
      0.2742233872413635,
      0.2028113305568695,
      0.9569611549377441,
      0.5981360673904419,
      -0.19158756732940674,
      0.9553338885307312,
      -0.3069537281990051,
      -0.6187971234321594,
      -0.44448351860046387,
      0.2669932246208191,
      0.009939189068973064,
      0.29880353808403015,
      -0.23750758171081543,
      0.38500139117240906,
      -0.1296224743127823,
      -0.09809739887714386,
      -0.9770373106002808,
      -0.2282477170228958,
      -0.06516370177268982,
      0.08797818422317505,
      -0.49114954471588135,
      -0.07561342418193817,
      0.5513148903846741,
      0.7714431881904602,
      0.8705378770828247,
      1.0489532947540283,
      0.3682997226715088,
      0.029496410861611366,
      0.17711877822875977,
      -0.45210960507392883,
      0.17295397818088531,
      -0.9408297538757324,
      -0.8307285308837891,
      -0.2984076738357544,
      0.021287214010953903,
      -0.33422011137008667,
      -0.15327493846416473,
      0.05125470086932182,
      0.5065712928771973,
      0.5085213780403137,
      0.8449341654777527,
      -0.11306852102279663,
      -0.05095767229795456,
      0.05219131335616112,
      0.37950342893600464,
      0.3551873564720154,
      0.4446924030780792,
      0.7616169452667236,
      -0.3945469260215759,
      0.053389642387628555,
      -0.8679933547973633,
      0.19287432730197906,
      0.9672237038612366,
      0.44906094670295715,
      0.2281656563282013,
      -0.04868921637535095,
      -0.26336267590522766,
      -0.6114897131919861,
      -0.28616002202033997,
      0.566213846206665,
      -0.6864795088768005,
      -0.9763827323913574,
      -0.2899080216884613,
      -0.26256921887397766,
      0.0843370258808136,
      -0.08303741365671158,
      -0.1401766985654831,
      0.046486299484968185,
      0.6065545678138733,
      -0.06366932392120361,
      0.5104460716247559,
      0.7127190828323364,
      -0.4648248255252838,
      0.20435142517089844,
      0.017590412870049477,
      -0.277008980512619,
      0.7236446738243103,
      0.042892735451459885,
      0.5703135132789612,
      0.65496826171875,
      0.5698617100715637,
      0.6768707036972046,
      -0.3733014166355133,
      1.1277507543563843,
      -1.0652419328689575,
      -0.5776302814483643,
      -0.002847458468750119,
      0.01196205522865057,
      0.002391617512330413,
      -0.291324257850647,
      1.3762773275375366,
      0.05815638601779938,
      0.24772749841213226,
      0.27759596705436707,
      -0.567402184009552,
      -0.031040135771036148,
      -0.09203705191612244,
      -1.0017071962356567,
      -0.35161465406417847,
      0.49538880586624146,
      0.8008999228477478,
      0.1462852954864502,
      -0.11368181556463242,
      -0.05998402461409569,
      -0.24171628057956696,
      -0.44613415002822876,
      -0.13870854675769806,
      0.1096036285161972,
      -0.580769419670105,
      -0.10536783933639526,
      0.726146936416626,
      0.4665958881378174,
      0.15954196453094482,
      -0.2757145166397095,
      0.5394101738929749,
      -0.3907950222492218,
      0.7598065733909607,
      0.819856584072113,
      0.24260213971138,
      1.1444567441940308,
      -0.35697928071022034,
      -0.8783963322639465,
      -0.19067969918251038,
      -0.8538973927497864,
      0.25070661306381226,
      -0.30704376101493835,
      -0.3683513104915619,
      -0.5731179118156433,
      0.2503235936164856,
      -0.6650656461715698,
      0.8323915004730225,
      0.8138895630836487,
      -0.5734420418739319,
      -0.5882906317710876,
      0.4061119556427002,
      0.7696880102157593,
      -0.5008985996246338,
      0.08223114162683487,
      -0.9592409729957581,
      -0.34591078758239746,
      0.4549493193626404,
      0.4324190020561218,
      -0.058456581085920334,
      -0.8334215879440308,
      0.16778171062469482,
      0.3838832378387451,
      -0.7551840543746948,
      1.2024554014205933,
      0.3820110559463501,
      -0.49268537759780884,
      0.37716159224510193,
      -1.1819525957107544,
      -0.4262172281742096,
      0.6185745596885681,
      -0.06242699921131134,
      -0.1369050294160843,
      -0.9441580772399902,
      -0.7585371732711792,
      0.3456133008003235,
      -0.5584255456924438,
      0.8193386197090149,
      0.41720476746559143,
      0.4908936023712158,
      -0.6320375204086304,
      -1.7584389448165894,
      0.7905280590057373,
      0.36770376563072205,
      0.6484287977218628,
      0.7419223785400391,
      -0.0659608244895935,
      -0.7996487021446228,
      0.3815965950489044,
      0.8797805309295654,
      -0.3093825578689575,
      0.46100717782974243,
      1.0526236295700073,
      0.4320716857910156,
      0.21244865655899048,
      0.8098036646842957,
      0.3294677138328552,
      -1.4422200918197632,
      0.10542792826890945,
      0.8348447680473328,
      0.07620567083358765,
      0.5867254137992859,
      0.1705428957939148,
      0.8149971961975098,
      -0.15882636606693268,
      0.2860122323036194,
      -0.27154675126075745,
      1.155013918876648,
      0.5507750511169434,
      -0.32482466101646423,
      -1.1770148277282715,
      -1.1001392602920532,
      0.10224982351064682,
      0.7141624689102173,
      1.9179843664169312,
      -1.6019906997680664,
      -1.2113697528839111,
      0.8688344359397888,
      0.18745996057987213,
      -0.6523446440696716,
      1.138658046722412,
      0.3336082398891449,
      1.2815473079681396,
      -0.31827983260154724,
      -0.03395240008831024,
      0.3163429796695709,
      -0.09161330759525299,
      0.5092734098434448,
      0.13985313475131989,
      0.0893949493765831,
      -1.1434993743896484,
      0.3198660612106323,
      -0.13332387804985046,
      -0.9336355328559875,
      -0.04965744540095329,
      -0.43625280261039734,
      0.3920328617095947,
      0.44927576184272766,
      -1.088363766670227,
      0.14618973433971405,
      0.04138632491230965,
      -0.5548236966133118,
      -0.5233959555625916,
      1.119763731956482,
      -0.6971672773361206,
      0.15661674737930298,
      0.18545550107955933,
      1.0028280019760132,
      0.42573073506355286,
      -1.8054560422897339,
      0.23532555997371674,
      -0.45161497592926025,
      -0.2760619819164276,
      1.4833945035934448,
      0.47994527220726013,
      0.22345687448978424,
      0.7135582566261292,
      -0.2734124958515167,
      0.6132902503013611,
      0.2899010479450226,
      0.4887828528881073,
      -0.3502194285392761,
      -0.6181465983390808,
      0.04814765974879265,
      0.30468398332595825,
      0.34692853689193726,
      0.4839833676815033,
      0.4071635603904724,
      -0.6497120261192322,
      0.2792132496833801,
      -0.18248634040355682,
      0.5077160596847534,
      0.48335859179496765,
      -0.003434233833104372,
      0.6588931679725647,
      -1.3882781267166138,
      -0.4805101454257965,
      0.1656423658132553,
      0.05541827529668808,
      0.21267639100551605,
      1.1601074934005737,
      0.16923855245113373,
      0.2685520350933075,
      -1.1689316034317017,
      0.5181864500045776,
      -0.03683581203222275,
      -0.5093096494674683,
      -0.758645236492157,
      0.8492608070373535,
      -0.5494799017906189,
      -0.09746707230806351,
      -0.6790069341659546,
      -0.5080293416976929,
      0.14610759913921356,
      0.5114372372627258,
      -1.4634382724761963,
      -0.4153839945793152,
      -0.26026085019111633,
      0.6095457673072815,
      0.13509614765644073,
      -1.336228847503662,
      0.2996208667755127,
      0.17828935384750366,
      0.20734649896621704,
      -0.5309928059577942,
      1.022311806678772,
      0.6742305755615234,
      -0.17267213761806488,
      0.00736693199723959,
      0.8799778819084167,
      -0.7030236721038818,
      -0.6745496392250061,
      -0.7297805547714233,
      -0.21189415454864502,
      0.25693219900131226,
      0.32444527745246887,
      0.2202722132205963,
      -1.4950100183486938,
      0.6315699815750122,
      -0.9473599195480347,
      0.193955659866333,
      -0.803000271320343,
      0.4919201135635376,
      -0.7915822267532349,
      -0.40708452463150024,
      -0.7996232509613037,
      -1.040784239768982,
      -0.7181481719017029,
      -1.145154356956482,
      -0.15521416068077087,
      1.5711535215377808,
      0.7003557085990906,
      0.45782670378685,
      -0.5141082406044006,
      -0.648628294467926,
      0.2278987318277359,
      0.2680465877056122,
      0.7261824011802673,
      0.5383011102676392,
      -0.9996803402900696,
      0.6056838035583496,
      -0.025568319484591484,
      -0.6038713455200195,
      -0.20095612108707428,
      0.14850547909736633,
      -0.4712132513523102,
      -0.6917501091957092,
      -0.884027898311615,
      -0.08768472075462341,
      -1.5835545063018799,
      0.307930588722229,
      0.6199921369552612,
      -0.4446556866168976,
      1.1257262229919434,
      -0.5542638301849365,
      -0.21777431666851044,
      0.2677168548107147,
      0.1748306006193161,
      -0.8129642605781555,
      -0.20838485658168793,
      1.124442219734192,
      -0.758385956287384,
      -0.3179377019405365,
      -0.671596884727478,
      -1.2438746690750122,
      -0.2597167193889618,
      -1.0435811281204224,
      -1.6661405563354492,
      -0.8431150913238525,
      0.6497570872306824,
      1.4756203889846802,
      -1.0472394227981567,
      0.3567051887512207,
      1.062400460243225,
      -0.6651502847671509,
      0.3008178174495697,
      -0.10629566758871078,
      0.49910372495651245,
      0.64504474401474,
      -0.07682948559522629,
      0.015596279874444008,
      -0.21041762828826904,
      0.22658947110176086,
      -0.8800680041313171,
      0.9756127595901489,
      0.2473900020122528,
      -0.9677630662918091,
      -0.21856732666492462,
      -0.45939767360687256,
      -0.8283486366271973,
      0.3754741847515106,
      -1.55148184299469,
      -0.004150135908275843,
      0.15088747441768646,
      -0.20203134417533875,
      -0.205295592546463,
      0.48965218663215637,
      0.49851542711257935,
      -1.8777997493743896,
      0.49944207072257996,
      -1.0188086032867432,
      0.003563179401680827,
      -1.3831243515014648,
      1.1814309358596802,
      -0.7468047738075256,
      0.7965260148048401,
      0.9190094470977783,
      0.8797041773796082,
      0.3118385076522827,
      -0.007460524793714285,
      -0.7922844886779785,
      -0.5700485110282898,
      0.18322642147541046,
      0.15563002228736877,
      0.5510402917861938,
      0.9703728556632996,
      -0.08577603101730347,
      -0.5577372312545776,
      1.0170118808746338,
      0.7927917838096619,
      0.34587177634239197,
      -0.04202913120388985,
      0.5065988898277283,
      0.0929768979549408,
      0.2784312665462494,
      -0.1488872468471527,
      0.21393899619579315,
      -0.1519494205713272,
      0.4146536588668823,
      -0.4752834737300873,
      -0.8974547982215881,
      0.7756868600845337,
      0.5290541052818298,
      -0.005899487063288689,
      0.046434346586465836,
      -0.3700582981109619,
      -0.2613467574119568,
      -1.7331724166870117,
      0.4835013449192047,
      0.6500364542007446,
      -0.44333139061927795,
      -0.027898335829377174,
      0.4079931080341339,
      -0.38155487179756165,
      0.9153546094894409,
      1.0702946186065674,
      0.37047213315963745,
      -0.13060180842876434,
      0.8839273452758789,
      -0.7797200679779053,
      0.4965943694114685,
      0.334190309047699,
      -0.2805176377296448,
      -0.7097508907318115,
      -0.5159119963645935,
      -0.10127678513526917,
      0.16572262346744537,
      -0.15108053386211395,
      -0.4891405403614044,
      -0.2017252892255783,
      -0.07193350046873093,
      -0.023590732365846634,
      -0.6126364469528198,
      0.956671953201294,
      -0.4491938054561615,
      -0.38674283027648926,
      0.16820698976516724,
      0.11336173862218857,
      0.3022921681404114,
      0.3895758092403412,
      -0.24636973440647125,
      0.28389686346054077,
      0.22042006254196167,
      0.2179163694381714,
      0.0014667168725281954,
      -0.15061382949352264,
      0.049697551876306534,
      -0.21380339562892914,
      -0.05710529536008835,
      -0.10725956410169601,
      -0.4939310848712921,
      0.3455727994441986,
      -0.4615451395511627,
      -0.12386328727006912,
      0.22067441046237946,
      -1.4372061491012573,
      -0.3800250291824341,
      0.39577123522758484,
      0.1915273517370224,
      -0.4483222961425781,
      -0.9637976288795471,
      0.5095648169517517,
      -0.11239904910326004,
      -0.7867475748062134,
      -0.5182496905326843,
      -0.2648153305053711,
      -0.05141017585992813,
      -0.08900376409292221,
      -0.941974937915802,
      -0.10890989750623703,
      -1.0098220109939575,
      1.1753383874893188,
      -0.41404080390930176,
      0.7446630001068115,
      -0.1826251596212387,
      -0.31813517212867737,
      -1.012465238571167,
      -0.0788874626159668,
      -1.4632114171981812,
      0.38996392488479614,
      0.46026453375816345,
      0.14230050146579742,
      -0.9626656770706177,
      -1.2810877561569214,
      -0.7766074538230896,
      1.3101304769515991,
      0.5391786694526672,
      -0.3293527662754059,
      0.42904797196388245,
      -1.2910081148147583,
      -0.32439929246902466,
      0.6010016202926636,
      -0.5612675547599792,
      -0.23364201188087463,
      0.3819538652896881,
      0.5389698147773743,
      0.998833954334259,
      0.3809311091899872,
      0.02158910408616066,
      -1.1185028553009033,
      0.0803530290722847,
      0.3912524878978729,
      -0.25578412413597107,
      -0.07372655719518661,
      0.09383759647607803,
      -0.34007734060287476
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "IF",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Train",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category):\n\nSAM (Single API Method): The issue specifically occurs during the invocation of model.fit() from Keras.\nLevel 2:\n\nBET (Behavioral Expectation): The unexpected behavior of negative loss values in binary cross-entropy indicates a violation of expected API behavior.\nLevel 3 (Hybrid Patterns):\n\nIC-1 (Incorrect Computation): The negative loss values indicate incorrect calculations due to improperly formatted labels.\nLeaf Contract Category:\n\nIC-1 (Incorrect Computation): The underlying issue is a computational misinterpretation of input labels, leading to erroneous loss calculation.\nRoot Cause:\n\nUnacceptable Input Value: Labels provided were incorrectly encoded as (1, 2) instead of the required (0, 1), causing the model's loss calculation to malfunction.\nEffect:\n\nIF (Incorrect Functionality): Although training didn't crash, the output was functionally incorrect (negative loss), indicating a malfunction in model training.\nML Library:\n\nKeras: The issue is directly related to Keras methods (model.fit) during model training.\nContract Violation Location:\n\nTrain: The contract violation occurred during the training phase, specifically while fitting data into the neural network.\nDetection Technique:\n\nStatic: This problem can be identified by examining the labels and model architecture statically, without runtime execution.\n\n"
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/42284873",
    "title": "",
    "question": "9\n\nI'm using the ImageDataGenerator inside Keras to read a directory of images. I'd like to save the result inside a numpy array, so I can do further manipulations and save it to disk in one file.\n\nflow_from_directory() returns an iterator, which is why I tried the following\n\nitr = gen.flow_from_directory('data/train/', batch_size=1, target_size=(32,32))\nimgs = np.concatenate([itr.next() for i in range(itr.nb_sample)])\nbut that produced\n\nValueError: could not broadcast input array from shape (32,32,3) into shape (1)\nI think I'm misusing the concatenate() function, but I can't figure out where I fail.",
    "answer": "19\n\nI had the same problem and solved it the following way: itr.next returns the next batch of images as two numpy.ndarray objects: batch_x, batch_y. (Source: keras/preprocessing/image.py) So what you can do is set the batch_size for flow_from_directory to the size of your whole train dataset.\n\nExample, my whole training set consists of 1481 images:\n\ntrain_datagen = ImageDataGenerator(rescale=1. / 255)\nitr = train_datagen.flow_from_directory(\ntrain_data_dir,\ntarget_size=(img_width, img_height),\nbatch_size=1481,\nclass_mode='categorical')\n\nX, y = itr.next()",
    "mlApiName": "keras.preprocessing.image.ImageDataGenerator.flow_from_directory",
    "embedding": [
      -0.1781584918498993,
      0.38185447454452515,
      -2.42933988571167,
      -1.4578603506088257,
      0.19518549740314484,
      -1.088556170463562,
      0.033917076885700226,
      0.41792958974838257,
      -1.127585768699646,
      -1.6253637075424194,
      -0.07499438524246216,
      0.6822351813316345,
      2.295012950897217,
      0.490456759929657,
      -0.179209902882576,
      -0.5624635219573975,
      0.035845428705215454,
      -0.641506016254425,
      0.08031509816646576,
      1.0296233892440796,
      -0.31932562589645386,
      0.04394078254699707,
      0.3017443120479584,
      0.13753508031368256,
      1.1793655157089233,
      -0.3177107572555542,
      0.0638461634516716,
      -0.2217576801776886,
      -1.4392187595367432,
      0.39630699157714844,
      1.0712281465530396,
      0.48270756006240845,
      0.12152700871229172,
      -1.352629542350769,
      -0.9904528856277466,
      -0.20858462154865265,
      0.6184866428375244,
      -0.8704350590705872,
      0.5989373326301575,
      0.2415253072977066,
      0.8008922338485718,
      -0.20782692730426788,
      -0.3621041178703308,
      -0.30403685569763184,
      0.2936139702796936,
      -0.6473880410194397,
      1.233471393585205,
      0.6039202213287354,
      -0.12290831655263901,
      -0.31602296233177185,
      0.20778626203536987,
      0.5384726524353027,
      -1.2114113569259644,
      0.13671062886714935,
      0.8940365314483643,
      1.1019742488861084,
      -0.1787109524011612,
      0.05431537330150604,
      0.6974175572395325,
      -0.8029746413230896,
      0.3303464949131012,
      0.36986634135246277,
      -1.1688944101333618,
      0.7984591126441956,
      1.0262253284454346,
      -0.7306234836578369,
      -1.4227631092071533,
      0.7941125631332397,
      -0.23494112491607666,
      0.08200971782207489,
      0.6906992197036743,
      0.2518002986907959,
      0.4955267310142517,
      0.5491916537284851,
      -0.11809004843235016,
      0.18044352531433105,
      -0.4825122356414795,
      -0.661461591720581,
      -0.32350245118141174,
      0.4732925295829773,
      0.03199930489063263,
      -0.05757302790880203,
      0.8100487589836121,
      -0.29302385449409485,
      0.558556854724884,
      0.34693676233291626,
      -0.23697230219841003,
      -0.4895803928375244,
      -0.4072362184524536,
      1.084233045578003,
      -0.08765306323766708,
      -0.054359450936317444,
      0.2071942687034607,
      1.2536888122558594,
      -0.06320422142744064,
      -0.27139952778816223,
      0.46447035670280457,
      0.7276196479797363,
      -0.37168022990226746,
      -0.3151920437812805,
      0.057964056730270386,
      0.25824975967407227,
      -0.08208160102367401,
      -0.62889564037323,
      0.39522939920425415,
      1.0428495407104492,
      0.8239245414733887,
      -0.17370808124542236,
      0.24068529903888702,
      -0.30461329221725464,
      -0.6362348198890686,
      -0.7651814818382263,
      -0.5882337093353271,
      0.030349748209118843,
      0.01400236040353775,
      0.4148210883140564,
      -0.07293739914894104,
      -0.8960438370704651,
      0.14323408901691437,
      -0.053775686770677567,
      -0.10806965082883835,
      -0.672057569026947,
      0.37003523111343384,
      -0.2970767915248871,
      -0.1414910852909088,
      0.39237868785858154,
      -0.7161238193511963,
      -0.051982831209897995,
      0.35317015647888184,
      -0.7043151259422302,
      -0.476042777299881,
      -0.9418147802352905,
      0.10926975309848785,
      0.2890380024909973,
      0.4639832377433777,
      0.7025020718574524,
      -0.7261063456535339,
      -1.5349615812301636,
      0.5171773433685303,
      0.0963355228304863,
      0.18873699009418488,
      0.0715605765581131,
      -0.8082134127616882,
      -0.15034666657447815,
      0.8202319145202637,
      -0.3924395740032196,
      0.1556532233953476,
      -0.3186977505683899,
      -0.1000923365354538,
      0.06515984237194061,
      -0.01802646741271019,
      0.6976326107978821,
      -0.6829038858413696,
      0.007724575698375702,
      1.0668201446533203,
      -0.5229527950286865,
      0.6759065985679626,
      0.9418325424194336,
      1.007604718208313,
      -0.329067587852478,
      0.6550536751747131,
      0.3251001536846161,
      -0.6964988708496094,
      0.3277348577976227,
      -0.4925772547721863,
      -1.4388052225112915,
      0.35104790329933167,
      -0.042350854724645615,
      -0.05794357880949974,
      -0.4595702290534973,
      -1.2533159255981445,
      -0.9141340851783752,
      -0.3929497003555298,
      -0.5132297873497009,
      -0.07653290033340454,
      0.6323387026786804,
      1.2797839641571045,
      -0.8782351016998291,
      0.7022702693939209,
      -0.5551198124885559,
      0.5287485122680664,
      -0.5629377961158752,
      0.45925137400627136,
      0.062335386872291565,
      0.4406718909740448,
      -0.04906841740012169,
      0.06436130404472351,
      0.6671141982078552,
      0.006952392403036356,
      -0.10050583630800247,
      0.5517512559890747,
      0.12056925147771835,
      -0.5490498542785645,
      -0.25690290331840515,
      -0.5963100790977478,
      -0.17285864055156708,
      0.3513605296611786,
      -0.9277783632278442,
      0.5119553804397583,
      0.22830459475517273,
      0.3279210329055786,
      0.14257043600082397,
      -0.448013037443161,
      0.8946167826652527,
      -0.04039826989173889,
      1.489511251449585,
      -0.7540160417556763,
      1.0359694957733154,
      -0.4974791705608368,
      0.8070782423019409,
      0.6653845906257629,
      -0.5785670280456543,
      0.08919787406921387,
      0.05048910528421402,
      -0.28211915493011475,
      -0.6101529598236084,
      1.1433378458023071,
      -0.8495421409606934,
      -0.6757208704948425,
      0.7691096067428589,
      0.09890156239271164,
      0.1951819509267807,
      1.1450861692428589,
      -0.3638897240161896,
      -0.02381840907037258,
      -0.18834808468818665,
      0.5347610116004944,
      -0.6063920259475708,
      -0.6640594601631165,
      -0.3752725124359131,
      -1.2334401607513428,
      -0.6481994390487671,
      0.423104465007782,
      0.5689525008201599,
      0.08118989318609238,
      0.7279791235923767,
      0.07242273539304733,
      1.1868940591812134,
      -1.0221911668777466,
      0.03703598305583,
      0.253989577293396,
      0.3552299737930298,
      0.4436527490615845,
      -0.3346322476863861,
      -0.9306661486625671,
      0.03221706673502922,
      -0.09461709856987,
      -0.8227005004882812,
      0.2639209032058716,
      0.6054314970970154,
      0.26176396012306213,
      0.07689002901315689,
      0.8381441831588745,
      0.14093001186847687,
      0.6145880222320557,
      -0.6118916869163513,
      -0.798914909362793,
      0.0712331235408783,
      0.2663588225841522,
      -0.13128365576267242,
      0.19551892578601837,
      0.30390608310699463,
      0.4196508228778839,
      -0.2393844872713089,
      -0.4563533365726471,
      -0.9692527055740356,
      0.6705406904220581,
      0.83253014087677,
      0.5600346326828003,
      -0.3751213550567627,
      0.12536224722862244,
      0.21749186515808105,
      0.5543591976165771,
      -0.8712321519851685,
      0.35196784138679504,
      0.6295857429504395,
      0.11750020831823349,
      0.05328014865517616,
      -0.40544790029525757,
      0.17821066081523895,
      -0.4124714732170105,
      -0.35852086544036865,
      -0.6514253616333008,
      0.6283832788467407,
      -0.14465677738189697,
      0.1367001235485077,
      -0.0347757525742054,
      0.8308172821998596,
      0.9933921098709106,
      0.5702595114707947,
      0.1283760517835617,
      0.20515887439250946,
      -0.2104470431804657,
      0.5762050747871399,
      0.08780857175588608,
      0.07945394515991211,
      1.0899358987808228,
      0.44261324405670166,
      0.1637645661830902,
      -0.7308845520019531,
      0.15312811732292175,
      0.510644793510437,
      1.5084012746810913,
      0.5911896228790283,
      -0.03938731551170349,
      0.33699560165405273,
      -0.11172181367874146,
      -0.3977135717868805,
      0.04670477658510208,
      -0.4852098822593689,
      -0.3981674909591675,
      -0.22674626111984253,
      -0.47951993346214294,
      1.0437935590744019,
      -0.03749043494462967,
      -0.8101028800010681,
      0.06543391942977905,
      0.25740402936935425,
      0.9447179436683655,
      -0.41897547245025635,
      -0.16939984261989594,
      -0.10946684330701828,
      -0.20090022683143616,
      -0.1679665744304657,
      -0.7384641170501709,
      0.39775145053863525,
      -0.2723815441131592,
      0.5274924635887146,
      1.35690438747406,
      -0.2774346172809601,
      -0.1068037673830986,
      0.9930136799812317,
      -0.046039219945669174,
      -0.5596076846122742,
      -0.4866378605365753,
      -0.1351650059223175,
      0.4300653338432312,
      0.2895330488681793,
      0.4000922739505768,
      0.93765789270401,
      0.5733919143676758,
      0.36141476035118103,
      0.5538187623023987,
      -1.0506701469421387,
      0.6103540062904358,
      0.8339405655860901,
      -0.5551493763923645,
      -0.0639907717704773,
      0.024554871022701263,
      0.18158888816833496,
      0.604618489742279,
      -0.6112245917320251,
      -0.03597592934966087,
      -1.1815712451934814,
      0.5343247056007385,
      0.7340525984764099,
      0.01841239631175995,
      -0.3473342955112457,
      0.6009259223937988,
      0.10596407949924469,
      0.45935800671577454,
      -0.1729462444782257,
      -0.03141820803284645,
      -0.3142031133174896,
      -0.020938806235790253,
      -0.1262299120426178,
      0.8423337340354919,
      -0.32321178913116455,
      0.8874865174293518,
      -0.48595771193504333,
      -0.33365169167518616,
      -1.4902559518814087,
      0.00006708005821565166,
      0.5988552570343018,
      -0.6078147292137146,
      0.1600579470396042,
      -0.523356020450592,
      0.4591235816478729,
      -0.5177602171897888,
      0.05855482071638107,
      0.5858519077301025,
      -0.3150484561920166,
      0.1538824737071991,
      -0.3629106879234314,
      -0.3662394881248474,
      0.42919284105300903,
      0.7405794262886047,
      -0.5893003940582275,
      -0.651536226272583,
      0.621643602848053,
      -0.22756794095039368,
      -1.0826640129089355,
      -1.1216599941253662,
      -1.0048696994781494,
      0.27721258997917175,
      0.33310210704803467,
      0.10546302050352097,
      0.5086502432823181,
      -0.9294292330741882,
      0.4847452640533447,
      -0.9351024031639099,
      -0.20063109695911407,
      0.11539150774478912,
      -0.31290045380592346,
      -0.7701905369758606,
      -0.4629869759082794,
      0.2544551193714142,
      -0.005490167997777462,
      0.48686450719833374,
      0.1957288533449173,
      0.24662023782730103,
      -0.28800320625305176,
      -0.5284251570701599,
      -1.550600528717041,
      0.8216851353645325,
      -0.37078750133514404,
      1.0886189937591553,
      0.6197293400764465,
      -0.7357710599899292,
      -0.039510536938905716,
      -0.1963498443365097,
      0.42522120475769043,
      -0.10308591276407242,
      0.13692307472229004,
      0.4099818170070648,
      1.023085594177246,
      0.11474356055259705,
      1.0721757411956787,
      0.3373337388038635,
      -0.9556198120117188,
      -0.1287834495306015,
      0.7331194877624512,
      0.7754060626029968,
      0.003739832667633891,
      -0.4494713246822357,
      0.3184165954589844,
      0.3394155204296112,
      1.53328275680542,
      -0.34308579564094543,
      0.3061539828777313,
      0.7692645788192749,
      -0.48186197876930237,
      -0.15518710017204285,
      0.3736562430858612,
      0.9519322514533997,
      0.8060159087181091,
      0.980695366859436,
      -0.32380038499832153,
      -1.5993528366088867,
      1.5677576065063477,
      -0.4322282373905182,
      0.11528363078832626,
      0.1949315220117569,
      0.16445675492286682,
      1.2213282585144043,
      0.14948974549770355,
      -0.5840550065040588,
      -0.8058743476867676,
      0.47310033440589905,
      0.08677186816930771,
      -0.24419449269771576,
      0.788339376449585,
      -1.018875002861023,
      0.35986968874931335,
      -0.07705384492874146,
      -0.5858548879623413,
      0.08138145506381989,
      -0.8290181756019592,
      0.2723380923271179,
      0.8391539454460144,
      -0.40644243359565735,
      -0.29915302991867065,
      0.7548834681510925,
      -0.0359184592962265,
      -0.09909633547067642,
      1.0040643215179443,
      -0.05189337208867073,
      -0.6199755668640137,
      1.0133801698684692,
      0.7355027198791504,
      -0.1307220757007599,
      -1.6448229551315308,
      -0.45467740297317505,
      -0.5784857273101807,
      0.079469233751297,
      1.433443307876587,
      -0.3150704801082611,
      0.0965462401509285,
      0.8823891878128052,
      -0.1388424038887024,
      0.6599017381668091,
      0.02356146089732647,
      0.1547902524471283,
      0.6409410238265991,
      -0.17444896697998047,
      -1.0373493432998657,
      -0.14672648906707764,
      0.20465539395809174,
      0.02449924498796463,
      -0.0783444419503212,
      -0.03505824878811836,
      -0.1593760997056961,
      -1.3801836967468262,
      0.3214430510997772,
      0.6164228320121765,
      -0.028054354712367058,
      0.056586846709251404,
      0.009136993438005447,
      -0.9139838814735413,
      0.17361359298229218,
      0.8645979166030884,
      0.11837209761142731,
      0.11775936931371689,
      0.38906288146972656,
      0.25721725821495056,
      -1.132430076599121,
      0.24337996542453766,
      -0.3975699543952942,
      -0.6327213644981384,
      0.45050081610679626,
      0.8162266612052917,
      -0.5240560173988342,
      -0.20040996372699738,
      -0.3157922923564911,
      -0.46634039282798767,
      0.2752661108970642,
      0.13647079467773438,
      -0.5303993225097656,
      0.3930812180042267,
      -0.22458390891551971,
      0.500120222568512,
      -0.5874319076538086,
      -1.1260737180709839,
      0.013386989012360573,
      -0.01842738874256611,
      -0.19049173593521118,
      -0.8676883578300476,
      1.0424138307571411,
      0.45444557070732117,
      0.113779716193676,
      0.5451449155807495,
      1.105563998222351,
      -0.42292049527168274,
      -0.06979922205209732,
      -0.5418893694877625,
      -0.2294921725988388,
      0.35362738370895386,
      0.1960565149784088,
      0.07718454301357269,
      -0.45255836844444275,
      0.4580536186695099,
      -0.23760193586349487,
      0.09632860869169235,
      -1.3912726640701294,
      -0.09857288748025894,
      -0.27204349637031555,
      -0.5294505953788757,
      -0.9432678818702698,
      -0.6643927097320557,
      -0.27881914377212524,
      -0.7729962468147278,
      0.35072118043899536,
      1.491759181022644,
      0.1507474184036255,
      0.396522581577301,
      0.5243334770202637,
      -0.1680682897567749,
      0.6706108450889587,
      0.0215750765055418,
      0.3500794768333435,
      -0.3495461344718933,
      -1.9148718118667603,
      0.7836428880691528,
      0.15815739333629608,
      0.3274560570716858,
      -0.04822149872779846,
      1.024949550628662,
      1.0205132961273193,
      -0.5918323397636414,
      -0.20136508345603943,
      0.24010895192623138,
      -1.1000111103057861,
      0.4860541820526123,
      -0.3208767771720886,
      -0.5287947058677673,
      0.6759103536605835,
      -0.1459154337644577,
      -0.4468313753604889,
      0.047315120697021484,
      -0.16925014555454254,
      -0.9457592368125916,
      -0.8623368144035339,
      0.43771037459373474,
      0.14696785807609558,
      0.4565536677837372,
      -0.24146324396133423,
      0.31053221225738525,
      0.8093351125717163,
      -0.6679989695549011,
      -0.923747181892395,
      -0.3183439075946808,
      0.8977059721946716,
      1.467036247253418,
      -0.5257596373558044,
      -1.7028110027313232,
      1.0024807453155518,
      -0.42443713545799255,
      0.273648738861084,
      -0.668938159942627,
      -0.030277453362941742,
      0.45849668979644775,
      -0.49998465180397034,
      0.09467768669128418,
      -0.08617141842842102,
      -0.037171464413404465,
      -0.3472151458263397,
      0.9243174195289612,
      0.2534785568714142,
      0.7421581745147705,
      -0.512593686580658,
      -0.6910507678985596,
      -0.9838110208511353,
      1.1605170965194702,
      -0.7677960395812988,
      0.4867520034313202,
      -0.3005911409854889,
      -0.5493820309638977,
      -0.3311292231082916,
      0.673738956451416,
      1.3867131471633911,
      -0.5616937279701233,
      -0.3077145516872406,
      -1.6721988916397095,
      0.10950081795454025,
      -0.9299967885017395,
      0.742311418056488,
      0.16382978856563568,
      1.054815649986267,
      0.3566606044769287,
      1.5425065755844116,
      -0.2920134663581848,
      -0.5630647540092468,
      -0.5319936275482178,
      0.5907801389694214,
      -0.32441291213035583,
      -0.6394414901733398,
      0.9162724614143372,
      1.515709638595581,
      -0.1066461130976677,
      -0.7417283654212952,
      0.9603187441825867,
      1.2053072452545166,
      0.0676640197634697,
      -0.08633380383253098,
      0.31373053789138794,
      0.2709609270095825,
      -0.13975481688976288,
      -1.3564856052398682,
      -1.0022944211959839,
      -1.0751333236694336,
      0.6764852404594421,
      -0.7792657017707825,
      -0.6606765985488892,
      0.3792174458503723,
      0.4899732768535614,
      0.11358261108398438,
      -0.7225879430770874,
      0.10201764851808548,
      -0.485199898481369,
      -1.3738510608673096,
      0.45858508348464966,
      0.4376550316810608,
      -0.31542396545410156,
      0.12751172482967377,
      0.48724016547203064,
      -0.2335006147623062,
      1.1828054189682007,
      0.6455259323120117,
      0.2090407758951187,
      0.3874986171722412,
      0.5021750330924988,
      -0.3952183425426483,
      0.3811519145965576,
      0.05734575539827347,
      0.35822388529777527,
      -0.3257673680782318,
      -0.543684184551239,
      -1.2553414106369019,
      -0.15744630992412567,
      -1.6572774648666382,
      -0.3395291864871979,
      -0.1902366727590561,
      0.3747202754020691,
      0.05103140324354172,
      -0.39882543683052063,
      0.2853301465511322,
      0.5221741795539856,
      -1.0304980278015137,
      0.5134105086326599,
      1.0893243551254272,
      0.6476550698280334,
      0.0038621686398983,
      0.6723051071166992,
      0.4200061857700348,
      -0.11478083580732346,
      0.059070512652397156,
      0.755032479763031,
      -0.046041227877140045,
      -0.0232404712587595,
      -0.643183708190918,
      -0.16151832044124603,
      -0.1989213228225708,
      -0.8957109451293945,
      1.16740083694458,
      -0.1778249740600586,
      0.5944377779960632,
      -0.07694429904222488,
      -1.085465908050537,
      -0.33924970030784607,
      0.2137736678123474,
      -0.30782586336135864,
      -0.024431951344013214,
      -0.715034008026123,
      -0.07971107959747314,
      -0.9600335359573364,
      -1.1038818359375,
      -0.14359259605407715,
      -0.4562763273715973,
      -0.5354281067848206,
      -0.7904930710792542,
      -1.0478261709213257,
      -0.5714994668960571,
      -1.0688154697418213,
      1.1956603527069092,
      0.1152024120092392,
      -0.13810314238071442,
      -1.3940131664276123,
      -0.8743161559104919,
      -0.37219682335853577,
      -0.3573634922504425,
      -0.4184058606624603,
      1.470609426498413,
      0.009638823568820953,
      -0.33254382014274597,
      -0.42404693365097046,
      -0.38131198287010193,
      -0.869415819644928,
      1.210158348083496,
      0.2996149957180023,
      -0.044181566685438156,
      -0.15401366353034973,
      -0.3028860092163086,
      0.03179291635751724,
      0.4384542405605316,
      0.3823821544647217,
      -0.21665994822978973,
      -0.05043754726648331,
      1.7057955265045166,
      1.3266671895980835,
      -0.04834863170981407,
      0.1577596515417099,
      -0.1913045346736908,
      -0.052664026618003845,
      0.002130025764927268,
      0.060623351484537125,
      -0.463724821805954,
      -0.9142842888832092,
      -0.8766365051269531
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Load",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category):\n\nSAM (Single API Method): The issue specifically arises during the use of the single Keras method flow_from_directory().\nLevel 2:\n\nBET (Behavioral Expectation): The user expects the iterator output to directly concatenate into a numpy array, but the API behavior is not aligned with this expectation.\nLevel 3 (Hybrid Patterns):\n\nIC-1 (Incorrect Computation): The misuse of numpy's concatenate function leads to incorrect dimensional computations, resulting in a shape mismatch.\nLeaf Contract Category:\n\nIC-1 (Incorrect Computation): The specific issue lies in incorrectly computing the shapes for numpy array concatenation due to misunderstanding the iterator output.\nRoot Cause:\n\nUnacceptable Input Value: The shape mismatch (attempting to broadcast arrays of shape (32,32,3) into (1,)) is the result of using incorrect array shapes for the concatenation.\nEffect:\n\nCrash: The incorrect array concatenation attempt directly results in a runtime crash (ValueError).\nML Library:\n\nKeras: Specifically related to Keras's ImageDataGenerator.flow_from_directory() method.\nContract Violation Location:\n\nLoad: The error occurs while loading data from a directory, specifically during data preprocessing/loading phase.\nDetection Technique:\n\nStatic: The incorrect usage can be identified statically by inspecting the shape expectations of numpy array operations without needing runtime execution."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/42886049",
    "title": "",
    "question": "10\n\nI am trying to train 1000x of Sequential models in a loop. In every loop my program leaks memory until I run out and get an OOM exception.\n\nI already asked a similar question before (Training multiple Sequential models in a row slows down)\n\nand have seen others in similar problems (Keras: Out of memory when doing hyper parameter grid search)\n\nand the solution is always to add K.clear_session() to your code after you have finished using the model. So I did that in my previous question and I am still leaking memory\n\nHere is code to reproduce the issue.\n\nimport random\nimport time\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras import backend as K\nimport tracemalloc\n\ndef run():\n    tracemalloc.start()\n    num_input_nodes = 12\n    num_hidden_nodes = 8\n    num_output_nodes = 1\n\n    random_numbers = random.sample(range(1000), 50)\n    train_x, train_y = create_training_dataset(random_numbers, num_input_nodes)\n\n    for i in range(100):\n        snapshot = tracemalloc.take_snapshot()\n        for j in range(10):\n            start_time = time.time()\n            nn = Sequential()\n            nn.add(Dense(num_hidden_nodes, input_dim=num_input_nodes, activation='relu'))\n            nn.add(Dense(num_output_nodes))\n            nn.compile(loss='mean_squared_error', optimizer='adam')\n            nn.fit(train_x, train_y, nb_epoch=300, batch_size=2, verbose=0)\n            K.clear_session()\n            print(\"Iteration {iter}. Current time {t}. Took {elapsed} seconds\".\n                  format(iter=i*10 + j + 1, t=time.strftime('%H:%M:%S'), elapsed=int(time.time() - start_time)))\n\n        top_stats = tracemalloc.take_snapshot().compare_to(snapshot, 'lineno')\n\n        print(\"[ Top 5 differences ]\")\n        for stat in top_stats[:5]:\n            print(stat)\n\ndef create_training_dataset(dataset, input_nodes):\n    \"\"\"\n    Outputs a training dataset (train_x, train_y) as numpy arrays.\n    Each item in train_x has 'input_nodes' number of items while train_y items are of size 1\n    :param dataset: list of ints\n    :param input_nodes:\n    :return: (numpy array, numpy array), train_x, train_y\n    \"\"\"\n    data_x, data_y = [], []\n    for i in range(len(dataset) - input_nodes - 1):\n        a = dataset[i:(i + input_nodes)]\n        data_x.append(a)\n        data_y.append(dataset[i + input_nodes])\n    return numpy.array(data_x), numpy.array(data_y)\n\nrun()\nHere is the output I get from the first memory debug print\n\n/tensorflow/python/framework/ops.py:121: size=3485 KiB (+3485 KiB), count=42343 (+42343) /tensorflow/python/framework/ops.py:1400: size=998 KiB (+998 KiB), count=8413 (+8413) /tensorflow/python/framework/ops.py:116: size=888 KiB (+888 KiB), count=32468 (+32468) /tensorflow/python/framework/ops.py:1185: size=795 KiB (+795 KiB), count=3179 (+3179) /tensorflow/python/framework/ops.py:2354: size=599 KiB (+599 KiB), count=5886 (+5886)\n\nSystem info:\n\npython 3.5\nkeras (1.2.2)\ntensorflow(1.0.0)",
    "answer": "13\n\nThe memory leak stems from Keras and TensorFlow using a single \"default graph\" to store the network structure, which increases in size with each iteration of the inner for loop.\n\nCalling K.clear_session() frees some of the (backend) state associated with the default graph between iterations, but an additional call to tf.reset_default_graph() is needed to clear the Python state.\n\nNote that there might be a more efficient solution: since nn does not depend on either of the loop variables, you can define it outside the loop, and reuse the same instance inside the loop. If you do that, there is no need to clear the session or reset the default graph, and performance should increase because you benefit from caching between iterations.",
    "mlApiName": " keras.backend.clear_session,keras.models.fit",
    "embedding": [
      1.2628135681152344,
      1.2454311847686768,
      -2.9914543628692627,
      -0.9759730696678162,
      0.7718569040298462,
      -0.9638733267784119,
      0.048106491565704346,
      0.4873602092266083,
      -0.04691790044307709,
      -0.2590584456920624,
      -0.20154736936092377,
      0.5913820862770081,
      1.0615906715393066,
      0.6120089888572693,
      -0.23516595363616943,
      -0.3123764097690582,
      0.5779570937156677,
      -0.2581234574317932,
      -0.5404260158538818,
      -0.024732140824198723,
      0.08730603009462357,
      -0.15395650267601013,
      0.1542874276638031,
      -0.19854842126369476,
      1.2684003114700317,
      0.885494589805603,
      -0.5467878580093384,
      0.023619361221790314,
      0.12401067465543747,
      0.7537076473236084,
      1.387207269668579,
      -0.6828723549842834,
      -0.8008695840835571,
      -1.476147174835205,
      -1.5375232696533203,
      -0.46662524342536926,
      0.5018733739852905,
      -0.678853452205658,
      0.296888142824173,
      -0.03221143037080765,
      0.6408773064613342,
      -0.19562295079231262,
      0.3566093444824219,
      0.27195626497268677,
      -0.03115607239305973,
      0.06978042423725128,
      1.2863361835479736,
      0.31139877438545227,
      0.5689305067062378,
      -1.0778586864471436,
      0.523938775062561,
      0.4320194125175476,
      -0.6909984946250916,
      0.00582157215103507,
      0.983709454536438,
      0.9399425983428955,
      -0.11923673748970032,
      0.1494743674993515,
      1.3319059610366821,
      -0.5698235630989075,
      1.0351179838180542,
      0.5324180126190186,
      -1.4061565399169922,
      1.1654099225997925,
      -0.12838980555534363,
      -0.13593505322933197,
      -0.7089625000953674,
      0.9676316380500793,
      0.22418883442878723,
      -0.12284364551305771,
      0.9013861417770386,
      0.39042648673057556,
      -0.09314383566379547,
      -0.15877176821231842,
      -0.6134384870529175,
      0.9275707602500916,
      -0.6373767256736755,
      0.3855564594268799,
      -0.038508091121912,
      0.8220914602279663,
      -0.43817365169525146,
      1.310684323310852,
      0.48459240794181824,
      -0.1652769148349762,
      0.4092612564563751,
      0.47664058208465576,
      -1.2938029766082764,
      -0.5646013021469116,
      -0.7980771064758301,
      1.4654148817062378,
      -0.3065119683742523,
      -0.3761344850063324,
      0.8758792877197266,
      0.7701034545898438,
      -0.6618691086769104,
      -0.3321678042411804,
      0.3485657572746277,
      0.5512782335281372,
      -1.0824841260910034,
      0.10360436886548996,
      0.17066538333892822,
      -0.3110508918762207,
      -0.4066780209541321,
      -1.2404078245162964,
      0.5065722465515137,
      1.1680155992507935,
      -0.3308064341545105,
      0.26209962368011475,
      0.1283363699913025,
      -0.046061351895332336,
      -0.25065311789512634,
      0.12273445725440979,
      -0.6398736238479614,
      -0.3071305453777313,
      -0.5494869947433472,
      0.4065400958061218,
      0.6029463410377502,
      -0.4148212671279907,
      0.12779970467090607,
      -0.2553621828556061,
      -0.6253953576087952,
      -1.0092533826828003,
      0.4528631269931793,
      -0.03502252325415611,
      0.5427467226982117,
      0.4263232350349426,
      -0.839043915271759,
      0.43299680948257446,
      -0.09193278104066849,
      -0.3987785279750824,
      -0.5926744341850281,
      -0.1278146207332611,
      -0.7445951104164124,
      0.8628163933753967,
      0.6146427392959595,
      0.8907454013824463,
      -0.9366527199745178,
      -0.435246080160141,
      -0.27068454027175903,
      0.24363994598388672,
      0.6999111175537109,
      -0.26043811440467834,
      0.12521962821483612,
      -0.11474376171827316,
      0.5530579090118408,
      -0.5959427952766418,
      0.21370425820350647,
      -0.6057386994361877,
      -0.8455156683921814,
      -0.00378516991622746,
      0.08348438888788223,
      0.37815794348716736,
      -1.4964276552200317,
      0.05520651489496231,
      0.8183642625808716,
      -0.5128703117370605,
      0.27706342935562134,
      0.1121300756931305,
      1.1030614376068115,
      0.2342541366815567,
      0.8887697458267212,
      0.5060861110687256,
      -0.47473666071891785,
      0.9182776212692261,
      -0.8984139561653137,
      -0.8470269441604614,
      0.27440145611763,
      0.5970213413238525,
      -0.43169933557510376,
      0.37444448471069336,
      -0.7229768633842468,
      -0.9702352285385132,
      -0.04660845547914505,
      -0.3289337456226349,
      -0.11074745655059814,
      1.2459596395492554,
      1.4239816665649414,
      -0.4646311104297638,
      0.4896264970302582,
      -0.015390372835099697,
      1.1137001514434814,
      -0.5044330358505249,
      0.7454397678375244,
      0.38793817162513733,
      -0.5511857271194458,
      0.2794596552848816,
      -0.044063106179237366,
      -0.13716359436511993,
      -0.24443288147449493,
      -1.2179349660873413,
      0.7373775839805603,
      -0.28627878427505493,
      -0.6652553081512451,
      -0.1324755996465683,
      -0.3487454354763031,
      -0.47247302532196045,
      0.7008373737335205,
      -0.6369276642799377,
      0.9437634348869324,
      -0.01606651209294796,
      -0.1881430745124817,
      0.004541289061307907,
      -1.3378392457962036,
      0.4452854096889496,
      -0.19826766848564148,
      0.5551012754440308,
      -0.18677078187465668,
      0.9176221489906311,
      -0.1751820594072342,
      -0.14192892611026764,
      0.6329829096794128,
      0.2689933776855469,
      0.3846810460090637,
      0.8618649840354919,
      -0.13082359731197357,
      -0.8719606399536133,
      0.7645198702812195,
      -0.34011778235435486,
      0.09856082499027252,
      0.3824947476387024,
      0.757892370223999,
      -0.4869861304759979,
      0.6814878582954407,
      -0.42183107137680054,
      0.17604292929172516,
      -0.46419408917427063,
      0.3402060270309448,
      -0.3629136383533478,
      -0.45824500918388367,
      0.12369892001152039,
      -0.596399188041687,
      -0.8115049004554749,
      0.2639766037464142,
      -0.006293255835771561,
      -0.007041607983410358,
      0.10691829025745392,
      0.5317160487174988,
      0.8227254152297974,
      -0.6856607794761658,
      0.26367273926734924,
      0.5421106219291687,
      0.5359171032905579,
      -0.08844033628702164,
      -0.33530470728874207,
      -0.4876045882701874,
      0.322393000125885,
      -0.24630610644817352,
      -1.0438002347946167,
      0.26232725381851196,
      0.31363168358802795,
      -0.1473921537399292,
      0.09286081790924072,
      0.6471195816993713,
      0.3271879255771637,
      0.784512996673584,
      -0.218794584274292,
      -0.28131309151649475,
      -0.18066735565662384,
      0.21051740646362305,
      -0.8450977206230164,
      0.6726689338684082,
      0.3848407566547394,
      -0.4985903203487396,
      -0.08590785413980484,
      -0.2899802029132843,
      -0.7349728345870972,
      0.09104626625776291,
      -0.5891335606575012,
      -0.22958506643772125,
      -0.04368443042039871,
      0.4928816854953766,
      0.2611388564109802,
      0.6665305495262146,
      0.7765873074531555,
      0.5524284839630127,
      0.5544257164001465,
      0.1893903762102127,
      -0.2247464805841446,
      0.19050805270671844,
      -0.2380969077348709,
      -0.7526947259902954,
      -0.9072681069374084,
      -0.5113701224327087,
      0.578133225440979,
      -0.32106927037239075,
      -0.21301975846290588,
      0.30223047733306885,
      -0.03718462586402893,
      0.6225878596305847,
      0.5961058735847473,
      0.03856322169303894,
      0.5433772206306458,
      0.6852461099624634,
      0.35526859760284424,
      0.1573755443096161,
      0.9059533476829529,
      0.6054803729057312,
      -0.25494030117988586,
      0.09129989892244339,
      -0.8639519214630127,
      0.6431202292442322,
      0.9012070298194885,
      0.36912456154823303,
      0.5898095369338989,
      -0.43624961376190186,
      0.003143494948744774,
      -0.07192085683345795,
      0.28165483474731445,
      -0.2813253104686737,
      -0.28240951895713806,
      -0.17288391292095184,
      -0.365475594997406,
      -0.47600099444389343,
      0.927979588508606,
      -0.3562154471874237,
      0.4091924726963043,
      0.2382151186466217,
      -0.013344907201826572,
      0.5510500073432922,
      -0.29794928431510925,
      -0.12844368815422058,
      -0.35467565059661865,
      -0.1287468671798706,
      -0.30734023451805115,
      -0.47303852438926697,
      0.11713062971830368,
      -0.09125091135501862,
      0.537162721157074,
      -0.09191534668207169,
      0.3192811608314514,
      0.40937161445617676,
      0.3880762457847595,
      0.6258163452148438,
      -0.9327804446220398,
      -0.8155553936958313,
      -0.22802866995334625,
      -0.08139647543430328,
      0.3155262768268585,
      -0.07290928810834885,
      0.4710708558559418,
      -0.2863554358482361,
      0.408925861120224,
      0.2047692835330963,
      -0.6035475730895996,
      0.060658376663923264,
      0.5953311920166016,
      -0.4443017244338989,
      -0.7890232801437378,
      1.2013758420944214,
      -0.0705852136015892,
      0.08358612656593323,
      -0.019252052530646324,
      -0.24427029490470886,
      -0.8014219403266907,
      -0.3939376175403595,
      -0.47568002343177795,
      0.06828977167606354,
      0.021956119686365128,
      -0.04419950395822525,
      0.060217853635549545,
      1.0440648794174194,
      -0.3594406843185425,
      -0.24534402787685394,
      -0.33457303047180176,
      0.0694943442940712,
      0.22237510979175568,
      1.6043832302093506,
      0.18560273945331573,
      0.7385839223861694,
      -0.6678261160850525,
      0.11665510386228561,
      -0.027269892394542694,
      -0.40294501185417175,
      0.4243791401386261,
      -0.5496605038642883,
      -0.12240362167358398,
      -1.019415020942688,
      0.23702339828014374,
      -0.15562447905540466,
      0.6120970845222473,
      0.39058226346969604,
      -0.9147665500640869,
      -0.3086961507797241,
      0.2001805454492569,
      0.11643968522548676,
      0.3409369885921478,
      0.8485323786735535,
      -1.217940092086792,
      -0.7315005660057068,
      0.8225784301757812,
      -0.04419434443116188,
      -0.2886570990085602,
      -0.8595873117446899,
      -0.7078117728233337,
      0.5103749632835388,
      -0.8898476958274841,
      0.23276512324810028,
      0.17834819853305817,
      0.25848451256752014,
      0.3269292712211609,
      -1.0427500009536743,
      -0.8193599581718445,
      0.013586083427071571,
      0.0740920752286911,
      -0.048603568226099014,
      -0.09670165926218033,
      -0.06285642087459564,
      0.1725061684846878,
      0.25454217195510864,
      0.3964816927909851,
      0.5244569182395935,
      1.1894798278808594,
      -0.12045001983642578,
      -1.4440312385559082,
      0.9245837330818176,
      -0.22244645655155182,
      1.542512059211731,
      1.5320460796356201,
      -0.5328328609466553,
      -1.3437186479568481,
      -0.2487398236989975,
      0.5855569243431091,
      -0.19339941442012787,
      0.04827271029353142,
      0.7414435148239136,
      0.5070494413375854,
      -0.07749783992767334,
      0.7744683027267456,
      0.37436237931251526,
      -1.6980116367340088,
      0.04829961061477661,
      0.44146406650543213,
      0.23457948863506317,
      0.20627404749393463,
      -0.38506513833999634,
      -0.10124202072620392,
      0.2292061746120453,
      0.8733223080635071,
      -0.6899920105934143,
      0.9926716685295105,
      0.7723237872123718,
      -0.11087898164987564,
      -0.8024214506149292,
      0.018538329750299454,
      0.2753024995326996,
      0.29783114790916443,
      1.1433125734329224,
      -1.0880000591278076,
      -1.6962631940841675,
      0.8895270228385925,
      -0.11777796596288681,
      -0.18534024059772491,
      0.6937665343284607,
      0.34349524974823,
      1.1956254243850708,
      -0.3084661364555359,
      -0.6799699664115906,
      0.14097942411899567,
      -0.1652711182832718,
      0.46384578943252563,
      -0.1412680596113205,
      0.8192312121391296,
      -0.36682429909706116,
      0.6398731470108032,
      -0.07658958435058594,
      -0.9765000343322754,
      -0.2532685399055481,
      -1.0938918590545654,
      0.7072787880897522,
      1.3401670455932617,
      -0.5396203994750977,
      -0.20371225476264954,
      0.3256107568740845,
      -0.3137062191963196,
      0.040804680436849594,
      -0.6107067465782166,
      -0.29978281259536743,
      0.5452993512153625,
      0.29757845401763916,
      1.1882365942001343,
      0.3489433825016022,
      -0.5449526906013489,
      -0.44279301166534424,
      -0.1912798434495926,
      -0.5174015164375305,
      1.418962836265564,
      0.440717875957489,
      -0.38812097907066345,
      0.5514736771583557,
      0.16386859118938446,
      0.8752934336662292,
      0.08343780040740967,
      0.015612118877470493,
      0.3486127555370331,
      -0.0024028983898460865,
      -0.5006241798400879,
      0.1898466795682907,
      0.3777354061603546,
      0.425569087266922,
      0.1141987219452858,
      -0.027761105448007584,
      0.13243140280246735,
      0.16100230813026428,
      0.06693395972251892,
      0.6775493025779724,
      0.6071898937225342,
      0.33994990587234497,
      -0.39477214217185974,
      -0.5818562507629395,
      -0.11539850383996964,
      -0.22052010893821716,
      0.23693343997001648,
      -0.15080618858337402,
      0.45935410261154175,
      0.40953755378723145,
      -1.1636838912963867,
      0.4330892860889435,
      -0.0017518936656415462,
      -0.5915961861610413,
      0.02713749185204506,
      0.6858048439025879,
      -0.016916530206799507,
      -0.4247678518295288,
      0.09870433062314987,
      -1.0687546730041504,
      0.2064385563135147,
      0.22375352680683136,
      -1.2960845232009888,
      0.05500271916389465,
      -0.40063026547431946,
      0.44570648670196533,
      -0.4685315191745758,
      -1.4376908540725708,
      0.0391874685883522,
      0.19754968583583832,
      0.022523371502757072,
      -0.15394474565982819,
      0.13942377269268036,
      0.10982945561408997,
      0.5826209783554077,
      0.6388590931892395,
      0.9096692800521851,
      0.39787477254867554,
      -0.32514938712120056,
      -0.8747250437736511,
      -0.6054436564445496,
      -0.057853467762470245,
      0.0823196992278099,
      0.9717267155647278,
      -1.4204394817352295,
      0.4679122865200043,
      -0.5497178435325623,
      0.39745375514030457,
      -1.1340744495391846,
      -0.16864319145679474,
      -0.5140058994293213,
      -0.07610731571912766,
      -0.7990760803222656,
      -1.361793875694275,
      -0.09416527301073074,
      -0.9618992805480957,
      0.43955910205841064,
      1.758719801902771,
      0.1621178686618805,
      0.09604723751544952,
      0.030225075781345367,
      -0.6404394507408142,
      0.1734558641910553,
      0.23696796596050262,
      0.006804978009313345,
      -0.18927517533302307,
      -1.3205593824386597,
      -0.03236677125096321,
      0.3163807988166809,
      -0.06421050429344177,
      0.8475289940834045,
      0.4940834641456604,
      0.1944701224565506,
      -0.8921185731887817,
      -0.9181153774261475,
      -0.06352142244577408,
      -1.120536208152771,
      0.5590683221817017,
      0.290720671415329,
      0.2635846436023712,
      0.472383975982666,
      -0.003886579303070903,
      -0.6917812824249268,
      0.9120898842811584,
      -0.16699782013893127,
      -0.7727633118629456,
      0.14704084396362305,
      0.7805595993995667,
      -0.5437363982200623,
      0.22821637988090515,
      0.17063532769680023,
      -0.8015015125274658,
      -0.1998431384563446,
      -0.8106967806816101,
      -1.4865455627441406,
      0.06953412294387817,
      0.7115270495414734,
      1.03250253200531,
      -1.6777384281158447,
      -0.7203174233436584,
      1.2810829877853394,
      -0.36909666657447815,
      -0.015499566681683064,
      -0.4600813388824463,
      0.18352742493152618,
      0.7454565763473511,
      -0.6513029932975769,
      0.025006072595715523,
      -0.3900170922279358,
      -0.1369330734014511,
      -0.7649921774864197,
      1.8217294216156006,
      0.5642214417457581,
      -0.42822539806365967,
      -0.8187569379806519,
      -0.40450209379196167,
      -0.9382060170173645,
      0.9019461870193481,
      -0.8054618835449219,
      0.31493619084358215,
      -0.40487176179885864,
      -0.5471125841140747,
      -0.8955329656600952,
      0.5047038197517395,
      0.5079472064971924,
      -0.6715250611305237,
      0.07555712014436722,
      -1.749782919883728,
      -0.27673301100730896,
      -1.0455013513565063,
      0.8527817726135254,
      -0.494812935590744,
      0.2535333037376404,
      0.27483731508255005,
      0.7244459390640259,
      0.20158474147319794,
      -0.4852958023548126,
      -0.8017560243606567,
      0.45948565006256104,
      0.24853219091892242,
      -1.0184866189956665,
      0.8733342289924622,
      1.628869652748108,
      0.14068983495235443,
      -0.389003187417984,
      1.1839630603790283,
      0.834266185760498,
      -0.29433462023735046,
      -0.04117109254002571,
      0.20885135233402252,
      -0.31341391801834106,
      -0.21775560081005096,
      -0.47184252738952637,
      -0.6597577929496765,
      -0.6572272777557373,
      0.19992493093013763,
      0.20608608424663544,
      -0.3099580705165863,
      -0.7784939408302307,
      0.5950368046760559,
      0.2729904055595398,
      -0.028331561014056206,
      -0.08943501114845276,
      -0.8269273042678833,
      -1.1341568231582642,
      0.6313759684562683,
      0.6339727640151978,
      -0.2579783797264099,
      0.179007887840271,
      0.5492972135543823,
      0.27943456172943115,
      1.2131493091583252,
      0.7211755514144897,
      -0.521411657333374,
      0.11779273301362991,
      0.7389548420906067,
      -0.6427931189537048,
      0.5757409930229187,
      0.22604306042194366,
      0.33969876170158386,
      -0.8257639408111572,
      0.2757510840892792,
      -1.3019378185272217,
      -0.20621751248836517,
      -0.8175513744354248,
      -0.04686201363801956,
      -0.05184827372431755,
      0.4140608310699463,
      -0.7117866277694702,
      -0.18447472155094147,
      0.9268942475318909,
      0.06480767577886581,
      -1.4097611904144287,
      0.8569718599319458,
      0.4914775490760803,
      -0.6214519143104553,
      0.24700693786144257,
      0.3990474343299866,
      0.6289768815040588,
      0.4195936918258667,
      0.31998980045318604,
      0.3855705261230469,
      0.36652445793151855,
      0.025500917807221413,
      -0.40371647477149963,
      -0.5240910053253174,
      -0.03983394801616669,
      -0.8542675971984863,
      1.1030324697494507,
      -0.14614805579185486,
      0.18026694655418396,
      -0.11550063639879227,
      -1.0802167654037476,
      0.16805218160152435,
      0.01825643889605999,
      -0.21952195465564728,
      -0.5547173619270325,
      -1.2557708024978638,
      0.7788262367248535,
      -0.2706182599067688,
      -1.0819171667099,
      0.16772772371768951,
      -0.4943143427371979,
      -0.31811290979385376,
      -0.05018163472414017,
      -0.7474659085273743,
      -0.6272478699684143,
      -1.2956829071044922,
      0.5143120884895325,
      0.1747378557920456,
      -0.41588401794433594,
      -0.7148392796516418,
      -0.7592779994010925,
      -0.8791046142578125,
      -0.28709718585014343,
      -0.567253828048706,
      0.373310923576355,
      0.4304773211479187,
      0.02055838704109192,
      -0.040740370750427246,
      -0.32877612113952637,
      -0.5973851084709167,
      0.7054404020309448,
      0.10383910685777664,
      -0.3841663599014282,
      0.2718598544597626,
      -0.088399238884449,
      -0.568091869354248,
      0.33462896943092346,
      -0.223041832447052,
      0.16203968226909637,
      0.23724015057086945,
      1.2087002992630005,
      1.0580190420150757,
      0.6987711787223816,
      -0.06768961250782013,
      -0.32010042667388916,
      0.32682639360427856,
      0.501552939414978,
      0.1950675994157791,
      -0.5526489615440369,
      0.453748881816864,
      -0.6130012273788452
    ],
    "label": {
      "level1": "AMO",
      "level2": "G",
      "level3": "G",
      "leafContractCategory": "G",
      "rootCause": "Missing Required Method Order",
      "effect": "MOB",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Train",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category):\n\nAMO (API Method Order): The problem is related to the order in which API methods are called. Specifically, not calling the necessary API methods in the correct sequence results in memory leaks.\nLevel 2:\n\nG (Graph-Related): The issue pertains to TensorFlow�s computational graph that keeps expanding as models are repeatedly created without properly clearing or resetting it.\nLevel 3 (Hybrid Patterns):\n\nG (Graph-Related): As above, the issue is graph-related. TensorFlow/Keras internally maintains a graph that needs to be explicitly reset between training iterations, otherwise memory continues to accumulate.\nLeaf Contract Category:\n\nG (Graph-Related): The specific nature of the issue remains graph-related due to the absence of a required graph reset operation.\nRoot Cause:\n\nMissing Required Method Order: The problem occurs because the necessary sequence of API method calls (tf.reset_default_graph() after K.clear_session()) is not followed. Only clearing the session is insufficient to fully clean the graph.\nEffect:\n\nMOB (Memory Out of Bound): The cumulative buildup of the computational graph leads to a significant memory leak, eventually causing an Out Of Memory (OOM) exception.\nML Library:\n\nKeras: Specifically pertains to Keras�s interaction with TensorFlow backend methods for graph management.\nContract Violation Location:\n\nTrain: The issue appears during repeated training phases, where each iteration incorrectly handles the graph, causing memory usage to continuously increase.\nDetection Technique:\n\nStatic: The problem can be detected through static analysis by observing the sequence of API method calls (missing tf.reset_default_graph()) needed for proper memory management."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/43178668",
    "title": "",
    "question": "35\n\nI want to compare the computation time between different models. During the fit the computation time per epoch is printed to the console.\n\nEpoch 5/5\n160000/160000 [==============================] - **10s** ......\nI'm looking for a way to store these times in a similar way to the model metrics that are saved in each epoch and avaliable through the history object.",
    "answer": "Try the following callback:\n\nclass TimeHistory(keras.callbacks.Callback):\n    def on_train_begin(self, logs={}):\n        self.times = []\n\n    def on_epoch_begin(self, batch, logs={}):\n        self.epoch_time_start = time.time()\n\n    def on_epoch_end(self, batch, logs={}):\n        self.times.append(time.time() - self.epoch_time_start)\nThen:\n\ntime_callback = TimeHistory()\nmodel.fit(..., callbacks=[..., time_callback],...)\ntimes = time_callback.times\nIn this case times should store the epoch computation times.",
    "mlApiName": "keras.models.fit",
    "embedding": [
      0.15867643058300018,
      0.23428906500339508,
      -3.74934458732605,
      -2.5479865074157715,
      0.7911690473556519,
      -0.44092223048210144,
      0.19181668758392334,
      -0.7537893652915955,
      -1.0716307163238525,
      -0.2917529344558716,
      -0.2347632348537445,
      0.08654274791479111,
      2.307487964630127,
      1.2167034149169922,
      -0.48740890622138977,
      -0.9345137476921082,
      0.5764789581298828,
      0.5692852139472961,
      -0.6528145670890808,
      1.2621406316757202,
      1.615869164466858,
      -0.3204929828643799,
      -0.5970095992088318,
      -0.08682321757078171,
      0.7811421751976013,
      0.5762379765510559,
      -0.4378531277179718,
      0.813073456287384,
      -0.5849819779396057,
      0.4653078019618988,
      1.0135055780410767,
      0.037939611822366714,
      0.5693065524101257,
      -0.8557686805725098,
      -1.1382521390914917,
      -1.709920048713684,
      0.19511616230010986,
      -0.5710914731025696,
      0.9599557518959045,
      0.2527543306350708,
      2.0136919021606445,
      -0.23934277892112732,
      0.9277873635292053,
      0.7619567513465881,
      1.2870557308197021,
      -0.1492202877998352,
      1.0984675884246826,
      -0.15922003984451294,
      0.6617212295532227,
      -0.4242953360080719,
      -0.20464199781417847,
      0.33637210726737976,
      -0.13937699794769287,
      0.04959087446331978,
      0.7930493950843811,
      0.5317785739898682,
      0.773533046245575,
      0.9492460489273071,
      0.5564375519752502,
      -0.8096286654472351,
      0.8274922966957092,
      -0.13819792866706848,
      -0.9529523253440857,
      1.2287102937698364,
      0.3137552738189697,
      -0.0987526997923851,
      -0.4889662265777588,
      0.5580854415893555,
      -0.4434981644153595,
      -0.5623200535774231,
      0.31331294775009155,
      1.111341118812561,
      -0.4049930274486542,
      -0.12416339665651321,
      -0.12369149178266525,
      1.0123587846755981,
      -0.49952030181884766,
      -0.3427561819553375,
      -0.18599379062652588,
      0.785509467124939,
      -0.3027722239494324,
      0.9589453339576721,
      1.3606635332107544,
      -0.8810476064682007,
      0.5245295166969299,
      -0.34186214208602905,
      -0.7847810387611389,
      0.20717884600162506,
      -0.11571145802736282,
      0.8239697217941284,
      -1.3684513568878174,
      -0.6575113534927368,
      1.1927766799926758,
      0.9671387076377869,
      -0.9280867576599121,
      0.07962479442358017,
      -0.10721218585968018,
      0.720888078212738,
      -1.235713243484497,
      0.347201943397522,
      -0.26386916637420654,
      -0.12865009903907776,
      -0.1902783364057541,
      -1.0432301759719849,
      0.40374308824539185,
      0.28217533230781555,
      -0.1257631629705429,
      -0.5209845304489136,
      0.002279581967741251,
      -1.1613695621490479,
      -0.30759337544441223,
      0.19492335617542267,
      -0.3162640631198883,
      0.5185890793800354,
      -0.22917234897613525,
      -0.26788732409477234,
      0.29662343859672546,
      -0.6911128163337708,
      -0.09906043857336044,
      -0.1464719921350479,
      0.1294589638710022,
      -0.4231383502483368,
      -0.3154306411743164,
      0.031165288761258125,
      -0.54774409532547,
      0.8262884020805359,
      -1.01344633102417,
      0.3799741268157959,
      -0.2084728479385376,
      -1.244678020477295,
      0.180575892329216,
      -0.223858043551445,
      -0.38922402262687683,
      0.2188277244567871,
      -0.29696500301361084,
      1.2198258638381958,
      -1.0050442218780518,
      -0.5130680203437805,
      -0.4275103807449341,
      0.6721314191818237,
      0.6582481861114502,
      -0.5604243278503418,
      -0.15890167653560638,
      -0.4523807466030121,
      0.14937977492809296,
      0.21585530042648315,
      -0.25109729170799255,
      -1.41972017288208,
      -0.4773276150226593,
      0.19204285740852356,
      0.06902522593736649,
      0.7339769005775452,
      -1.328354835510254,
      0.49971023201942444,
      0.6719037294387817,
      -0.4445893466472626,
      -0.43967461585998535,
      0.5546156764030457,
      0.21999801695346832,
      0.709214985370636,
      0.3669913411140442,
      -0.0917510837316513,
      -0.45843505859375,
      0.7693104147911072,
      -0.5837440490722656,
      0.031281013041734695,
      -0.15748514235019684,
      0.8737680315971375,
      0.11251526325941086,
      -0.6922600269317627,
      -1.0169976949691772,
      -0.6233554482460022,
      -0.14188742637634277,
      0.025018984451889992,
      0.3749668300151825,
      0.05895976722240448,
      1.1298319101333618,
      -1.0410902500152588,
      0.08817378431558609,
      -0.5871273875236511,
      0.9855742454528809,
      -0.4756517708301544,
      0.8459672927856445,
      0.04602658748626709,
      -0.7275440096855164,
      -0.6417253613471985,
      0.6454866528511047,
      0.3263171315193176,
      0.0413406677544117,
      -0.3964824378490448,
      0.5727754235267639,
      -0.5512611269950867,
      -0.2508014440536499,
      -0.2895326614379883,
      -0.20986679196357727,
      -0.7074797749519348,
      0.39891964197158813,
      -0.262089341878891,
      0.1953428089618683,
      0.18995869159698486,
      0.3411795496940613,
      0.07841366529464722,
      -0.49046996235847473,
      0.09295947849750519,
      -0.020881442353129387,
      0.8898919820785522,
      0.9565051794052124,
      0.8852755427360535,
      -0.8366650342941284,
      0.7335351705551147,
      1.0893446207046509,
      1.1350514888763428,
      0.22575733065605164,
      0.3632828891277313,
      0.4172416031360626,
      -0.3527836203575134,
      0.34383144974708557,
      0.3210686445236206,
      -0.056273289024829865,
      0.6918853521347046,
      0.007275082636624575,
      -0.6742406487464905,
      1.6522740125656128,
      -0.45750176906585693,
      0.8420020341873169,
      -1.114567518234253,
      -0.23997651040554047,
      0.4694330394268036,
      -0.7180280685424805,
      -0.2282436490058899,
      -0.8685503005981445,
      -0.7084408402442932,
      -0.2780762016773224,
      0.3334342837333679,
      -0.031730495393276215,
      0.7247757911682129,
      0.6935725808143616,
      1.0535603761672974,
      0.143246591091156,
      0.20864522457122803,
      0.3840120732784271,
      0.6833141446113586,
      0.2511439323425293,
      -0.11011572927236557,
      -1.1114294528961182,
      0.1875605285167694,
      0.28635454177856445,
      0.13985510170459747,
      0.2781740128993988,
      1.11429762840271,
      -0.24753783643245697,
      0.4678809344768524,
      0.2986062169075012,
      0.012874896638095379,
      1.5558311939239502,
      -1.384031057357788,
      0.2822110652923584,
      -0.3890189230442047,
      -0.6611118316650391,
      -0.27871939539909363,
      0.6013148427009583,
      0.056773364543914795,
      0.425001859664917,
      -0.06255190819501877,
      0.00935900304466486,
      -1.6199276447296143,
      0.286653995513916,
      -0.6819292902946472,
      -0.22851887345314026,
      -0.3572773337364197,
      0.1300085037946701,
      -0.17451700568199158,
      1.0102355480194092,
      1.1129111051559448,
      0.47622862458229065,
      -0.03372228145599365,
      0.09595862030982971,
      -0.3905995488166809,
      -0.10686221718788147,
      -0.44256892800331116,
      -0.7862539291381836,
      -1.9320932626724243,
      -0.7925021052360535,
      0.1892232596874237,
      -0.441042959690094,
      -0.5373204350471497,
      -0.5441137552261353,
      0.9210749864578247,
      0.397238552570343,
      -0.1779710203409195,
      -0.12988080084323883,
      0.7569135427474976,
      -0.06859918683767319,
      0.5283023118972778,
      -0.4232242703437805,
      0.5606065988540649,
      0.7887270450592041,
      -0.07963564991950989,
      0.654043436050415,
      -0.9398688077926636,
      0.7108333110809326,
      0.47897782921791077,
      0.5466554164886475,
      0.90079665184021,
      0.5691373944282532,
      -0.5398691892623901,
      -0.28968295454978943,
      -0.2225048840045929,
      0.381852388381958,
      -0.8258017897605896,
      -0.11789846420288086,
      0.21064309775829315,
      -0.9743275046348572,
      0.5316264629364014,
      -0.8342397809028625,
      -0.33433791995048523,
      0.017494672909379005,
      -0.003926151432096958,
      -0.1782785952091217,
      -0.5063572525978088,
      0.5224649310112,
      -1.077685832977295,
      0.45560067892074585,
      -0.42612650990486145,
      -0.8011149168014526,
      0.6828707456588745,
      -0.6593457460403442,
      0.33475878834724426,
      -0.5490884184837341,
      0.4709746539592743,
      0.5096737146377563,
      -0.05394776165485382,
      0.5918141007423401,
      -0.9470804333686829,
      -0.21845513582229614,
      0.20317256450653076,
      0.23840604722499847,
      -0.49752843379974365,
      -0.40446460247039795,
      0.6140257120132446,
      -0.636703372001648,
      0.7315887212753296,
      0.2510489225387573,
      -0.1709398776292801,
      0.34977835416793823,
      -0.4052271544933319,
      -0.6273022294044495,
      -0.23377451300621033,
      0.7402176856994629,
      0.48609623312950134,
      -0.19713447988033295,
      -0.4618549942970276,
      -0.19831380248069763,
      -0.5778742432594299,
      1.0376091003417969,
      -0.11900942772626877,
      0.7012103796005249,
      0.5834624171257019,
      0.8211551904678345,
      0.7282597422599792,
      1.0256844758987427,
      0.6762232780456543,
      0.12682786583900452,
      -0.022656753659248352,
      0.07193721830844879,
      0.07380446046590805,
      0.6247783303260803,
      0.7951822876930237,
      1.3651363849639893,
      -0.30199316143989563,
      -0.033018309623003006,
      0.3114771246910095,
      0.040419358760118484,
      0.56717848777771,
      0.19590547680854797,
      0.09134070575237274,
      -0.6508088111877441,
      0.5021389722824097,
      -0.46153515577316284,
      0.7462177872657776,
      0.693244993686676,
      -0.8990247249603271,
      0.34120798110961914,
      0.27243539690971375,
      0.7504711747169495,
      -0.1466139853000641,
      0.41660410165786743,
      -0.23436208069324493,
      -0.5039486289024353,
      0.516200065612793,
      0.5597018003463745,
      -0.781261682510376,
      -1.1284650564193726,
      -0.6298413872718811,
      0.7537934184074402,
      -0.6419776082038879,
      0.7453601360321045,
      0.11784922331571579,
      0.056206367909908295,
      -0.041788894683122635,
      -0.4731944799423218,
      0.26847636699676514,
      0.14758208394050598,
      0.12021560221910477,
      -0.7839335203170776,
      0.025516940280795097,
      -0.38274937868118286,
      -0.5064389705657959,
      0.15113285183906555,
      0.18083538115024567,
      0.01635262370109558,
      0.12119358032941818,
      -0.3268166184425354,
      -1.2344698905944824,
      -0.2850033640861511,
      0.04400312528014183,
      1.2513474225997925,
      0.6964378356933594,
      -0.19367355108261108,
      -0.6806194186210632,
      0.18336912989616394,
      0.48922303318977356,
      -0.47247859835624695,
      -0.09055473655462265,
      0.41039803624153137,
      0.5348119735717773,
      -0.03273069113492966,
      0.9106746315956116,
      -0.22805552184581757,
      -1.9336224794387817,
      0.5062934756278992,
      0.14603887498378754,
      1.1206974983215332,
      0.34519821405410767,
      -0.05704071745276451,
      0.23687542974948883,
      0.23397868871688843,
      0.27545735239982605,
      -0.012868023477494717,
      0.4235098659992218,
      0.04499031975865364,
      -0.3503020703792572,
      -0.4304424524307251,
      -0.31772375106811523,
      -0.5371460318565369,
      0.829851508140564,
      0.8208328485488892,
      -1.1010186672210693,
      -1.2999858856201172,
      0.774837076663971,
      -0.001050855265930295,
      -0.17372597754001617,
      -0.0001930440339492634,
      1.2287471294403076,
      1.0390026569366455,
      -0.3112775981426239,
      0.7670482397079468,
      0.09303092211484909,
      0.43020105361938477,
      0.7105382680892944,
      -0.6518571376800537,
      0.6651636958122253,
      -0.389411062002182,
      0.30645570158958435,
      -0.16345985233783722,
      -1.76273775100708,
      0.05103880167007446,
      -0.7222319841384888,
      0.2429308295249939,
      0.9689202904701233,
      -0.10085950791835785,
      -0.5742394924163818,
      0.0987827479839325,
      -1.1443079710006714,
      0.3011646270751953,
      0.7783742547035217,
      -0.2798019349575043,
      -0.38726893067359924,
      0.9529339671134949,
      0.9756085276603699,
      0.5996035933494568,
      -1.5402793884277344,
      -0.6608698964118958,
      0.142741397023201,
      -0.2757117748260498,
      1.481062650680542,
      0.7763867974281311,
      -0.45533356070518494,
      0.28715837001800537,
      -0.18295124173164368,
      0.35264748334884644,
      -0.06052462384104729,
      0.8041778206825256,
      0.3629998564720154,
      0.008222783915698528,
      -0.16543857753276825,
      0.3099255859851837,
      0.6008997559547424,
      0.24512547254562378,
      -0.8538172841072083,
      0.7047823667526245,
      0.7663828134536743,
      -0.03137160837650299,
      0.18736839294433594,
      0.8077589869499207,
      -0.11403544992208481,
      0.380473792552948,
      0.13328689336776733,
      -0.7297284603118896,
      0.1575070321559906,
      0.4866600036621094,
      0.6577473282814026,
      -0.027285510674118996,
      0.6512280702590942,
      1.1209702491760254,
      -1.267665147781372,
      0.6164015531539917,
      -0.08026020228862762,
      -0.22152827680110931,
      -0.6634950041770935,
      0.3446505069732666,
      0.2746429443359375,
      -0.029975373297929764,
      0.29215705394744873,
      -0.7336582541465759,
      -0.12924709916114807,
      0.25684815645217896,
      -2.201810598373413,
      0.5551904439926147,
      -1.1661142110824585,
      0.9542389512062073,
      -0.949358344078064,
      -1.865816593170166,
      -0.18152375519275665,
      -0.12029144167900085,
      0.3388616144657135,
      -0.7129509449005127,
      0.3364948630332947,
      0.8393270373344421,
      -0.2468574494123459,
      -0.704998791217804,
      0.845933198928833,
      0.07889249175786972,
      -1.0032988786697388,
      -0.39617156982421875,
      -0.2207360714673996,
      -0.44089969992637634,
      0.8859639167785645,
      0.9148977398872375,
      -0.7349286675453186,
      -0.15400610864162445,
      -0.6624231934547424,
      0.802610456943512,
      -1.3773773908615112,
      -0.1269191950559616,
      -0.4595937430858612,
      0.5639725923538208,
      -0.9247146844863892,
      -1.2702252864837646,
      -0.10977883636951447,
      -0.9731969237327576,
      0.5170248746871948,
      2.1661429405212402,
      0.36632710695266724,
      -0.6717681288719177,
      -0.7069533467292786,
      -0.5828054547309875,
      0.1902984380722046,
      1.0883082151412964,
      0.16626735031604767,
      1.0092662572860718,
      -1.8910411596298218,
      1.0184749364852905,
      0.23890940845012665,
      -0.7396304607391357,
      -0.5337833762168884,
      1.0321440696716309,
      0.31435418128967285,
      -0.7611991763114929,
      -0.8101633787155151,
      -0.5006747841835022,
      -1.4123176336288452,
      0.00748415058478713,
      1.0109587907791138,
      -0.2130519598722458,
      0.5478596091270447,
      0.43101170659065247,
      -0.48490217328071594,
      -0.10766346752643585,
      0.40595152974128723,
      -0.4137829840183258,
      -0.6576228737831116,
      1.0072362422943115,
      -0.45256954431533813,
      0.3319101333618164,
      0.5464079976081848,
      -0.5360184907913208,
      0.414013534784317,
      -0.5071977972984314,
      -1.0984869003295898,
      -0.37145110964775085,
      0.2592211365699768,
      1.6296319961547852,
      -1.553159475326538,
      0.7290045022964478,
      1.350232481956482,
      -1.062611699104309,
      0.29702335596084595,
      0.4263990521430969,
      -0.575833797454834,
      0.8384527564048767,
      -0.08545766025781631,
      0.2297937124967575,
      0.8451845645904541,
      -0.387600302696228,
      -1.1176178455352783,
      0.9778811931610107,
      -0.06706906110048294,
      -1.0321767330169678,
      -0.2485458254814148,
      -0.0027808446902781725,
      -0.0365983322262764,
      0.9458307027816772,
      -1.173905611038208,
      0.42800185084342957,
      -0.35252103209495544,
      -0.8885897994041443,
      -0.33890894055366516,
      0.3374413847923279,
      0.21347762644290924,
      -1.2743691205978394,
      -0.05531036853790283,
      -1.149454116821289,
      -0.3010457456111908,
      -0.2717682123184204,
      1.1766315698623657,
      -0.3697265684604645,
      0.7641367316246033,
      -0.5461134910583496,
      1.152306318283081,
      0.7135101556777954,
      -0.45248913764953613,
      -0.6151175498962402,
      0.7355767488479614,
      -0.3500739634037018,
      -0.8700175881385803,
      0.7668127417564392,
      1.1836766004562378,
      1.0010735988616943,
      -0.7356882691383362,
      1.3065071105957031,
      0.6508393287658691,
      0.36709335446357727,
      -0.05516057461500168,
      0.37577202916145325,
      -0.3561047911643982,
      0.43044278025627136,
      -0.8119150400161743,
      -0.30070316791534424,
      -0.5594035983085632,
      0.7223362326622009,
      -0.9279434084892273,
      -0.997968852519989,
      -0.18443448841571808,
      0.4386686682701111,
      0.2603248953819275,
      -0.9366744756698608,
      -0.48612940311431885,
      -0.4443451166152954,
      -1.228481650352478,
      0.3120551109313965,
      0.6964099407196045,
      -0.1505926549434662,
      -0.27848750352859497,
      0.20265516638755798,
      0.14287905395030975,
      0.6891900300979614,
      0.9715831279754639,
      0.5153225064277649,
      0.05357057973742485,
      0.5857120156288147,
      -0.48076194524765015,
      0.5626623630523682,
      0.11548755317926407,
      0.5831647515296936,
      -0.7476970553398132,
      -0.04594404995441437,
      -0.5627527236938477,
      -0.11012794077396393,
      -0.43812909722328186,
      -0.39059433341026306,
      0.4576290547847748,
      -0.34056809544563293,
      -0.24867315590381622,
      -0.18052996695041656,
      0.33058369159698486,
      0.1329670399427414,
      -1.5246665477752686,
      -0.15686500072479248,
      0.4420410394668579,
      0.47446244955062866,
      0.3772423565387726,
      1.012372374534607,
      0.5714311599731445,
      -0.154288187623024,
      -0.7692729234695435,
      -0.5142854452133179,
      -0.18516789376735687,
      -0.43834325671195984,
      -0.13646729290485382,
      -0.16226810216903687,
      0.26048848032951355,
      -0.4577655494213104,
      0.34231624007225037,
      0.5044928193092346,
      0.0358453094959259,
      -0.31808924674987793,
      -0.8300011157989502,
      -0.30813026428222656,
      -0.5663809776306152,
      0.16415782272815704,
      -1.0182442665100098,
      -0.8073431253433228,
      -0.6585292220115662,
      0.08065208792686462,
      -0.020347464829683304,
      -0.09467542171478271,
      -0.5415511727333069,
      -0.5406426787376404,
      -0.09137608110904694,
      0.10211622714996338,
      -0.11590253561735153,
      -0.9716984629631042,
      1.94375479221344,
      0.33891451358795166,
      0.4706907272338867,
      -1.4155374765396118,
      0.11386285722255707,
      -1.613893985748291,
      0.03188839182257652,
      -1.5597472190856934,
      0.2237093597650528,
      -0.2969173491001129,
      0.6116410493850708,
      -0.41553163528442383,
      -0.9973536133766174,
      -0.8795115947723389,
      0.9687285423278809,
      0.45576533675193787,
      -0.5302046537399292,
      0.9087032675743103,
      -0.7109097242355347,
      -1.2693166732788086,
      -0.5192838907241821,
      -0.5334873199462891,
      0.5164584517478943,
      1.172506332397461,
      0.8303622007369995,
      1.0131869316101074,
      0.433072954416275,
      0.06882750988006592,
      -0.026337316259741783,
      -0.07607246190309525,
      0.10133899003267288,
      0.17172421514987946,
      -0.191626638174057,
      0.24044987559318542,
      -0.8359603881835938
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Unknown",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Train",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category):\n\nSAM (Single API Method):\nThe issue specifically involves the single API method keras.models.fit.\nLevel 2:\n\nBET (Behavioral Expectation Type):\nThe user's expectation for capturing the training time per epoch is not directly supported by default API behavior, hence involving an incorrect expectation.\nLevel 3 (Hybrid Patterns):\n\nIC-1 (Incorrect Computation):\nThe problem stems from the incorrect expectation that the training time per epoch will be automatically stored in the history object.\nLeaf Contract Category:\n\nIC-1 (Incorrect Computation):\nSpecifically, the incorrect computation pertains to measuring and capturing epoch-level training durations, which is not a built-in behavior.\nRoot Cause:\n\nUnacceptable Input Value:\nThe issue is due to expecting an output (epoch timing data) that is not produced by default, requiring additional implementation.\nEffect:\n\nUnknown:\nAlthough it doesn't result in a crash, the intended effect of automatically storing epoch computation times isn't achieved. It's not clearly a crash or performance degradation, just a missing feature.\nML Library:\n\nKeras:\nThe method involved is specifically from Keras's high-level training API.\nContract Violation Location:\n\nTrain:\nThe problem occurs during the training phase (model.fit) when epoch-level metrics are typically collected.\nDetection Technique:\n\nStatic:\nDetecting this issue involves static analysis of Keras API documentation or source code to realize epoch times are not automatically captured by default, hence the need for a custom callback.\n"
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/43396572",
    "title": "",
    "question": "68\n\nI have tried to build a CNN with one layer, but I have some problem with it. Indeed, the compilator says me that\n\nValueError: Error when checking model input: expected conv1d_1_input to have 3 dimensions, but got array with shape (569, 30)\n\nThis is the code\n\nimport numpy\nfrom keras.models import Sequential\nfrom keras.layers.convolutional import Conv1D\n\nnumpy.random.seed(7)\n\ndatasetTraining = numpy.loadtxt(\"CancerAdapter.csv\",delimiter=\",\")\nX = datasetTraining[:,1:31]\nY = datasetTraining[:,0]\ndatasetTesting = numpy.loadtxt(\"CancereEvaluation.csv\",delimiter=\",\")\nX_test = datasetTraining[:,1:31]\nY_test = datasetTraining[:,0]\n\nmodel = Sequential()\nmodel.add(Conv1D(2,2,activation='relu',input_shape=X.shape))\nmodel.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])\nmodel.fit(X, Y, epochs=150, batch_size=5)\nscores = model.evaluate(X_test, Y_test)\n\nprint(\"\\n%s: %.2f%%\" % (model.metrics_names[1], scores[1]*100))",
    "answer": "136\n\ntd; lr you need to reshape you data to have a spatial dimension for Conv1d to make sense:\n\nX = np.expand_dims(X, axis=2) # reshape (569, 30) to (569, 30, 1) \n# now input can be set as \nmodel.add(Conv1D(2,2,activation='relu',input_shape=(30, 1))\nEssentially reshaping a dataset that looks like this:\n\nfeatures    \n.8, .1, .3  \n.2, .4, .6  \n.7, .2, .1  \nTo:\n\n[[.8\n.1\n.3],\n\n[.2,\n .4,\n .6\n ],\n\n[.7,\n .2,\n .1]]\n \nExplanation and examples\n\nNormally convolution works over spatial dimensions. The kernel is \"convolved\" over the dimension producing a tensor. In the case of Conv1D, the kernel is passed over the 'steps' dimension of every example.\n\nYou will see Conv1D used in NLP where steps is a number of words in the sentence (padded to some fixed maximum length). The words would be encoded as vectors of length 4.\n\nHere is an example sentence:\n\njack   .1   .3   -.52   |\nis     .05  .8,  -.7    |<--- kernel is `convolving` along this dimension.\na      .5   .31  -.2    |\nboy    .5   .8   -.4   \\|/\nAnd the way we would set the input to the conv in this case:\n\nmaxlen = 4\ninput_dim = 3\nmodel.add(Conv1D(2,2,activation='relu',input_shape=(maxlen, input_dim))\nIn your case, you will treat the features as the spatial dimensions with each feature having length 1. (see below)\n\nHere would be an example from your dataset\n\natt1   .04    |\natt2   .05    |  < -- kernel convolving along this dimension\natt3   .1     |       notice the features have length 1. each\natt4   .5    \\|/      example have these 4 featues.\nAnd we would set the Conv1D example as:\n\nmaxlen = num_features = 4 # this would be 30 in your case\ninput_dim = 1 # since this is the length of _each_ feature (as shown above)\n\nmodel.add(Conv1D(2,2,activation='relu',input_shape=(maxlen, input_dim))\nAs you see your dataset has to be reshaped in to (569, 30, 1) use:\n\nX = np.expand_dims(X, axis=2) # reshape (569, 30, 1) \n# now input can be set as \nmodel.add(Conv1D(2,2,activation='relu',input_shape=(30, 1))\nHere is a full-fledged example that you can run (I'll use the Functional API)\n\nfrom keras.models import Model\nfrom keras.layers import Conv1D, Dense, MaxPool1D, Flatten, Input\nimport numpy as np\n\ninp =  Input(shape=(5, 1))\nconv = Conv1D(filters=2, kernel_size=2)(inp)\npool = MaxPool1D(pool_size=2)(conv)\nflat = Flatten()(pool)\ndense = Dense(1)(flat)\nmodel = Model(inp, dense)\nmodel.compile(loss='mse', optimizer='adam')\n\nprint(model.summary())\n\n# get some data\nX = np.expand_dims(np.random.randn(10, 5), axis=2)\ny = np.random.randn(10, 1)\n\n# fit model\nmodel.fit(X, y)",
    "mlApiName": "keras.layers.Conv1D",
    "embedding": [
      0.5118508338928223,
      0.6621458530426025,
      -1.9929494857788086,
      -1.241196632385254,
      0.27396970987319946,
      -0.060462478548288345,
      0.11591708660125732,
      0.8296637535095215,
      -0.5109527111053467,
      -0.8634135127067566,
      -0.1281728744506836,
      0.2499137967824936,
      2.0514183044433594,
      0.6284807324409485,
      -0.4831414818763733,
      -0.8243670463562012,
      0.26199162006378174,
      -0.016451649367809296,
      0.11346223950386047,
      0.7045490741729736,
      -0.3167906105518341,
      -0.3870607316493988,
      0.08840618282556534,
      -0.5925250053405762,
      1.409485101699829,
      0.702372133731842,
      -0.4353737533092499,
      0.6471828818321228,
      -0.5868719220161438,
      0.10034584254026413,
      1.2438859939575195,
      -0.766004204750061,
      -0.46901440620422363,
      -1.0171996355056763,
      -1.1642823219299316,
      -0.8283191919326782,
      0.9387505054473877,
      0.1200493723154068,
      -0.23926903307437897,
      -0.08888110518455505,
      0.7392013072967529,
      0.37308862805366516,
      -0.27124354243278503,
      0.5143579840660095,
      0.14269068837165833,
      -0.18510334193706512,
      1.4003342390060425,
      0.21784956753253937,
      0.7798643708229065,
      -1.240931510925293,
      0.09667657315731049,
      1.2107006311416626,
      -0.1610097438097,
      0.15298300981521606,
      1.1012544631958008,
      0.4649946987628937,
      -0.7540757656097412,
      0.3621118664741516,
      1.3794796466827393,
      -0.945550799369812,
      0.03281472623348236,
      0.7402603626251221,
      -1.821268916130066,
      1.3034613132476807,
      0.340996116399765,
      -0.13765694200992584,
      -0.4216615855693817,
      0.7283967733383179,
      -0.5190702676773071,
      -0.7394106388092041,
      0.6247655749320984,
      -0.4257407784461975,
      -0.13345077633857727,
      -0.3134360909461975,
      -0.5408324599266052,
      0.005044987890869379,
      -0.720356822013855,
      -0.0330352708697319,
      -0.24451598525047302,
      0.5507951974868774,
      -0.12360446900129318,
      0.9695560336112976,
      1.0649760961532593,
      -0.6165385246276855,
      -0.05726419389247894,
      0.3793462812900543,
      -0.7179486751556396,
      -0.44777438044548035,
      -0.46847444772720337,
      1.434224247932434,
      -0.30630865693092346,
      -0.2227448970079422,
      0.5469126105308533,
      1.1302183866500854,
      -0.4742298126220703,
      -0.4991905391216278,
      -0.16693927347660065,
      0.38547080755233765,
      -0.3734559714794159,
      0.36007121205329895,
      -0.3255515694618225,
      1.0322308540344238,
      -0.06868252158164978,
      -1.3493372201919556,
      -0.17728368937969208,
      1.4375025033950806,
      -0.05378996208310127,
      -0.040888525545597076,
      0.3518390953540802,
      -0.39743679761886597,
      -0.8646495938301086,
      -0.4079192280769348,
      -0.373007208108902,
      -0.34632042050361633,
      0.28928646445274353,
      -0.01158447377383709,
      0.17965000867843628,
      -0.6572921276092529,
      0.6256849765777588,
      0.014288741163909435,
      -0.020675672218203545,
      -1.1557594537734985,
      0.7117965221405029,
      0.19178591668605804,
      0.10886169224977493,
      0.8303914666175842,
      -0.5730191469192505,
      0.3974011242389679,
      -0.19100342690944672,
      -0.769340991973877,
      0.373989999294281,
      -0.04200606793165207,
      -0.5951731204986572,
      0.22602057456970215,
      0.7463329434394836,
      1.411361575126648,
      -1.393449068069458,
      -0.7191075682640076,
      0.33920130133628845,
      0.7205635905265808,
      0.34268268942832947,
      0.2141152024269104,
      -0.28592079877853394,
      -0.7880873680114746,
      0.42657604813575745,
      -0.7975609302520752,
      0.5046292543411255,
      -0.6027141809463501,
      -0.7871800065040588,
      -0.5557857155799866,
      -0.3507731556892395,
      0.7373331189155579,
      -0.7295417785644531,
      0.21769072115421295,
      0.08132628351449966,
      0.057906731963157654,
      0.6175419092178345,
      0.39390650391578674,
      0.5117924213409424,
      -0.20168298482894897,
      0.9740645289421082,
      0.5403573513031006,
      -0.7727222442626953,
      0.8549285531044006,
      -0.17628854513168335,
      -0.6503033638000488,
      0.20213399827480316,
      0.07885333895683289,
      -0.512795090675354,
      0.21515679359436035,
      -0.4691251814365387,
      -0.6558534502983093,
      -0.18740814924240112,
      -0.2406967133283615,
      -0.37915632128715515,
      0.933434784412384,
      0.9871966242790222,
      -0.7695531249046326,
      0.7766460180282593,
      -0.10380611568689346,
      0.8700575828552246,
      0.05714824050664902,
      0.6749746203422546,
      -0.05461574345827103,
      -0.25072556734085083,
      -0.12384013086557388,
      0.0760781317949295,
      -0.2959454357624054,
      0.0411839596927166,
      -0.6071791052818298,
      0.651029646396637,
      -0.08768405020236969,
      -0.695143461227417,
      -0.3042125999927521,
      -0.06136944890022278,
      0.6251170039176941,
      1.3448835611343384,
      -0.9011532664299011,
      0.8766478896141052,
      0.2295531928539276,
      0.24290362000465393,
      0.44313931465148926,
      0.34869664907455444,
      1.068576455116272,
      -0.6173743009567261,
      1.094236969947815,
      -0.5222656726837158,
      0.6517961621284485,
      -0.8905087113380432,
      0.699961245059967,
      0.5438846349716187,
      -0.4415799081325531,
      0.3215731978416443,
      0.08772990852594376,
      0.20128190517425537,
      -0.03880339115858078,
      0.9144599437713623,
      -0.5515523552894592,
      -0.19735701382160187,
      0.37426260113716125,
      0.5032816529273987,
      -0.4858632981777191,
      1.0654308795928955,
      0.2905912697315216,
      0.514765739440918,
      -0.797346293926239,
      0.01621527038514614,
      -0.22038057446479797,
      -0.45464709401130676,
      -0.2640781104564667,
      -0.9358302354812622,
      -0.8289756178855896,
      0.7075766324996948,
      0.11088107526302338,
      0.029164902865886688,
      0.5569697022438049,
      0.2985178828239441,
      0.4646974503993988,
      -0.4414203464984894,
      0.2756240963935852,
      0.32094913721084595,
      0.4348650276660919,
      0.34643784165382385,
      -0.27828338742256165,
      -0.9495536088943481,
      -0.4121762216091156,
      -0.5096415281295776,
      -0.44727328419685364,
      0.08746770769357681,
      0.8376976251602173,
      -0.32962995767593384,
      0.19345834851264954,
      0.9331187605857849,
      0.32919979095458984,
      0.795766294002533,
      -0.8204668760299683,
      -0.3659190833568573,
      0.03897517919540405,
      0.8188000917434692,
      -0.7514426112174988,
      0.2973874509334564,
      0.18695762753486633,
      -0.08859831839799881,
      -0.17632938921451569,
      -0.3970496952533722,
      -0.6767054200172424,
      -0.2729916572570801,
      0.3290064334869385,
      -0.003976072184741497,
      -0.18741251528263092,
      0.10733499377965927,
      0.7981734275817871,
      0.5968866348266602,
      0.49367615580558777,
      0.8140125870704651,
      0.5792484879493713,
      0.1681368350982666,
      -0.45299282670021057,
      0.25855982303619385,
      -0.01174888201057911,
      -0.925017774105072,
      -0.5537384152412415,
      -0.34898850321769714,
      0.07926009595394135,
      0.34320068359375,
      0.3317471146583557,
      -0.04292217269539833,
      0.2954222857952118,
      0.38030877709388733,
      0.617495059967041,
      -0.37456944584846497,
      0.14448171854019165,
      -0.4044746160507202,
      0.427068829536438,
      0.3761076331138611,
      0.6525801420211792,
      0.7012327313423157,
      -0.47038257122039795,
      0.1945837438106537,
      -0.8792433738708496,
      0.03440540283918381,
      0.5250808000564575,
      0.7690234780311584,
      -0.03375491872429848,
      -0.19567906856536865,
      0.015560879372060299,
      0.5525032877922058,
      0.1637023389339447,
      0.15669439733028412,
      -0.07902857661247253,
      -0.6345377564430237,
      -0.05210230126976967,
      -0.159913569688797,
      0.5366392135620117,
      -0.26679420471191406,
      -0.11956469714641571,
      -0.03627068176865578,
      0.37679511308670044,
      0.021587230265140533,
      -0.4680382013320923,
      0.18566152453422546,
      -0.09851490706205368,
      -0.2863369584083557,
      -0.02217254787683487,
      -0.11874786764383316,
      0.8570521473884583,
      0.08298467099666595,
      -0.20188075304031372,
      0.24963200092315674,
      0.024174921214580536,
      0.9377696514129639,
      0.3439289927482605,
      0.4283308982849121,
      -1.1823314428329468,
      -0.7445676326751709,
      -0.986186146736145,
      -0.18190068006515503,
      0.012667583301663399,
      0.6729737520217896,
      0.7162340879440308,
      -0.5585598945617676,
      0.015508238226175308,
      0.2642882466316223,
      -0.5423604846000671,
      -0.12771214544773102,
      0.5237375497817993,
      -0.923985481262207,
      -0.2806943356990814,
      0.7903419137001038,
      0.22322656214237213,
      -0.15246793627738953,
      0.4503735303878784,
      -0.04989314451813698,
      -1.0601190328598022,
      0.5725540518760681,
      0.08810209482908249,
      0.702860414981842,
      0.08901194483041763,
      0.3454529643058777,
      0.15983060002326965,
      0.970367431640625,
      -0.03709714487195015,
      -0.091878242790699,
      -0.6020664572715759,
      -0.03005947172641754,
      0.49517130851745605,
      1.562787652015686,
      0.10882123559713364,
      1.2724449634552002,
      -0.08867470920085907,
      -0.33995315432548523,
      -0.7597742080688477,
      -0.2930983006954193,
      0.20054802298545837,
      0.16492247581481934,
      0.4282340407371521,
      -1.2918281555175781,
      0.02969149313867092,
      -0.11623872816562653,
      -0.05072367563843727,
      0.6788817048072815,
      -0.4751695990562439,
      0.239150732755661,
      -0.4720137417316437,
      0.03800113871693611,
      0.22550435364246368,
      0.4786440134048462,
      -0.9975257515907288,
      -0.5840967297554016,
      0.4097399413585663,
      0.19111552834510803,
      -0.1818181276321411,
      -0.610954999923706,
      -0.6348198652267456,
      0.43562906980514526,
      -0.2702304720878601,
      0.4432534873485565,
      0.2848852574825287,
      -0.6509529948234558,
      0.5393038392066956,
      -0.8681411147117615,
      -0.7939094305038452,
      -0.30424007773399353,
      -0.4015952944755554,
      -0.4126395881175995,
      -0.481763631105423,
      0.2703162133693695,
      -0.18880173563957214,
      -0.5946261286735535,
      0.41351160407066345,
      0.04084177687764168,
      0.40658554434776306,
      0.1657726913690567,
      -1.5719927549362183,
      0.5190442204475403,
      0.05428397282958031,
      0.46937549114227295,
      0.2937150299549103,
      -0.5529815554618835,
      -0.5922887921333313,
      -0.9288133382797241,
      1.056794285774231,
      -0.44787731766700745,
      0.17385229468345642,
      1.4378564357757568,
      0.6169037222862244,
      0.2777027189731598,
      1.4093116521835327,
      0.1564026027917862,
      -0.9476112127304077,
      0.6283184885978699,
      0.4642035663127899,
      0.6282602548599243,
      -0.21045832335948944,
      -0.3750735819339752,
      0.2021203190088272,
      -0.571943461894989,
      1.0027902126312256,
      -0.6397467255592346,
      0.5853927135467529,
      0.3974071145057678,
      -0.7428915500640869,
      -0.6015105843544006,
      -0.4974991977214813,
      0.8227002620697021,
      0.4864739179611206,
      0.5091988444328308,
      -0.4492514431476593,
      -1.2836259603500366,
      1.18013596534729,
      -0.5136496424674988,
      -0.31899493932724,
      0.20962589979171753,
      0.215762659907341,
      1.7115858793258667,
      -0.31133198738098145,
      -0.06211412325501442,
      -0.08693169057369232,
      0.22556044161319733,
      0.3483870029449463,
      -0.08132574707269669,
      0.4973873496055603,
      -1.091041088104248,
      -0.19935005903244019,
      -0.5180605053901672,
      -1.2111380100250244,
      0.02145957201719284,
      -0.6260379552841187,
      0.1821458339691162,
      0.9788119792938232,
      -0.7629547119140625,
      -0.21009661257266998,
      0.22977851331233978,
      -0.259998083114624,
      -0.19817572832107544,
      0.46288901567459106,
      -0.4775547981262207,
      0.17774532735347748,
      -0.1049283891916275,
      0.7619234323501587,
      0.41192883253097534,
      -1.639086127281189,
      -0.26046714186668396,
      -0.4679305851459503,
      -0.03797272965312004,
      1.718522071838379,
      -0.08217242360115051,
      -0.1506541669368744,
      0.5304288268089294,
      0.4628038704395294,
      0.46224838495254517,
      -0.13585029542446136,
      0.2543894052505493,
      0.12452834844589233,
      -0.416533499956131,
      -0.019460560753941536,
      0.20772115886211395,
      0.4335096776485443,
      0.6044927835464478,
      0.7390269041061401,
      0.37110453844070435,
      0.15656211972236633,
      -0.3012196719646454,
      0.05266938731074333,
      0.2015877217054367,
      -0.5847039222717285,
      0.6268011331558228,
      -0.6403400897979736,
      -0.09894783049821854,
      0.09495896100997925,
      0.12492794543504715,
      0.07661939412355423,
      0.28682026267051697,
      -0.10777599364519119,
      0.0772845521569252,
      -1.3835028409957886,
      0.1520264893770218,
      0.5786953568458557,
      -0.7586948275566101,
      -0.30175450444221497,
      0.6027821898460388,
      -0.5985884666442871,
      -0.0739293321967125,
      -0.545428454875946,
      -0.26279109716415405,
      0.7581063508987427,
      0.23552089929580688,
      -1.5049971342086792,
      -0.16404037177562714,
      -0.8717136979103088,
      0.11028438061475754,
      -0.237556591629982,
      -1.4171589612960815,
      -0.3030516505241394,
      0.4994281530380249,
      -0.14652693271636963,
      0.005599433556199074,
      0.7701489925384521,
      1.0114688873291016,
      -0.24218027293682098,
      0.2779458165168762,
      1.2947486639022827,
      -0.27974042296409607,
      -0.2579506039619446,
      -0.3498603105545044,
      -0.3438800573348999,
      0.5927337408065796,
      0.8614195585250854,
      0.7789359092712402,
      -1.0863264799118042,
      -0.18956123292446136,
      -1.0197672843933105,
      0.2997000515460968,
      -0.8634345531463623,
      0.22979938983917236,
      -0.9829485416412354,
      -0.6884799003601074,
      -0.8283286094665527,
      -0.3872254192829132,
      -0.3160048723220825,
      -0.8761541843414307,
      -0.4574396312236786,
      1.5459235906600952,
      -0.14889870584011078,
      -0.48405468463897705,
      -0.6779032349586487,
      -0.6771579384803772,
      0.3310442268848419,
      0.08923468738794327,
      0.5067474246025085,
      -0.3560238182544708,
      -1.5927916765213013,
      0.544983983039856,
      0.2940613329410553,
      -0.4787925183773041,
      0.15570004284381866,
      0.7407357692718506,
      0.08763596415519714,
      -0.5268256068229675,
      -0.42438963055610657,
      0.1987348347902298,
      -1.1588932275772095,
      -0.29814237356185913,
      0.6613572835922241,
      0.08793353289365768,
      1.0461695194244385,
      -0.08669033646583557,
      -0.8840498328208923,
      0.06261511892080307,
      -0.5211657881736755,
      -0.7566894888877869,
      -0.2705334424972534,
      1.2788901329040527,
      -0.2735486924648285,
      0.48962661623954773,
      -0.8138669729232788,
      -0.0811665877699852,
      0.541529655456543,
      -0.6849454641342163,
      -1.2696785926818848,
      -0.048718128353357315,
      0.8381689190864563,
      1.1820526123046875,
      -1.1378306150436401,
      0.09679372608661652,
      0.8188508749008179,
      -0.5735977292060852,
      0.2611996829509735,
      -0.1343867927789688,
      0.34928131103515625,
      1.2775700092315674,
      0.051046617329120636,
      -0.28532224893569946,
      0.19089889526367188,
      0.118487648665905,
      -0.793163537979126,
      1.0484037399291992,
      -0.49709010124206543,
      0.49453628063201904,
      -0.22337432205677032,
      0.07136842608451843,
      -0.9604828357696533,
      1.0808357000350952,
      -1.0342034101486206,
      0.1424991935491562,
      -0.39956027269363403,
      -0.6844828724861145,
      -0.09155379235744476,
      0.35445636510849,
      0.6662172079086304,
      -1.3976632356643677,
      0.09307511895895004,
      -1.1763559579849243,
      0.4419578015804291,
      -0.884585440158844,
      1.2867333889007568,
      -0.24634447693824768,
      0.8852589130401611,
      0.4539501965045929,
      1.3084923028945923,
      0.29810574650764465,
      0.23314636945724487,
      -0.33148685097694397,
      0.6772685050964355,
      0.02832312323153019,
      -1.4396402835845947,
      1.1447806358337402,
      1.0459136962890625,
      -0.21860569715499878,
      -0.04067898914217949,
      1.0983216762542725,
      1.166582465171814,
      -0.38546690344810486,
      -0.5648194551467896,
      0.5321672558784485,
      -0.29337310791015625,
      0.03544732183218002,
      -0.7236916422843933,
      -0.8155092000961304,
      -0.24068336188793182,
      0.09913094341754913,
      -0.12120206654071808,
      -0.7469935417175293,
      -0.46073976159095764,
      0.3523387014865875,
      0.21313117444515228,
      -0.2192130833864212,
      0.5160722732543945,
      -0.2422368973493576,
      -1.036238431930542,
      0.21918632090091705,
      0.4754832684993744,
      -0.03186347335577011,
      0.927411675453186,
      0.3359898328781128,
      -0.04001104086637497,
      1.0604031085968018,
      0.8984771370887756,
      0.39886215329170227,
      -0.31863081455230713,
      0.9208798408508301,
      0.2727561295032501,
      1.053510308265686,
      0.34523385763168335,
      0.22525916993618011,
      -1.3034758567810059,
      0.15744471549987793,
      -1.0863659381866455,
      -0.17987653613090515,
      -0.3663266897201538,
      0.43167969584465027,
      -0.12496010214090347,
      0.2510015070438385,
      -0.16179747879505157,
      -0.508449375629425,
      0.7037019729614258,
      0.12408225238323212,
      -0.771234393119812,
      0.2887089252471924,
      0.7155916690826416,
      0.2368236631155014,
      -0.31932389736175537,
      0.22901417315006256,
      0.3176824748516083,
      -0.05180612578988075,
      -0.15832100808620453,
      -0.29969167709350586,
      0.16763213276863098,
      -0.2993512451648712,
      -0.32815155386924744,
      -0.030199479311704636,
      0.0022724138107150793,
      -0.7577483654022217,
      1.0814210176467896,
      0.07124005258083344,
      0.6075750589370728,
      -0.49571120738983154,
      -0.5868270397186279,
      -0.28539106249809265,
      -0.6469331383705139,
      -0.2752757966518402,
      -0.7019777894020081,
      -1.399827003479004,
      0.28361091017723083,
      -0.23099757730960846,
      -0.8110095262527466,
      0.20014436542987823,
      -0.29407551884651184,
      -0.3764050006866455,
      0.2868897616863251,
      -0.8982900381088257,
      -0.2732114791870117,
      -1.694661259651184,
      1.209793210029602,
      -0.21362178027629852,
      -0.019243160262703896,
      -0.6297614574432373,
      -0.7042842507362366,
      -1.0579935312271118,
      -0.6045043468475342,
      -0.8075031638145447,
      0.5250039100646973,
      0.2607671022415161,
      -0.17070376873016357,
      -0.5451831221580505,
      -0.10564618557691574,
      -1.0496270656585693,
      1.3591035604476929,
      0.0030393803026527166,
      -0.16659364104270935,
      -0.039908770471811295,
      -0.2298073023557663,
      -0.5248384475708008,
      0.0831465795636177,
      -0.7314112186431885,
      0.22986449301242828,
      -0.17499412596225739,
      0.9954004883766174,
      1.0777193307876587,
      -0.28292834758758545,
      0.4635142683982849,
      -0.594005823135376,
      0.5308683514595032,
      0.15379643440246582,
      0.1924106776714325,
      -0.6934226155281067,
      0.1339823603630066,
      -0.14482080936431885
    ],
    "label": {
      "level1": "SAM",
      "level2": "DT",
      "level3": "MT",
      "leafContractCategory": "MT",
      "rootCause": "Unacceptable Input Type",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category):\n\nSAM (Single API Method): The issue originates from a single API method, Conv1D, being used incorrectly.\nLevel 2:\n\nDT (Data Type): The error is due to an incorrect data shape being passed to Conv1D, leading to a dimensionality mismatch.\nLevel 3 (Hybrid Patterns):\n\nMT (Machine Learning Type): The issue involves the structure of input data for a machine learning model, specifically for 1D convolutions.\nLeaf Contract Category:\n\nMT (Machine Learning Type): The error is due to improper handling of machine learning-specific data shapes.\nRoot Cause:\n\nUnacceptable Input Type: The input tensor shape (569, 30) does not match the expected 3D shape for Conv1D, causing the function to raise an error.\nEffect:\n\nCrash: The model fails to compile due to the input shape mismatch, causing a ValueError.\nML Library:\n\nKeras: The issue is specific to Keras' Conv1D layer.\nContract Violation Location:\n\nModel Construction: The error happens at model construction when defining input layers.\nDetection Technique:\n\nStatic: The issue can be identified through static analysis by checking the shape requirements for Conv1D."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/45930844",
    "title": "",
    "question": "8\n\nI am trying to create my first ensemble models in keras. I have 3 input values and a single output value in my dataset.\n\nfrom keras.optimizers import SGD,Adam\nfrom keras.layers import Dense,Merge\nfrom keras.models import Sequential\n\nmodel1 = Sequential()\nmodel1.add(Dense(3, input_dim=3, activation='relu'))\nmodel1.add(Dense(2, activation='relu'))\nmodel1.add(Dense(2, activation='tanh'))\nmodel1.compile(loss='mse', optimizer='Adam', metrics=['accuracy'])\n\nmodel2 = Sequential()\nmodel2.add(Dense(3, input_dim=3, activation='linear'))\nmodel2.add(Dense(4, activation='tanh'))\nmodel2.add(Dense(3, activation='tanh'))\nmodel2.compile(loss='mse', optimizer='SGD', metrics=['accuracy'])\n\nmodel3 = Sequential()\nmodel3.add(Merge([model1, model2], mode = 'concat'))\nmodel3.add(Dense(1, activation='sigmoid'))\nmodel3.compile(loss='binary_crossentropy', optimizer='Adam', metrics=['accuracy'])\n\nmodel3.input_shape\nThe ensemble model(model3) compiles without any error but while fitting the model I have to pass the same input two times model3.fit([X,X],y). Which I think is an unnecessary step and instead of passing input twice I want to have a common input nodes for my ensemble model. How can I do it?",
    "answer": "7\n\nKeras functional API seems to be a better fit for your use case, as it allows more flexibility in the computation graph. e.g.:\n\nfrom keras.layers import concatenate\nfrom keras.models import Model\nfrom keras.layers import Input, Merge\nfrom keras.layers.core import Dense\nfrom keras.layers.merge import concatenate\n\n# a single input layer\ninputs = Input(shape=(3,))\n\n# model 1\nx1 = Dense(3, activation='relu')(inputs)\nx1 = Dense(2, activation='relu')(x1)\nx1 = Dense(2, activation='tanh')(x1)\n\n# model 2 \nx2 = Dense(3, activation='linear')(inputs)\nx2 = Dense(4, activation='tanh')(x2)\nx2 = Dense(3, activation='tanh')(x2)\n\n# merging models\nx3 = concatenate([x1, x2])\n\n# output layer\npredictions = Dense(1, activation='sigmoid')(x3)\n\n# generate a model from the layers above\nmodel = Model(inputs=inputs, outputs=predictions)\nmodel.compile(optimizer='adam',\n              loss='binary_crossentropy',\n              metrics=['accuracy'])\n\n# Always a good idea to verify it looks as you expect it to \n# model.summary()\n\ndata = [[1,2,3], [1,1,3], [7,8,9], [5,8,10]]\nlabels = [0,0,1,1]\n\n# The resulting model can be fit with a single input:\nmodel.fit(data, labels, epochs=50)\nNotes:\n\nThere might be slight differences in the API between Keras versions (pre- and post- version 2)\nThe example above specifies different optimizer and loss function for each of the models. However, since fit() is being called only once (on model3), the same settings - those of model3 - will apply to the entire model. In order to have different settings when training the sub-models, they will have to be fit() separately - see comment by @Daniel.\nEDIT: updated notes based on comments",
    "mlApiName": " keras.models.Model,keras.layers.merge.concatenate",
    "embedding": [
      -0.4478308856487274,
      0.20904000103473663,
      -2.5582854747772217,
      -1.2276356220245361,
      1.0221329927444458,
      -0.5481796860694885,
      0.17222994565963745,
      0.4855642020702362,
      -1.1752773523330688,
      -0.1847544014453888,
      -0.696535587310791,
      0.7195428013801575,
      1.8561371564865112,
      0.8312487006187439,
      -0.5707798600196838,
      -0.22606602311134338,
      0.43560755252838135,
      0.8719426393508911,
      -0.009725754149258137,
      1.1765419244766235,
      -1.0685440301895142,
      -0.6507405638694763,
      0.2949727475643158,
      -0.6124392151832581,
      0.8492826819419861,
      0.3108888268470764,
      -0.5832115411758423,
      0.5920916795730591,
      -0.37015727162361145,
      0.30249467492103577,
      0.7551432251930237,
      -0.16269990801811218,
      0.1676550656557083,
      -1.072540283203125,
      -1.232376217842102,
      -0.563508152961731,
      0.9251375198364258,
      -0.13746120035648346,
      -0.07750502228736877,
      -0.3508100211620331,
      1.2718298435211182,
      0.6665845513343811,
      0.10993268340826035,
      0.06939906626939774,
      0.32339608669281006,
      -0.6221450567245483,
      2.1591503620147705,
      -0.24597638845443726,
      0.7293081879615784,
      -1.2381783723831177,
      0.11486707627773285,
      1.054295539855957,
      -0.11216682940721512,
      0.21867932379245758,
      1.224455714225769,
      0.6111604571342468,
      -0.02752077952027321,
      0.6931748390197754,
      1.30875825881958,
      -1.0319585800170898,
      0.08324085175991058,
      0.3063494563102722,
      -1.638230800628662,
      1.789454460144043,
      0.6959018707275391,
      -0.3014870285987854,
      -0.5863003730773926,
      1.716819405555725,
      -0.002225142903625965,
      -0.373605340719223,
      0.19293642044067383,
      0.45888400077819824,
      0.6347273588180542,
      -0.09827729314565659,
      -0.18930506706237793,
      -0.17664894461631775,
      -0.438241183757782,
      -0.5645087361335754,
      -0.26821640133857727,
      0.5547497868537903,
      -0.07360988855361938,
      0.774379551410675,
      1.2433807849884033,
      -0.516306459903717,
      0.1939983069896698,
      0.07977388054132462,
      -0.6880877017974854,
      -0.6186368465423584,
      -1.1392031908035278,
      1.0996532440185547,
      0.013204718008637428,
      -0.5345044136047363,
      0.8590682148933411,
      0.8922074437141418,
      -0.6774817705154419,
      -0.31669193506240845,
      -0.46373286843299866,
      0.6904239654541016,
      -0.4591025114059448,
      -0.36235418915748596,
      -0.29358646273612976,
      0.3294951915740967,
      -0.4541997015476227,
      -0.8688866496086121,
      -0.21610350906848907,
      1.07552170753479,
      0.32429978251457214,
      -0.2490781992673874,
      0.3582044839859009,
      -0.39707162976264954,
      -1.1185799837112427,
      -0.07901525497436523,
      0.13248175382614136,
      -0.3510342538356781,
      -0.5469297766685486,
      -0.33762070536613464,
      -0.020752079784870148,
      -0.60748291015625,
      0.5331203937530518,
      -0.41283977031707764,
      0.3553352355957031,
      -0.9091992974281311,
      0.3268567621707916,
      -0.5129064321517944,
      -0.1977209448814392,
      0.8426066040992737,
      -0.3027677536010742,
      0.2952018678188324,
      -0.5692856311798096,
      -1.4001301527023315,
      0.16249048709869385,
      -0.23286056518554688,
      -0.08931983262300491,
      0.33027300238609314,
      0.7281477451324463,
      0.9125806093215942,
      -1.0737577676773071,
      -0.8728796243667603,
      0.13290315866470337,
      0.43997180461883545,
      0.4508938193321228,
      0.09537350386381149,
      -0.2737515866756439,
      -1.4374765157699585,
      0.21761003136634827,
      -1.0418981313705444,
      0.19669823348522186,
      -0.8337187767028809,
      -1.4405182600021362,
      0.3509702682495117,
      0.3038395941257477,
      0.2915774881839752,
      -0.8471366763114929,
      0.8320448994636536,
      0.08141607791185379,
      -0.638635516166687,
      0.33986228704452515,
      0.1796165555715561,
      0.3196207284927368,
      -0.2398521602153778,
      0.6987860798835754,
      -0.33705732226371765,
      -0.487355500459671,
      0.44171231985092163,
      -0.08494924753904343,
      -0.26155635714530945,
      0.3074892461299896,
      0.23195672035217285,
      0.272542268037796,
      0.35745862126350403,
      -0.7020770907402039,
      -1.1079151630401611,
      -0.422853022813797,
      0.3062782287597656,
      0.06150458753108978,
      0.8704706430435181,
      1.4333100318908691,
      -1.0118831396102905,
      0.39037683606147766,
      0.2810712158679962,
      1.0889570713043213,
      0.42681771516799927,
      0.34810176491737366,
      -0.26854079961776733,
      0.10936637967824936,
      0.032127078622579575,
      -0.05738287419080734,
      0.4275994598865509,
      0.09107735753059387,
      -0.5619574189186096,
      1.0804262161254883,
      -0.06832864135503769,
      -0.13311871886253357,
      -0.42878979444503784,
      -0.06561940163373947,
      -0.006562156602740288,
      0.8396385312080383,
      -0.8219285607337952,
      0.7984198331832886,
      -0.04999633505940437,
      -0.0326269157230854,
      -0.01993030682206154,
      -0.4024466574192047,
      0.7301245927810669,
      -0.5961877107620239,
      1.8823294639587402,
      -0.2884959876537323,
      1.0679309368133545,
      -0.1564861685037613,
      0.2930041253566742,
      0.1107330322265625,
      -0.34978076815605164,
      0.4292531907558441,
      0.277809739112854,
      -0.22993823885917664,
      -0.752030074596405,
      0.463023841381073,
      -0.33578935265541077,
      -0.26452603936195374,
      0.38028743863105774,
      -0.032090865075588226,
      -0.3080209791660309,
      0.9093037843704224,
      0.16924692690372467,
      0.4490472674369812,
      -1.013157606124878,
      0.36902880668640137,
      0.029403328895568848,
      -1.1272860765457153,
      -0.40064433217048645,
      -0.4030750095844269,
      -0.7249388694763184,
      0.7128791213035583,
      -0.6326866149902344,
      -0.26963236927986145,
      1.0355453491210938,
      0.8827617168426514,
      0.9097251892089844,
      -0.8424240350723267,
      0.1128876805305481,
      0.623214840888977,
      0.5183513760566711,
      0.06954125314950943,
      -0.360018253326416,
      -0.7328664064407349,
      0.08197461813688278,
      -0.3506092429161072,
      -0.3271534740924835,
      0.45115163922309875,
      0.943225085735321,
      -0.22758200764656067,
      0.5016723275184631,
      -0.20985208451747894,
      0.05749446898698807,
      0.961844801902771,
      -1.1450133323669434,
      -0.17760813236236572,
      0.034756168723106384,
      0.8286132216453552,
      -0.2914856970310211,
      0.2609593868255615,
      0.3934205174446106,
      -0.3479423224925995,
      -0.18425185978412628,
      -0.5871241092681885,
      -1.1425126791000366,
      0.11217711865901947,
      -0.7253305315971375,
      0.10506629943847656,
      -0.43566471338272095,
      -0.4504220187664032,
      -0.022112689912319183,
      0.7134648561477661,
      0.7097601890563965,
      0.7264209389686584,
      0.5784366130828857,
      -0.2175016552209854,
      -0.5512213706970215,
      -0.05182632431387901,
      -0.1798904687166214,
      -0.7225900888442993,
      -1.1377164125442505,
      -0.5290284156799316,
      0.36776095628738403,
      -0.638824999332428,
      0.061023760586977005,
      0.09880456328392029,
      0.6225349307060242,
      0.31717589497566223,
      0.7996566891670227,
      -0.23594637215137482,
      0.17197614908218384,
      0.4514717161655426,
      0.06472288817167282,
      0.07161195576190948,
      0.48854750394821167,
      1.0776227712631226,
      -0.5660574436187744,
      0.14004741609096527,
      -0.48151785135269165,
      0.37887048721313477,
      1.1410599946975708,
      1.143772840499878,
      0.6420033574104309,
      0.8248938918113708,
      0.16016682982444763,
      -0.3373272120952606,
      0.027164900675415993,
      0.41545864939689636,
      -0.5204007029533386,
      -0.2885785400867462,
      -0.4478083848953247,
      -0.609061062335968,
      0.9208916425704956,
      -0.23408356308937073,
      -0.09642709791660309,
      0.1899447739124298,
      0.33595865964889526,
      0.31914040446281433,
      -0.8794511556625366,
      -0.06478431820869446,
      -0.537307858467102,
      0.35732561349868774,
      -0.2999264597892761,
      -0.017942698672413826,
      0.9060731530189514,
      -0.4635588228702545,
      -0.08779459446668625,
      0.2255098670721054,
      -0.5684403777122498,
      0.47552192211151123,
      0.6443779468536377,
      0.20991267263889313,
      -1.2949309349060059,
      -1.1079713106155396,
      -0.4845868647098541,
      0.20753370225429535,
      -0.3407743275165558,
      0.18219304084777832,
      1.451372742652893,
      -0.5306587815284729,
      0.011023793369531631,
      0.3003545105457306,
      -0.5895190238952637,
      -0.4253878891468048,
      -0.03557250648736954,
      -0.5205220580101013,
      -0.8059802055358887,
      0.9083550572395325,
      -0.0055346377193927765,
      -0.6501838564872742,
      0.09977085888385773,
      0.043986428529024124,
      -0.703925371170044,
      -0.2625071406364441,
      -0.615239679813385,
      0.6126769185066223,
      -0.07702912390232086,
      0.21548569202423096,
      0.955062985420227,
      1.023066520690918,
      -0.46488434076309204,
      -0.17543606460094452,
      -0.5379421710968018,
      0.1041628047823906,
      0.13103841245174408,
      1.434428334236145,
      0.029331449419260025,
      1.4316625595092773,
      -0.06202686205506325,
      -0.3411731719970703,
      -0.535169780254364,
      -0.9130815863609314,
      0.2905581593513489,
      0.019384367391467094,
      -0.22149400413036346,
      -0.624583899974823,
      0.5861291885375977,
      -0.24401363730430603,
      0.38128507137298584,
      0.7473536729812622,
      -0.3659714162349701,
      0.17457635700702667,
      0.3837137520313263,
      0.4760781228542328,
      0.5154066681861877,
      0.590779185295105,
      -0.41575247049331665,
      -0.460546612739563,
      1.0610129833221436,
      0.23819343745708466,
      -0.2608279883861542,
      -0.7643439173698425,
      -0.2998446524143219,
      0.8837551474571228,
      -0.524795413017273,
      0.7028485536575317,
      0.1304449588060379,
      -0.6809754371643066,
      1.0997613668441772,
      -1.109207272529602,
      -0.6215329170227051,
      -0.46036097407341003,
      -0.5266647338867188,
      -0.3180604875087738,
      -0.46992722153663635,
      -0.04576166346669197,
      -0.4717302918434143,
      -0.18878759443759918,
      0.5925454497337341,
      0.0889296755194664,
      0.7079026103019714,
      -0.06628891080617905,
      -1.0051321983337402,
      0.48708051443099976,
      0.07583137601613998,
      0.6248636841773987,
      0.6777101755142212,
      -0.6845473647117615,
      -0.7978338003158569,
      -0.9753251671791077,
      1.1638987064361572,
      -0.4265255033969879,
      0.15058031678199768,
      1.0979846715927124,
      0.47706979513168335,
      1.1760666370391846,
      1.111448049545288,
      0.040616270154714584,
      -1.7186450958251953,
      0.6755138039588928,
      0.4835590422153473,
      0.7401067018508911,
      -0.6352192759513855,
      -0.5966135263442993,
      -0.16505438089370728,
      -0.17241710424423218,
      0.7740553021430969,
      -0.709290623664856,
      0.7290040254592896,
      0.8316047191619873,
      -0.5647872686386108,
      -0.9884617328643799,
      -0.6737383604049683,
      0.39922139048576355,
      0.4440305829048157,
      0.8683757185935974,
      -0.7917152047157288,
      -1.3402752876281738,
      0.8170743584632874,
      0.08594004064798355,
      0.11620283871889114,
      0.498518168926239,
      0.8256001472473145,
      1.5651116371154785,
      0.5940161347389221,
      0.0934540405869484,
      0.18570905923843384,
      0.1741807907819748,
      0.3759637176990509,
      0.33056968450546265,
      0.6946911215782166,
      -0.8117733597755432,
      0.14198090136051178,
      0.17442642152309418,
      -1.1459956169128418,
      -0.5110471248626709,
      -0.27230599522590637,
      0.43056660890579224,
      0.5665180683135986,
      -0.22190070152282715,
      -0.1708315759897232,
      0.382880300283432,
      -0.2999029755592346,
      0.023755982518196106,
      -0.02993755228817463,
      0.014205442741513252,
      -0.05034926161170006,
      0.5376421809196472,
      0.7101280689239502,
      0.19435001909732819,
      -1.7655248641967773,
      -0.38472288846969604,
      -0.5454472303390503,
      -0.10162314027547836,
      1.320236086845398,
      0.6096672415733337,
      -0.4590781033039093,
      0.6965919137001038,
      -0.318665474653244,
      0.4463694095611572,
      0.1830500215291977,
      0.4258373975753784,
      -0.19776128232479095,
      0.01838579773902893,
      -0.12654156982898712,
      0.34931042790412903,
      0.5798173546791077,
      0.5903201699256897,
      0.14478278160095215,
      0.07408908009529114,
      0.4942205548286438,
      -0.40468811988830566,
      0.44513407349586487,
      0.32563862204551697,
      -0.31088635325431824,
      0.44826996326446533,
      -0.9268723130226135,
      0.25868096947669983,
      0.43394675850868225,
      0.15715794265270233,
      -0.15969133377075195,
      0.012688133865594864,
      0.15551957488059998,
      0.037560027092695236,
      -0.82362300157547,
      0.2633574604988098,
      0.09171728044748306,
      -0.42960304021835327,
      -0.5374096035957336,
      0.6796102523803711,
      -0.2590586841106415,
      -0.923943042755127,
      -0.2934567630290985,
      -0.41200321912765503,
      0.42427632212638855,
      -0.16002920269966125,
      -1.4808375835418701,
      -0.01086529903113842,
      -0.3828146457672119,
      0.21746832132339478,
      0.29135751724243164,
      -1.3925559520721436,
      0.6590622067451477,
      0.9208600521087646,
      -0.16541944444179535,
      -0.7260981202125549,
      0.6346761584281921,
      0.5963225960731506,
      -0.2918485999107361,
      0.09042733907699585,
      0.8169094920158386,
      0.18787118792533875,
      -0.4712810814380646,
      -0.555681586265564,
      0.5066573619842529,
      0.4879181981086731,
      0.7193022966384888,
      0.7130162119865417,
      -0.6924617290496826,
      0.07514999061822891,
      -1.4434534311294556,
      0.6122183203697205,
      -1.239167332649231,
      0.7713183164596558,
      -0.8049424886703491,
      -0.6443844437599182,
      -0.8916081190109253,
      -0.20841562747955322,
      -0.04245661199092865,
      -0.9143174886703491,
      -0.3111887574195862,
      1.5849848985671997,
      -0.017876707017421722,
      -0.5283081531524658,
      -1.0125303268432617,
      -0.6568697690963745,
      0.8983489274978638,
      -0.043390605598688126,
      0.42749857902526855,
      0.22365052998065948,
      -2.3594069480895996,
      0.517264187335968,
      0.6926372647285461,
      -0.3659144639968872,
      0.17062392830848694,
      0.9435843825340271,
      -0.013660045340657234,
      -0.2950408458709717,
      -0.8860383033752441,
      0.49348679184913635,
      -1.653243064880371,
      -0.20632751286029816,
      0.29987508058547974,
      -0.2640542685985565,
      1.355268955230713,
      -0.05035092681646347,
      -0.22804191708564758,
      0.08531710505485535,
      0.011197310872375965,
      -0.7125138640403748,
      -0.511292576789856,
      1.3663263320922852,
      -0.24335353076457977,
      0.5353590250015259,
      -0.15603426098823547,
      -0.014769305475056171,
      0.9998982548713684,
      -0.37259262800216675,
      -1.1018586158752441,
      -0.44753384590148926,
      0.599733293056488,
      1.495737075805664,
      -1.2279722690582275,
      0.12329176813364029,
      1.2277897596359253,
      -0.7097924947738647,
      -0.3977716267108917,
      -0.48249757289886475,
      0.45052120089530945,
      0.18295806646347046,
      -0.4635893404483795,
      0.21287581324577332,
      0.09717652201652527,
      0.3916839063167572,
      -0.6018107533454895,
      0.6006007194519043,
      -0.2180561125278473,
      -0.019269675016403198,
      -0.2636910676956177,
      -0.14917607605457306,
      -1.313477873802185,
      0.7873566150665283,
      -0.8592601418495178,
      -0.11053400486707687,
      -0.5138363838195801,
      -0.45084479451179504,
      -0.6623827219009399,
      0.507064163684845,
      0.1869610995054245,
      -0.8787217736244202,
      0.07441536337137222,
      -1.1641250848770142,
      0.1307234764099121,
      -1.4035530090332031,
      1.3885390758514404,
      -0.5512549877166748,
      0.45410993695259094,
      0.28712454438209534,
      1.2660789489746094,
      0.27868059277534485,
      0.46685534715652466,
      -0.11893904209136963,
      0.8571849465370178,
      0.3947398364543915,
      -0.8239507079124451,
      1.2122843265533447,
      0.4375726580619812,
      0.11205940693616867,
      -0.26651090383529663,
      0.6712769269943237,
      0.5980507135391235,
      0.034316081553697586,
      0.06817261129617691,
      0.9350458979606628,
      -0.02911723591387272,
      0.14065958559513092,
      -0.16976960003376007,
      -0.6261270046234131,
      0.3456795811653137,
      -0.16357043385505676,
      -0.5265220999717712,
      -0.8676580190658569,
      0.20725147426128387,
      0.6554203033447266,
      -0.05069044232368469,
      0.26005232334136963,
      -0.01860831119120121,
      -0.5309452414512634,
      -1.423046350479126,
      0.5138108730316162,
      0.18238157033920288,
      0.06086992099881172,
      0.42664238810539246,
      0.29393598437309265,
      -0.6759088635444641,
      1.013487696647644,
      1.0666601657867432,
      0.5449087619781494,
      0.16564881801605225,
      0.760395884513855,
      -0.07030699402093887,
      0.8999002575874329,
      0.37226876616477966,
      0.6622005701065063,
      -0.9745420217514038,
      0.13788364827632904,
      -0.7827624082565308,
      -0.24432246387004852,
      -0.7868967056274414,
      0.09870404750108719,
      -0.3119426965713501,
      -0.006410431116819382,
      0.2068583369255066,
      -1.1324464082717896,
      1.2379400730133057,
      0.30559492111206055,
      -1.0409597158432007,
      0.42615824937820435,
      1.129456639289856,
      0.30010637640953064,
      -0.6261653900146484,
      0.1787574738264084,
      0.1779794991016388,
      -0.3203126788139343,
      0.09454452991485596,
      0.11948733776807785,
      0.10724399238824844,
      -0.3234802186489105,
      -0.7542840838432312,
      -0.4363727569580078,
      0.258306086063385,
      -1.0493296384811401,
      0.9715524911880493,
      -0.2250949740409851,
      0.1304119974374771,
      -0.04144877567887306,
      -0.5285232663154602,
      -0.756780207157135,
      0.398659348487854,
      -0.30761536955833435,
      -0.30982717871665955,
      -1.1211615800857544,
      0.5010462999343872,
      -0.8875425457954407,
      -0.9527148008346558,
      -0.09637084603309631,
      -0.5588168501853943,
      -0.2993399500846863,
      0.14479371905326843,
      -0.8996254205703735,
      -0.28848204016685486,
      -1.970676302909851,
      1.2877999544143677,
      -0.14369361102581024,
      0.2767696976661682,
      -0.8957807421684265,
      -0.1033003181219101,
      -0.9202529191970825,
      -0.07688843458890915,
      -1.345384120941162,
      0.43981799483299255,
      0.17195703089237213,
      -0.025310389697551727,
      -0.6935142874717712,
      -0.46350449323654175,
      -1.307043433189392,
      1.2127935886383057,
      0.5605977773666382,
      -0.1610553115606308,
      -0.08032748848199844,
      -0.4360019862651825,
      -0.5190168619155884,
      0.15772409737110138,
      0.14013437926769257,
      0.014547109603881836,
      0.18597283959388733,
      1.5408000946044922,
      0.9577766060829163,
      0.6317212581634521,
      -0.19376172125339508,
      -0.6812615990638733,
      -0.13787248730659485,
      0.3300880491733551,
      0.4344189167022705,
      -0.4651466906070709,
      0.39031466841697693,
      -0.47787579894065857
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SL",
      "level3": "F",
      "leafContractCategory": "AMO(Level-2)",
      "rootCause": "Missing Options",
      "effect": "Unknown",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): Hybrid\nThe issue arises from multiple API interactions (Model, Merge, concatenate), leading to a hybrid contract violation.\n\nLevel 2: SL (Selection Issue)\nThe user incorrectly selects Merge instead of using the Keras functional API, which is better suited for ensemble models.\n\nLevel 3 (Hybrid Patterns): F (Eventually Constraint)\nThe problem involves model structure dependencies, where a proper computational graph should eventually be defined before calling fit.\n\nLeaf Contract Category: AMO (Level-2)\nThe issue stems from improper ordering of API calls, requiring the correct definition of model inputs before merging.\n\nRoot Cause: Missing Options\nThe problem arises because an appropriate API method (concatenate from Keras functional API) was not used, leading to unnecessary duplication of inputs.\n\nEffect: Unknown\nThe code does not crash but results in inefficient behavior (unnecessary duplicated inputs), which may lead to unpredictable outcomes.\n\nML Library: Keras\nThe violation specifically pertains to Keras' model-building process.\n\nContract Violation Location: Model Construction\nThe error occurs while constructing the ensemble model, before training.\n\nDetection Technique: Static\nThe incorrect API usage can be identified through static analysis by checking for improper model merging patterns."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/49834380",
    "title": "",
    "question": "12\n\nI have CNN models trained using Keras with Tensorflow backend. And I want to visualize my CNN filters with this tutorial: https://blog.keras.io/how-convolutional-neural-networks-see-the-world.html\n\nfrom keras import backend as K\nfrom keras.models import load_model\nimport numpy as np\n\nmodel = load_model('my_cnn_model.h5')\ninput_img = np.load('my_picture.npy')\n\n# get the symbolic outputs of each \"key\" layer (we gave them unique names).\nlayer_dict = dict([(layer.name, layer) for layer in model.layers])\n\nlayer_name = 'block5_conv3'\nfilter_index = 0  # can be any integer from 0 to 511, as there are 512 filters in that layer\n\n# build a loss function that maximizes the activation\n# of the nth filter of the layer considered\nlayer_output = layer_dict[layer_name].output\nloss = K.mean(layer_output[:, :, :, filter_index])\n\n# compute the gradient of the input picture wrt this loss\ngrads = K.gradients(loss, input_img)[0]\n\n# normalization trick: we normalize the gradient\ngrads /= (K.sqrt(K.mean(K.square(grads))) + 1e-5)\n\n# this function returns the loss and grads given the input picture\niterate = K.function([input_img], [loss, grads])\nHowever, when the code execute to this line:\ngrads = K.gradients(loss, input_img)[0]\nI found it returns nothing but None object, so the program fail to progress after that.\n\nI search for some solution. Some people say theinput_img should be tensorflow's Tensor type: https://github.com/keras-team/keras/issues/5455\n\nBut when I tried to convert the img to Tensor, the problem is still exist.\nI tried the solution in the link above, but still fail.\n\nThere is also someone say that this problem exists because your CNN model is not differentiable. https://github.com/keras-team/keras/issues/8478\n\nBut my model use only the activate function of ReLU and Sigmoid(at output layer). Is this problem really caused by nondifferentiable problem?\n\nCan anyone help me? Thank you very much!",
    "answer": "12\n\nIf you have a Model instance, then to take the gradient of the loss with respect to the input, you should do:\n\ngrads = K.gradients(loss, model.input)[0]\nmodel.input contains the symbolic tensor that represents the input to the model. Using a plain numpy array makes no sense because TensorFlow then has no idea how this connects to the computational graph, and returns None as the gradient.\n\nThen you should also rewrite the iterate function as:\n\niterate = K.function([model.input], [loss, grads])",
    "mlApiName": "keras.backend.function, keras.backend.gradients",
    "embedding": [
      0.23586638271808624,
      0.9444164633750916,
      -2.3573496341705322,
      -1.4082260131835938,
      1.6005535125732422,
      -0.3273240029811859,
      1.6732755899429321,
      0.3628043830394745,
      -0.5997744202613831,
      -0.32166701555252075,
      -0.5595493316650391,
      1.0179084539413452,
      2.431687831878662,
      0.9087562561035156,
      -0.7523416876792908,
      -0.23020663857460022,
      0.31064993143081665,
      -0.08372203260660172,
      -0.07948482036590576,
      0.9447264075279236,
      -0.6789703369140625,
      0.47506898641586304,
      0.2865995466709137,
      -0.3461224138736725,
      1.7531461715698242,
      0.6255739331245422,
      -0.5261106491088867,
      0.22364738583564758,
      -0.806382954120636,
      0.7844700813293457,
      1.0611273050308228,
      -0.5256628394126892,
      -0.6555373668670654,
      -0.9157190918922424,
      -0.6656880974769592,
      0.08141280710697174,
      1.4479897022247314,
      0.11404137313365936,
      0.6699250936508179,
      -0.14444643259048462,
      0.7666300535202026,
      0.2566983103752136,
      -0.10992740839719772,
      0.3424159586429596,
      -0.18442481756210327,
      -0.19498857855796814,
      0.739935576915741,
      0.17958058416843414,
      0.20428286492824554,
      -0.9129563570022583,
      0.39644956588745117,
      1.1818726062774658,
      -0.15898099541664124,
      -0.023085927590727806,
      0.554911196231842,
      0.01720801368355751,
      0.09184367954730988,
      0.6028944849967957,
      0.8600127100944519,
      -0.7570742964744568,
      0.4991191327571869,
      2.0145833492279053,
      -1.0204440355300903,
      1.0068354606628418,
      0.46207618713378906,
      -0.5624566078186035,
      -1.1674646139144897,
      0.6080687642097473,
      -0.7297186851501465,
      0.1791422963142395,
      -0.018226033076643944,
      0.1253347247838974,
      -0.1632622629404068,
      1.0323213338851929,
      -0.5835975408554077,
      -0.07367485016584396,
      -0.09813286364078522,
      -0.28950536251068115,
      -0.24486267566680908,
      0.2753736674785614,
      0.06658121198415756,
      0.9965362548828125,
      1.0771766901016235,
      -0.1091688796877861,
      0.5726492404937744,
      0.02686460316181183,
      -0.8182669281959534,
      -0.5165441036224365,
      -0.7549692392349243,
      1.565062403678894,
      -0.6054931879043579,
      -0.17669129371643066,
      0.5600436329841614,
      1.1562799215316772,
      -0.7875980734825134,
      -0.6503220796585083,
      -0.41457948088645935,
      0.3877822458744049,
      -0.7267173528671265,
      -0.45804521441459656,
      -0.37981757521629333,
      0.2520434558391571,
      -0.020260969176888466,
      -0.7098739147186279,
      -0.2159210443496704,
      0.9269775152206421,
      0.7078387141227722,
      0.1122174933552742,
      0.35176676511764526,
      -1.0367528200149536,
      -0.7576603293418884,
      -0.3093150854110718,
      -0.33694127202033997,
      -0.49616050720214844,
      -0.2361879199743271,
      -0.46575093269348145,
      -0.41046342253685,
      -0.5556002259254456,
      0.2638007402420044,
      0.8109036684036255,
      -0.45946961641311646,
      -0.18986237049102783,
      0.538986086845398,
      -0.3265974223613739,
      0.061895422637462616,
      1.189109206199646,
      -0.5212414264678955,
      -0.3453046679496765,
      0.33005964756011963,
      -0.8327943086624146,
      0.2542026937007904,
      -1.007215142250061,
      -0.7812311053276062,
      0.04932282865047455,
      0.426033616065979,
      1.7462928295135498,
      -0.8387163877487183,
      -1.0795260667800903,
      0.36834898591041565,
      0.6423885226249695,
      0.578271746635437,
      -0.225363090634346,
      -0.41087061166763306,
      -0.7161661982536316,
      0.05435372143983841,
      -0.8163347244262695,
      0.5488209128379822,
      -0.7690333724021912,
      -0.2840404212474823,
      -0.6756764650344849,
      0.23014679551124573,
      0.7635974287986755,
      -1.100691318511963,
      0.1327861249446869,
      1.224616289138794,
      -1.6239917278289795,
      0.4593598544597626,
      0.9257194399833679,
      0.09776680916547775,
      -0.5124097466468811,
      1.4409948587417603,
      0.7888644337654114,
      -0.008610065095126629,
      0.8772190809249878,
      -0.38966989517211914,
      -1.2662965059280396,
      0.42273491621017456,
      0.060401055961847305,
      0.19720140099525452,
      0.3129309117794037,
      -0.9092787504196167,
      -0.24151617288589478,
      0.09563369303941727,
      -0.6107418537139893,
      -0.08655483275651932,
      1.1208879947662354,
      1.1331168413162231,
      -0.1432337611913681,
      0.7522361278533936,
      0.12755940854549408,
      0.49642497301101685,
      0.18266993761062622,
      0.7764488458633423,
      -0.5185492038726807,
      -0.37069565057754517,
      0.22755034267902374,
      -0.29168233275413513,
      0.4338891804218292,
      0.5032520890235901,
      -0.9035621285438538,
      1.063202142715454,
      -0.080332912504673,
      -0.5757458806037903,
      -0.722369372844696,
      -0.4142266809940338,
      0.2713654041290283,
      0.07600972056388855,
      -0.6468616724014282,
      1.47604238986969,
      0.45290714502334595,
      0.04540467634797096,
      0.7072880864143372,
      -0.9420632719993591,
      0.6072854399681091,
      -1.1863024234771729,
      0.46601784229278564,
      -0.1747744232416153,
      0.6958521008491516,
      -0.41012659668922424,
      0.12232372909784317,
      -0.4813961088657379,
      -0.1680397093296051,
      0.5901305079460144,
      0.24151569604873657,
      -0.014421050436794758,
      0.04740055277943611,
      0.7753284573554993,
      -0.3311470150947571,
      -0.6324334144592285,
      0.34643977880477905,
      0.6115806698799133,
      -0.20491406321525574,
      0.2948906123638153,
      0.24137155711650848,
      0.3206852376461029,
      -0.609292209148407,
      -0.4656010568141937,
      -0.6283602714538574,
      -0.15607288479804993,
      0.14962804317474365,
      -0.9357185363769531,
      -0.8138740062713623,
      0.7845698595046997,
      0.6189156770706177,
      -0.07700185477733612,
      0.8363854289054871,
      0.7081685066223145,
      0.6168094873428345,
      0.005112620070576668,
      0.8041670322418213,
      -0.1089407429099083,
      0.7074740529060364,
      0.21292127668857574,
      0.513724148273468,
      -0.893730878829956,
      0.058251332491636276,
      -0.4745783805847168,
      -0.5265368819236755,
      0.11338366568088531,
      0.838503897190094,
      0.3910495936870575,
      0.5766781568527222,
      1.0070210695266724,
      0.21472378075122833,
      0.9143971800804138,
      -0.32747626304626465,
      -0.38715267181396484,
      -0.8147112131118774,
      1.2709088325500488,
      -0.37668028473854065,
      0.4462156593799591,
      0.6591760516166687,
      -0.1974395513534546,
      0.09153171628713608,
      -0.7615518569946289,
      -0.6659698486328125,
      -0.25674259662628174,
      -0.09906722605228424,
      0.1874292492866516,
      -0.2758633494377136,
      0.14559084177017212,
      0.839754045009613,
      0.7959920167922974,
      0.5287473201751709,
      0.31856319308280945,
      0.8299369812011719,
      0.1952451914548874,
      -0.6061592102050781,
      -0.39342984557151794,
      -0.07748083025217056,
      -0.24241945147514343,
      -0.7942708134651184,
      -0.4624280631542206,
      -0.2400999218225479,
      -0.08961407840251923,
      0.030455512925982475,
      0.1504867523908615,
      0.7947641611099243,
      0.14098216593265533,
      0.786368191242218,
      -0.8730033040046692,
      0.21912157535552979,
      0.07254961133003235,
      -0.009749183431267738,
      -0.27715224027633667,
      0.38490211963653564,
      1.1274982690811157,
      -0.7483749985694885,
      0.011984254233539104,
      -0.29790034890174866,
      0.5439271926879883,
      0.5990216135978699,
      0.991976261138916,
      0.6564010381698608,
      -0.0691123679280281,
      -0.7615794539451599,
      0.49618175625801086,
      -0.05386967211961746,
      0.11851011216640472,
      -0.031663477420806885,
      -0.544470489025116,
      -0.5800608396530151,
      -0.1189703419804573,
      0.7058573961257935,
      0.2831723093986511,
      0.10676392912864685,
      0.3360660672187805,
      0.5082802176475525,
      0.3507590591907501,
      0.04330694302916527,
      0.2645062506198883,
      -0.3365354835987091,
      -0.18876948952674866,
      0.2677619755268097,
      -0.4415580928325653,
      0.5428507328033447,
      -0.17856542766094208,
      -0.11127051711082458,
      0.7711790204048157,
      -0.45969265699386597,
      0.32718056440353394,
      0.6034218072891235,
      0.22989873588085175,
      -0.735252320766449,
      -0.214510977268219,
      -0.06929989159107208,
      -0.45097899436950684,
      0.008734188973903656,
      -0.02354535087943077,
      0.6451433300971985,
      0.17998181283473969,
      0.31655171513557434,
      -0.284338116645813,
      -0.9219614863395691,
      -0.40020638704299927,
      -0.006242289673537016,
      -0.7746777534484863,
      -1.0289793014526367,
      0.3991855978965759,
      0.30767518281936646,
      -0.08223360031843185,
      0.10385407507419586,
      0.44545504450798035,
      -0.7614759206771851,
      -0.09680264443159103,
      0.18986813724040985,
      1.0295013189315796,
      0.32973629236221313,
      0.3550899028778076,
      0.4358467161655426,
      0.9659820199012756,
      -0.24091017246246338,
      -0.26539143919944763,
      -0.06018472835421562,
      -0.17233653366565704,
      -0.21599169075489044,
      0.964461088180542,
      0.0623391754925251,
      0.03062514215707779,
      -0.11523740738630295,
      0.21239666640758514,
      -0.268212229013443,
      -0.2923343777656555,
      0.48153695464134216,
      -1.013103723526001,
      0.006518821697682142,
      -0.9826992750167847,
      0.6908922791481018,
      -0.01205280888825655,
      -0.09909900277853012,
      0.2794923186302185,
      -0.8280590176582336,
      0.4539977014064789,
      0.06981689482927322,
      0.8728656768798828,
      1.0450788736343384,
      0.196748748421669,
      -1.567469596862793,
      0.16533523797988892,
      1.0733230113983154,
      0.21004937589168549,
      0.2137800008058548,
      -0.9948554039001465,
      -0.4888053834438324,
      0.3930833637714386,
      -0.9727253317832947,
      1.24300217628479,
      0.569014847278595,
      -0.15860089659690857,
      0.5421270132064819,
      -1.2816121578216553,
      -0.33587196469306946,
      -0.0329098142683506,
      -0.1495560258626938,
      -0.3889695107936859,
      -0.2720547616481781,
      0.13605782389640808,
      -0.29261907935142517,
      0.017602408304810524,
      0.14043252170085907,
      0.1227140799164772,
      0.03490694984793663,
      0.46903517842292786,
      -1.4944628477096558,
      1.0869648456573486,
      0.3044426143169403,
      0.3898496925830841,
      0.9095333218574524,
      -0.5066026449203491,
      -1.1463268995285034,
      0.33096006512641907,
      0.6113612055778503,
      -0.4972248077392578,
      0.10617806762456894,
      0.6308543086051941,
      0.7200244665145874,
      0.5904009342193604,
      1.2658230066299438,
      0.13136522471904755,
      -1.537544846534729,
      0.2946428656578064,
      0.17838455736637115,
      0.5794738531112671,
      -0.47835564613342285,
      -0.29555973410606384,
      0.28786060214042664,
      -0.22664067149162292,
      0.9395076632499695,
      -0.5905766487121582,
      0.995721161365509,
      0.93035489320755,
      0.031574614346027374,
      -1.2375165224075317,
      -0.8342208862304688,
      0.5676264762878418,
      0.4095464050769806,
      1.359391212463379,
      -0.1680397242307663,
      -1.6619341373443604,
      1.0786592960357666,
      -0.534626305103302,
      0.5134443044662476,
      -0.07377327233552933,
      0.39117467403411865,
      1.2393085956573486,
      -0.29878538846969604,
      -0.39536863565444946,
      -0.3564620912075043,
      -0.5642824769020081,
      0.24291576445102692,
      -0.01195649616420269,
      0.29107680916786194,
      -0.8801825046539307,
      -0.25298523902893066,
      -0.3407934606075287,
      -1.1791696548461914,
      -0.22003236413002014,
      -0.06264274567365646,
      1.221368432044983,
      0.7320123910903931,
      -0.8954593539237976,
      0.004101233556866646,
      0.5094451904296875,
      -0.31730449199676514,
      -0.5045860409736633,
      0.20026390254497528,
      0.008942296728491783,
      -0.047900985926389694,
      0.8500486612319946,
      0.8356398344039917,
      0.18638695776462555,
      -1.6779643297195435,
      -0.4840679168701172,
      -0.7488541603088379,
      -0.5291146636009216,
      1.257006287574768,
      -0.3237951993942261,
      -0.05535411834716797,
      0.029183395206928253,
      -0.12390444427728653,
      0.2844254672527313,
      -0.1426549255847931,
      -0.037379924207925797,
      -0.0662672147154808,
      -0.13852499425411224,
      -0.20978417992591858,
      0.11288148164749146,
      1.0705140829086304,
      0.8051232099533081,
      0.5608305335044861,
      -0.28194135427474976,
      0.13597291707992554,
      -0.7833461761474609,
      0.3791208267211914,
      0.6958552598953247,
      0.07487188279628754,
      0.616765558719635,
      -1.4957201480865479,
      -0.2553423345088959,
      0.300742506980896,
      -0.24433784186840057,
      -0.317261278629303,
      0.25329411029815674,
      0.15287253260612488,
      -0.1932603269815445,
      -1.3990263938903809,
      0.04812993109226227,
      0.17013128101825714,
      -1.3673253059387207,
      -0.06286299973726273,
      0.3870663046836853,
      -0.40575167536735535,
      -0.2032071352005005,
      -0.21169306337833405,
      -0.4385043978691101,
      0.30071938037872314,
      0.40909260511398315,
      -1.2942794561386108,
      0.32559841871261597,
      -0.4301987290382385,
      -0.20826604962348938,
      0.11225474625825882,
      -1.3854789733886719,
      0.11532832682132721,
      0.4915826916694641,
      -0.4847612977027893,
      0.15704724192619324,
      1.0476118326187134,
      0.04927970468997955,
      -0.2026764154434204,
      0.6261595487594604,
      1.5992932319641113,
      0.5238161087036133,
      -0.12736739218235016,
      -0.3305197060108185,
      0.26409751176834106,
      -0.18000569939613342,
      0.8258458375930786,
      0.43386659026145935,
      -1.8953046798706055,
      0.05768737196922302,
      -1.1146469116210938,
      0.3654739558696747,
      -0.653596818447113,
      -0.19835048913955688,
      -0.7739755511283875,
      -1.1820416450500488,
      -1.2178460359573364,
      -0.987492561340332,
      -0.5374420881271362,
      -0.3842790722846985,
      0.07490207999944687,
      1.8560359477996826,
      -0.30028900504112244,
      -0.16297847032546997,
      -1.0633084774017334,
      -0.18192915618419647,
      0.8011046051979065,
      0.9107903838157654,
      0.05817551910877228,
      -0.39244502782821655,
      -1.4638698101043701,
      0.15138235688209534,
      0.41614967584609985,
      -0.10915137827396393,
      0.5499194264411926,
      0.6952771544456482,
      -0.2208845168352127,
      -0.988081693649292,
      -0.5491946935653687,
      0.49747151136398315,
      -1.3211767673492432,
      0.1747676432132721,
      0.150111123919487,
      -0.13277339935302734,
      0.7422496676445007,
      0.017547734081745148,
      -0.47504839301109314,
      0.11238285154104233,
      0.34196022152900696,
      -1.1249725818634033,
      -0.4620687663555145,
      0.9260779619216919,
      -0.31876182556152344,
      0.44659966230392456,
      -0.5928674340248108,
      -0.44529420137405396,
      0.5977272987365723,
      -0.5530242919921875,
      -1.4949610233306885,
      -0.5895859003067017,
      0.5073229670524597,
      0.935594916343689,
      -1.730774998664856,
      0.2968822419643402,
      1.678955078125,
      -0.6825771331787109,
      0.4062536656856537,
      -0.10920795053243637,
      0.4017044007778168,
      0.013794233091175556,
      0.05991748347878456,
      0.14644873142242432,
      0.08021686226129532,
      0.29357582330703735,
      -0.8746272921562195,
      1.0707160234451294,
      -0.24643346667289734,
      -0.5875440239906311,
      -0.6257873773574829,
      -0.7433393597602844,
      -0.52259761095047,
      1.3443535566329956,
      -0.8738272786140442,
      0.6899070739746094,
      -0.09697598218917847,
      -0.7161654829978943,
      -0.06256590783596039,
      -0.1230686604976654,
      0.7054839730262756,
      -0.7665656208992004,
      0.13667485117912292,
      -1.0796600580215454,
      0.19365401566028595,
      -1.1752827167510986,
      0.9401179552078247,
      0.2566825747489929,
      0.8597450256347656,
      0.7210133075714111,
      0.29124733805656433,
      -0.07536514103412628,
      0.007113008294254541,
      -0.6992931365966797,
      0.2784871459007263,
      0.2551884353160858,
      -0.6307831406593323,
      0.38513076305389404,
      1.4162638187408447,
      -0.808225691318512,
      -0.22685077786445618,
      1.260845422744751,
      1.3733083009719849,
      0.37533465027809143,
      -0.468373566865921,
      0.1631830781698227,
      -0.15146243572235107,
      0.014363360591232777,
      -0.6600185632705688,
      -0.523401141166687,
      -0.25203728675842285,
      0.04574711620807648,
      -0.6682342886924744,
      -1.204757571220398,
      -0.2741430103778839,
      0.34505391120910645,
      0.09110217541456223,
      -0.8306087255477905,
      0.33557718992233276,
      -0.019261717796325684,
      -0.6540482044219971,
      0.2294146865606308,
      -0.10138280689716339,
      0.13604401051998138,
      1.0250232219696045,
      0.10712047666311264,
      -0.06350254267454147,
      0.7369193434715271,
      1.06657075881958,
      -0.08426735550165176,
      0.15969155728816986,
      1.1301251649856567,
      0.3197857439517975,
      0.8742682933807373,
      -0.07349972426891327,
      -0.289711058139801,
      -1.5122579336166382,
      -0.19686976075172424,
      -1.4990816116333008,
      -0.12956717610359192,
      -0.3792569935321808,
      -0.686392605304718,
      0.24316218495368958,
      0.06632950156927109,
      -0.7804064154624939,
      -0.42518049478530884,
      0.2106429934501648,
      -0.2305804044008255,
      -1.038638710975647,
      0.580034077167511,
      0.8399959206581116,
      0.3508760929107666,
      0.1062784418463707,
      -0.4897457957267761,
      0.08650100231170654,
      0.18908055126667023,
      -0.2772439122200012,
      0.3432958722114563,
      -0.48337405920028687,
      -0.19539381563663483,
      -0.3520899713039398,
      -0.256479412317276,
      0.35194721817970276,
      -1.1257014274597168,
      1.5673935413360596,
      0.15647996962070465,
      0.7259790301322937,
      -0.09607632458209991,
      -1.0416247844696045,
      -0.7389625310897827,
      -0.4856146574020386,
      0.2597537338733673,
      -0.07096868008375168,
      -1.3558048009872437,
      -0.05604863911867142,
      -0.38272544741630554,
      -0.2968340516090393,
      0.10153618454933167,
      -0.39981335401535034,
      -0.737328827381134,
      -0.206194207072258,
      -0.903866708278656,
      0.31016919016838074,
      -1.2713693380355835,
      1.0968633890151978,
      -0.023647073656320572,
      0.046890996396541595,
      -0.8890419006347656,
      -0.8980475068092346,
      -0.41727691888809204,
      -0.40460750460624695,
      -0.8253522515296936,
      0.5865129828453064,
      -0.26211920380592346,
      0.12337927520275116,
      -0.23739783465862274,
      -0.3113996088504791,
      -0.5729397535324097,
      0.8368878960609436,
      0.24105964601039886,
      -0.7911051511764526,
      0.4181792438030243,
      -0.04653961583971977,
      0.13729743659496307,
      -0.013968496583402157,
      -0.2698650062084198,
      -0.031161120161414146,
      -0.4165671467781067,
      0.779259204864502,
      1.4185128211975098,
      0.5024484395980835,
      0.2427142709493637,
      -0.9485814571380615,
      0.08799190819263458,
      0.6794160604476929,
      -0.4287141263484955,
      -0.440798282623291,
      -0.33413004875183105,
      -0.5412041544914246
    ],
    "label": {
      "level1": "AMO",
      "level2": "F",
      "level3": "F",
      "leafContractCategory": "F",
      "rootCause": "Missing Required State-specific Method Order",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Evaluation",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): AMO (API Method Order)\nThe issue is caused by calling Keras API methods (K.gradients and K.function) in an incorrect order or without fulfilling required preconditions.\n\nLevel 2: F (Eventually Required Condition)\nThe model's computational graph requires a valid TensorFlow tensor (model.input), but the user incorrectly provides a NumPy array instead.\n\nLevel 3 (Hybrid Patterns): F (Eventually Required Condition)\nThe failure happens because input_img is expected to be part of the TensorFlow computation graph, but it isn�t, breaking the expected flow of execution.\n\nLeaf Contract Category: F (Eventually Required Condition)\nThe function expects a structured computational graph, which was not properly set up.\n\nRoot Cause: Missing Required State-specific Method Order\nThe missing method order requirement is that K.gradients must compute gradients with respect to a symbolic tensor (model.input), but the user incorrectly passes a NumPy array, which breaks the computational graph.\n\nEffect: Crash\nThe API call returns None instead of valid gradients, causing an immediate failure when subsequent computations depend on it.\n\nML Library: Keras\nThe issue occurs due to incorrect usage of Keras backend functions (K.gradients and K.function).\n\nContract Violation Location: Model Evaluation\nThe error occurs while evaluating the model for visualization, where the gradient computation should have taken place.\n\nDetection Technique: Static\nThe issue can be identified through static analysis by checking for improper arguments passed to K.gradients, specifically ensuring that inputs are symbolic tensors rather than NumPy arrays.\n\n\n"
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/34716454",
    "title": "",
    "question": "213\n\nIf I want to use the BatchNormalization function in Keras, then do I need to call it once only at the beginning?\n\nI read this documentation for it: http://keras.io/layers/normalization/\n\nI don't see where I'm supposed to call it. Below is my code attempting to use it:\n\nmodel = Sequential()\nkeras.layers.normalization.BatchNormalization(epsilon=1e-06, mode=0, momentum=0.9, weights=None)\nmodel.add(Dense(64, input_dim=14, init='uniform'))\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(64, init='uniform'))\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(2, init='uniform'))\nmodel.add(Activation('softmax'))\n\nsgd = SGD(lr=0.1, decay=1e-6, momentum=0.9, nesterov=True)\nmodel.compile(loss='binary_crossentropy', optimizer=sgd)\nmodel.fit(X_train, y_train, nb_epoch=20, batch_size=16, show_accuracy=True, validation_split=0.2, verbose = 2)\nI ask because if I run the code with the second line including the batch normalization and if I run the code without the second line I get similar outputs. So either I'm not calling the function in the right place, or I guess it doesn't make that much of a difference.",
    "answer": "As Pavel said, Batch Normalization is just another layer, so you can use it as such to create your desired network architecture.\n\nThe general use case is to use BN between the linear and non-linear layers in your network, because it normalizes the input to your activation function, so that you're centered in the linear section of the activation function (such as Sigmoid). There's a small discussion of it here\n\nIn your case above, this might look like:\n\n# import BatchNormalization\nfrom keras.layers.normalization import BatchNormalization\n\n# instantiate model\nmodel = Sequential()\n\n# we can think of this chunk as the input layer\nmodel.add(Dense(64, input_dim=14, init='uniform'))\nmodel.add(BatchNormalization())\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.5))\n\n# we can think of this chunk as the hidden layer    \nmodel.add(Dense(64, init='uniform'))\nmodel.add(BatchNormalization())\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.5))\n\n# we can think of this chunk as the output layer\nmodel.add(Dense(2, init='uniform'))\nmodel.add(BatchNormalization())\nmodel.add(Activation('softmax'))\n\n# setting up the optimization of our weights \nsgd = SGD(lr=0.1, decay=1e-6, momentum=0.9, nesterov=True)\nmodel.compile(loss='binary_crossentropy', optimizer=sgd)\n\n# running the fitting\nmodel.fit(X_train, y_train, nb_epoch=20, batch_size=16, show_accuracy",
    "mlApiName": "keras.layers.Activation, keras.layers.BatchNormalization, keras.layers.Dense",
    "embedding": [
      0.3657955229282379,
      0.2563096284866333,
      -2.594481945037842,
      -1.1847668886184692,
      1.2725127935409546,
      -0.39374643564224243,
      0.5466636419296265,
      0.23655954003334045,
      -0.9066644310951233,
      -1.562359094619751,
      -0.9555727243423462,
      0.7327741980552673,
      1.7809431552886963,
      0.9652955532073975,
      0.05855425447225571,
      -1.4564369916915894,
      0.4520813226699829,
      0.2204412966966629,
      0.5207924842834473,
      0.6522154211997986,
      -0.2675957977771759,
      0.39464983344078064,
      0.13000717759132385,
      -0.7432965040206909,
      2.2439332008361816,
      -0.10414399206638336,
      -0.5114703178405762,
      0.6571976542472839,
      -0.6145778894424438,
      0.06772288680076599,
      1.0644043684005737,
      -0.5903453230857849,
      0.25847959518432617,
      -0.9844934940338135,
      -1.5289686918258667,
      -0.6029958724975586,
      0.30051112174987793,
      -0.2668484151363373,
      -0.7112329006195068,
      -0.1730656623840332,
      0.8923123478889465,
      0.22477887570858002,
      0.591488778591156,
      -0.20725351572036743,
      -0.19572781026363373,
      -0.2703128159046173,
      0.7839376926422119,
      0.3150578439235687,
      1.1149427890777588,
      -1.5240288972854614,
      0.17447242140769958,
      0.9377755522727966,
      -0.6794082522392273,
      0.32708749175071716,
      1.6063930988311768,
      0.7225092053413391,
      0.22711649537086487,
      1.0879807472229004,
      0.8068903684616089,
      -0.21784035861492157,
      0.11179621517658234,
      1.2741351127624512,
      -0.8600371479988098,
      1.1268857717514038,
      0.30654558539390564,
      -0.09827982634305954,
      -0.6167135238647461,
      0.6056526899337769,
      -0.7130202054977417,
      -0.20968371629714966,
      0.46338513493537903,
      -0.06885864585638046,
      -0.028393490239977837,
      -0.2626630663871765,
      -0.5888391733169556,
      0.39596790075302124,
      -0.0734768956899643,
      -0.42845770716667175,
      0.0016375361010432243,
      1.1053824424743652,
      -0.7188357710838318,
      0.9726078510284424,
      1.4895902872085571,
      -0.6075340509414673,
      0.15854226052761078,
      0.9404228925704956,
      -0.3811672329902649,
      -0.4542224407196045,
      -0.6888989210128784,
      1.5279361009597778,
      -0.270990788936615,
      -0.7817209362983704,
      0.05123518034815788,
      0.8965837955474854,
      -0.8897029161453247,
      -0.7870580554008484,
      0.0987556055188179,
      0.35185641050338745,
      -0.2419476956129074,
      -0.1769293248653412,
      -0.3632916212081909,
      0.9222437143325806,
      0.18365591764450073,
      -0.860322892665863,
      -0.5501956343650818,
      1.7803266048431396,
      0.4085112512111664,
      0.14054027199745178,
      0.25557273626327515,
      -0.6253820657730103,
      -0.6013097167015076,
      -0.20143893361091614,
      -0.08561348915100098,
      -0.25755774974823,
      0.9454134702682495,
      -0.10647442936897278,
      0.6423643231391907,
      -0.36058732867240906,
      0.506267249584198,
      0.5154809951782227,
      -0.27710095047950745,
      -0.6513038873672485,
      0.4637254476547241,
      -0.3518495261669159,
      0.41374191641807556,
      0.7452699542045593,
      -0.40924036502838135,
      0.18570385873317719,
      0.12084006518125534,
      -1.2803725004196167,
      -0.05398573726415634,
      -0.35570216178894043,
      -0.1261579841375351,
      0.04776345565915108,
      0.6024714708328247,
      0.8380715847015381,
      -0.9716843962669373,
      -1.2534147500991821,
      0.18614652752876282,
      -0.3807547092437744,
      -0.22748421132564545,
      -0.07445552945137024,
      -0.2491605281829834,
      -0.9637128114700317,
      0.3871302902698517,
      -0.3524840772151947,
      1.1099909543991089,
      -0.608008086681366,
      -0.39730748534202576,
      0.09871388226747513,
      -0.17672789096832275,
      0.6363771557807922,
      -0.9804845452308655,
      0.1500217616558075,
      0.84174644947052,
      -0.8382502794265747,
      0.8263184428215027,
      0.46205341815948486,
      0.6314386129379272,
      -0.12937553226947784,
      0.9768452644348145,
      0.25072357058525085,
      -0.12554988265037537,
      0.33296480774879456,
      -0.8290236592292786,
      -0.7501201629638672,
      0.35489898920059204,
      -0.15848709642887115,
      -0.3084830343723297,
      0.4107528626918793,
      -0.23987656831741333,
      -0.5383164286613464,
      0.21323484182357788,
      -0.15292684733867645,
      -0.5377929210662842,
      1.1715458631515503,
      1.126272201538086,
      -0.25632184743881226,
      0.5896987915039062,
      -0.20432724058628082,
      0.14846867322921753,
      -0.41207146644592285,
      0.6658279299736023,
      -0.34785905480384827,
      -0.9618343710899353,
      0.0020184244494885206,
      0.03751173987984657,
      -0.06180465593934059,
      -0.6166324019432068,
      -0.8484723567962646,
      0.44614744186401367,
      0.13366059958934784,
      -0.6132949590682983,
      -0.35574471950531006,
      -0.313396692276001,
      -0.21470056474208832,
      0.37054941058158875,
      -0.9909850358963013,
      0.7458571195602417,
      -0.28372445702552795,
      -0.25604769587516785,
      0.13294416666030884,
      -0.7150552272796631,
      0.09385903924703598,
      -0.9152674674987793,
      1.1427812576293945,
      -0.5496119260787964,
      0.30735304951667786,
      -0.5416123867034912,
      0.4383518099784851,
      0.6617269515991211,
      0.1690598428249359,
      -0.36308392882347107,
      -0.007647243328392506,
      0.03075317107141018,
      -0.6252725124359131,
      0.600630521774292,
      -0.2228844165802002,
      -0.430865615606308,
      -0.21672172844409943,
      0.12767592072486877,
      -0.6957869529724121,
      1.1961140632629395,
      -0.1255263239145279,
      0.6511783599853516,
      -0.9315224289894104,
      0.25642913579940796,
      0.35039111971855164,
      -0.4694063365459442,
      -0.1643681526184082,
      -0.9020145535469055,
      -1.518204689025879,
      0.09779753535985947,
      -0.32056620717048645,
      -0.7952458262443542,
      0.7560989260673523,
      0.9247794151306152,
      1.0634229183197021,
      -0.2549789547920227,
      0.35913118720054626,
      -0.2873857915401459,
      0.9711644649505615,
      0.6073627471923828,
      0.8926583528518677,
      -1.1260496377944946,
      0.003159336745738983,
      0.17267680168151855,
      -0.47953110933303833,
      -0.7487135529518127,
      0.9323451519012451,
      0.12645137310028076,
      0.01978723146021366,
      0.3231050372123718,
      0.6668856739997864,
      1.2509205341339111,
      -0.8862525224685669,
      -0.05590438470244408,
      -0.251973956823349,
      0.5887978672981262,
      -0.4113784432411194,
      0.5072333216667175,
      -0.15131503343582153,
      -0.25419676303863525,
      -0.5075859427452087,
      -0.5010448098182678,
      -0.9460931420326233,
      -0.5336033701896667,
      0.2574405372142792,
      0.40081459283828735,
      -0.16056951880455017,
      0.29427775740623474,
      0.3806496560573578,
      0.5388105511665344,
      1.1545847654342651,
      0.8531572222709656,
      0.05568261817097664,
      -0.025918593630194664,
      0.005582988262176514,
      0.18249231576919556,
      0.2104915827512741,
      -0.7764196991920471,
      -0.9864456653594971,
      -0.4641052484512329,
      0.05532513186335564,
      -0.16200508177280426,
      -0.03613745793700218,
      0.3623657524585724,
      0.8180434107780457,
      0.08018217980861664,
      0.5619848966598511,
      0.02711966075003147,
      -0.6572281122207642,
      0.18999546766281128,
      0.6645398736000061,
      0.4121958613395691,
      0.3931495249271393,
      0.8990370631217957,
      -0.4717276692390442,
      -0.14235442876815796,
      -0.6372108459472656,
      0.731268584728241,
      0.4380608797073364,
      0.5684886574745178,
      0.7001597285270691,
      0.06344806402921677,
      0.10401987284421921,
      0.2954348623752594,
      -0.0868825763463974,
      -0.13116976618766785,
      -0.020563071593642235,
      0.09804926812648773,
      0.30040794610977173,
      -0.1522534042596817,
      0.6218355894088745,
      -0.10621592402458191,
      0.16837501525878906,
      0.05059078708291054,
      0.3825730085372925,
      0.3606349527835846,
      0.5803614854812622,
      -0.7042600512504578,
      -0.6893833875656128,
      0.09565862268209457,
      0.11170050501823425,
      -0.8002943396568298,
      0.9837600588798523,
      -0.2558598220348358,
      0.7053053975105286,
      0.6242585182189941,
      -0.16333279013633728,
      0.5672694444656372,
      0.3909512162208557,
      0.08641456812620163,
      -1.4407933950424194,
      -0.7375138998031616,
      -0.4052058160305023,
      -0.1999835968017578,
      -0.06191098690032959,
      -0.1584998220205307,
      1.059424638748169,
      0.06747600436210632,
      0.2767654359340668,
      1.0037633180618286,
      -0.4946860074996948,
      0.17479652166366577,
      -0.12360724806785583,
      -1.315748691558838,
      -0.4112089276313782,
      0.038579195737838745,
      0.38156238198280334,
      -0.11280374974012375,
      -0.07933251559734344,
      -0.11557493358850479,
      -0.11588912457227707,
      -0.23630064725875854,
      0.24009820818901062,
      0.502707839012146,
      0.11542738974094391,
      0.15547211468219757,
      0.23881755769252777,
      1.1449934244155884,
      -0.12559233605861664,
      -0.23184306919574738,
      0.9498962759971619,
      0.1731957197189331,
      0.4041539132595062,
      0.6017228364944458,
      0.501846432685852,
      0.1334058791399002,
      0.1060837134718895,
      -0.20059052109718323,
      0.3402409553527832,
      0.24438855051994324,
      0.24083051085472107,
      -0.7377423048019409,
      -0.17966428399085999,
      -0.892025887966156,
      0.5085322260856628,
      -0.010578995570540428,
      0.8464561700820923,
      -0.3262900412082672,
      -1.1919060945510864,
      0.12073082476854324,
      0.20736829936504364,
      1.0270885229110718,
      0.8707324266433716,
      0.07809693366289139,
      -0.28842127323150635,
      0.3785949945449829,
      1.300862193107605,
      0.02803555503487587,
      -0.5345993638038635,
      -0.11479789018630981,
      -1.2417683601379395,
      0.6311694979667664,
      -0.24032287299633026,
      1.461992859840393,
      0.4615299701690674,
      -0.09569051861763,
      0.7660315632820129,
      -1.9892772436141968,
      -0.7247714996337891,
      -0.19805815815925598,
      -0.36394599080085754,
      -0.43360671401023865,
      -0.5399672985076904,
      0.580710232257843,
      -0.1363399773836136,
      0.3089383542537689,
      -0.4307960569858551,
      0.2547488212585449,
      0.24465139210224152,
      -0.2173270881175995,
      -1.2622385025024414,
      0.8107357621192932,
      -0.11297506839036942,
      0.7245884537696838,
      0.43301162123680115,
      -1.08011794090271,
      -0.73796546459198,
      0.34946921467781067,
      0.3388967514038086,
      -0.3276342451572418,
      -0.48000356554985046,
      0.7614743709564209,
      0.9333683252334595,
      1.2159088850021362,
      1.3622561693191528,
      0.6466718912124634,
      -1.8161189556121826,
      -0.029620494693517685,
      0.8751684427261353,
      0.9552800059318542,
      0.008244450204074383,
      -0.8537997007369995,
      -0.4644099771976471,
      -0.4802699387073517,
      1.0940577983856201,
      -0.743893027305603,
      0.79038405418396,
      1.1081690788269043,
      -0.4558525085449219,
      -1.2802108526229858,
      -0.463203489780426,
      0.4141232967376709,
      0.47077271342277527,
      1.24550461769104,
      -1.2774320840835571,
      -1.6723437309265137,
      1.3597090244293213,
      -0.4402100145816803,
      0.36128678917884827,
      0.39296963810920715,
      0.16403208673000336,
      1.7935858964920044,
      -0.7149145603179932,
      -0.17647504806518555,
      -0.18634174764156342,
      -0.3402751386165619,
      0.037747107446193695,
      -0.26596203446388245,
      -0.06910587102174759,
      -1.4570627212524414,
      -0.20476876199245453,
      -0.04896209388971329,
      -0.8192911744117737,
      -0.2911333441734314,
      -0.35580697655677795,
      0.6142942309379578,
      1.364815592765808,
      0.022070828825235367,
      -0.5665835738182068,
      0.5027701258659363,
      -0.5166727900505066,
      0.6761488914489746,
      0.045259907841682434,
      0.14720341563224792,
      0.3914856016635895,
      -0.02050662785768509,
      0.412056028842926,
      0.2662191390991211,
      -1.9278123378753662,
      -0.4446867108345032,
      -0.2928124666213989,
      -0.910659670829773,
      1.434149980545044,
      -0.019940055906772614,
      -0.6313037276268005,
      0.537386417388916,
      0.4045366048812866,
      0.6771055459976196,
      -0.3358367085456848,
      0.12094128876924515,
      0.5322888493537903,
      -0.1366404891014099,
      -0.616195559501648,
      0.02781485766172409,
      1.0944421291351318,
      -0.049003101885318756,
      0.7388606667518616,
      0.4201071560382843,
      0.36183997988700867,
      -0.7087672352790833,
      0.6322211623191833,
      0.5322351455688477,
      -0.06619743257761002,
      1.322353720664978,
      -0.47293540835380554,
      -0.6925925016403198,
      -1.030647873878479,
      0.4211309850215912,
      -0.21074669063091278,
      -0.09829984605312347,
      -0.20900827646255493,
      0.42040586471557617,
      -1.5200082063674927,
      0.4148504436016083,
      -0.4755741357803345,
      -1.5687661170959473,
      -0.49997788667678833,
      0.15582016110420227,
      -0.25642672181129456,
      -0.4040571451187134,
      -0.807951033115387,
      -0.847136914730072,
      -0.17164921760559082,
      0.1399451494216919,
      -1.5331954956054688,
      0.32814109325408936,
      -0.31359297037124634,
      -0.018466433510184288,
      0.1810339242219925,
      -1.2931849956512451,
      0.31328049302101135,
      0.6833471059799194,
      -0.18040652573108673,
      -0.358255535364151,
      1.1754436492919922,
      0.14068517088890076,
      0.024100610986351967,
      -0.10478468239307404,
      1.139994502067566,
      0.21588370203971863,
      0.2465202808380127,
      -0.5305341482162476,
      0.2146235704421997,
      0.1358209103345871,
      0.7989429235458374,
      0.3596862852573395,
      -0.9454445838928223,
      -0.5662130117416382,
      -0.787952184677124,
      0.4876071810722351,
      -0.6928901076316833,
      -0.32551509141921997,
      -0.4333301782608032,
      -0.47660690546035767,
      -0.7775368690490723,
      -0.44776415824890137,
      -0.4953151047229767,
      -1.0571647882461548,
      -0.09471231698989868,
      1.9643813371658325,
      0.2644262909889221,
      0.7280317544937134,
      -0.740989089012146,
      -0.27985620498657227,
      1.175548791885376,
      -0.010325467213988304,
      0.6347209215164185,
      -0.4265746772289276,
      -1.0438741445541382,
      -0.2923389673233032,
      0.2650662064552307,
      -0.2793467938899994,
      0.888136088848114,
      0.5582625865936279,
      0.5606487393379211,
      -0.7629436254501343,
      -0.4231548011302948,
      0.2327243685722351,
      -1.2259373664855957,
      -0.30384907126426697,
      0.10468295961618423,
      0.1086609736084938,
      0.7071781158447266,
      0.03763462230563164,
      -1.0008957386016846,
      0.3660390377044678,
      -0.006230744067579508,
      -1.2907689809799194,
      -0.23699718713760376,
      1.04852294921875,
      -0.06604553014039993,
      0.4908546507358551,
      0.2898564338684082,
      -0.9434365034103394,
      -0.015788430348038673,
      -0.1833702176809311,
      -1.3507473468780518,
      0.6462907791137695,
      0.6686782836914062,
      1.2964881658554077,
      -1.8866161108016968,
      0.06895918399095535,
      1.643131136894226,
      -0.25474467873573303,
      0.38476866483688354,
      -0.5903342962265015,
      0.5595321655273438,
      0.4863396883010864,
      -0.06571105122566223,
      -0.4134275019168854,
      -0.12455876171588898,
      0.07072842866182327,
      -0.8331242799758911,
      0.14841675758361816,
      0.19219717383384705,
      0.5133839249610901,
      -0.2040679007768631,
      -0.3265571594238281,
      -0.7392514944076538,
      1.0576298236846924,
      -0.8088566064834595,
      1.143197774887085,
      -0.00773020600900054,
      -0.7364168763160706,
      -0.14505819976329803,
      -0.3031991124153137,
      0.07219132781028748,
      -1.29574716091156,
      -0.121357761323452,
      -2.4362449645996094,
      0.044555485248565674,
      -1.1813896894454956,
      0.9420855045318604,
      0.029234128072857857,
      0.47701767086982727,
      0.12090392410755157,
      1.1442830562591553,
      0.04534954950213432,
      0.40529462695121765,
      -0.3058207631111145,
      1.2036795616149902,
      0.9190349578857422,
      -1.652230978012085,
      0.5318290591239929,
      0.592110812664032,
      0.01903039775788784,
      0.22156409919261932,
      0.46821820735931396,
      1.528608798980713,
      -0.40844833850860596,
      0.4087167978286743,
      1.24285888671875,
      -0.6099607348442078,
      0.3715243935585022,
      -0.13211561739444733,
      -1.5424901247024536,
      -0.4465835392475128,
      0.2945239543914795,
      -0.592817485332489,
      -1.1288460493087769,
      -0.303346186876297,
      0.6846903562545776,
      0.2853498160839081,
      0.2281927764415741,
      0.5959005951881409,
      -0.20097407698631287,
      -0.8825229406356812,
      -0.11498826742172241,
      0.014870566315948963,
      0.14450767636299133,
      0.7536697387695312,
      0.47096651792526245,
      0.024412445724010468,
      1.0439445972442627,
      1.0312443971633911,
      -0.5499445796012878,
      -0.2599645256996155,
      1.2768217325210571,
      -0.3136724531650543,
      1.2404650449752808,
      -0.5643362402915955,
      0.26603204011917114,
      -0.9775212407112122,
      0.35694730281829834,
      -1.3289122581481934,
      -0.6531575918197632,
      -0.7314043045043945,
      0.16464374959468842,
      -0.13760261237621307,
      0.4971889853477478,
      -0.2737707793712616,
      -0.5103928446769714,
      0.8028990626335144,
      0.10909116268157959,
      -0.8710249066352844,
      -0.13317039608955383,
      1.2156985998153687,
      0.40823665261268616,
      -0.10309548676013947,
      -0.010985839180648327,
      0.6064741611480713,
      1.0521247386932373,
      -0.11718282103538513,
      0.32929423451423645,
      0.15987445414066315,
      -1.1949751377105713,
      -1.0533398389816284,
      -0.8590632081031799,
      0.5327551364898682,
      -0.05106713995337486,
      1.816633939743042,
      -0.54659503698349,
      0.7263110876083374,
      0.21622003614902496,
      -0.5692172646522522,
      -0.041790276765823364,
      -0.050400909036397934,
      0.30414488911628723,
      -0.04095160588622093,
      -0.8455110788345337,
      0.7077561616897583,
      -0.5214066505432129,
      0.15117228031158447,
      -0.4554833769798279,
      0.014697512611746788,
      -0.1839732825756073,
      0.03242712840437889,
      -1.3306137323379517,
      0.05780572071671486,
      -1.5239499807357788,
      1.2335892915725708,
      -0.5957319140434265,
      -0.3575507700443268,
      -0.09059756994247437,
      -0.7160871028900146,
      -0.740719735622406,
      -0.007926013320684433,
      -1.3514155149459839,
      0.4480148255825043,
      0.5564614534378052,
      0.5330612063407898,
      -0.9530625939369202,
      -0.10600189119577408,
      -0.29450392723083496,
      0.9269813299179077,
      0.13489291071891785,
      -0.28097403049468994,
      0.23005835711956024,
      0.15250152349472046,
      -0.5766756534576416,
      0.2814614772796631,
      -0.031987547874450684,
      -0.23696699738502502,
      -0.6597386598587036,
      1.1042190790176392,
      0.9249008297920227,
      0.2442474365234375,
      -0.25575119256973267,
      -0.6588891744613647,
      0.0916152223944664,
      -0.026582028716802597,
      -0.08860784024000168,
      -1.2052255868911743,
      -0.023833679035305977,
      -0.7849944829940796
    ],
    "label": {
      "level1": "AMO",
      "level2": "F",
      "level3": "F",
      "leafContractCategory": "F",
      "rootCause": "Missing Required State-specific Method Order",
      "effect": "BP",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model construction",
      "detectionTechnique": "Runtime Checking",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): AMO (API Method Order)\nThe issue arises from calling BatchNormalization improperly outside the model definition. The correct method order is required for the layer to function as expected.\n\nLevel 2: F (Eventually Required Condition)\nThe batch normalization layer must eventually be called within the model's structure before activation layers to properly normalize inputs.\n\nLevel 3 (Hybrid Patterns): F (Eventually Required Condition)\nThe normalization step must be inserted in the right sequence for the model to behave as expected, affecting training and prediction consistency.\n\nLeaf Contract Category: F (Eventually Required Condition)\nThe model expects proper ordering of layers (BatchNormalization before Activation) to ensure expected behavior.\n\nRoot Cause: Missing Required State-specific Method Order\nThe error is caused by not placing BatchNormalization within the model structure, leading to the function not being executed as part of the computation graph.\n\nEffect: BP (Bad Prediction)\nThe model trains, but predictions may not be optimal since normalization is not applied where expected, affecting learning stability.\n\nML Library: Keras\nThe issue is related to Keras's layer ordering requirements.\n\nContract Violation Location: Model Construction\nThe problem occurs while defining the model architecture.\n\nDetection Technique: Runtime Checking\nThe issue is detected during execution, as the user notices similar results with and without BatchNormalization, indicating it was not properly integrated into the model.\n\n\n"
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/40278868",
    "title": "",
    "question": "This is in fact really easy. Here's the code (for those who don't want to read all that text):\n\ninputs=Input((784,))\nencode=Dense(10, input_shape=[784])(inputs)\ndecode=Dense(784, input_shape=[10])\n\nmodel=Model(input=inputs, output=decode(encode))\n\ninputs_2=Input((10,))\ndecode_model=Model(input=inputs_2, output=decode(inputs_2))\nIn this setup, the decode_model will use the same decode layer as the model. If you train the model, the decode_model will be trained, too.\n\nActual question:\n\nI'm trying to create a simple autoencoder for MNIST in Keras:\n\nThis is the code so far:\n\nmodel=Sequential()\nencode=Dense(10, input_shape=[784])\ndecode=Dense(784, input_shape=[10])\n\nmodel.add(encode)\nmodel.add(decode)\n\nmodel.compile(loss=\"mse\",\n             optimizer=\"adadelta\",\n             metrics=[\"accuracy\"])\n\ndecode_model=Sequential()\ndecode_model.add(decode)\nI'm training it to learn the identity function\n\nmodel.fit(X_train,X_train,batch_size=50, nb_epoch=10, verbose=1, \n          validation_data=[X_test, X_test])\nThe reconstruction is quite interesting:\n\nenter image description here\n\nBut I would also like to look at the representations of cluster. What is the output of passing [1,0...0] to the decoding layer ? This should be the \"cluster-mean\" of one class in MNIST.\n\nIn order to do that I created a second model decode_model, which reuses the decoder layer. But if I try to use that model, it complains:\n\nException: Error when checking : expected dense_input_5 to have shape (None, 784) but got array with shape (10, 10)\n\nThat seemed strange. It's simply a dense layer, the Matrix wouldn't even be able to process 784-dim input. I decided to look at the model summary:\n\n____________________________________________________________________________________________________\nLayer (type)                     Output Shape          Param #     Connected to                     \n====================================================================================================\ndense_14 (Dense)                 (None, 784)           8624        dense_13[0][0]                   \n====================================================================================================\nTotal params: 8624\nIt is connected to dense_13. It's difficult to keep track of the names of the layers, but that looks like the encoder layer. Sure enough, the model summary of the whole model is:\n\n____________________________________________________________________________________________________\nLayer (type)                     Output Shape          Param #     Connected to                     \n====================================================================================================\ndense_13 (Dense)                 (None, 10)            7850        dense_input_6[0][0]              \n____________________________________________________________________________________________________\ndense_14 (Dense)                 (None, 784)           8624        dense_13[0][0]                   \n====================================================================================================\nTotal params: 16474\n____________________\nApparently the layers are permanently connected. Strangely there is no input layer in my decode_model.\n\nHow can I reuse a layer in Keras ? I've looked at the functional API, but there too, layers are fused together.",
    "answer": "8\n\nOh, nevermind.\n\nI should have read the entire functional API: https://keras.io/getting-started/functional-api-guide/#shared-layers\n\nHere's one of the predictions (maybe still lacking some training): enter image description here\n\nI'm guessing this could be a 3 ? Well at least it works now.\n\nAnd for those with similar problems, here's the updated code:\n\ninputs=Input((784,))\nencode=Dense(10, input_shape=[784])(inputs)\ndecode=Dense(784, input_shape=[10])\n\nmodel=Model(input=inputs, output=decode(encode))\n\nmodel.compile(loss=\"mse\",\n             optimizer=\"adadelta\",\n             metrics=[\"accuracy\"])\n\ninputs_2=Input((10,))\ndecode_model=Model(input=inputs_2, output=decode(inputs_2))\nI only compiled one of the models. For training you need to compile a model, for prediction that is not necessary.",
    "mlApiName": "keras.models.fit, keras.models.compile",
    "embedding": [
      -0.14277836680412292,
      0.181794211268425,
      -2.3106255531311035,
      -1.2296462059020996,
      1.7668254375457764,
      -0.4782612919807434,
      0.2638036906719208,
      1.036544680595398,
      -0.7502415776252747,
      -0.9662117958068848,
      -0.7904716730117798,
      0.1825249344110489,
      1.6690975427627563,
      0.3751623034477234,
      -0.20267945528030396,
      -0.28531938791275024,
      0.0802263543009758,
      -0.10516954958438873,
      -0.27284273505210876,
      0.7666547894477844,
      -0.21897713840007782,
      -0.010869654826819897,
      0.35472872853279114,
      -0.6534175872802734,
      1.5646002292633057,
      0.7574988603591919,
      -0.8235981464385986,
      0.8317320346832275,
      -0.2549872398376465,
      0.05701393634080887,
      1.5022141933441162,
      -0.7786330580711365,
      0.12472008168697357,
      -0.5409838557243347,
      -1.6935486793518066,
      -0.7393409609794617,
      0.5599914193153381,
      0.2175717055797577,
      0.09051166474819183,
      0.5218948125839233,
      1.1159381866455078,
      0.3755691349506378,
      -0.634139895439148,
      0.8491657972335815,
      0.09321960061788559,
      0.7668553590774536,
      1.349794864654541,
      -0.19181960821151733,
      1.35548734664917,
      -0.47646915912628174,
      0.6204262971878052,
      0.7551500201225281,
      0.5092899203300476,
      -0.0782511755824089,
      1.0985338687896729,
      0.612663745880127,
      -0.8770536780357361,
      0.7766873836517334,
      0.831946074962616,
      -0.9456290006637573,
      -0.08135192096233368,
      0.9276072978973389,
      -1.993730902671814,
      0.49639976024627686,
      0.16274714469909668,
      0.21383363008499146,
      -0.6957404017448425,
      1.1725512742996216,
      -0.08664864301681519,
      -0.6902770400047302,
      0.7771885991096497,
      0.41155368089675903,
      -0.4789935052394867,
      0.2751256823539734,
      -0.8349246978759766,
      -0.28391844034194946,
      -0.6578708291053772,
      -0.5538586974143982,
      -0.0738823339343071,
      0.4756593704223633,
      -0.32629507780075073,
      0.722811758518219,
      0.9805728197097778,
      -0.5208279490470886,
      0.2395973950624466,
      0.19582241773605347,
      -1.1377947330474854,
      -0.41443178057670593,
      -0.7842494249343872,
      1.2303684949874878,
      -0.06872484087944031,
      -0.17152021825313568,
      0.48000383377075195,
      0.7119877338409424,
      -0.7448583245277405,
      -0.40663912892341614,
      -0.197871595621109,
      0.1756061166524887,
      -0.8808844685554504,
      -0.024001043289899826,
      -0.4025254547595978,
      0.06125008687376976,
      -0.2219083607196808,
      -0.6498443484306335,
      -0.2012617141008377,
      1.0778714418411255,
      0.03263413906097412,
      -0.3362005054950714,
      -0.13021638989448547,
      0.5391905307769775,
      -0.32827112078666687,
      0.16683520376682281,
      -0.4607854187488556,
      0.37876659631729126,
      -0.09049393236637115,
      -0.08180642127990723,
      0.5015985369682312,
      -0.6107604503631592,
      -0.2569013237953186,
      0.09982930123806,
      -0.05698366463184357,
      -0.5650719404220581,
      0.6783443093299866,
      -0.39110058546066284,
      -0.20929208397865295,
      0.9435304999351501,
      -0.20536983013153076,
      0.16293729841709137,
      -0.2412843257188797,
      -1.2338021993637085,
      0.5448442697525024,
      -0.39868947863578796,
      -0.08859823644161224,
      0.7388797998428345,
      0.31503745913505554,
      1.3216174840927124,
      -1.5025911331176758,
      -0.49057653546333313,
      0.4513727128505707,
      0.49816983938217163,
      0.5027830004692078,
      0.07933169603347778,
      -0.1454719454050064,
      -1.1138314008712769,
      0.6744847297668457,
      -0.7302575707435608,
      0.13665811717510223,
      -0.7858985066413879,
      -0.785241425037384,
      0.23545631766319275,
      -0.15077541768550873,
      0.33641672134399414,
      -1.0519044399261475,
      0.31432461738586426,
      0.5360531210899353,
      -0.19303344190120697,
      0.4571809768676758,
      0.18251705169677734,
      0.3328510820865631,
      0.28988730907440186,
      0.9873396754264832,
      -0.06621553748846054,
      -0.6805028319358826,
      0.7567105293273926,
      -0.14343714714050293,
      -0.6105332374572754,
      -0.028615763410925865,
      0.22729358077049255,
      -0.028244927525520325,
      0.1714545041322708,
      -1.0700271129608154,
      -1.1168586015701294,
      -0.14882536232471466,
      0.1826000064611435,
      0.1552630066871643,
      0.7106988430023193,
      0.8472972512245178,
      -0.8572509288787842,
      0.437218576669693,
      0.25274911522865295,
      1.3394579887390137,
      0.24423904716968536,
      1.4941102266311646,
      0.15461531281471252,
      -0.5194104909896851,
      -0.3470253050327301,
      -0.24160557985305786,
      0.006510553881525993,
      0.23905853927135468,
      -0.29985302686691284,
      0.7623865008354187,
      0.48205021023750305,
      -0.7308768033981323,
      0.20797348022460938,
      0.010130137205123901,
      -0.5584548711776733,
      0.5032365322113037,
      -0.8905680775642395,
      0.756213903427124,
      0.1269141584634781,
      -0.34881624579429626,
      0.48785924911499023,
      0.09053503721952438,
      0.9684851169586182,
      -0.3670492172241211,
      0.5822382569313049,
      -0.6310506463050842,
      0.48956984281539917,
      -0.9458993673324585,
      0.3545176386833191,
      0.9150301218032837,
      0.12530489265918732,
      0.1864597052335739,
      0.24094770848751068,
      0.22529353201389313,
      -0.3583914339542389,
      0.07528293877840042,
      -0.5332449078559875,
      -0.37854433059692383,
      0.0704861581325531,
      0.3407628536224365,
      -0.6292022466659546,
      0.877655565738678,
      0.33547040820121765,
      0.413215309381485,
      -0.5751503109931946,
      0.3650132119655609,
      -0.39060887694358826,
      -1.0563294887542725,
      0.232204407453537,
      0.1184074655175209,
      -0.9452937245368958,
      0.8355184197425842,
      -0.15649005770683289,
      -0.22410327196121216,
      0.25541770458221436,
      0.4594883620738983,
      1.2852864265441895,
      -0.9793455004692078,
      -0.10327658802270889,
      0.18512672185897827,
      0.8200343251228333,
      -0.19298326969146729,
      -0.1553940325975418,
      -1.1492745876312256,
      -0.05086646229028702,
      -0.14948125183582306,
      -0.1552789807319641,
      -0.19912783801555634,
      0.7292808294296265,
      -0.2508153021335602,
      0.7291306257247925,
      -0.25240492820739746,
      0.3351098597049713,
      1.3425089120864868,
      -0.6544710993766785,
      -0.5144222974777222,
      -0.41453424096107483,
      1.20505690574646,
      -0.42962440848350525,
      0.3667128086090088,
      -0.03971850499510765,
      0.17337995767593384,
      -0.11384313553571701,
      -0.8835375905036926,
      -0.4887201189994812,
      -0.089845672249794,
      0.20322982966899872,
      0.011257942765951157,
      -0.008264095522463322,
      -0.12754495441913605,
      0.5165966749191284,
      0.804680585861206,
      0.4591817259788513,
      0.4398539960384369,
      0.47094962000846863,
      -0.3905943036079407,
      -0.04009198397397995,
      -0.3105873167514801,
      0.2447526603937149,
      -0.8818371295928955,
      -0.3477894365787506,
      0.08274994790554047,
      -0.06481383740901947,
      -0.047160230576992035,
      -0.14501698315143585,
      -0.42073094844818115,
      0.7802218198776245,
      0.594014585018158,
      0.4780023396015167,
      -0.2853367328643799,
      -0.08222366124391556,
      0.1347920298576355,
      1.0283689498901367,
      -0.29855966567993164,
      0.8101803064346313,
      0.888940155506134,
      -0.581808865070343,
      0.2714017927646637,
      -0.8277999758720398,
      -0.189958393573761,
      1.0231608152389526,
      0.45198217034339905,
      0.13200435042381287,
      0.3055073320865631,
      -0.10104385763406754,
      -0.6075766682624817,
      0.2787187099456787,
      -0.43431556224823,
      -0.45853307843208313,
      -0.5845915675163269,
      -0.0558309406042099,
      -0.4089494049549103,
      0.0323731005191803,
      -0.41334840655326843,
      -0.3403356373310089,
      0.10021398216485977,
      -0.3757692277431488,
      0.18909122049808502,
      -0.05774862691760063,
      0.6380476951599121,
      -0.1898368000984192,
      0.40950819849967957,
      -0.5575718283653259,
      -0.17692482471466064,
      1.096713900566101,
      0.18374428153038025,
      -0.20667116343975067,
      -0.2912209630012512,
      -0.5291884541511536,
      0.9710952639579773,
      -0.16315579414367676,
      0.65754634141922,
      -0.9268121719360352,
      -0.9208189249038696,
      -0.22827602922916412,
      -0.6269627809524536,
      -0.045151058584451675,
      0.06214336305856705,
      0.5804785490036011,
      -0.33212587237358093,
      0.4458710551261902,
      0.7137346863746643,
      -0.3786020278930664,
      0.16173064708709717,
      0.20749567449092865,
      -1.0632697343826294,
      -1.0192205905914307,
      1.0862070322036743,
      0.47172701358795166,
      -0.13115490972995758,
      0.4872279167175293,
      -0.01727563887834549,
      -0.9666138887405396,
      0.12113288789987564,
      -0.2572888135910034,
      0.30754274129867554,
      -0.20285043120384216,
      -0.13561858236789703,
      0.34457045793533325,
      1.5930811166763306,
      0.038160402327775955,
      -0.26608505845069885,
      -0.17196021974086761,
      -0.508497416973114,
      0.02237636409699917,
      0.7414581179618835,
      -0.16280455887317657,
      0.30963844060897827,
      0.1466485857963562,
      -0.5991851091384888,
      -0.20667478442192078,
      -0.6637833714485168,
      0.19499148428440094,
      -0.11905437707901001,
      -0.17304611206054688,
      -0.9149354100227356,
      0.3756048083305359,
      -0.0530509389936924,
      0.20872369408607483,
      0.12152606248855591,
      -0.4649744927883148,
      -0.2986893355846405,
      0.025253912433981895,
      0.9483332633972168,
      0.008523862808942795,
      0.6308302283287048,
      -0.9387525916099548,
      -0.29534757137298584,
      0.6763705611228943,
      0.21309569478034973,
      -0.5597478151321411,
      -0.2517182230949402,
      -0.21276640892028809,
      0.29229536652565,
      -1.0425432920455933,
      0.8613957762718201,
      0.35166624188423157,
      -0.8213350176811218,
      0.5434077382087708,
      -1.2675070762634277,
      -0.35328903794288635,
      -0.20500905811786652,
      -0.2907642722129822,
      -0.0915699228644371,
      -0.5948686003684998,
      -0.3177432119846344,
      -0.6500154137611389,
      0.17414118349552155,
      0.20511557161808014,
      0.22070574760437012,
      0.9536442160606384,
      -0.05716032534837723,
      -1.6258811950683594,
      0.0312567763030529,
      -0.06876439601182938,
      0.8257232308387756,
      0.995130181312561,
      -0.3720511794090271,
      -0.706944465637207,
      -0.5090662240982056,
      0.9899901151657104,
      -0.32166653871536255,
      0.07913036644458771,
      1.5938259363174438,
      0.360122412443161,
      0.6331466436386108,
      1.125644564628601,
      0.7133641839027405,
      -1.2883776426315308,
      0.6641407012939453,
      0.21075277030467987,
      0.18347683548927307,
      -0.3970712423324585,
      -0.5452399253845215,
      0.047415606677532196,
      -0.15540386736392975,
      1.1296272277832031,
      -0.41674160957336426,
      0.5257759094238281,
      -0.048501044511795044,
      -0.19327817857265472,
      -0.6040535569190979,
      -0.7669587135314941,
      0.8183554410934448,
      0.18378666043281555,
      0.6696539521217346,
      -0.7874561548233032,
      -0.9935548901557922,
      1.2513138055801392,
      0.20495745539665222,
      -0.23917347192764282,
      0.5049601197242737,
      0.7767800092697144,
      1.9956684112548828,
      -0.2600799798965454,
      -0.1482502669095993,
      -0.026355890557169914,
      0.24691864848136902,
      0.4563697576522827,
      0.2720305025577545,
      0.5034002065658569,
      -0.5588297247886658,
      0.6366044282913208,
      -0.6251352429389954,
      -1.171947956085205,
      0.08904536068439484,
      -1.1898125410079956,
      0.6317219734191895,
      0.8766576051712036,
      -1.1978459358215332,
      0.19119831919670105,
      0.6551383137702942,
      -0.45026299357414246,
      0.0691227912902832,
      0.5134919285774231,
      -0.3628568947315216,
      -0.017291512340307236,
      0.4406753182411194,
      0.8373835682868958,
      0.02020983397960663,
      -1.4210466146469116,
      -0.31998273730278015,
      -0.6050615906715393,
      -0.02854892611503601,
      1.8685221672058105,
      0.12358943372964859,
      -0.13783715665340424,
      -0.35593798756599426,
      -0.47222697734832764,
      0.8761199712753296,
      0.0006267688586376607,
      -0.5579474568367004,
      -0.6285585761070251,
      -0.7263975143432617,
      -0.46052056550979614,
      -0.14403358101844788,
      0.34409764409065247,
      0.45032748579978943,
      0.976733386516571,
      -0.29863569140434265,
      -0.09797173738479614,
      -0.1841498762369156,
      0.5197598338127136,
      0.36822137236595154,
      -0.328776091337204,
      1.3520222902297974,
      -0.7195708155632019,
      -0.49415624141693115,
      -0.2520117163658142,
      -0.09253860265016556,
      0.17907652258872986,
      0.3264310657978058,
      -0.0955505296587944,
      0.059807706624269485,
      -1.2947487831115723,
      -0.3520224988460541,
      0.8324475884437561,
      -0.8324812054634094,
      -0.7559335827827454,
      0.706785261631012,
      -0.4612223207950592,
      -0.8572772145271301,
      0.18192200362682343,
      -1.0493075847625732,
      -0.05625332519412041,
      0.4835537075996399,
      -1.8636244535446167,
      -0.01748853549361229,
      -0.3510081171989441,
      0.3866828680038452,
      -0.19422359764575958,
      -1.069385290145874,
      0.30755290389060974,
      0.9428934454917908,
      -0.5946717858314514,
      0.0388030968606472,
      0.29936230182647705,
      1.0390903949737549,
      0.25519904494285583,
      0.571474015712738,
      1.2804139852523804,
      0.0730285793542862,
      -0.28783971071243286,
      -0.659048855304718,
      0.028111804276704788,
      0.8512645959854126,
      0.973778247833252,
      0.43628159165382385,
      -0.82389235496521,
      -0.2874433696269989,
      -1.0762649774551392,
      0.32434070110321045,
      -1.1978514194488525,
      0.3001689612865448,
      -0.8110781908035278,
      -0.21159063279628754,
      -0.6640332341194153,
      -0.1630214899778366,
      -0.7116962671279907,
      -1.8333228826522827,
      0.2702718675136566,
      1.5716445446014404,
      0.9178569912910461,
      -0.3367060720920563,
      -1.1421775817871094,
      -0.6661944389343262,
      -0.0054529448971152306,
      0.33192354440689087,
      0.7643041610717773,
      0.5570545792579651,
      -1.68405282497406,
      0.7482421398162842,
      0.46314963698387146,
      -0.5379989147186279,
      -0.26240959763526917,
      0.7009891271591187,
      0.21498043835163116,
      -0.8076722621917725,
      -0.25325652956962585,
      0.21198377013206482,
      -1.352693796157837,
      -0.05761570483446121,
      1.032456398010254,
      -0.31235378980636597,
      1.4896318912506104,
      -0.251895934343338,
      -0.7093209624290466,
      0.21763214468955994,
      0.15156997740268707,
      -0.8908936381340027,
      -0.3843836486339569,
      1.3501217365264893,
      -0.24531890451908112,
      0.3413297235965729,
      -0.10773397982120514,
      -0.22302770614624023,
      0.09333408623933792,
      -0.3504446744918823,
      -1.4900293350219727,
      -0.3558981418609619,
      1.4545477628707886,
      1.3927042484283447,
      -1.2551840543746948,
      0.18517951667308807,
      1.3525687456130981,
      -0.1640166938304901,
      0.3125508427619934,
      -0.07613550126552582,
      0.3530987799167633,
      0.9025496244430542,
      0.23333580791950226,
      0.33481481671333313,
      -0.40166860818862915,
      0.6606449484825134,
      -1.0845266580581665,
      1.3041009902954102,
      0.03667270019650459,
      -0.44389164447784424,
      -0.06273393332958221,
      -0.07517855614423752,
      -1.1552706956863403,
      0.7316519618034363,
      -1.8156806230545044,
      -0.027447916567325592,
      -0.6934576034545898,
      -0.5452583432197571,
      0.0515328124165535,
      1.0078015327453613,
      0.4433874487876892,
      -1.3442752361297607,
      0.26734957098960876,
      -1.2860431671142578,
      -0.3365531265735626,
      -1.190599799156189,
      1.2202235460281372,
      -0.2654479742050171,
      0.6625657081604004,
      0.5046053528785706,
      1.4173415899276733,
      -0.0032588995527476072,
      0.24412766098976135,
      -0.4982457756996155,
      0.8143393397331238,
      0.14981487393379211,
      -0.7339596152305603,
      1.3482205867767334,
      1.1032298803329468,
      0.2077113538980484,
      -0.1491515040397644,
      0.6012049913406372,
      1.3043850660324097,
      -0.1633264571428299,
      -0.7358520030975342,
      1.1002949476242065,
      0.17595037817955017,
      -0.04677744209766388,
      -0.5544092059135437,
      -0.44999030232429504,
      -0.47306522727012634,
      0.8450892567634583,
      -0.22469457983970642,
      -0.13138827681541443,
      -0.794249951839447,
      0.20468465983867645,
      -0.17353211343288422,
      -0.5855841040611267,
      0.46041181683540344,
      -0.8408524990081787,
      -0.9601882696151733,
      0.16096727550029755,
      0.572455644607544,
      -0.12833933532238007,
      0.04712271690368652,
      0.6674829125404358,
      -0.14166010916233063,
      0.4803069531917572,
      0.8359485864639282,
      -0.045781999826431274,
      -0.5864740610122681,
      0.39713412523269653,
      0.09872198104858398,
      0.8221742510795593,
      0.3337344825267792,
      0.37054646015167236,
      -1.1603001356124878,
      0.38232094049453735,
      -1.0119057893753052,
      0.11999240517616272,
      -0.2581871449947357,
      -0.5214858651161194,
      -0.047922953963279724,
      -0.18855607509613037,
      0.2263386845588684,
      -1.2974187135696411,
      1.0377857685089111,
      -0.34895390272140503,
      -0.8492588996887207,
      0.6545460224151611,
      0.793391764163971,
      -0.23295509815216064,
      0.2614193856716156,
      0.08290950208902359,
      0.48187196254730225,
      0.4739682972431183,
      -0.5515069961547852,
      0.1595337688922882,
      0.13370086252689362,
      -0.31167906522750854,
      -0.3253724277019501,
      -0.02998032048344612,
      0.2060745507478714,
      -0.424126535654068,
      0.5445037484169006,
      -0.6228758692741394,
      0.2829965651035309,
      -0.6682618260383606,
      -0.3811705708503723,
      -0.9964098334312439,
      0.052763305604457855,
      0.4715988337993622,
      -0.2144978642463684,
      -1.1971827745437622,
      1.0168265104293823,
      -0.01834615133702755,
      -0.7826993465423584,
      0.05749398469924927,
      -0.13076113164424896,
      -0.21387536823749542,
      0.34339964389801025,
      -0.9976383447647095,
      0.27778100967407227,
      -1.2361899614334106,
      0.9602323770523071,
      -0.07600376754999161,
      -0.04321323707699776,
      -0.3586291968822479,
      -0.8205989599227905,
      -1.543996810913086,
      0.07869954407215118,
      -0.9187219142913818,
      0.8598806858062744,
      0.8645989894866943,
      -0.12531492114067078,
      -0.18790946900844574,
      -0.8153537511825562,
      -1.2278082370758057,
      1.3781675100326538,
      -0.1715661734342575,
      -0.16676534712314606,
      0.46524810791015625,
      -0.4476931691169739,
      -0.12514959275722504,
      0.18959878385066986,
      -0.8410528302192688,
      0.4223475754261017,
      -0.12008155882358551,
      0.8494781255722046,
      1.0810785293579102,
      0.1988515555858612,
      0.21178996562957764,
      -0.7192168831825256,
      0.5289589762687683,
      0.606584370136261,
      -0.44264885783195496,
      -0.7109478116035461,
      0.25517737865448,
      -0.1814148724079132
    ],
    "label": {
      "level1": "AMO",
      "level2": "G",
      "level3": "G",
      "leafContractCategory": "G",
      "rootCause": "Missing Required Method Order",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Train",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): AMO (API Method Order)\nThe issue stems from incorrect ordering of API calls, specifically compile not being called for the second model before attempting predictions.\n\nLevel 2: G (Graph-Related Issue)\nThe problem is related to how Keras constructs its computation graph, where layers are permanently connected after compilation.\n\nLevel 3 (Hybrid Patterns): G (Graph-Related Issue)\nThe model architecture is not correctly structured for reusing layers in a new model, causing an issue in the computational graph.\n\nLeaf Contract Category: G (Graph-Related Issue)\nThe issue directly arises from how the graph is built and connected, affecting proper layer reuse.\n\nRoot Cause: Missing Required Method Order\nThe user expected to reuse a layer in a separate model but didn't call compile correctly before attempting predictions.\n\nEffect: Crash\nThe incorrect method order results in a runtime error when attempting to use the second model.\n\nML Library: Keras\nThe issue specifically relates to Keras' handling of models and layer reusability.\n\nContract Violation Location: Train\nThe error manifests during training, particularly when trying to use the second model.\n\nDetection Technique: Static\nThe issue can be identified by inspecting the source code and ensuring that compile is called correctly before using the model.\n\n\n"
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/48846332",
    "title": "",
    "question": "10\n\nI train a model A and try to use the output of the intermediate layer with the name=\"layer_x\" as an additional input for model B.\n\nI tried to use the output of the intermediate layer like on the Keras doc https://keras.io/getting-started/faq/#how-can-i-obtain-the-output-of-an-intermediate-layer.\n\nModel A:\n\ninputs = Input(shape=(100,))\ndnn = Dense(1024, activation='relu')(inputs)\ndnn = Dense(128, activation='relu', name=\"layer_x\")(dnn)\ndnn = Dense(1024, activation='relu')(dnn)\noutput = Dense(10, activation='softmax')(dnn)\nModel B:\n\ninput_1 = Input(shape=(200,))\ninput_2 = Input(shape=(100,)) # input for model A\n\n# loading model A\nmodel_a = keras.models.load_model(path_to_saved_model_a)\n\nintermediate_layer_model = Model(inputs=model_a.input, \n                                 outputs=model_a.get_layer(\"layer_x\").output)\n\nintermediate_output = intermediate_layer_model.predict(data)\n\nmerge_layer = concatenate([input_1, intermediate_output])\ndnn_layer = Dense(512, activation=\"relu\")(merge_layer)\noutput = Dense(5, activation=\"sigmoid\")(dnn_layer)\nmodel = keras.models.Model(inputs=[input_1, input_2], outputs=output)\nWhen I debug I get an error on this line:\n\nintermediate_layer_model = Model(inputs=model_a.input, \n                                 outputs=model_a.get_layer(\"layer_x\").output)\n\nFile \"..\", line 89, in set_model\n  outputs=self.neural_net_asc.model.get_layer(\"layer_x\").output)\nFile \"C:\\WinPython\\python-3.5.3.amd64\\lib\\site-packages\\keras\\legacy\\interfaces.py\", line 87, in wrapper\n  return func(*args, **kwargs)\nFile \"C:\\WinPython\\python-3.5.3.amd64\\lib\\site-packages\\keras\\engine\\topology.py\", line 1592, in __init__\n  mask = node.output_masks[tensor_index]\nAttributeError: 'Node' object has no attribute 'output_masks'\nI can access the tensor with get_layer(\"layer_x\").output and the output_mask is None. Do I have to set manually an output mask and how do I set up this output mask if needed?",
    "answer": "There are two things that you seem to be doing wrong :\n\nintermediate_output = intermediate_layer_model.predict(data)\nwhen you do .predict(), you are actually passing data through the graph and asking what will be the result. When you do that, intermediate_output will be a numpy array and not a layer as you would like it to be.\n\nSecondly, you don't need to recreate a new intermediate model. You can directly use the part of model_a that interest you.\n\nHere is a code that \"compiles\" for me :\n\nfrom keras.layers import Input, Dense, concatenate\nfrom keras.models import Model\n\ninputs = Input(shape=(100,))\ndnn = Dense(1024, activation='relu')(inputs)\ndnn = Dense(128, activation='relu', name=\"layer_x\")(dnn)\ndnn = Dense(1024, activation='relu')(dnn)\noutput = Dense(10, activation='softmax')(dnn)\n\nmodel_a = Model(inputs=inputs, outputs=output)\n\n# You don't need to recreate an input for the model_a, \n# it already has one and you can reuse it\ninput_b = Input(shape=(200,))\n\n# Here you get the layer that interests you from model_a, \n# it is still linked to its input layer, you just need to remember it for later\nintermediate_from_a = model_a.get_layer(\"layer_x\").output\n\n# Since intermediate_from_a is a layer, you can concatenate it with the other input\nmerge_layer = concatenate([input_b, intermediate_from_a])\ndnn_layer = Dense(512, activation=\"relu\")(merge_layer)\noutput_b = Dense(5, activation=\"sigmoid\")(dnn_layer)\n# Here you remember that one input is input_b and the other one is from model_a\nmodel_b = Model(inputs=[input_b, model_a.input], outputs=output_b)\nI hope this is what you wanted to do.\n\nPlease tell me if something isn't clear :-)",
    "mlApiName": "keras.models.Model, keras.models.model.predict",
    "embedding": [
      -0.4650104343891144,
      0.48328742384910583,
      -2.4318325519561768,
      -1.1593674421310425,
      0.9746169447898865,
      -0.6221532225608826,
      0.1435920149087906,
      0.4343102276325226,
      -0.23591406643390656,
      -0.47529008984565735,
      -1.0313342809677124,
      0.793775200843811,
      2.1677908897399902,
      -0.04306214675307274,
      0.3220504820346832,
      -0.3387223184108734,
      0.9259517788887024,
      -0.12306175380945206,
      0.7340624928474426,
      0.4867074489593506,
      -0.2168586254119873,
      -0.7705816030502319,
      0.4002837538719177,
      -0.5328393578529358,
      1.6273390054702759,
      0.24683810770511627,
      -0.543644905090332,
      0.21017493307590485,
      -0.3301180303096771,
      0.0714074894785881,
      0.6888311505317688,
      -1.166257619857788,
      0.36773863434791565,
      -0.634563148021698,
      -1.8932726383209229,
      -1.0549627542495728,
      0.7075686454772949,
      -0.18311887979507446,
      -0.46667495369911194,
      0.20304562151432037,
      1.3318281173706055,
      -0.18115274608135223,
      -0.22444692254066467,
      0.4655883312225342,
      -0.5120337009429932,
      -0.037318598479032516,
      0.8910084366798401,
      0.26399174332618713,
      0.15126021206378937,
      -0.6705260872840881,
      0.6727973818778992,
      0.9592518210411072,
      0.356463760137558,
      0.06344606727361679,
      1.489815354347229,
      0.4180326461791992,
      0.386984646320343,
      -0.17431968450546265,
      1.4215329885482788,
      -0.7651064395904541,
      0.4196842312812805,
      1.3712905645370483,
      -0.9402152299880981,
      1.1740057468414307,
      0.7166225910186768,
      -0.10539744049310684,
      -0.8827913999557495,
      0.9875532388687134,
      -0.6534314155578613,
      -0.3919272720813751,
      0.18039217591285706,
      0.40885233879089355,
      0.2092890739440918,
      0.09701089560985565,
      -0.2013741284608841,
      0.12693756818771362,
      -0.5177736878395081,
      -0.3757094144821167,
      -0.014180254191160202,
      0.9410805106163025,
      0.5123916864395142,
      0.9836738109588623,
      1.305922031402588,
      -0.5367904901504517,
      -0.08633093535900116,
      0.7045055031776428,
      -1.2250179052352905,
      -0.3719531297683716,
      -0.9259833097457886,
      1.0592821836471558,
      -0.34722036123275757,
      0.31082332134246826,
      0.19690236449241638,
      1.0969600677490234,
      -0.776512086391449,
      -0.8928079009056091,
      -0.1538301706314087,
      0.5267297029495239,
      -0.44967153668403625,
      -0.02974054403603077,
      -0.24395544826984406,
      0.5982042551040649,
      -0.11609409749507904,
      -1.2899692058563232,
      0.1257128119468689,
      1.2183486223220825,
      -0.08373810350894928,
      -0.7614830136299133,
      0.25807997584342957,
      -0.1398618072271347,
      -1.1244310140609741,
      0.25643494725227356,
      -0.30072009563446045,
      -0.1476820409297943,
      -0.1320587694644928,
      -0.5796532034873962,
      0.34204983711242676,
      0.28102928400039673,
      0.25410622358322144,
      0.33779177069664,
      0.006934052798897028,
      -0.18310953676700592,
      0.6257924437522888,
      -0.45018866658210754,
      0.23916421830654144,
      0.9262231588363647,
      -0.9930362105369568,
      0.037877731025218964,
      0.08750994503498077,
      -0.8621418476104736,
      0.3042832314968109,
      -0.15000593662261963,
      -0.14713096618652344,
      0.9312555193901062,
      1.1777962446212769,
      1.4297086000442505,
      -0.8420697450637817,
      -1.3458000421524048,
      0.4560248553752899,
      0.3584398329257965,
      0.5496537685394287,
      0.242206409573555,
      -0.3752237558364868,
      -1.0923025608062744,
      0.2818169593811035,
      -0.40419802069664,
      0.6960934400558472,
      -0.29178062081336975,
      -0.7772154808044434,
      0.3858278691768646,
      0.16293813288211823,
      0.7591798305511475,
      -0.906725287437439,
      0.7501909136772156,
      0.4615146219730377,
      -0.8011388182640076,
      0.44663357734680176,
      -0.27877774834632874,
      0.2444295436143875,
      0.22769849002361298,
      1.2276291847229004,
      -0.22443655133247375,
      -0.31786230206489563,
      0.6600750088691711,
      -0.8213483691215515,
      -1.0544462203979492,
      0.08007949590682983,
      0.055545222014188766,
      -0.1678883582353592,
      0.16314421594142914,
      -0.3403097093105316,
      -0.25880277156829834,
      -0.2262343019247055,
      0.2972296476364136,
      0.29972267150878906,
      0.4049653112888336,
      1.3750766515731812,
      -0.42691361904144287,
      0.4016963541507721,
      -0.23622997105121613,
      1.5303034782409668,
      -0.37186199426651,
      1.0274897813796997,
      -0.11357195675373077,
      -0.7449495792388916,
      0.2096167653799057,
      -0.15682002902030945,
      0.18164047598838806,
      0.0014349124394357204,
      -0.3950617015361786,
      0.4744400084018707,
      0.24412891268730164,
      -0.7441078424453735,
      -0.47940540313720703,
      -0.14003407955169678,
      0.5662459135055542,
      0.6545149683952332,
      -1.0259168148040771,
      1.081650733947754,
      0.16315396130084991,
      0.11736223846673965,
      0.47005292773246765,
      -0.4892858564853668,
      0.5441755056381226,
      -1.1204427480697632,
      0.9176676869392395,
      -0.47350209951400757,
      0.32950031757354736,
      -0.20861701667308807,
      0.2404877245426178,
      0.8782094120979309,
      -0.1465556025505066,
      0.6627370715141296,
      0.336019366979599,
      0.038734838366508484,
      -0.5369941592216492,
      0.6181209087371826,
      -0.3617705702781677,
      -0.11700743436813354,
      -0.31312382221221924,
      -0.03117273934185505,
      -0.4795263707637787,
      0.8665482997894287,
      0.7045450806617737,
      0.3850518465042114,
      -0.54205322265625,
      -0.25813761353492737,
      0.27879300713539124,
      -1.0965001583099365,
      0.019543932750821114,
      -0.35611435770988464,
      -1.424246907234192,
      0.11071229726076126,
      0.3196040391921997,
      -0.006015715189278126,
      0.08245410770177841,
      1.2135040760040283,
      0.8918235898017883,
      -0.35028448700904846,
      0.3602142333984375,
      -0.29757097363471985,
      0.07955411076545715,
      0.06452587991952896,
      -0.026721077039837837,
      -1.5818018913269043,
      0.5710256695747375,
      -0.08419912308454514,
      -0.48607543110847473,
      0.04744601249694824,
      0.8244478702545166,
      0.20278114080429077,
      0.8276166915893555,
      0.4848414659500122,
      0.016330575570464134,
      1.1683311462402344,
      -0.8745618462562561,
      -0.50655198097229,
      0.17150385677814484,
      0.25423896312713623,
      -0.254822313785553,
      0.222370445728302,
      0.16140221059322357,
      0.09718266874551773,
      -0.39129209518432617,
      -0.8101216554641724,
      -0.7348094582557678,
      0.01302833016961813,
      0.03964391350746155,
      0.3348475694656372,
      -0.5063341856002808,
      -0.6826372742652893,
      0.21150802075862885,
      0.8065550327301025,
      0.6454989314079285,
      0.26305854320526123,
      0.8108906149864197,
      0.1688702255487442,
      -0.04454849660396576,
      0.22125419974327087,
      -0.5789564251899719,
      -0.8900833129882812,
      -0.7513788938522339,
      -0.15944650769233704,
      -0.27869492769241333,
      -0.36519166827201843,
      -0.11663749068975449,
      -0.005599877331405878,
      0.6805993914604187,
      0.6449997425079346,
      0.5292350053787231,
      -0.056613489985466,
      -0.19637170433998108,
      -0.18396243453025818,
      -0.025437546893954277,
      0.03792442008852959,
      0.22767086327075958,
      1.164040446281433,
      -0.013379955664277077,
      -0.13626432418823242,
      -0.8172635436058044,
      0.5346799492835999,
      0.09836918860673904,
      0.5733466148376465,
      -0.014332831837236881,
      -0.1820572018623352,
      -0.6299193501472473,
      0.06705193966627121,
      0.5139315724372864,
      0.32912755012512207,
      -0.5536649227142334,
      -0.11672457307577133,
      0.04210913926362991,
      -0.21703872084617615,
      0.5676979422569275,
      -0.1490030735731125,
      0.6337954998016357,
      0.5159344673156738,
      0.02091912552714348,
      0.318263977766037,
      0.18152490258216858,
      -0.14351600408554077,
      -0.041550714522600174,
      0.4340006709098816,
      0.24740462005138397,
      -0.5619291067123413,
      0.7391416430473328,
      -0.14922703802585602,
      0.30617398023605347,
      -0.5871717929840088,
      -0.7971293926239014,
      1.1264164447784424,
      0.16921794414520264,
      0.02342608943581581,
      -1.1206320524215698,
      -0.6361084580421448,
      -0.5630738139152527,
      -0.06574565917253494,
      0.23993030190467834,
      0.2703711986541748,
      0.8292894959449768,
      0.6584795117378235,
      -0.1786670684814453,
      0.5743860006332397,
      0.03848731517791748,
      -0.4385632574558258,
      0.1936866044998169,
      -1.2374424934387207,
      -0.8308589458465576,
      0.037363965064287186,
      0.5210838913917542,
      -0.646998405456543,
      0.36288559436798096,
      0.3374922275543213,
      -0.28017064929008484,
      0.0661657303571701,
      -0.39982911944389343,
      0.8211367726325989,
      0.242132306098938,
      0.312762975692749,
      0.8528202176094055,
      0.9630360007286072,
      0.0489923357963562,
      0.11752764880657196,
      -0.21625323593616486,
      0.09580648690462112,
      0.45775118470191956,
      1.0711692571640015,
      -0.10239774733781815,
      0.5901105999946594,
      0.0489807203412056,
      -0.0568409226834774,
      -0.10628682374954224,
      -0.5989201664924622,
      0.0906800925731659,
      -0.9121063351631165,
      -0.27713003754615784,
      -0.8067693710327148,
      0.3465065062046051,
      -0.5748224854469299,
      0.40999898314476013,
      0.13238100707530975,
      -0.17894695699214935,
      -0.5694050192832947,
      0.6358469724655151,
      0.6158693432807922,
      0.7359465956687927,
      0.4609113931655884,
      -0.6051205396652222,
      0.18961989879608154,
      1.1601483821868896,
      0.31359362602233887,
      -0.24624966084957123,
      -0.5940002202987671,
      -0.38574346899986267,
      0.11693713068962097,
      -0.6483597755432129,
      0.9451500773429871,
      0.27053195238113403,
      -0.3338315486907959,
      0.33029624819755554,
      -0.793091893196106,
      -0.8416880965232849,
      0.16321448981761932,
      -0.019380997866392136,
      -0.5324511528015137,
      -0.014947209507226944,
      0.2263479381799698,
      -0.5280014872550964,
      0.8648876547813416,
      0.4910682737827301,
      0.251481294631958,
      -0.0975600928068161,
      0.0018336301436647773,
      -1.4434292316436768,
      0.1776469349861145,
      0.1302395612001419,
      0.676464319229126,
      0.9738465547561646,
      -0.9767321944236755,
      -0.17435918748378754,
      0.04902807995676994,
      0.8316149711608887,
      -0.05882912129163742,
      -0.31061220169067383,
      1.282828450202942,
      0.3100601136684418,
      0.47803813219070435,
      1.1785953044891357,
      -0.1149604544043541,
      -1.9560282230377197,
      0.29535144567489624,
      0.10787288099527359,
      0.4400407671928406,
      -0.5826989412307739,
      -1.1276980638504028,
      0.09859143942594528,
      -0.3152523934841156,
      0.7562762498855591,
      0.027454940602183342,
      0.8756536841392517,
      1.4844874143600464,
      -0.13149738311767578,
      -0.6780465841293335,
      -0.8571052551269531,
      0.6253972053527832,
      0.8696809411048889,
      0.7327823638916016,
      -0.8467544317245483,
      -1.3234529495239258,
      0.923729658126831,
      -0.4760729670524597,
      -0.48923563957214355,
      0.2806171178817749,
      0.128834530711174,
      1.5592410564422607,
      0.0516740083694458,
      0.36518165469169617,
      0.39589959383010864,
      -0.08046125620603561,
      -0.0013693273067474365,
      0.25685784220695496,
      0.62523353099823,
      -0.8997454643249512,
      -0.15928830206394196,
      -0.30399808287620544,
      -1.079440712928772,
      -0.48426514863967896,
      0.08916217088699341,
      0.4885501265525818,
      1.0706136226654053,
      -0.7908123731613159,
      0.045919664204120636,
      0.9105437397956848,
      0.02144451066851616,
      0.2633278965950012,
      -0.553981602191925,
      -0.11704575270414352,
      0.06698181480169296,
      0.16816744208335876,
      0.809172511100769,
      -0.39798504114151,
      -0.9441299438476562,
      -0.6592233180999756,
      -0.29619020223617554,
      -0.013555004261434078,
      1.2721728086471558,
      0.1059148982167244,
      0.2685301899909973,
      0.38666045665740967,
      -0.07385922223329544,
      0.31994885206222534,
      -0.06084105372428894,
      -0.524603009223938,
      0.10745412856340408,
      -0.3342045843601227,
      -0.4077983498573303,
      0.1763341724872589,
      0.6599382162094116,
      0.3270822763442993,
      0.8954288363456726,
      0.08388406783342361,
      0.5866706967353821,
      -0.2622530460357666,
      0.004750709980726242,
      0.8441013693809509,
      -0.5851930975914001,
      0.699709415435791,
      -0.4873298108577728,
      -0.1900217980146408,
      0.18249371647834778,
      0.018335441127419472,
      -0.03882548585534096,
      -0.15689806640148163,
      0.3380638062953949,
      0.031932149082422256,
      -0.9034509062767029,
      0.36186084151268005,
      0.7104986906051636,
      -1.0721038579940796,
      -0.2983112931251526,
      0.6784744262695312,
      -0.6363930702209473,
      -0.5066967606544495,
      -0.49357783794403076,
      -1.1562747955322266,
      0.0063982270658016205,
      0.03514338284730911,
      -1.645941972732544,
      -0.05216413363814354,
      -0.4682062566280365,
      -0.0638112723827362,
      -0.43312370777130127,
      -1.1533006429672241,
      0.22494293749332428,
      0.2583562135696411,
      0.03466702252626419,
      0.13627876341342926,
      0.7321192026138306,
      0.2427276372909546,
      -0.09889661520719528,
      0.26428377628326416,
      1.373353362083435,
      0.04639492183923721,
      -0.5523256063461304,
      0.0026625387836247683,
      0.05127263069152832,
      0.1071707159280777,
      1.0894896984100342,
      0.7915325164794922,
      -1.0995060205459595,
      0.1279468983411789,
      -1.2397953271865845,
      0.77620929479599,
      -0.7516998648643494,
      -0.23171496391296387,
      -0.8097540736198425,
      -0.2308608591556549,
      -0.869551956653595,
      -0.5114036202430725,
      -0.1390080600976944,
      -1.3089796304702759,
      0.14525584876537323,
      1.7732174396514893,
      0.7181856036186218,
      -0.5773134231567383,
      -0.405043363571167,
      -1.0682039260864258,
      0.37749379873275757,
      0.51027512550354,
      0.42883583903312683,
      0.11461351066827774,
      -1.1490709781646729,
      -0.3341160714626312,
      0.5843386054039001,
      -0.5794168710708618,
      0.041772160679101944,
      0.9866519570350647,
      0.053181640803813934,
      -0.31581205129623413,
      0.11262746900320053,
      -0.1141112670302391,
      -1.4366551637649536,
      0.3847983479499817,
      0.6886003017425537,
      0.03196699172258377,
      0.6212137341499329,
      -0.34473487734794617,
      -0.28131598234176636,
      0.2894146740436554,
      0.3172762095928192,
      -0.9605560898780823,
      -0.7465735077857971,
      0.9953244924545288,
      -0.691166341304779,
      0.2996383011341095,
      0.026682566851377487,
      -0.3519827127456665,
      0.4081082046031952,
      -0.4459482729434967,
      -1.143115758895874,
      -0.28719738125801086,
      0.6131977438926697,
      1.5542693138122559,
      -1.6415672302246094,
      0.22978928685188293,
      1.236132264137268,
      -0.7677123546600342,
      -0.026203572750091553,
      -0.3009245693683624,
      0.48793333768844604,
      0.14025743305683136,
      -0.2642715573310852,
      -0.20289954543113708,
      -0.31709057092666626,
      0.5513659119606018,
      -0.723116397857666,
      0.7669246792793274,
      -0.06904828548431396,
      -0.5252696871757507,
      -0.43790555000305176,
      -0.07334373891353607,
      -0.9751201868057251,
      1.163024663925171,
      -1.6682292222976685,
      0.35231226682662964,
      -1.213644027709961,
      -0.23184306919574738,
      -0.25791677832603455,
      0.25450563430786133,
      1.1393074989318848,
      -1.7447689771652222,
      0.018102163448929787,
      -2.0174272060394287,
      -0.2968871593475342,
      -0.953534722328186,
      0.9412194490432739,
      -0.2382611483335495,
      0.43402233719825745,
      0.8142035603523254,
      1.1159155368804932,
      0.13018684089183807,
      -0.06644229590892792,
      -1.2966220378875732,
      1.2033872604370117,
      0.02438282035291195,
      -1.3076342344284058,
      0.9154815077781677,
      1.1816235780715942,
      -0.19252467155456543,
      0.10901135951280594,
      0.7608508467674255,
      0.4997883141040802,
      -0.1745615005493164,
      -0.49196717143058777,
      0.6406189799308777,
      0.06264719367027283,
      0.19260504841804504,
      -0.01712176948785782,
      -0.84551602602005,
      0.09645235538482666,
      0.5858830213546753,
      -0.4834758937358856,
      -0.6654285788536072,
      -0.23973384499549866,
      -0.1562865674495697,
      -0.5910990834236145,
      -0.45815446972846985,
      0.13513930141925812,
      -0.21786393225193024,
      -0.7112246155738831,
      0.19620224833488464,
      0.17600174248218536,
      -0.07743269205093384,
      0.2750062346458435,
      -0.015461625531315804,
      0.23115818202495575,
      0.5509153604507446,
      0.5744243264198303,
      -0.1810273826122284,
      -0.45735251903533936,
      0.3264845013618469,
      0.20454782247543335,
      0.6861676573753357,
      -0.4039528965950012,
      0.26905810832977295,
      -1.147547721862793,
      0.19181862473487854,
      -1.0871505737304688,
      -0.4201788902282715,
      0.014091159217059612,
      -0.09901794791221619,
      0.29674890637397766,
      0.5931455492973328,
      -0.10983283072710037,
      -0.6111501455307007,
      0.4914305508136749,
      -0.3826315104961395,
      -1.0630325078964233,
      0.7152078151702881,
      0.8297972083091736,
      0.45128729939460754,
      0.17444361746311188,
      -0.5179855227470398,
      0.30781471729278564,
      -0.44495707750320435,
      -0.22814340889453888,
      0.25968462228775024,
      0.5863732099533081,
      -0.1391814947128296,
      -0.32024452090263367,
      -0.084444060921669,
      -0.01083912793546915,
      -0.6197940111160278,
      1.3966503143310547,
      -0.7994885444641113,
      1.0836107730865479,
      0.23336146771907806,
      -0.23877178132534027,
      -0.6867891550064087,
      0.15098293125629425,
      -0.34459131956100464,
      -0.3356545567512512,
      -0.9710229635238647,
      0.8161712288856506,
      -0.9283190369606018,
      -0.247319296002388,
      0.40569332242012024,
      -0.5026513338088989,
      -0.38300225138664246,
      0.3205610513687134,
      -0.46374234557151794,
      0.5066477656364441,
      -1.3117555379867554,
      0.8228801488876343,
      -0.7008265256881714,
      -0.4905520975589752,
      -1.0111603736877441,
      -0.8686239719390869,
      -1.0310808420181274,
      -0.3829992711544037,
      -1.061658263206482,
      -0.16706301271915436,
      0.576403021812439,
      -0.2826421856880188,
      -0.2880844473838806,
      -0.4287899434566498,
      -0.1554838865995407,
      1.2063459157943726,
      -0.17233937978744507,
      -0.2431308776140213,
      0.5449478626251221,
      -0.023066500201821327,
      -0.5001013278961182,
      -0.09369591623544693,
      0.022826729342341423,
      -0.39863118529319763,
      -0.8199594616889954,
      1.253576397895813,
      1.0983755588531494,
      0.2713065445423126,
      -0.18707500398159027,
      -0.852885901927948,
      0.2017495036125183,
      0.5250211358070374,
      -0.5880599021911621,
      -0.4832622706890106,
      0.25222504138946533,
      -0.8030389547348022
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "F",
      "level3": "F",
      "leafContractCategory": "AMO(Level-2)",
      "rootCause": "Missing Options",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Prediction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): Hybrid\nThe issue arises from combining multiple models (Model A and Model B) and their intermediate outputs, leading to a hybrid contract violation.\n\nLevel 2: F (Eventually Required Condition)\nThe model expects that intermediate layers must be correctly linked, but the user mistakenly calls predict(), converting the layer output into a NumPy array instead of preserving it as a tensor.\n\nLevel 3 (Hybrid Patterns): F (Eventually Required Condition)\nThe get_layer(\"layer_x\").output method is used incorrectly, breaking the expected computational graph dependency.\n\nLeaf Contract Category: AMO (Level-2)\nThe error is related to the improper order of API calls�using predict() prematurely instead of passing the layer output directly into the second model.\n\nRoot Cause: Missing Options\nThe user manually attempts to retrieve an intermediate output but does not maintain it as a valid tensor in the computational graph.\n\nEffect: Crash\nThe incorrect API call results in an AttributeError, causing a runtime failure.\n\nML Library: Keras\nThe issue is specific to Keras' functional API for model composition.\n\nContract Violation Location: Prediction\nThe error manifests while attempting to pass intermediate layer outputs during model inference.\n\nDetection Technique: Static\nThe mistake can be identified statically by reviewing how intermediate outputs should be extracted and passed within the Keras functional API.\n\n\n"
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/51100508",
    "title": "",
    "question": "9\n\nI need some help with keras loss function. I have been implementing custom loss function on keras with Tensorflow backend.\n\nI have implemented the custom loss function in numpy but it would be great if it could be translated into keras loss function. The loss function takes dataframe and series of user id. The Euclidean distance for same user_id are positive and negative if the user_id are different. The function returns summed up scalar distance of the dataframe.\n\ndef custom_loss_numpy (encodings, user_id):\n# user_id: a pandas series of users\n# encodings: a pandas dataframe of encodings\n\n    batch_dist = 0\n\n    for i in range(len(user_id)):\n         first_row = encodings.iloc[i,:].values\n         first_user = user_id[i]\n\n         for j in range(i+1, len(user_id)):\n              second_user = user_id[j]\n              second_row = encodings.iloc[j,:].values\n\n        # compute distance: if the users are same then Euclidean distance is positive otherwise negative.\n            if first_user == second_user:\n                tmp_dist = np.linalg.norm(first_row - second_row)\n            else:\n                tmp_dist = -np.linalg.norm(first_row - second_row)\n\n            batch_dist += tmp_dist\n\n    return batch_dist\nI have tried to implement into keras loss function. I extracted numpy array from y_true and y_pred tensor objects.\n\ndef custom_loss_keras(y_true, y_pred):\n    # session of my program\n    sess = tf_session.TF_Session().get()\n\n    with sess.as_default():\n        array_pred = y_pred.eval()\n        print(array_pred)\nBut I get the following error.\n\ntensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'dense_1_input' with dtype float and shape [?,102]\n [[Node: dense_1_input = Placeholder[dtype=DT_FLOAT, shape=[?,102], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\nAny kind of help would be really appreciated.",
    "answer": "First of all, it is not possible to \"extract numpy array from y_true and y_pred\" in Keras loss functions. You have to operate the tensors with Keras backend functions (or TF functions) to calculate the loss.\n\nIn other words, it would be better to think about a \"vectorized\" way to calculate the loss, without using if-else and loops.\n\nYour loss function can be computed in the following steps:\n\nGenerate a matrix of pairwise Euclidean distances, between all pairs of vectors in encodings.\nGenerate a matrix I whose element I_ij is 1 if user_i == user_j, and -1 if user_i != user_j.\nElement-wise multiply the two matrices, and sum up the elements to get the final loss.\nHere's an implementation:\n\ndef custom_loss_keras(user_id, encodings):\n    # calculate pairwise Euclidean distance matrix\n    pairwise_diff = K.expand_dims(encodings, 0) - K.expand_dims(encodings, 1)\n    pairwise_squared_distance = K.sum(K.square(pairwise_diff), axis=-1)\n\n    # add a small number before taking K.sqrt for numerical safety\n    # (K.sqrt(0) sometimes becomes nan)\n    pairwise_distance = K.sqrt(pairwise_squared_distance + K.epsilon())\n\n    # this will be a pairwise matrix of True and False, with shape (batch_size, batch_size)\n    pairwise_equal = K.equal(K.expand_dims(user_id, 0), K.expand_dims(user_id, 1))\n\n    # convert True and False to 1 and -1\n    pos_neg = K.cast(pairwise_equal, K.floatx()) * 2 - 1\n\n    # divide by 2 to match the output of `custom_loss_numpy`, but it's not really necessary\n    return K.sum(pairwise_distance * pos_neg, axis=-1) / 2\nI've assumed that user_id are integers in the code above. The trick here is to use K.expand_dims for implementing pairwise operations. It's probably a bit difficult to understand at a first glance, but it's quite useful.\n\nIt should give about the same loss value as custom_loss_numpy (there will be a little bit difference because of K.epsilon()):\n\nencodings = np.random.rand(32, 10)\nuser_id = np.random.randint(10, size=32)\n\nprint(K.eval(custom_loss_keras(K.variable(user_id), K.variable(encodings))).sum())\n-478.4245\n\nprint(custom_loss_numpy(pd.DataFrame(encodings), pd.Series(user_id)))\n-478.42953553795815\nI've made a mistake in the loss function.\n\nWhen this function is used in training, since Keras automatically changes y_true to be at least 2D, the argument user_id is no longer a 1D tensor. The shape of it will be (batch_size, 1).\n\nIn order to use this function, the extra axis must be removed:\n\ndef custom_loss_keras(user_id, encodings):\n    pairwise_diff = K.expand_dims(encodings, 0) - K.expand_dims(encodings, 1)\n    pairwise_squared_distance = K.sum(K.square(pairwise_diff), axis=-1)\n    pairwise_distance = K.sqrt(pairwise_squared_distance + K.epsilon())\n\n    user_id = K.squeeze(user_id, axis=1)  # remove the axis added by Keras\n    pairwise_equal = K.equal(K.expand_dims(user_id, 0), K.expand_dims(user_id, 1))\n\n    pos_neg = K.cast(pairwise_equal, K.floatx()) * 2 - 1\n    return K.sum(pairwise_distance * pos_neg, axis=-1)",
    "mlApiName": "keras.backend.sqrt, keras.backend.expand_dims",
    "embedding": [
      0.6063254475593567,
      0.9917692542076111,
      -1.8362330198287964,
      -1.3205362558364868,
      0.4985780715942383,
      -0.7244488596916199,
      0.5390720367431641,
      0.5304805636405945,
      0.04736390709877014,
      -0.8204748034477234,
      -0.4490952789783478,
      0.8060266375541687,
      2.087991952896118,
      -0.3377639949321747,
      -0.3770369291305542,
      -0.3278562128543854,
      -0.006830398924648762,
      -0.3067079484462738,
      -0.17705613374710083,
      1.584059476852417,
      -0.6353819370269775,
      0.05673910677433014,
      -0.11114472895860672,
      -0.19271720945835114,
      1.3989297151565552,
      -0.06267523765563965,
      -0.30796706676483154,
      0.652266263961792,
      -0.604712724685669,
      0.4684327244758606,
      0.9078406095504761,
      -0.1560966968536377,
      0.22898916900157928,
      -0.5857254266738892,
      -0.9270110726356506,
      -0.024054236710071564,
      1.114143967628479,
      -0.3982253074645996,
      0.4665731191635132,
      -0.09797178953886032,
      -0.089055635035038,
      -0.5753566026687622,
      0.1786201447248459,
      0.6398645043373108,
      0.7454341650009155,
      -0.6222111582756042,
      0.900398850440979,
      0.29438304901123047,
      0.20649012923240662,
      -0.6326125860214233,
      0.05730217695236206,
      0.11822394281625748,
      -0.3987411558628082,
      0.03479347378015518,
      0.7055116891860962,
      0.703528106212616,
      -0.4803716242313385,
      -0.5478886365890503,
      1.0994893312454224,
      -0.6239343285560608,
      0.3795894980430603,
      1.0237528085708618,
      -0.9786525368690491,
      0.1302279829978943,
      0.9813756942749023,
      -0.46222344040870667,
      -0.9269303679466248,
      0.6802225112915039,
      -0.521991491317749,
      -0.4114120304584503,
      0.8850812911987305,
      0.513342559337616,
      -0.05179771035909653,
      0.6287113428115845,
      -0.36920544505119324,
      0.5862289667129517,
      -0.13825078308582306,
      -0.2102855145931244,
      0.20776209235191345,
      0.569722056388855,
      -0.4687982499599457,
      0.731839120388031,
      1.1398855447769165,
      -0.13784155249595642,
      -0.032582756131887436,
      0.1940578818321228,
      -0.09263940900564194,
      -0.5423636436462402,
      -0.40316540002822876,
      1.2585009336471558,
      -0.4197453260421753,
      -0.5390239357948303,
      0.9919172525405884,
      1.0720255374908447,
      -0.5542968511581421,
      -0.36304834485054016,
      -0.33909404277801514,
      -0.2994138300418854,
      -0.09882476925849915,
      -0.29434093832969666,
      0.332844614982605,
      -0.07846470177173615,
      -0.5612919926643372,
      -1.1279915571212769,
      -0.24303287267684937,
      0.648064374923706,
      0.4708738327026367,
      0.5296538472175598,
      0.4459093511104584,
      -0.1909518539905548,
      -0.4904627501964569,
      -0.5988102555274963,
      -0.6619760394096375,
      -1.1401461362838745,
      0.6489105820655823,
      -0.29116976261138916,
      0.5257108807563782,
      -1.1063613891601562,
      0.39624565839767456,
      0.6277685761451721,
      -0.4032512605190277,
      0.12648867070674896,
      0.8095529675483704,
      0.029410166665911674,
      -0.29505234956741333,
      0.7859688997268677,
      -0.3852958083152771,
      0.022883713245391846,
      0.21583639085292816,
      -0.5358390212059021,
      -0.013421300798654556,
      -1.058348536491394,
      -0.7112125158309937,
      0.4095008671283722,
      0.3986372649669647,
      1.0041940212249756,
      -0.47453150153160095,
      -0.4689922332763672,
      0.2178805023431778,
      0.5164536833763123,
      0.6788479685783386,
      -0.20675857365131378,
      -0.37705639004707336,
      -0.45749130845069885,
      0.08878827840089798,
      -0.8690811991691589,
      0.7269027233123779,
      -0.6633894443511963,
      -0.3370295763015747,
      -0.3824150860309601,
      0.6962417364120483,
      0.26341015100479126,
      -0.8843944072723389,
      -0.1000220850110054,
      1.1837985515594482,
      -0.6280906200408936,
      0.3623935878276825,
      0.9876894354820251,
      0.39012783765792847,
      -0.2216295599937439,
      0.5359751582145691,
      0.7770599126815796,
      -0.5050094723701477,
      1.1575297117233276,
      -0.34620651602745056,
      -0.7651358246803284,
      0.5313031673431396,
      -0.003210563212633133,
      -0.4416607916355133,
      -0.15704603493213654,
      -0.650791585445404,
      -0.9857903718948364,
      0.3505425453186035,
      -0.5247709155082703,
      -0.41181692481040955,
      1.2125838994979858,
      0.7291851043701172,
      -0.3641974627971649,
      0.15617278218269348,
      -0.17984570562839508,
      0.44004833698272705,
      -0.3865070939064026,
      0.9616153240203857,
      0.19850313663482666,
      -0.28712981939315796,
      0.26003599166870117,
      0.5616565942764282,
      0.43337956070899963,
      -0.316657155752182,
      -0.6187277436256409,
      0.49661487340927124,
      0.060697928071022034,
      -0.09698953479528427,
      -0.38201504945755005,
      -0.25676190853118896,
      0.12902042269706726,
      0.8708847761154175,
      -0.3054928481578827,
      1.0654081106185913,
      0.3973763585090637,
      -0.35231372714042664,
      0.9875270128250122,
      -0.6490241289138794,
      0.2646286189556122,
      0.02111640013754368,
      -0.25841137766838074,
      -0.21503248810768127,
      0.2371424436569214,
      -0.16018907725811005,
      -0.12970834970474243,
      0.2757274806499481,
      -0.3515907824039459,
      -0.3671008348464966,
      0.9150909185409546,
      0.498490571975708,
      -0.06324481964111328,
      0.4399764835834503,
      -0.3150186836719513,
      -0.38521045446395874,
      0.552749752998352,
      0.5588953495025635,
      -0.41713109612464905,
      0.22007015347480774,
      -0.03148457035422325,
      0.3819301128387451,
      -0.32300281524658203,
      -0.17727965116500854,
      -0.6484988927841187,
      -0.9889214038848877,
      -0.09312965720891953,
      -1.1358518600463867,
      -0.18615171313285828,
      0.5898022651672363,
      0.09925641864538193,
      0.012933299876749516,
      1.0751866102218628,
      0.8501253128051758,
      0.6744785904884338,
      -0.067891426384449,
      0.5124196410179138,
      0.18964779376983643,
      0.33427974581718445,
      0.2913780212402344,
      0.7277944087982178,
      -0.8536596894264221,
      -0.10719189047813416,
      -0.577411413192749,
      -1.419157862663269,
      0.09204217046499252,
      0.6986982822418213,
      0.0030976084526628256,
      0.6021400690078735,
      0.9163616895675659,
      0.14860068261623383,
      0.9083126187324524,
      -0.20486916601657867,
      -0.7732746005058289,
      -0.6865617036819458,
      1.1215875148773193,
      -0.7666765451431274,
      0.3820434808731079,
      0.5358056426048279,
      0.018443996086716652,
      -0.20427879691123962,
      -0.5741212368011475,
      -0.39062216877937317,
      -0.4334738254547119,
      0.22807909548282623,
      -0.08631549030542374,
      -0.2863577902317047,
      -0.19420430064201355,
      0.5854386687278748,
      1.0769554376602173,
      0.5385009050369263,
      0.7148217558860779,
      0.08569151908159256,
      0.13261651992797852,
      -0.07681240886449814,
      0.14594386518001556,
      0.34424829483032227,
      -0.060024164617061615,
      -0.4495493471622467,
      -1.0103503465652466,
      -0.014525030739605427,
      -0.15841858088970184,
      0.0016085936222225428,
      0.3877025842666626,
      0.7995070219039917,
      0.04491867870092392,
      0.4947402775287628,
      -0.043603528290987015,
      0.5034348368644714,
      0.06984984129667282,
      0.3251587748527527,
      0.4894832372665405,
      1.0582897663116455,
      1.0112545490264893,
      -0.4758119285106659,
      -0.16391749680042267,
      -0.46329250931739807,
      0.2048058956861496,
      0.5864093899726868,
      0.5892838835716248,
      0.11658719927072525,
      -0.4607573449611664,
      -0.0562172569334507,
      0.1108316108584404,
      -0.06404075771570206,
      0.39429771900177,
      0.11452440172433853,
      -0.18833227455615997,
      -0.1048826202750206,
      -0.440151184797287,
      0.865156888961792,
      -0.6112915873527527,
      0.2783621847629547,
      1.1884232759475708,
      0.3362167477607727,
      0.23695358633995056,
      0.1606673002243042,
      0.31342262029647827,
      -0.9736800789833069,
      -0.12070474028587341,
      0.4217681288719177,
      -0.19747985899448395,
      0.5237061381340027,
      -0.7862924337387085,
      -0.15571950376033783,
      0.560967743396759,
      -0.0602450929582119,
      -0.2918376922607422,
      0.3479725420475006,
      0.4210081696510315,
      -1.4460725784301758,
      -1.5954278707504272,
      0.1701786071062088,
      -0.17821046710014343,
      -0.19481493532657623,
      -0.06653249263763428,
      0.8675810098648071,
      0.09126308560371399,
      -0.0861269012093544,
      -0.16106536984443665,
      -0.967743992805481,
      -0.4898405969142914,
      0.4672446548938751,
      -0.5672599673271179,
      -0.22271503508090973,
      0.8061487078666687,
      -0.6494312882423401,
      0.07037433981895447,
      -0.5839841961860657,
      0.4335640072822571,
      -0.23581171035766602,
      -0.10330399870872498,
      0.2225530743598938,
      0.948697030544281,
      -0.33794084191322327,
      0.007755686528980732,
      0.38912302255630493,
      0.604328453540802,
      -0.4707568287849426,
      0.03682277351617813,
      0.04199148342013359,
      -0.08586842566728592,
      -0.4197688102722168,
      1.1975200176239014,
      0.2450728565454483,
      0.06436241418123245,
      -0.06720905750989914,
      -0.29014474153518677,
      -0.004110401961952448,
      -0.22567498683929443,
      0.029792990535497665,
      -0.6013416051864624,
      -0.20928989350795746,
      -0.9775663614273071,
      0.1634363830089569,
      -0.4973291754722595,
      0.6283541321754456,
      0.3489917814731598,
      -0.07710766792297363,
      0.4970006048679352,
      -0.16528022289276123,
      0.32688596844673157,
      0.15456709265708923,
      0.6055964827537537,
      -1.2846417427062988,
      0.534736156463623,
      0.9422464966773987,
      -0.06803946942090988,
      -0.9568480849266052,
      -1.2515164613723755,
      -0.41818228363990784,
      0.5644859075546265,
      -0.6015254855155945,
      0.45691585540771484,
      0.1445285826921463,
      -0.5526753664016724,
      0.5363019108772278,
      -1.7796398401260376,
      -0.47370538115501404,
      0.5263362526893616,
      -0.4023672640323639,
      -0.05103329196572304,
      -0.9076477289199829,
      0.1804458051919937,
      -0.03603889420628548,
      0.06796262413263321,
      -0.2668856978416443,
      0.35604745149612427,
      0.7218397855758667,
      0.28370770812034607,
      -1.4161015748977661,
      1.2245405912399292,
      0.18351593613624573,
      1.0495941638946533,
      0.374586820602417,
      -0.23007211089134216,
      -0.7287271022796631,
      -0.3894733488559723,
      0.5197467803955078,
      -0.6436048150062561,
      0.5500966310501099,
      0.5414891242980957,
      0.4154384434223175,
      -0.1464127153158188,
      0.5705405473709106,
      1.0110670328140259,
      -1.0824068784713745,
      -0.12363408505916595,
      0.8247458934783936,
      0.24839535355567932,
      0.15703096985816956,
      -0.14110411703586578,
      -0.42593714594841003,
      0.19595657289028168,
      0.26108044385910034,
      -0.23664675652980804,
      1.538750410079956,
      0.5543816089630127,
      -0.2373523712158203,
      -0.8424946665763855,
      -0.46162736415863037,
      0.7106024622917175,
      0.16970513761043549,
      0.6181864142417908,
      -0.5184792280197144,
      -0.5773702263832092,
      1.062195062637329,
      -0.2669164538383484,
      0.3892352283000946,
      0.7604468464851379,
      -0.028150098398327827,
      1.0896809101104736,
      -0.3922809660434723,
      -0.4743006229400635,
      -0.6818516254425049,
      0.2130386382341385,
      0.5783166885375977,
      -0.6559914350509644,
      0.60379558801651,
      -0.8330916166305542,
      -0.2630680203437805,
      -0.25655731558799744,
      -0.3587893545627594,
      0.2062986195087433,
      -0.1753617227077484,
      0.45689699053764343,
      0.676720380783081,
      -1.3471324443817139,
      -0.35473644733428955,
      0.5280801653862,
      -0.26590925455093384,
      -0.7661445736885071,
      0.10749941319227219,
      -0.27206218242645264,
      -0.26034021377563477,
      0.9050289392471313,
      0.6856113076210022,
      0.06269091367721558,
      -1.1085416078567505,
      -0.6713192462921143,
      -0.4858171343803406,
      -0.09731640666723251,
      1.3113033771514893,
      0.1452607810497284,
      -0.35902804136276245,
      0.10568367689847946,
      -0.24541501700878143,
      0.3919864594936371,
      -0.35430875420570374,
      -0.39479896426200867,
      -0.05347792059183121,
      0.15197178721427917,
      -0.34653306007385254,
      -0.2266215980052948,
      0.8364676833152771,
      0.1479896903038025,
      0.49138161540031433,
      -0.22588084638118744,
      0.33216729760169983,
      -0.9181267619132996,
      -0.1675935834646225,
      0.6335927248001099,
      -0.3694533705711365,
      0.8893064856529236,
      -0.6433215737342834,
      -0.4568967819213867,
      0.004524859134107828,
      0.00925524439662695,
      0.1895284354686737,
      0.5092964768409729,
      0.2551382780075073,
      -0.27372685074806213,
      -0.8999647498130798,
      0.5216095447540283,
      0.9437347054481506,
      -0.9050666689872742,
      0.31111419200897217,
      0.5528491139411926,
      -0.1822618693113327,
      0.18802346289157867,
      -0.4233258068561554,
      -0.5565285086631775,
      -0.04809155687689781,
      0.3387064039707184,
      -0.4330397844314575,
      -0.012996208854019642,
      -0.39693236351013184,
      -0.02218051441013813,
      -0.5335231423377991,
      -1.6460132598876953,
      -0.4110454022884369,
      -0.11967001110315323,
      -0.3099568486213684,
      -0.7316226363182068,
      0.9184705018997192,
      0.42245015501976013,
      -0.3763538897037506,
      0.598180890083313,
      1.0221214294433594,
      -0.21071551740169525,
      -0.21726997196674347,
      -0.6056481003761292,
      -0.010132714174687862,
      -0.20995374023914337,
      0.19111381471157074,
      1.0785014629364014,
      -1.0442454814910889,
      0.10091685503721237,
      -0.44266828894615173,
      0.37340089678764343,
      -1.0361005067825317,
      0.17868435382843018,
      -0.8377720713615417,
      -0.6220344305038452,
      -0.5698204040527344,
      -0.3130968511104584,
      -0.3313986659049988,
      -0.7527571320533752,
      0.24349820613861084,
      1.2199714183807373,
      0.1536567360162735,
      -0.2050638049840927,
      -0.9653216004371643,
      0.02896244265139103,
      0.39062145352363586,
      0.7127171158790588,
      0.2431875616312027,
      -0.17115795612335205,
      -1.2259037494659424,
      0.2758846879005432,
      -0.20750883221626282,
      0.003327497048303485,
      0.717266857624054,
      0.17927539348602295,
      -0.3873057961463928,
      -0.6274771094322205,
      -0.3859997093677521,
      -0.1825604885816574,
      -0.5574243068695068,
      0.6964515447616577,
      0.002347812056541443,
      -0.16965770721435547,
      0.5774891972541809,
      0.4760091006755829,
      -0.6095232963562012,
      0.2663988471031189,
      -0.5693350434303284,
      -0.8876380920410156,
      -0.1999717652797699,
      0.8695778846740723,
      -0.5776187181472778,
      -0.37357354164123535,
      -0.1709650307893753,
      -0.6227308511734009,
      0.38705548644065857,
      -0.4828968644142151,
      -1.0718435049057007,
      -0.24110770225524902,
      0.8248947858810425,
      1.3081375360488892,
      -1.4242618083953857,
      0.3149394989013672,
      1.2290133237838745,
      -0.133643239736557,
      -0.022678988054394722,
      -0.16307780146598816,
      0.0786101445555687,
      0.6866087317466736,
      0.11145450919866562,
      -0.00442097894847393,
      0.17761953175067902,
      -0.004322826396673918,
      -0.9721563458442688,
      1.4300997257232666,
      0.2867394685745239,
      -0.6398788094520569,
      -0.022695254534482956,
      -0.3244658410549164,
      -1.2604669332504272,
      0.4281079173088074,
      -0.7354534864425659,
      0.5904384255409241,
      0.10388437658548355,
      -1.0304323434829712,
      -0.49594831466674805,
      0.27315574884414673,
      0.6741513013839722,
      -0.91131991147995,
      -0.17481593787670135,
      -0.660617470741272,
      -0.08111140877008438,
      -0.9547547698020935,
      1.7634209394454956,
      -0.3432525098323822,
      0.9434505701065063,
      0.8585600852966309,
      0.44142481684684753,
      -0.4580090343952179,
      -0.0679822638630867,
      -0.4056224822998047,
      0.08840423822402954,
      -1.025741457939148,
      -0.008175627328455448,
      0.7045749425888062,
      1.174472451210022,
      -0.059569988399744034,
      -0.395638108253479,
      1.0795072317123413,
      1.1735562086105347,
      0.04180498793721199,
      0.0006995144067332149,
      0.4397251009941101,
      -0.14022110402584076,
      -0.08653448522090912,
      -1.0363510847091675,
      -0.8134397864341736,
      -0.09177500754594803,
      0.5052775740623474,
      -0.41831710934638977,
      -0.8077828884124756,
      -0.09840727597475052,
      0.5871066451072693,
      0.3133348524570465,
      -0.06600321829319,
      0.3171854019165039,
      -0.3210531175136566,
      -0.6077591776847839,
      0.5977322459220886,
      0.8588919043540955,
      -0.9439690113067627,
      0.539640486240387,
      0.6644893884658813,
      0.12787824869155884,
      0.8894808292388916,
      0.46262484788894653,
      -0.6707338094711304,
      -0.014431840740144253,
      0.5636110305786133,
      -0.6482756733894348,
      0.39276471734046936,
      -0.19325999915599823,
      0.006293389946222305,
      -0.4528154730796814,
      0.11344199627637863,
      -0.8961207270622253,
      0.5247284770011902,
      -0.29951211810112,
      -0.49811527132987976,
      -0.003135969862341881,
      0.12136617302894592,
      -0.3067893981933594,
      -0.3228243589401245,
      0.130676731467247,
      0.4065505266189575,
      -0.7513158321380615,
      0.26331356167793274,
      0.7689341306686401,
      0.01160364132374525,
      -0.14209258556365967,
      0.09565640240907669,
      0.33249908685684204,
      0.6284471750259399,
      -0.09265724569559097,
      0.5823826193809509,
      -0.2873660922050476,
      -0.0823659896850586,
      -0.21850121021270752,
      0.7969264388084412,
      0.06725706160068512,
      -0.6311855912208557,
      0.68210768699646,
      0.06490105390548706,
      0.6639266014099121,
      0.00808118935674429,
      -0.7837845683097839,
      0.10677638649940491,
      -1.1096283197402954,
      0.21728093922138214,
      -0.47829267382621765,
      -0.9578081369400024,
      -0.13743317127227783,
      -0.539818525314331,
      -0.8471394777297974,
      0.27063995599746704,
      0.03421353921294212,
      -0.9795072674751282,
      -0.36613455414772034,
      -0.7031023502349854,
      -0.0835675448179245,
      -0.7964664101600647,
      0.9709423184394836,
      -0.3705149292945862,
      0.0948927253484726,
      -0.9815447330474854,
      -0.642097532749176,
      -0.9870370626449585,
      0.1635449379682541,
      -0.8692600727081299,
      0.3494734764099121,
      -0.0845799595117569,
      -0.2851457893848419,
      -0.1134069487452507,
      -0.5984637141227722,
      -0.5280975699424744,
      1.2994359731674194,
      0.17588451504707336,
      -0.7262459397315979,
      -0.17425411939620972,
      -0.6204869151115417,
      0.1299094259738922,
      0.47827255725860596,
      0.12060552835464478,
      0.46831583976745605,
      -0.1567056030035019,
      0.8542075753211975,
      0.7327716946601868,
      0.13141773641109467,
      0.3574926555156708,
      -0.5263922810554504,
      -0.18805362284183502,
      0.30942872166633606,
      -0.2852916717529297,
      -0.410602867603302,
      -0.19866390526294708,
      -0.058739084750413895
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SL",
      "level3": "F, IC-1",
      "leafContractCategory": "Comb. of SAM(Level 3) and AMO(Level 2)",
      "rootCause": "Missing Options",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): Hybrid\nThe issue involves multiple Keras API methods (K.sqrt, K.expand_dims) and their incorrect interaction in a custom loss function.\n\nLevel 2: SL (Selection Issue)\nThe problem arises due to incorrect selection of Keras functions for tensor operations instead of NumPy operations, leading to improper computation.\n\nLevel 3 (Hybrid Patterns): F (Eventually Required Condition), IC-1 (Intra-argument Contract)\nThe issue stems from a missing required condition in the computational graph, and the loss function must properly maintain input tensor shapes across operations.\n\nLeaf Contract Category: Combination of SAM(Level 3) and AMO(Level 2)\nThe problem involves both single API method misuse (K.sqrt, K.expand_dims) and method-order dependencies (K.gradients expecting tensor inputs).\n\nRoot Cause: Missing Options\nThe custom loss function attempts to extract NumPy arrays from Keras tensors, which is not allowed in Keras loss functions.\n\nEffect: Crash\nThe incorrect function usage leads to an InvalidArgumentError when TensorFlow cannot process the computation.\n\nML Library: Keras\nThe issue occurs in Keras�s backend operations when defining a loss function.\n\nContract Violation Location: Model Construction\nThe problem happens when constructing the model with a custom loss function.\n\nDetection Technique: Static\nThe issue can be detected through static analysis by reviewing how Keras loss functions handle tensor operations and ensuring proper function selection."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/41378461",
    "title": "",
    "question": "21\n\nI want to get pretrained VGG16 model in Keras, remove its output layer, and then put a new output layer with the number of classes suited for my problem, and then to fit it on new data. For this reason, I am trying to use the model here: https://keras.io/applications/#vgg16, but since it is not Sequential, I cannot just model.pop(). Popping from layers and adding it also does not work, because in the predictions it still expects the old shape. How would I do that? Is there a way to convert this type of model to Sequential?",
    "answer": "You can use pop() on model.layers and then use model.layers[-1].output to create new layers.\n\nExample:\n\nfrom keras.models import Model\nfrom keras.layers import Dense,Flatten\nfrom keras.applications import vgg16\nfrom keras import backend as K\n\nmodel = vgg16.VGG16(weights='imagenet', include_top=True)\n\nmodel.input\n\nmodel.summary(line_length=150)\n\nmodel.layers.pop()\nmodel.layers.pop()\n\nmodel.summary(line_length=150)\n\nnew_layer = Dense(10, activation='softmax', name='my_dense')\n\ninp = model.input\nout = new_layer(model.layers[-1].output)\n\nmodel2 = Model(inp, out)\nmodel2.summary(line_length=150)\nAlternatively, you can use include_top=False option of these models. In this case if you need to use flatten the layer then you need to pass the input_shape also.\n\nmodel3 = vgg16.VGG16(weights='imagenet', include_top=False, input_shape=(224, 224, 3))\nmodel3.summary(line_length=150)\n\nflatten = Flatten()\nnew_layer2 = Dense(10, activation='softmax', name='my_dense_2')\n\ninp2 = model3.input\nout2 = new_layer2(flatten(model3.output))\n\nmodel4 = Model(inp2, out2)\nmodel4.summary(line_length=150)",
    "mlApiName": "keras.models.pop, keras.applications.vgg16.VGG16, keras.layers, keras.models",
    "embedding": [
      -0.359031081199646,
      0.6960781216621399,
      -2.18339204788208,
      -1.15828275680542,
      0.6229769587516785,
      -0.09334402531385422,
      0.2952232360839844,
      0.25677454471588135,
      -0.3342013359069824,
      -0.7154406905174255,
      -0.4361676573753357,
      0.3306669592857361,
      2.1967945098876953,
      0.5176699757575989,
      0.021035486832261086,
      -0.5919692516326904,
      0.1745939701795578,
      -0.04044909030199051,
      -0.2101643830537796,
      0.6726943850517273,
      0.4539130926132202,
      -1.327473521232605,
      0.5329116582870483,
      -0.6867538094520569,
      0.9708285927772522,
      -0.18531422317028046,
      -0.1713884323835373,
      0.3801325857639313,
      -0.36788737773895264,
      0.4898774027824402,
      1.4343891143798828,
      -0.8869815468788147,
      0.26906299591064453,
      -1.0992727279663086,
      -1.1878995895385742,
      -0.44014590978622437,
      1.3018317222595215,
      -0.31625762581825256,
      -0.5138142704963684,
      0.1944480687379837,
      1.4150530099868774,
      0.5296686887741089,
      0.24535702168941498,
      0.6058418154716492,
      -0.5122129917144775,
      0.1346127986907959,
      1.355428695678711,
      0.4788658320903778,
      0.7340725064277649,
      -0.8702417016029358,
      0.40715262293815613,
      0.8102235198020935,
      0.07913635671138763,
      -0.3164016902446747,
      0.8452796339988708,
      0.7323237061500549,
      0.3817049264907837,
      0.3294433653354645,
      1.0193865299224854,
      -1.1862493753433228,
      -0.41192805767059326,
      1.416695475578308,
      -1.4188992977142334,
      2.042710065841675,
      0.2335805594921112,
      0.3975028097629547,
      -0.9226691126823425,
      0.2835696041584015,
      -0.3913863003253937,
      -1.0341441631317139,
      0.2204897105693817,
      0.9770392775535583,
      0.24034333229064941,
      -0.47309184074401855,
      -0.5142600536346436,
      -0.4097530245780945,
      -0.3007853329181671,
      -0.9147191047668457,
      -0.2950313985347748,
      0.47892075777053833,
      0.0788266509771347,
      1.263597011566162,
      1.269747257232666,
      -0.7878968119621277,
      -0.029085000976920128,
      0.2248590737581253,
      -0.9843559861183167,
      -0.43085047602653503,
      -1.146689534187317,
      1.4238569736480713,
      -0.26483237743377686,
      -1.0790270566940308,
      0.5668705105781555,
      0.9271500110626221,
      -1.179675817489624,
      -0.8969935178756714,
      -0.10099819302558899,
      -0.0315566323697567,
      -0.11158437281847,
      -0.4507938325405121,
      -0.021311230957508087,
      0.20408746600151062,
      -0.28915974497795105,
      -1.1860616207122803,
      -0.635473906993866,
      1.3098461627960205,
      -0.3506670892238617,
      0.09438817203044891,
      0.9261301159858704,
      -0.3048064112663269,
      -0.8382121324539185,
      0.13831868767738342,
      0.112772636115551,
      0.48685529828071594,
      -0.15410900115966797,
      -0.3672589361667633,
      0.24429170787334442,
      0.059482187032699585,
      0.10188329219818115,
      0.46634241938591003,
      0.00721108028665185,
      -0.8087327480316162,
      0.7981308102607727,
      -0.34114009141921997,
      -0.14987026154994965,
      0.43818753957748413,
      -0.9854892492294312,
      0.09363453090190887,
      0.2515355050563812,
      -0.9563328623771667,
      0.33745628595352173,
      -0.558739423751831,
      -0.010760139673948288,
      1.0742413997650146,
      1.092900037765503,
      1.9074560403823853,
      -0.8822274804115295,
      -1.0743592977523804,
      0.8202887773513794,
      0.3829396963119507,
      0.535539448261261,
      0.13818658888339996,
      -0.14209716022014618,
      -0.6155445575714111,
      0.34588879346847534,
      -0.057841237634420395,
      0.8083022236824036,
      -0.287515789270401,
      -0.9584854245185852,
      0.7637792825698853,
      -0.01787562482059002,
      0.5179395079612732,
      -1.0843769311904907,
      -0.12979716062545776,
      0.852729320526123,
      -1.0267225503921509,
      0.7512117624282837,
      0.7545374035835266,
      0.45623233914375305,
      -0.8686299920082092,
      1.0324608087539673,
      -0.3344264328479767,
      -0.2490464299917221,
      0.1616578996181488,
      -0.12422666698694229,
      -0.9504655599594116,
      -0.4544980227947235,
      0.0818931832909584,
      -0.548032283782959,
      0.8163230419158936,
      -0.42944249510765076,
      -0.4236869812011719,
      -0.5425467491149902,
      0.33753225207328796,
      0.2650482952594757,
      0.6729507446289062,
      1.807029366493225,
      -0.35370534658432007,
      1.0244137048721313,
      0.1293497085571289,
      1.215868592262268,
      -0.19258326292037964,
      0.914554238319397,
      -0.10797447711229324,
      -0.6145302653312683,
      0.4046608805656433,
      0.21955102682113647,
      0.12254885584115982,
      0.4612748622894287,
      -0.568327009677887,
      0.4881496727466583,
      0.23546506464481354,
      -0.42525842785835266,
      -0.4304051399230957,
      0.12581561505794525,
      0.08453154563903809,
      1.230735182762146,
      -0.43924272060394287,
      0.7478281855583191,
      -0.2117665708065033,
      0.15793608129024506,
      0.6847785115242004,
      -0.33161529898643494,
      0.25972476601600647,
      -0.9473710656166077,
      0.5759992003440857,
      -0.25715649127960205,
      0.7606450915336609,
      -0.3833519518375397,
      0.043779708445072174,
      0.45528644323349,
      0.043010637164115906,
      0.7039358019828796,
      0.543841540813446,
      0.20493492484092712,
      -0.028613245114684105,
      0.6803522109985352,
      -0.41353222727775574,
      0.10058805346488953,
      -0.1932716816663742,
      0.30133056640625,
      -0.17624378204345703,
      0.5195003747940063,
      0.26165643334388733,
      0.7510935068130493,
      -1.265331745147705,
      0.6291837692260742,
      0.011137163266539574,
      -1.2596327066421509,
      -0.09636107832193375,
      -0.11101371049880981,
      -0.9557636976242065,
      -0.052355777472257614,
      0.523354172706604,
      -0.33384889364242554,
      0.20937392115592957,
      1.0248695611953735,
      1.0964884757995605,
      -0.9111952781677246,
      -0.11133545637130737,
      -0.128954216837883,
      0.43511706590652466,
      0.2668699622154236,
      -0.23480446636676788,
      -0.9039104580879211,
      0.05427989736199379,
      0.14329463243484497,
      -0.12841841578483582,
      0.44452252984046936,
      0.8386027812957764,
      0.24714860320091248,
      0.3107113242149353,
      0.9183205962181091,
      -0.10523096472024918,
      1.1182597875595093,
      -0.7874489426612854,
      -0.7485144734382629,
      -0.13468730449676514,
      0.5395862460136414,
      -0.3338654339313507,
      0.4090382158756256,
      0.43696925044059753,
      -0.48040327429771423,
      0.2270079404115677,
      -0.24674084782600403,
      -0.7478296756744385,
      -0.22393174469470978,
      -0.5694873332977295,
      0.34637901186943054,
      -0.03305711969733238,
      -0.061828505247831345,
      0.6467676162719727,
      0.8285767436027527,
      1.1276155710220337,
      0.8755323886871338,
      0.11818394809961319,
      0.4308398962020874,
      0.23903793096542358,
      -0.17902067303657532,
      0.25790056586265564,
      -0.48292848467826843,
      -1.4652900695800781,
      -0.5275439620018005,
      -0.4447140395641327,
      0.08147863298654556,
      -0.3606603443622589,
      -0.1529885232448578,
      -0.2808367609977722,
      0.29310816526412964,
      0.3815608620643616,
      -0.4898834824562073,
      0.09029993414878845,
      -0.26019400358200073,
      0.4551338255405426,
      -0.5141671895980835,
      0.04112893342971802,
      0.6597592830657959,
      -0.015972217544913292,
      0.2203448861837387,
      -0.818046510219574,
      0.21615011990070343,
      0.7752811312675476,
      1.229055643081665,
      0.3468336760997772,
      0.34083449840545654,
      -0.10594717413187027,
      0.40474823117256165,
      -0.14650572836399078,
      0.06484716385602951,
      -0.6309180855751038,
      -1.055131196975708,
      -0.03052234649658203,
      -0.4974251389503479,
      1.0885659456253052,
      -0.32719916105270386,
      -0.06302713602781296,
      0.14197590947151184,
      0.3796960413455963,
      -0.20533664524555206,
      -0.2207818180322647,
      -0.2506921887397766,
      0.40142619609832764,
      0.4070749282836914,
      0.39430108666419983,
      -0.9577232003211975,
      0.7381078004837036,
      -0.372554749250412,
      -0.2836976945400238,
      0.4415067434310913,
      0.006537518929690123,
      0.6896333694458008,
      0.10923468321561813,
      0.30847984552383423,
      -1.3734104633331299,
      -0.6826807856559753,
      0.20023229718208313,
      0.1561342030763626,
      0.20144419372081757,
      0.42537859082221985,
      0.8373388051986694,
      -0.3772004544734955,
      0.02373548038303852,
      0.45021313428878784,
      -0.2368607521057129,
      -0.5919935703277588,
      0.2483956515789032,
      -1.3527008295059204,
      -1.378722906112671,
      0.6810505390167236,
      0.24897558987140656,
      -0.37861397862434387,
      0.6363937854766846,
      -0.2886992394924164,
      -0.41357848048210144,
      0.14359760284423828,
      -0.5005577206611633,
      0.49304550886154175,
      0.3563668429851532,
      0.4530174136161804,
      0.608880877494812,
      0.9805288314819336,
      -1.0046930313110352,
      0.0901675820350647,
      0.4754103422164917,
      0.14641982316970825,
      0.21800950169563293,
      0.5379210114479065,
      -0.2291605919599533,
      0.8953205943107605,
      0.020081887021660805,
      0.026388084515929222,
      -0.6048735976219177,
      -0.2423711121082306,
      0.2757120728492737,
      -0.24841181933879852,
      0.27497339248657227,
      -0.7620211243629456,
      0.31893593072891235,
      -0.6489925980567932,
      -0.4450974464416504,
      0.4134117364883423,
      -0.7344235181808472,
      0.44966864585876465,
      -0.17891564965248108,
      0.21274228394031525,
      0.8945446014404297,
      0.7387142181396484,
      -0.22587211430072784,
      0.08351322263479233,
      1.6283200979232788,
      0.12466039508581161,
      -0.18477880954742432,
      -0.2531028091907501,
      -0.2208009511232376,
      0.031320009380578995,
      -0.6413853764533997,
      0.7695108652114868,
      0.018496869131922722,
      -0.8203465938568115,
      -0.007747371681034565,
      -1.546791672706604,
      -0.5499934554100037,
      0.2346956580877304,
      -0.044073332101106644,
      -0.25842538475990295,
      -0.1623922735452652,
      0.12248875945806503,
      -0.31775274872779846,
      0.5592188239097595,
      -0.07170239835977554,
      -0.11589284986257553,
      -0.3919661343097687,
      -0.007863684557378292,
      -1.627549648284912,
      0.8202386498451233,
      -0.08773340284824371,
      0.7087101340293884,
      1.2145189046859741,
      -0.7335875034332275,
      -0.4615306556224823,
      -0.4490572512149811,
      0.3869667649269104,
      -0.2475375235080719,
      -0.1333511918783188,
      0.8282172083854675,
      0.879767119884491,
      0.34532472491264343,
      0.9225959777832031,
      0.18474219739437103,
      -2.0671565532684326,
      0.4996698796749115,
      -0.04451673850417137,
      0.7287197709083557,
      -0.9346446394920349,
      -0.8695898056030273,
      -0.007529100403189659,
      -0.26755890250205994,
      1.24997878074646,
      -0.5430952906608582,
      0.1291537582874298,
      1.1783360242843628,
      -0.432503879070282,
      -0.6302187442779541,
      -0.4099756181240082,
      0.35821405053138733,
      0.21097637712955475,
      0.7123000025749207,
      -0.8420946598052979,
      -1.44162118434906,
      1.771553635597229,
      -0.3341744840145111,
      -0.4822877049446106,
      0.17760160565376282,
      1.1240804195404053,
      1.6759531497955322,
      -0.12746945023536682,
      -0.12434111535549164,
      0.007364814169704914,
      -0.3794293999671936,
      0.28025543689727783,
      0.2744814455509186,
      0.4702244997024536,
      -0.7411990165710449,
      -0.14668802917003632,
      -0.40478160977363586,
      -1.2703027725219727,
      -0.14806833863258362,
      -0.22033773362636566,
      0.8999120593070984,
      1.267491340637207,
      -0.7420185804367065,
      -0.27219340205192566,
      0.5656145811080933,
      -0.33453506231307983,
      0.24225151538848877,
      0.3875725567340851,
      -0.15938983857631683,
      -0.05837789922952652,
      -0.33217471837997437,
      0.1676861196756363,
      0.2507067918777466,
      -1.7065762281417847,
      -0.4141784608364105,
      -0.8018307089805603,
      -0.22729408740997314,
      1.6892017126083374,
      -0.03110351227223873,
      0.31543245911598206,
      0.24767635762691498,
      -0.09201346337795258,
      0.684314489364624,
      -0.27682164311408997,
      -0.3547850549221039,
      0.1840469390153885,
      0.31176599860191345,
      -0.09637943655252457,
      0.21506327390670776,
      1.2911587953567505,
      0.19907443225383759,
      0.960939347743988,
      0.037859369069337845,
      0.3149232268333435,
      -0.7686469554901123,
      0.018923887982964516,
      0.9460992217063904,
      -0.5354329943656921,
      0.7368183732032776,
      -0.7895736694335938,
      0.002194987377151847,
      -0.1863410323858261,
      0.736246645450592,
      -0.44492679834365845,
      -0.07554319500923157,
      0.1980176568031311,
      0.5576136112213135,
      -1.3325963020324707,
      -0.22178560495376587,
      0.6294049620628357,
      -1.1491323709487915,
      0.19873297214508057,
      0.4823766052722931,
      -0.7778224349021912,
      -0.28629347681999207,
      -0.5237712860107422,
      -0.7301700711250305,
      0.25369811058044434,
      0.13579575717449188,
      -1.4642809629440308,
      0.8113415837287903,
      -0.9605609774589539,
      0.46338605880737305,
      -0.21799278259277344,
      -1.2434498071670532,
      -0.14955177903175354,
      0.12159682810306549,
      -0.048827189952135086,
      -0.42608004808425903,
      1.336270809173584,
      0.709625244140625,
      -0.23669658601284027,
      0.2535114884376526,
      1.1144278049468994,
      0.17288093268871307,
      -0.7760425209999084,
      -1.0554007291793823,
      0.23100228607654572,
      0.09500731527805328,
      1.4254791736602783,
      0.4630949795246124,
      -0.397571325302124,
      -0.2824874520301819,
      -1.3582463264465332,
      0.4819163978099823,
      -0.6823907494544983,
      -0.14922615885734558,
      -1.02577543258667,
      -0.7776541113853455,
      -0.821049153804779,
      -0.45962807536125183,
      -0.41368368268013,
      -1.266943097114563,
      0.14404110610485077,
      1.784666657447815,
      -0.07563545554876328,
      -0.3965461850166321,
      -0.18805333971977234,
      -0.6952798366546631,
      0.783758819103241,
      0.08219871670007706,
      0.2530663311481476,
      -0.27239370346069336,
      -1.2946994304656982,
      0.41402196884155273,
      0.434393048286438,
      -0.5924056172370911,
      0.09311995655298233,
      0.9420058727264404,
      0.565508246421814,
      -0.526728093624115,
      0.2594219148159027,
      -0.5820410847663879,
      -1.6082059144973755,
      -0.1087120994925499,
      0.18525990843772888,
      0.23052790760993958,
      0.435200572013855,
      -0.25185251235961914,
      -0.9909036755561829,
      -0.2787322998046875,
      0.4729744493961334,
      -1.136698603630066,
      -0.9804474115371704,
      0.5728853940963745,
      -0.26528817415237427,
      0.9166836142539978,
      0.3552841544151306,
      -0.7329872846603394,
      0.6662148833274841,
      0.017265040427446365,
      -1.6226617097854614,
      -0.14595158398151398,
      0.4556613266468048,
      1.494980812072754,
      -1.5728285312652588,
      0.2449074685573578,
      0.9820581078529358,
      -1.1095471382141113,
      0.8102808594703674,
      -0.06910335272550583,
      -0.11057300120592117,
      0.33729130029678345,
      -0.08462290465831757,
      -0.040303654968738556,
      0.009214436635375023,
      0.8979766368865967,
      -1.2410376071929932,
      0.6765732169151306,
      0.015328534878790379,
      -0.12559813261032104,
      -0.8934931755065918,
      -1.2132450342178345,
      -0.785129964351654,
      1.5459272861480713,
      -1.8786406517028809,
      0.432615727186203,
      -0.4820428490638733,
      -0.42508187890052795,
      0.10808311402797699,
      0.9105767011642456,
      0.5966574549674988,
      -1.318191409111023,
      0.46062609553337097,
      -2.00437331199646,
      0.19756516814231873,
      -0.5050134062767029,
      1.9693362712860107,
      -0.21199890971183777,
      0.5885990262031555,
      0.2806539833545685,
      0.5249327421188354,
      0.20021435618400574,
      0.36277708411216736,
      -0.32251065969467163,
      0.6909693479537964,
      0.12470252811908722,
      -0.7526111006736755,
      0.9691188931465149,
      0.35341018438339233,
      0.1555761843919754,
      0.17600783705711365,
      0.691747784614563,
      1.058466911315918,
      -0.12771782279014587,
      -0.9101596474647522,
      0.5295267701148987,
      -0.17287762463092804,
      -0.03996168076992035,
      -0.30328142642974854,
      -0.7707068920135498,
      0.2546551823616028,
      -0.4245030879974365,
      -0.7052425742149353,
      -0.46832701563835144,
      -0.526410698890686,
      0.6124927401542664,
      0.2603082060813904,
      -0.11596064269542694,
      0.6344053149223328,
      -0.11740583926439285,
      -0.8825322985649109,
      -0.3254302442073822,
      0.3556884825229645,
      -0.5572203993797302,
      0.6254721879959106,
      0.9641261696815491,
      -0.22835224866867065,
      0.8590965867042542,
      0.842369794845581,
      0.1777380257844925,
      -0.4335368573665619,
      0.7041412591934204,
      0.07001842558383942,
      0.9434670209884644,
      0.959423303604126,
      0.21430927515029907,
      -1.600205421447754,
      0.3254631757736206,
      -1.070876955986023,
      0.5503522157669067,
      0.592857301235199,
      -0.37940263748168945,
      -0.032648004591464996,
      0.37568941712379456,
      0.33748188614845276,
      -0.5808805823326111,
      0.32650426030158997,
      -0.7279031872749329,
      -1.4934413433074951,
      0.3629954159259796,
      1.0412524938583374,
      0.783257782459259,
      0.3970431983470917,
      -0.2949906587600708,
      0.4023064076900482,
      -0.16042150557041168,
      -0.05924021825194359,
      0.23372642695903778,
      -0.09459617733955383,
      -0.2402818500995636,
      -0.9406982064247131,
      -0.8869931101799011,
      0.0390457808971405,
      -0.13442456722259521,
      1.534214735031128,
      -0.7989825010299683,
      0.6576424241065979,
      -0.6509256958961487,
      -0.09329333156347275,
      -0.530451238155365,
      -0.4890972375869751,
      -0.18999385833740234,
      -0.7027543783187866,
      -1.1746352910995483,
      1.0356556177139282,
      -0.15765351057052612,
      -0.43972691893577576,
      -0.11389259248971939,
      -0.1360180824995041,
      -0.9603780508041382,
      0.06625466793775558,
      -1.0614476203918457,
      0.10618206113576889,
      -1.3560845851898193,
      1.5512138605117798,
      -0.7691608667373657,
      -0.4108465313911438,
      -0.7672559022903442,
      -0.5402889847755432,
      -0.548297107219696,
      -0.7420797348022461,
      -1.2201248407363892,
      0.520413875579834,
      0.6602954864501953,
      0.7352391481399536,
      -0.6876516342163086,
      0.23029717803001404,
      -0.9435528516769409,
      1.666154146194458,
      -0.47866693139076233,
      -0.10448513180017471,
      0.03254261240363121,
      0.18328215181827545,
      -0.6035435795783997,
      -0.3026818037033081,
      -1.0266507863998413,
      0.20115983486175537,
      -0.29962751269340515,
      0.9463323950767517,
      0.7197662591934204,
      0.022608650848269463,
      -0.14094094932079315,
      -0.7424805164337158,
      0.77311772108078,
      0.11049199849367142,
      0.2739247977733612,
      -0.6910961866378784,
      0.10455044358968735,
      -0.2466188222169876
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SL",
      "level3": "F, F, IC-1",
      "leafContractCategory": "Comb. of SAM(Level 3) and AMO(Level 2)",
      "rootCause": "Missing Options",
      "effect": "IF",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): Hybrid\nThe issue involves multiple Keras API methods (VGG16, pop, layers, models), making it a hybrid contract violation.\n\nLevel 2: SL (Selection Issue)\nThe user incorrectly selects pop() for modifying the model structure, which does not work with functional API models like VGG16.\n\nLevel 3 (Hybrid Patterns): F (Eventually Required Condition), F (Eventually Required Condition), IC-1 (Intra-argument Contract)\nThe issue is due to the expectation that modifying layers will automatically update the model structure, which requires additional steps for functional models.\n\nLeaf Contract Category: Combination of SAM(Level 3) and AMO(Level 2)\nThe violation stems from both single API misuse (SAM) and incorrect API method order (AMO) when modifying pre-trained models.\n\nRoot Cause: Missing Options\nThe user failed to specify include_top=False when loading VGG16, which would allow proper customization of the model.\n\nEffect: IF (Incorrect Functionality)\nThe model does not crash but does not function correctly, as it still expects the original output shape.\n\nML Library: Keras\nThe issue specifically relates to modifying pre-trained Keras models.\n\nContract Violation Location: Model Construction\nThe error occurs during model construction while attempting to modify the architecture.\n\nDetection Technique: Static\nThe incorrect use of pop() with functional API models can be detected through static analysis by checking whether the modification properly updates the model structure.\n\n\n"
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/53212672",
    "title": "",
    "question": "24\n\nI have cloned human pose estimation keras model from this link human pose estimation keras\n\nWhen I try to load the model on google colab, I get the following error\n\ncode\n\nfrom keras.models import load_model\nmodel = load_model('model.h5')\nerror\n\nValueError                                Traceback (most recent call \n\nlast)\n in ()\n      1 from keras.models import load_model\n----> 2 model = load_model('model.h5')\n\n/usr/local/lib/python3.6/dist-packages/keras/engine/saving.py in load_model(filepath, custom_objects, compile)\n    417     f = h5dict(filepath, 'r')\n    418     try:\n--> 419         model = _deserialize_model(f, custom_objects, compile)\n    420     finally:\n    421         if opened_new_file:\n\n/usr/local/lib/python3.6/dist-packages/keras/engine/saving.py in _deserialize_model(f, custom_objects, compile)\n    219         return obj\n    220 \n--> 221     model_config = f['model_config']\n    222     if model_config is None:\n    223         raise ValueError('No model found in config.')\n\n/usr/local/lib/python3.6/dist-packages/keras/utils/io_utils.py in __getitem__(self, attr)\n    300             else:\n    301                 if self.read_only:\n--> 302                     raise ValueError('Cannot create group in read only mode.')\n    303                 val = H5Dict(self.data.create_group(attr))\n    304         return val\n\nValueError: Cannot create group in read only mode.\nCan someone please help me understand this read-only mode? How do I load this model?",
    "answer": "Here is an example Git gist created on Google Collab for you: https://gist.github.com/kolygri/835ccea6b87089fbfd64395c3895c01f\n\nAs far as I understand:\n\nYou have to set and define the architecture of your model and then use model.load_weights('alexnet_weights.h5').\n\nHere is a useful Github conversation link, which hopefully will help you understand the issue better: https://github.com/keras-team/keras/issues/6937",
    "mlApiName": "keras.models.model.load_weights",
    "embedding": [
      -0.5619858503341675,
      1.057911992073059,
      -2.8274171352386475,
      -1.5094020366668701,
      1.4568551778793335,
      0.8674401044845581,
      -0.38917261362075806,
      0.7111191153526306,
      -0.9266909956932068,
      -0.2456999272108078,
      -0.29659804701805115,
      0.15856066346168518,
      1.5779916048049927,
      -0.5972728133201599,
      -0.5603168606758118,
      -0.2047833800315857,
      0.40613242983818054,
      0.04478248581290245,
      -0.02511676959693432,
      0.9913244247436523,
      -0.3771539330482483,
      -0.7625463604927063,
      -0.4236995279788971,
      -0.2696533799171448,
      1.4280447959899902,
      0.4993876516819,
      -0.5403357148170471,
      0.8153841495513916,
      -0.377674400806427,
      -0.03881465271115303,
      0.7718154191970825,
      -0.8942345380783081,
      -0.05430290848016739,
      -1.0076799392700195,
      -0.770645260810852,
      -0.8316265344619751,
      0.937561571598053,
      -0.15852856636047363,
      -0.05049987882375717,
      0.7026684880256653,
      0.8592274188995361,
      0.3524187505245209,
      0.003467888105660677,
      0.5642114281654358,
      0.11552631855010986,
      -0.21412162482738495,
      1.5448681116104126,
      0.745208740234375,
      1.0064290761947632,
      -0.3054153621196747,
      0.6362881660461426,
      -0.07550947368144989,
      -0.7164329886436462,
      -0.2357952743768692,
      1.8628095388412476,
      0.9902529716491699,
      0.18348024785518646,
      0.25661319494247437,
      0.779927670955658,
      -1.3728903532028198,
      0.5700097680091858,
      1.0644348859786987,
      -0.7372405529022217,
      1.5069663524627686,
      0.24545414745807648,
      -0.7589660882949829,
      -0.49334296584129333,
      1.554234266281128,
      -0.11314433813095093,
      -0.1842232644557953,
      0.5668805241584778,
      0.43163689970970154,
      0.014859814196825027,
      -0.22956958413124084,
      -0.622200608253479,
      0.5740146636962891,
      -0.41246581077575684,
      -0.6929395794868469,
      0.19117839634418488,
      0.7545871138572693,
      0.03061114251613617,
      1.1865040063858032,
      1.034804105758667,
      -0.4228437840938568,
      0.605997622013092,
      0.31647443771362305,
      -1.1518537998199463,
      -0.24492137134075165,
      -0.22957098484039307,
      1.4026203155517578,
      0.15793003141880035,
      -0.4294877052307129,
      0.8890604376792908,
      0.42277058959007263,
      -0.7466423511505127,
      -0.4416981637477875,
      -0.445165753364563,
      0.369750052690506,
      -0.7985894083976746,
      -0.39013561606407166,
      -0.2351066768169403,
      0.6057308912277222,
      -0.4326481223106384,
      -1.4917035102844238,
      -0.23169364035129547,
      1.3482353687286377,
      -0.05084647983312607,
      0.5251938700675964,
      0.22818100452423096,
      -0.6310222148895264,
      -0.6598262786865234,
      0.2448064237833023,
      0.38061028718948364,
      -0.4596351385116577,
      -0.21263618767261505,
      -0.21959099173545837,
      0.9688931107521057,
      -0.5074087381362915,
      0.7164463996887207,
      -0.2801485061645508,
      -0.38482627272605896,
      -0.6430026888847351,
      0.3027017116546631,
      0.0809520035982132,
      -0.434055358171463,
      -0.1347389966249466,
      -0.5355255007743835,
      -0.1550503671169281,
      -0.4787427484989166,
      -1.3460211753845215,
      -0.10224605351686478,
      -0.2941754460334778,
      -0.7907177805900574,
      0.4690903127193451,
      0.8797886967658997,
      0.6716801524162292,
      -0.55185866355896,
      -0.573793888092041,
      0.4892084300518036,
      0.4891708791255951,
      0.3025410771369934,
      0.26071229577064514,
      0.21889625489711761,
      -0.5058016180992126,
      0.607123076915741,
      -0.8087815642356873,
      0.6039343476295471,
      -0.44266536831855774,
      -0.3627716302871704,
      0.31088462471961975,
      -0.2097957879304886,
      0.7802339196205139,
      -1.0038948059082031,
      0.6249347925186157,
      0.6145289540290833,
      -0.9616023302078247,
      0.353128582239151,
      0.7192927002906799,
      1.001088261604309,
      -0.022410517558455467,
      0.768640398979187,
      0.15892265737056732,
      -0.8782578706741333,
      1.0708321332931519,
      -0.6908929347991943,
      -0.37030988931655884,
      0.27408158779144287,
      -0.013052066788077354,
      0.23891913890838623,
      0.4195312261581421,
      -1.1474426984786987,
      -0.9667156338691711,
      -0.8716208934783936,
      -0.03391993045806885,
      0.34310126304626465,
      -0.0013142828829586506,
      1.0012080669403076,
      -0.6686752438545227,
      0.711768627166748,
      0.09006844460964203,
      0.6860852837562561,
      -0.8214739561080933,
      0.7143574357032776,
      -0.1509874165058136,
      -1.1627591848373413,
      0.4017651379108429,
      0.1784302145242691,
      0.46610626578330994,
      0.8236390352249146,
      -0.35626330971717834,
      0.528035044670105,
      0.3715738356113434,
      -0.6305801272392273,
      -0.9918939471244812,
      -0.019386721774935722,
      -0.5354242920875549,
      0.7708340287208557,
      -0.5496482253074646,
      0.8028323650360107,
      0.42003193497657776,
      0.002755441702902317,
      0.25267693400382996,
      -0.6323240995407104,
      0.09187604486942291,
      -1.1018627882003784,
      0.5879988074302673,
      -0.37490615248680115,
      0.18055114150047302,
      0.012408001348376274,
      0.3667149245738983,
      0.5984180569648743,
      -0.09624988585710526,
      -0.10479215532541275,
      0.5261648893356323,
      0.47415849566459656,
      -0.6115826368331909,
      0.44862183928489685,
      -0.34040993452072144,
      -0.3293818533420563,
      0.21460872888565063,
      0.4965336322784424,
      -0.05586244538426399,
      0.510413646697998,
      0.1353680044412613,
      0.5186753273010254,
      -0.5373340845108032,
      -0.3018232583999634,
      -0.8107951283454895,
      -0.3526495397090912,
      -0.5385281443595886,
      -0.9819904565811157,
      -1.0643342733383179,
      0.7581107020378113,
      0.2804637849330902,
      -0.11174887418746948,
      0.9253355264663696,
      0.7541946768760681,
      1.3664453029632568,
      -0.889884352684021,
      -0.1071854755282402,
      0.4030322730541229,
      0.576862633228302,
      0.3385615944862366,
      -0.042626287788152695,
      -0.8735041618347168,
      0.17622679471969604,
      0.14392973482608795,
      -0.724283754825592,
      0.526906430721283,
      0.6640840768814087,
      0.08559448271989822,
      0.5417423844337463,
      0.9885129332542419,
      0.4934687614440918,
      1.1639796495437622,
      -0.1876310259103775,
      -0.39062485098838806,
      -0.3438909947872162,
      0.17755527794361115,
      -0.24975425004959106,
      0.09002749621868134,
      -0.278630793094635,
      -0.22176241874694824,
      -0.35235199332237244,
      -0.08699582517147064,
      -0.5485242009162903,
      -0.2006474733352661,
      -0.04278360679745674,
      0.26703205704689026,
      -0.3691662847995758,
      0.46202006936073303,
      0.7660316228866577,
      0.41348615288734436,
      0.8090305328369141,
      0.0870472639799118,
      0.15996186435222626,
      0.12473005801439285,
      -0.5374384522438049,
      -0.38832980394363403,
      -0.12584739923477173,
      0.000034513686841819435,
      -1.2935611009597778,
      -0.43310976028442383,
      -0.4838746190071106,
      -0.23209324479103088,
      -0.11404119431972504,
      -0.5511375665664673,
      0.22193613648414612,
      0.7803035974502563,
      -0.16320931911468506,
      -0.3996182382106781,
      0.23393814265727997,
      -0.48483753204345703,
      0.04320745915174484,
      0.09660696983337402,
      1.3799868822097778,
      1.0136158466339111,
      -0.011053335852921009,
      -0.40975937247276306,
      -0.5889807343482971,
      0.3658529818058014,
      0.021105946972966194,
      1.1108779907226562,
      0.7457908391952515,
      0.0029923629481345415,
      -0.10266152769327164,
      0.43049588799476624,
      0.487022340297699,
      0.2874225080013275,
      0.08881878852844238,
      -0.5900412201881409,
      -0.2629084885120392,
      0.06108488887548447,
      1.5442744493484497,
      -0.44905897974967957,
      0.5455224514007568,
      0.17823800444602966,
      -0.37971556186676025,
      -0.1180492490530014,
      -1.3068610429763794,
      0.22588886320590973,
      -0.485688716173172,
      -0.33480218052864075,
      0.4151138663291931,
      -0.25717058777809143,
      0.9199732542037964,
      -0.2503679096698761,
      0.7726759910583496,
      0.6811822652816772,
      -0.7989482283592224,
      0.3968057632446289,
      0.5558682084083557,
      0.5562227368354797,
      -1.6522579193115234,
      -1.2655285596847534,
      -0.269336998462677,
      -0.4254865348339081,
      0.28133684396743774,
      -0.05363692715764046,
      0.7106447815895081,
      0.28632938861846924,
      0.5238056778907776,
      0.20057028532028198,
      -0.4992869794368744,
      -0.8188937306404114,
      -0.4815766215324402,
      -1.1846568584442139,
      -0.6067202687263489,
      1.2591898441314697,
      0.35798710584640503,
      -0.6595768928527832,
      0.7633466124534607,
      -0.2084968388080597,
      -0.27881133556365967,
      -0.3942277133464813,
      -0.35763105750083923,
      0.14821243286132812,
      0.33958715200424194,
      0.020112216472625732,
      0.4127432405948639,
      1.5410014390945435,
      0.4898362457752228,
      0.8625807166099548,
      -0.29564014077186584,
      0.4196234941482544,
      -0.026113873347640038,
      0.73092120885849,
      -0.03247945010662079,
      0.9208024740219116,
      -0.5073691010475159,
      -0.2906222939491272,
      -1.2683285474777222,
      0.236115500330925,
      -0.018083911389112473,
      0.7277467250823975,
      0.42532140016555786,
      -0.6480802297592163,
      0.09093479067087173,
      -0.7941775918006897,
      0.7961854338645935,
      0.05827007070183754,
      -1.0958563089370728,
      -0.14933498203754425,
      0.09799429029226303,
      0.9376730918884277,
      0.42761051654815674,
      0.541007936000824,
      -0.7808846831321716,
      -0.2587636113166809,
      0.9091150164604187,
      0.3845660388469696,
      -0.8244370222091675,
      -0.8657134771347046,
      -0.012804865837097168,
      0.8614112138748169,
      -0.6769366264343262,
      1.08049476146698,
      -0.27590060234069824,
      0.2456951141357422,
      0.17350636422634125,
      -1.262563943862915,
      -0.6279693245887756,
      0.23965714871883392,
      0.09822719544172287,
      -0.5716601014137268,
      0.24619099497795105,
      0.1326529085636139,
      -0.19185617566108704,
      0.11834296584129333,
      0.7502060532569885,
      0.21955253183841705,
      0.9158242344856262,
      0.6836820244789124,
      -1.422569990158081,
      1.3191570043563843,
      0.584168016910553,
      0.3651920258998871,
      1.179571509361267,
      -0.8390616774559021,
      -0.5554113388061523,
      0.3669440448284149,
      0.34837672114372253,
      -0.6554248332977295,
      -0.2468954473733902,
      0.7656661868095398,
      0.6778197884559631,
      -0.22586597502231598,
      1.5153896808624268,
      0.34114310145378113,
      -2.0558769702911377,
      0.35006090998649597,
      0.716012716293335,
      0.26955029368400574,
      0.24110405147075653,
      -0.08177077770233154,
      0.2927091717720032,
      0.6712153553962708,
      0.9743878841400146,
      -0.26308801770210266,
      0.35647016763687134,
      1.074445366859436,
      -0.07011011242866516,
      -1.0225354433059692,
      0.0740790143609047,
      0.10945712774991989,
      0.634946882724762,
      0.734355628490448,
      -0.589090883731842,
      -1.1553459167480469,
      0.9884738922119141,
      0.1949280947446823,
      -0.5795683860778809,
      0.6204473972320557,
      0.10113521665334702,
      1.6366305351257324,
      -0.5187867283821106,
      -0.129090815782547,
      0.15184341371059418,
      -0.38645654916763306,
      0.5745989084243774,
      0.01689421385526657,
      0.39649057388305664,
      -0.3536684215068817,
      0.11270499229431152,
      -0.043478064239025116,
      -1.236688256263733,
      -0.12212018668651581,
      -0.2224663645029068,
      0.43299493193626404,
      0.45595818758010864,
      -0.7742794156074524,
      0.10936761647462845,
      0.5151813626289368,
      -1.2169417142868042,
      -0.506682276725769,
      0.46340614557266235,
      0.01398039236664772,
      0.30848342180252075,
      0.5414683818817139,
      0.937633216381073,
      0.8518391847610474,
      -1.37095046043396,
      -0.5968974828720093,
      -0.3790745139122009,
      -0.17054760456085205,
      1.1321110725402832,
      0.27416571974754333,
      0.5744915008544922,
      0.2706233561038971,
      0.10623278468847275,
      0.5515972971916199,
      0.3818897306919098,
      -0.10618183761835098,
      -0.21708589792251587,
      -0.018851207569241524,
      0.05149662122130394,
      -0.1289805918931961,
      0.7812748551368713,
      0.732992947101593,
      0.1965402215719223,
      0.5682603120803833,
      -0.06558758020401001,
      0.2605650722980499,
      -0.4355520009994507,
      0.28324490785598755,
      0.09344521164894104,
      0.7910770773887634,
      -0.5113909840583801,
      0.07610256224870682,
      -0.08143725991249084,
      -0.22649416327476501,
      0.04536387696862221,
      -0.008545292541384697,
      0.245520681142807,
      0.036005131900310516,
      -1.1479737758636475,
      0.8027857542037964,
      0.1800953894853592,
      -0.6066429018974304,
      -0.37018755078315735,
      0.4323025941848755,
      -0.46477314829826355,
      0.31550678610801697,
      -0.37726497650146484,
      -1.0802311897277832,
      0.5507100820541382,
      0.9895229339599609,
      -1.4015802145004272,
      0.1064595952630043,
      -0.22239115834236145,
      0.6246770620346069,
      -0.08361073583364487,
      -0.7829883098602295,
      -0.27685827016830444,
      -0.0018731891177594662,
      -0.4332488179206848,
      -0.666572630405426,
      1.1283987760543823,
      0.24255236983299255,
      -0.49119922518730164,
      0.13263338804244995,
      0.37218472361564636,
      0.06959864497184753,
      0.2443687617778778,
      -0.5611822009086609,
      0.43201926350593567,
      0.0761239305138588,
      0.4816869795322418,
      0.48563987016677856,
      -0.47211751341819763,
      0.4811592698097229,
      -0.6689876317977905,
      0.7499592304229736,
      -0.1256714016199112,
      0.495102196931839,
      -1.0691217184066772,
      -1.1108856201171875,
      0.10078230500221252,
      -1.302925705909729,
      -0.2324294000864029,
      -0.6468164920806885,
      0.6655047535896301,
      2.0514187812805176,
      -0.46971169114112854,
      -0.060844019055366516,
      -0.36373844742774963,
      -0.629672646522522,
      0.26469483971595764,
      0.5629357099533081,
      -0.20752404630184174,
      -0.5399063229560852,
      -1.2813618183135986,
      -0.10475216805934906,
      0.6672834753990173,
      -0.3855203688144684,
      -0.0760568156838417,
      0.7717527747154236,
      -0.21817848086357117,
      -0.7840085625648499,
      -0.07786531001329422,
      0.06634975969791412,
      -1.8317071199417114,
      0.33652937412261963,
      0.93262779712677,
      0.035087715834379196,
      0.8125907778739929,
      0.3035091459751129,
      -0.8155649304389954,
      -0.04900026321411133,
      -0.10170327126979828,
      -0.4413260519504547,
      -0.4196013808250427,
      0.493530809879303,
      -0.22397863864898682,
      0.2475268393754959,
      -0.14013268053531647,
      -0.813631534576416,
      -0.07351735979318619,
      -0.2854103446006775,
      -1.6792161464691162,
      0.1690177619457245,
      0.6106072068214417,
      0.953035295009613,
      -1.7547091245651245,
      0.2974841296672821,
      0.3354330062866211,
      -1.3753879070281982,
      -0.060970909893512726,
      -0.4246514141559601,
      0.1174471527338028,
      0.06918856501579285,
      -0.5269470810890198,
      -0.1632968932390213,
      -0.05206787586212158,
      0.902664065361023,
      -1.6314074993133545,
      1.1753220558166504,
      0.2761126458644867,
      -0.8926718235015869,
      0.06639999151229858,
      -0.5129881501197815,
      -1.230180025100708,
      1.1051870584487915,
      -1.4421131610870361,
      0.5995850563049316,
      -0.5821882486343384,
      -1.215855598449707,
      0.025863192975521088,
      0.6940622925758362,
      0.8291885256767273,
      -1.2068088054656982,
      -0.029883401468396187,
      -2.1631276607513428,
      -0.0397239625453949,
      -0.6533194780349731,
      1.3724168539047241,
      -0.22617307305335999,
      0.7352452278137207,
      0.72034752368927,
      0.19603793323040009,
      0.5712818503379822,
      -0.3628280460834503,
      -0.04431626945734024,
      0.353819340467453,
      0.041863180696964264,
      -0.7532490491867065,
      0.6874376535415649,
      0.32084599137306213,
      0.6209381222724915,
      -0.4064990282058716,
      0.973965585231781,
      0.13074873387813568,
      0.10251444578170776,
      0.018728679046034813,
      0.8784205317497253,
      0.007072881795465946,
      0.10367430746555328,
      -0.21831431984901428,
      -0.8789174556732178,
      -0.7112210988998413,
      0.3485449254512787,
      -0.0022442557383328676,
      -0.4960779547691345,
      -0.6502366065979004,
      0.2073640078306198,
      -0.23812748491764069,
      -0.4140302240848541,
      0.03219757601618767,
      -0.630057156085968,
      -0.9245645403862,
      0.09093260020017624,
      0.5643193125724792,
      0.0047933124005794525,
      0.02441054955124855,
      0.4966605305671692,
      -0.31098994612693787,
      0.657382607460022,
      0.7703219056129456,
      0.3750789165496826,
      -0.30928564071655273,
      -0.3669396936893463,
      0.3073202073574066,
      0.47051674127578735,
      0.6643157601356506,
      0.5805481672286987,
      -0.9927065968513489,
      0.624437689781189,
      -1.6057679653167725,
      0.020793497562408447,
      -0.22613823413848877,
      -0.29104432463645935,
      -0.30947911739349365,
      0.2673005163669586,
      0.49103641510009766,
      -0.7417203783988953,
      0.12555623054504395,
      -0.4814644455909729,
      -0.6668445467948914,
      0.44986802339553833,
      0.679758608341217,
      0.0047312770038843155,
      -0.5083709359169006,
      0.09109789878129959,
      0.6736488938331604,
      -0.014683020301163197,
      -0.29355308413505554,
      -0.17913725972175598,
      -0.05377883091568947,
      -0.1655147522687912,
      -0.3047516942024231,
      -0.47236016392707825,
      -0.06447764486074448,
      -0.8315002918243408,
      1.1924395561218262,
      0.07933586090803146,
      0.3191456198692322,
      -0.2383410781621933,
      -0.45389696955680847,
      -0.15827596187591553,
      -0.7874014973640442,
      0.7710114121437073,
      -1.3455610275268555,
      -0.7497442960739136,
      0.2807609438896179,
      -0.7038963437080383,
      -0.5726771950721741,
      -0.15417973697185516,
      -0.02122008241713047,
      0.1279543936252594,
      0.3103042542934418,
      -1.0683616399765015,
      -0.008069549687206745,
      -1.6113888025283813,
      0.8438826203346252,
      -0.5985316038131714,
      0.7654532790184021,
      -0.7723278999328613,
      -0.8693267107009888,
      -1.0035462379455566,
      -0.2684200406074524,
      -1.007393717765808,
      0.8669354319572449,
      0.5879160761833191,
      0.9121318459510803,
      -0.6707868576049805,
      -0.364136278629303,
      -1.7171810865402222,
      0.7633465528488159,
      0.24492879211902618,
      -0.6022748947143555,
      0.4244188666343689,
      -0.7230654358863831,
      -0.2687433958053589,
      0.061381950974464417,
      -0.9636145830154419,
      -0.30161571502685547,
      -0.28303879499435425,
      0.975753903388977,
      0.9305026531219482,
      0.3540154695510864,
      0.05240032821893692,
      -1.16139817237854,
      -0.0643845945596695,
      0.44647231698036194,
      -0.07129524648189545,
      -0.6184035539627075,
      -0.025350423529744148,
      -0.1600370705127716
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Load",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): SAM (Single API Method)\nThe issue is caused by incorrect usage of a single API method, model.load_weights(), making it a SAM contract violation.\n\nLevel 2: BET (Behavioral Expectation Type)\nThe error arises from incorrect assumptions about how model weights should be loaded in Keras.\n\nLevel 3 (Hybrid Patterns): IC-1 (Intra-argument Contract)\nThe function expects a valid .h5 file with a compatible model architecture, but the input model structure is missing or improperly defined.\n\nLeaf Contract Category: IC-1 (Intra-argument Contract)\nThe issue directly involves an argument inconsistency within the load_weights() function, where the model structure is not properly set up before loading weights.\n\nRoot Cause: Unacceptable Input Value\nThe user attempts to load weights into a model that hasn�t been defined, leading to an error about read-only mode.\n\nEffect: Crash\nThe program fails and raises a ValueError, preventing further execution.\n\nML Library: Keras\nThe error occurs due to the way Keras handles loading model weights.\n\nContract Violation Location: Load\nThe issue arises while attempting to load pre-trained model weights.\n\nDetection Technique: Static\nThe issue can be detected through static analysis by verifying that the model architecture is defined before calling load_weights().\n\n\n"
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/49834380",
    "title": "",
    "question": "years, 10 months ago\nModified 4 years, 8 months ago\nViewed 14k times\n12\n\nI have CNN models trained using Keras with Tensorflow backend. And I want to visualize my CNN filters with this tutorial: https://blog.keras.io/how-convolutional-neural-networks-see-the-world.html\n\nfrom keras import backend as K\nfrom keras.models import load_model\nimport numpy as np\n\nmodel = load_model('my_cnn_model.h5')\ninput_img = np.load('my_picture.npy')\n\n# get the symbolic outputs of each \"key\" layer (we gave them unique names).\nlayer_dict = dict([(layer.name, layer) for layer in model.layers])\n\nlayer_name = 'block5_conv3'\nfilter_index = 0  # can be any integer from 0 to 511, as there are 512 filters in that layer\n\n# build a loss function that maximizes the activation\n# of the nth filter of the layer considered\nlayer_output = layer_dict[layer_name].output\nloss = K.mean(layer_output[:, :, :, filter_index])\n\n# compute the gradient of the input picture wrt this loss\ngrads = K.gradients(loss, input_img)[0]\n\n# normalization trick: we normalize the gradient\ngrads /= (K.sqrt(K.mean(K.square(grads))) + 1e-5)\n\n# this function returns the loss and grads given the input picture\niterate = K.function([input_img], [loss, grads])\nHowever, when the code execute to this line:\ngrads = K.gradients(loss, input_img)[0]\nI found it returns nothing but None object, so the program fail to progress after that.\n\nI search for some solution. Some people say theinput_img should be tensorflow's Tensor type: https://github.com/keras-team/keras/issues/5455\n\nBut when I tried to convert the img to Tensor, the problem is still exist.\nI tried the solution in the link above, but still fail.\n\nThere is also someone say that this problem exists because your CNN model is not differentiable. https://github.com/keras-team/keras/issues/8478\n\nBut my model use only the activate function of ReLU and Sigmoid(at output layer). Is this problem really caused by nondifferentiable problem?\n\nCan anyone help me? Thank you very much!",
    "answer": "12\n\nIf you have a Model instance, then to take the gradient of the loss with respect to the input, you should do:\n\ngrads = K.gradients(loss, model.input)[0]\nmodel.input contains the symbolic tensor that represents the input to the model. Using a plain numpy array makes no sense because TensorFlow then has no idea how this connects to the computational graph, and returns None as the gradient.\n\nThen you should also rewrite the iterate function as:\n\niterate = K.function([model.input], [loss, grads])",
    "mlApiName": "keras.backend.function, keras.backend.gradients",
    "embedding": [
      0.30710369348526,
      0.9370356202125549,
      -2.393782615661621,
      -1.2943180799484253,
      1.5486171245574951,
      -0.4419468343257904,
      1.7212542295455933,
      0.4608590304851532,
      -0.5528312921524048,
      -0.38448670506477356,
      -0.47426459193229675,
      1.0485508441925049,
      2.2677626609802246,
      0.8837847709655762,
      -0.6399726867675781,
      -0.15692481398582458,
      0.32107922434806824,
      -0.19671057164669037,
      -0.10441826283931732,
      0.8913977742195129,
      -0.6688457727432251,
      0.3635282814502716,
      0.34485793113708496,
      -0.4024200141429901,
      1.6707391738891602,
      0.6551358699798584,
      -0.6506271958351135,
      0.2470269650220871,
      -0.6726723313331604,
      0.830430805683136,
      1.2656835317611694,
      -0.6761386394500732,
      -0.689077615737915,
      -0.741696834564209,
      -0.7394513487815857,
      0.04596332833170891,
      1.39328932762146,
      -0.0047028870321810246,
      0.7856225371360779,
      -0.14322173595428467,
      0.8741357922554016,
      0.3519153296947479,
      -0.18547023832798004,
      0.3319093585014343,
      -0.0990915521979332,
      -0.2794778347015381,
      0.6700339913368225,
      0.15006692707538605,
      0.2861602306365967,
      -0.9372524619102478,
      0.3613396883010864,
      1.2043732404708862,
      -0.12410778552293777,
      0.129232257604599,
      0.6235119700431824,
      0.010727521032094955,
      -0.07170060276985168,
      0.6296942234039307,
      0.8731601238250732,
      -0.858961820602417,
      0.5630695819854736,
      1.959372639656067,
      -1.0045228004455566,
      1.0689927339553833,
      0.4597111642360687,
      -0.5772974491119385,
      -1.184472918510437,
      0.6364193558692932,
      -0.746653139591217,
      0.15496930480003357,
      -0.064229816198349,
      0.09760767221450806,
      -0.1336248815059662,
      1.282431721687317,
      -0.512507975101471,
      -0.04208807274699211,
      -0.15549349784851074,
      -0.30265846848487854,
      -0.1894814670085907,
      0.35929733514785767,
      0.08624330908060074,
      0.8442828059196472,
      0.8831146955490112,
      -0.12185545265674591,
      0.5894094109535217,
      -0.06444519758224487,
      -0.7546988725662231,
      -0.4415607750415802,
      -0.8356994390487671,
      1.7439109086990356,
      -0.534912645816803,
      -0.12858359515666962,
      0.4181295931339264,
      1.1776474714279175,
      -0.752564013004303,
      -0.7564826011657715,
      -0.3089026212692261,
      0.34184521436691284,
      -0.7673171162605286,
      -0.42634695768356323,
      -0.3476456105709076,
      0.2040361911058426,
      -0.17092126607894897,
      -0.5986214876174927,
      -0.19887082278728485,
      0.8638023734092712,
      0.6860133409500122,
      -0.055327173322439194,
      0.3095298409461975,
      -1.0062627792358398,
      -0.7548431158065796,
      -0.253426730632782,
      -0.27550581097602844,
      -0.4472368359565735,
      -0.28851595520973206,
      -0.43913155794143677,
      -0.5421277284622192,
      -0.4947897791862488,
      0.21965746581554413,
      0.753709077835083,
      -0.5636013746261597,
      -0.28851577639579773,
      0.522486686706543,
      -0.41268447041511536,
      0.2030879259109497,
      1.0897682905197144,
      -0.47682780027389526,
      -0.3462584912776947,
      0.2360941618680954,
      -0.8594499230384827,
      0.07327459007501602,
      -0.9125301241874695,
      -0.8913064002990723,
      0.016191400587558746,
      0.4801752269268036,
      1.620351791381836,
      -0.8779474496841431,
      -1.1761665344238281,
      0.3247455656528473,
      0.6958334445953369,
      0.5668707489967346,
      -0.16400925815105438,
      -0.33002305030822754,
      -0.697842001914978,
      -0.023472003638744354,
      -0.8766641020774841,
      0.5001043677330017,
      -0.7802197933197021,
      -0.43080806732177734,
      -0.680387020111084,
      0.09133923053741455,
      0.65398770570755,
      -1.119371771812439,
      0.15706518292427063,
      1.1979970932006836,
      -1.5287115573883057,
      0.35354262590408325,
      1.0851905345916748,
      0.13712488114833832,
      -0.45720934867858887,
      1.3965988159179688,
      0.7108264565467834,
      -0.15909086167812347,
      0.8084040284156799,
      -0.261592298746109,
      -1.3432611227035522,
      0.38798803091049194,
      0.044656697660684586,
      0.21174828708171844,
      0.2600148618221283,
      -1.012655258178711,
      -0.1842324435710907,
      0.05075906589627266,
      -0.6719321608543396,
      -0.1378515213727951,
      0.9857949018478394,
      1.0385597944259644,
      -0.124845489859581,
      0.6803616285324097,
      0.20578324794769287,
      0.5412939190864563,
      0.20971597731113434,
      0.7271525263786316,
      -0.48281344771385193,
      -0.4110829532146454,
      0.2556188404560089,
      -0.3043808043003082,
      0.3665059506893158,
      0.6252220273017883,
      -1.0257567167282104,
      1.170188069343567,
      -0.034114859998226166,
      -0.7231095433235168,
      -0.5703828930854797,
      -0.39806219935417175,
      0.3329528868198395,
      0.08527880162000656,
      -0.6613110303878784,
      1.3414027690887451,
      0.45814278721809387,
      -0.0029806068632751703,
      0.6548300385475159,
      -0.9036377668380737,
      0.5789393186569214,
      -1.215350866317749,
      0.44960275292396545,
      0.015467728488147259,
      0.6004996299743652,
      -0.32822123169898987,
      0.09859637916088104,
      -0.4774688482284546,
      -0.13535961508750916,
      0.47693881392478943,
      0.29415568709373474,
      0.034501608461141586,
      0.04718640819191933,
      0.7475356459617615,
      -0.38077011704444885,
      -0.5910979509353638,
      0.3761844336986542,
      0.6895945072174072,
      -0.22480668127536774,
      0.44029906392097473,
      0.19845342636108398,
      0.2979191243648529,
      -0.5976400971412659,
      -0.5532246232032776,
      -0.5896645188331604,
      -0.18363520503044128,
      0.1345571130514145,
      -0.939734160900116,
      -0.7590909600257874,
      0.8865380883216858,
      0.714485228061676,
      -0.06772354990243912,
      0.6595878601074219,
      0.6666874885559082,
      0.45576050877571106,
      0.023474249988794327,
      0.7881868481636047,
      0.03758322075009346,
      0.6426287889480591,
      0.04442814365029335,
      0.5462002754211426,
      -0.8290663361549377,
      0.0010989982401952147,
      -0.5011501312255859,
      -0.4898461401462555,
      0.16187602281570435,
      0.764909565448761,
      0.451069712638855,
      0.675635814666748,
      0.9991335868835449,
      0.1207350641489029,
      0.826254665851593,
      -0.28330281376838684,
      -0.32364532351493835,
      -0.7690812945365906,
      1.3289289474487305,
      -0.3719213306903839,
      0.4769780933856964,
      0.6594157218933105,
      -0.1139073595404625,
      0.060933057218790054,
      -0.8259706497192383,
      -0.5891665816307068,
      -0.2956628203392029,
      -0.09841837733983994,
      0.2694077491760254,
      -0.3720732033252716,
      0.3097647726535797,
      0.8002787232398987,
      0.9055367708206177,
      0.5665764212608337,
      0.2930235266685486,
      0.9184420704841614,
      0.12291830778121948,
      -0.6283401846885681,
      -0.35658499598503113,
      -0.034413762390613556,
      -0.25220856070518494,
      -0.8322076797485352,
      -0.4954991936683655,
      -0.2117747813463211,
      -0.1584051549434662,
      0.1599133014678955,
      0.11953261494636536,
      0.7521554231643677,
      0.17798812687397003,
      0.6550371646881104,
      -0.7968447804450989,
      0.18546822667121887,
      0.12542547285556793,
      -0.017687641084194183,
      -0.1986175775527954,
      0.3679349422454834,
      1.0464043617248535,
      -0.8658588528633118,
      0.04717195779085159,
      -0.3274570405483246,
      0.6343196034431458,
      0.588772177696228,
      1.0250320434570312,
      0.6366255283355713,
      -0.01230642944574356,
      -0.8359549641609192,
      0.4412761330604553,
      -0.039309512823820114,
      0.16451308131217957,
      -0.001766658155247569,
      -0.44129523634910583,
      -0.5717132687568665,
      -0.22486741840839386,
      0.6180124282836914,
      0.2835620641708374,
      0.06718973815441132,
      0.4230019450187683,
      0.43876636028289795,
      0.43211671710014343,
      0.10152050852775574,
      0.2881278693675995,
      -0.33188503980636597,
      -0.21759822964668274,
      0.04800913482904434,
      -0.3490917384624481,
      0.5408594608306885,
      -0.2086946964263916,
      0.023870179429650307,
      0.7479544281959534,
      -0.4472501277923584,
      0.2851986885070801,
      0.5131413340568542,
      0.26331350207328796,
      -0.6997509002685547,
      -0.2001432329416275,
      -0.06733732670545578,
      -0.35002461075782776,
      0.033673904836177826,
      -0.01073270570486784,
      0.707774817943573,
      0.03907141834497452,
      0.2726843059062958,
      -0.39451441168785095,
      -0.7104600667953491,
      -0.42590293288230896,
      0.010264239273965359,
      -0.7167342901229858,
      -1.0780844688415527,
      0.359234094619751,
      0.41177818179130554,
      -0.05633937567472458,
      0.12950807809829712,
      0.4489247798919678,
      -0.7039090991020203,
      -0.07719545066356659,
      0.05988990515470505,
      0.9033898115158081,
      0.48565036058425903,
      0.3913346529006958,
      0.47174257040023804,
      0.993480920791626,
      -0.09773373603820801,
      -0.22008374333381653,
      -0.16312213242053986,
      -0.1907499134540558,
      -0.22912779450416565,
      1.0070452690124512,
      0.05766263231635094,
      0.07656751573085785,
      -0.13176466524600983,
      -0.04874227195978165,
      -0.2958941161632538,
      -0.29215842485427856,
      0.5556303262710571,
      -1.0205519199371338,
      -0.04104612395167351,
      -1.0255345106124878,
      0.6602931618690491,
      0.11437764763832092,
      -0.18905776739120483,
      0.3336660861968994,
      -0.7926051020622253,
      0.37117934226989746,
      0.023251177743077278,
      0.7407992482185364,
      1.1333085298538208,
      0.3061090111732483,
      -1.5978983640670776,
      0.29476645588874817,
      1.0793733596801758,
      0.22191345691680908,
      0.3338426947593689,
      -0.9106340408325195,
      -0.530683696269989,
      0.4293574392795563,
      -0.7827871441841125,
      1.129279375076294,
      0.432085782289505,
      -0.06065931171178818,
      0.5440728664398193,
      -1.3313829898834229,
      -0.526456356048584,
      0.004576758481562138,
      -0.08756658434867859,
      -0.5021835565567017,
      -0.28762760758399963,
      0.02995448186993599,
      -0.23085710406303406,
      -0.03113728202879429,
      0.09283454716205597,
      0.17071633040905,
      0.07884249836206436,
      0.4378563165664673,
      -1.4584202766418457,
      1.1532891988754272,
      0.276139497756958,
      0.4270022511482239,
      0.7800716161727905,
      -0.4822039306163788,
      -1.2468048334121704,
      0.4238165616989136,
      0.6817024350166321,
      -0.505554735660553,
      0.18321090936660767,
      0.7545854449272156,
      0.6754685640335083,
      0.5108000040054321,
      1.188561201095581,
      0.10902172327041626,
      -1.5274308919906616,
      0.4897633492946625,
      0.1587248593568802,
      0.5846877098083496,
      -0.533370852470398,
      -0.23670682311058044,
      0.28026124835014343,
      -0.2491191327571869,
      0.9288192987442017,
      -0.5718688368797302,
      1.0644129514694214,
      0.9225054383277893,
      0.06541232019662857,
      -1.2262920141220093,
      -0.753362238407135,
      0.5936883687973022,
      0.3542170822620392,
      1.5323623418807983,
      -0.1472315490245819,
      -1.54241144657135,
      1.056487798690796,
      -0.47302255034446716,
      0.552384614944458,
      0.04213731363415718,
      0.4612598121166229,
      1.1567507982254028,
      -0.3924401104450226,
      -0.39312031865119934,
      -0.29986372590065,
      -0.5846356153488159,
      0.368232786655426,
      0.00719511229544878,
      0.4101821184158325,
      -0.8099517822265625,
      -0.28995853662490845,
      -0.34405264258384705,
      -1.1400154829025269,
      -0.2634079158306122,
      -0.028602013364434242,
      1.2377020120620728,
      0.5982871651649475,
      -0.9151924252510071,
      0.0390850305557251,
      0.45182543992996216,
      -0.3621150553226471,
      -0.5680208206176758,
      0.17744854092597961,
      0.02530336007475853,
      0.07373135536909103,
      0.8839795589447021,
      0.9416387677192688,
      0.158152773976326,
      -1.6505320072174072,
      -0.4457778036594391,
      -0.8234853744506836,
      -0.508983314037323,
      1.2157814502716064,
      -0.31157034635543823,
      -0.09533056616783142,
      0.03385008126497269,
      -0.037550926208496094,
      0.3318657875061035,
      -0.1493876576423645,
      -0.042120613157749176,
      -0.1194305345416069,
      -0.13522183895111084,
      -0.23344963788986206,
      0.13145044445991516,
      1.0101454257965088,
      0.8446353673934937,
      0.4662834107875824,
      -0.38309136033058167,
      0.200470969080925,
      -0.7808554172515869,
      0.25105026364326477,
      0.7795376181602478,
      0.13402822613716125,
      0.4671580195426941,
      -1.509721040725708,
      -0.25646498799324036,
      0.3902736008167267,
      -0.1306687742471695,
      -0.2770129144191742,
      0.1846463680267334,
      0.20649738609790802,
      -0.24612626433372498,
      -1.319246768951416,
      0.10123368352651596,
      0.1810673326253891,
      -1.3712235689163208,
      -0.1710105538368225,
      0.3716614842414856,
      -0.45979130268096924,
      -0.19480584561824799,
      -0.2316681146621704,
      -0.4863136112689972,
      0.33263760805130005,
      0.4335018992424011,
      -1.3081825971603394,
      0.357230007648468,
      -0.28998851776123047,
      -0.1961483508348465,
      0.11938992887735367,
      -1.33848237991333,
      0.08058315515518188,
      0.47535577416419983,
      -0.39815157651901245,
      0.09188386797904968,
      1.0333651304244995,
      0.16809453070163727,
      -0.4147801101207733,
      0.48739612102508545,
      1.5830622911453247,
      0.6260027289390564,
      -0.15722690522670746,
      -0.30485525727272034,
      0.3010530471801758,
      -0.20238737761974335,
      0.7302433252334595,
      0.5144117474555969,
      -1.918344497680664,
      0.17908979952335358,
      -1.1119035482406616,
      0.4019067585468292,
      -0.5908790826797485,
      -0.14979147911071777,
      -0.7516787648200989,
      -1.1733481884002686,
      -1.2303547859191895,
      -1.0159716606140137,
      -0.47215285897254944,
      -0.3930632174015045,
      0.08392030000686646,
      1.8782559633255005,
      -0.35919249057769775,
      -0.170645073056221,
      -1.0015721321105957,
      -0.20437781512737274,
      0.6569141745567322,
      0.8260852694511414,
      0.16212183237075806,
      -0.294254332780838,
      -1.500098705291748,
      0.10696697980165482,
      0.38845545053482056,
      -0.040457583963871,
      0.5859406590461731,
      0.730883777141571,
      -0.13938646018505096,
      -0.9071176052093506,
      -0.6180962324142456,
      0.5100210309028625,
      -1.4954893589019775,
      0.19852599501609802,
      0.20992565155029297,
      -0.05676868557929993,
      0.5678974986076355,
      0.03231218829751015,
      -0.45019832253456116,
      0.14061018824577332,
      0.2798821032047272,
      -1.064527153968811,
      -0.5662153363227844,
      0.9187229871749878,
      -0.357622891664505,
      0.46673300862312317,
      -0.7427719235420227,
      -0.25794947147369385,
      0.43632662296295166,
      -0.612379252910614,
      -1.539793848991394,
      -0.704623818397522,
      0.49684080481529236,
      0.9307932257652283,
      -1.7717257738113403,
      0.3022342920303345,
      1.5705331563949585,
      -0.6964579224586487,
      0.308283269405365,
      -0.06219286099076271,
      0.41979897022247314,
      -0.06710110604763031,
      -0.05282239243388176,
      0.14625424146652222,
      0.013400502502918243,
      0.201694518327713,
      -0.8566046357154846,
      1.14753258228302,
      -0.13608139753341675,
      -0.5615202188491821,
      -0.6301656365394592,
      -0.893436849117279,
      -0.42818760871887207,
      1.2754719257354736,
      -0.8653820157051086,
      0.6275387406349182,
      -0.13664154708385468,
      -0.6629034876823425,
      -0.13386347889900208,
      -0.19349181652069092,
      0.6248425841331482,
      -0.692022979259491,
      0.1076192632317543,
      -1.0065737962722778,
      0.3260960578918457,
      -1.1781039237976074,
      0.7708479762077332,
      0.34231439232826233,
      0.7244023680686951,
      0.6881585717201233,
      0.2691026031970978,
      -0.07333669066429138,
      -0.004955110140144825,
      -0.7524325847625732,
      0.3294738829135895,
      0.2061188966035843,
      -0.6087815761566162,
      0.4216606020927429,
      1.3989366292953491,
      -0.8550290465354919,
      -0.18991124629974365,
      1.3312805891036987,
      1.3276704549789429,
      0.4735703468322754,
      -0.47397109866142273,
      0.2094615250825882,
      -0.17009283602237701,
      0.04824770987033844,
      -0.6011684536933899,
      -0.48399773240089417,
      -0.1905820667743683,
      0.12217105180025101,
      -0.6416983604431152,
      -1.1377066373825073,
      -0.3269989788532257,
      0.3451172709465027,
      0.07156902551651001,
      -0.8414239883422852,
      0.33269959688186646,
      -0.021307161077857018,
      -0.588539183139801,
      0.2807883024215698,
      -0.03922722116112709,
      0.08473134785890579,
      0.9367308616638184,
      0.14430826902389526,
      -0.02465720847249031,
      0.780961275100708,
      0.9378392696380615,
      0.0006505686906166375,
      0.23007142543792725,
      1.0524237155914307,
      0.4142007827758789,
      0.8099110722541809,
      0.060088492929935455,
      -0.2145715057849884,
      -1.5769195556640625,
      -0.33078765869140625,
      -1.4923495054244995,
      -0.23517416417598724,
      -0.22328250110149384,
      -0.5563421249389648,
      0.2600184977054596,
      -0.03716214746236801,
      -0.7678277492523193,
      -0.36903247237205505,
      0.24117988348007202,
      -0.18528051674365997,
      -1.006742238998413,
      0.6172179579734802,
      0.8357741236686707,
      0.3104386329650879,
      0.043411169201135635,
      -0.5325192809104919,
      0.13144050538539886,
      0.2466256469488144,
      -0.2313648909330368,
      0.286470502614975,
      -0.3688252866268158,
      -0.18025046586990356,
      -0.2461474984884262,
      -0.29955294728279114,
      0.3355328440666199,
      -1.109905481338501,
      1.514876365661621,
      0.1424965262413025,
      0.770961582660675,
      -0.11729063093662262,
      -1.0595862865447998,
      -0.7892383933067322,
      -0.35636648535728455,
      0.2734943926334381,
      -0.16108514368534088,
      -1.4209154844284058,
      0.013162895105779171,
      -0.2227596789598465,
      -0.20008401572704315,
      0.1950952559709549,
      -0.5683506727218628,
      -0.7632272839546204,
      -0.203618124127388,
      -0.8251461386680603,
      0.23978260159492493,
      -1.3490263223648071,
      1.1244473457336426,
      0.014176449738442898,
      0.06563489884138107,
      -0.9850497841835022,
      -0.8606857061386108,
      -0.4959394633769989,
      -0.542907178401947,
      -0.7823917865753174,
      0.472707599401474,
      -0.29879143834114075,
      0.15061785280704498,
      -0.2597277760505676,
      -0.2314683347940445,
      -0.45939427614212036,
      0.862605631351471,
      0.08548685908317566,
      -0.8066123723983765,
      0.44267359375953674,
      -0.03433699533343315,
      0.17617566883563995,
      -0.07125918567180634,
      -0.22171291708946228,
      0.007342786528170109,
      -0.27910834550857544,
      0.7201219797134399,
      1.4403564929962158,
      0.6390030384063721,
      0.21254396438598633,
      -0.971480667591095,
      0.1647009700536728,
      0.610447347164154,
      -0.4784682095050812,
      -0.3679331839084625,
      -0.2041415423154831,
      -0.5341439843177795
    ],
    "label": {
      "level1": "AMO",
      "level2": "F",
      "level3": "F",
      "leafContractCategory": "F",
      "rootCause": "Missing Required State-specific Method Order",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Evaluation",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): AMO (API Method Order)\nThe issue arises due to the incorrect order of API method calls when computing gradients using K.gradients.\n\nLevel 2: F (Eventually Required Condition)\nThe function K.gradients(loss, input_img)[0] expects a TensorFlow tensor as input, but the user mistakenly provides a NumPy array, breaking the expected execution sequence.\n\nLevel 3 (Hybrid Patterns): F (Eventually Required Condition), F (Eventually Required Condition)\nThe computational graph fails because the provided input is not part of TensorFlow�s symbolic execution, which is necessary for gradient computation.\n\nLeaf Contract Category: F (Eventually Required Condition)\nThe API expects input_img to be a valid tensor, but it isn't, violating the eventual requirement for differentiability.\n\nRoot Cause: Missing Required State-specific Method Order\nThe user did not ensure that input_img is properly incorporated into the TensorFlow computation graph before using it in K.gradients.\n\nEffect: Crash\nThe function returns None instead of gradients, causing the program to fail when the returned value is used later.\n\nML Library: Keras\nThe issue specifically arises from the Keras backend functions (K.gradients, K.function).\n\nContract Violation Location: Model Evaluation\nThe error occurs while attempting to evaluate model gradients during CNN filter visualization.\n\nDetection Technique: Static\nThe issue can be identified by inspecting how K.gradients operates and ensuring that all inputs are TensorFlow tensors rather than NumPy arrays."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/34716454",
    "title": "",
    "question": "213\n\nIf I want to use the BatchNormalization function in Keras, then do I need to call it once only at the beginning?\n\nI read this documentation for it: http://keras.io/layers/normalization/\n\nI don't see where I'm supposed to call it. Below is my code attempting to use it:\n\nmodel = Sequential()\nkeras.layers.normalization.BatchNormalization(epsilon=1e-06, mode=0, momentum=0.9, weights=None)\nmodel.add(Dense(64, input_dim=14, init='uniform'))\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(64, init='uniform'))\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(2, init='uniform'))\nmodel.add(Activation('softmax'))\n\nsgd = SGD(lr=0.1, decay=1e-6, momentum=0.9, nesterov=True)\nmodel.compile(loss='binary_crossentropy', optimizer=sgd)\nmodel.fit(X_train, y_train, nb_epoch=20, batch_size=16, show_accuracy=True, validation_split=0.2, verbose = 2)\nI ask because if I run the code with the second line including the batch normalization and if I run the code without the second line I get similar outputs. So either I'm not calling the function in the right place, or I guess it doesn't make that much of a difference.",
    "answer": "270\n\nAs Pavel said, Batch Normalization is just another layer, so you can use it as such to create your desired network architecture.\n\nThe general use case is to use BN between the linear and non-linear layers in your network, because it normalizes the input to your activation function, so that you're centered in the linear section of the activation function (such as Sigmoid). There's a small discussion of it here\n\nIn your case above, this might look like:\n\n# import BatchNormalization\nfrom keras.layers.normalization import BatchNormalization\n\n# instantiate model\nmodel = Sequential()\n\n# we can think of this chunk as the input layer\nmodel.add(Dense(64, input_dim=14, init='uniform'))\nmodel.add(BatchNormalization())\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.5))\n\n# we can think of this chunk as the hidden layer    \nmodel.add(Dense(64, init='uniform'))\nmodel.add(BatchNormalization())\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.5))\n\n# we can think of this chunk as the output layer\nmodel.add(Dense(2, init='uniform'))\nmodel.add(BatchNormalization())\nmodel.add(Activation('softmax'))\n\n# setting up the optimization of our weights \nsgd = SGD(lr=0.1, decay=1e-6, momentum=0.9, nesterov=True)\nmodel.compile(loss='binary_crossentropy', optimizer=sgd)\n\n# running the fitting\nmodel.fit(X_train, y_train, nb_epoch=20, batch_size=16, show_accuracy=True, validation_split=0.2, verbose = 2)\nShare",
    "mlApiName": "keras.layers.Activation, keras.layers.BatchNormalization, keras.layers.Dense",
    "embedding": [
      0.35552552342414856,
      0.31969237327575684,
      -2.6012701988220215,
      -1.1951074600219727,
      1.2541372776031494,
      -0.4167078137397766,
      0.5455065369606018,
      0.2787110507488251,
      -0.9042983651161194,
      -1.5628916025161743,
      -0.9071436524391174,
      0.7246448993682861,
      1.7669501304626465,
      0.99043208360672,
      0.04677732661366463,
      -1.4574999809265137,
      0.4373567998409271,
      0.23072503507137299,
      0.506607711315155,
      0.6572005748748779,
      -0.30890974402427673,
      0.3605574071407318,
      0.1424158215522766,
      -0.7943707704544067,
      2.2450520992279053,
      -0.10690941661596298,
      -0.5110401511192322,
      0.67762291431427,
      -0.6056959629058838,
      0.07149598747491837,
      1.0787272453308105,
      -0.6168703436851501,
      0.2564865052700043,
      -0.9636369943618774,
      -1.5620025396347046,
      -0.597245454788208,
      0.3208717405796051,
      -0.27539440989494324,
      -0.7108892798423767,
      -0.18374094367027283,
      0.9324170351028442,
      0.19779327511787415,
      0.5797967910766602,
      -0.1749446839094162,
      -0.2112383395433426,
      -0.2730312645435333,
      0.8134682774543762,
      0.30033376812934875,
      1.1176362037658691,
      -1.5395315885543823,
      0.17035645246505737,
      0.9021472334861755,
      -0.6633087396621704,
      0.31200942397117615,
      1.6040418148040771,
      0.6917750239372253,
      0.19562193751335144,
      1.0894579887390137,
      0.8250399827957153,
      -0.2573215067386627,
      0.1034676805138588,
      1.292167067527771,
      -0.8488726019859314,
      1.130275845527649,
      0.335065633058548,
      -0.08136612176895142,
      -0.6064025163650513,
      0.6094807386398315,
      -0.6976326107978821,
      -0.2165134996175766,
      0.4618348181247711,
      -0.08066653460264206,
      -0.005058264825493097,
      -0.2504734694957733,
      -0.5738319754600525,
      0.4136306047439575,
      -0.06775163859128952,
      -0.4236072301864624,
      0.01003059558570385,
      1.1140621900558472,
      -0.6688052415847778,
      0.9629064798355103,
      1.5118216276168823,
      -0.6432243585586548,
      0.16060508787631989,
      0.9254957437515259,
      -0.33939042687416077,
      -0.4904315173625946,
      -0.6790046691894531,
      1.5145022869110107,
      -0.2513473629951477,
      -0.760063886642456,
      0.06735608726739883,
      0.9014005064964294,
      -0.9061097502708435,
      -0.7967785596847534,
      0.1298622339963913,
      0.3523138761520386,
      -0.2563396096229553,
      -0.19907422363758087,
      -0.36977291107177734,
      0.9061837196350098,
      0.1838812679052353,
      -0.855503499507904,
      -0.5409807562828064,
      1.7567651271820068,
      0.407105952501297,
      0.14024507999420166,
      0.2716529071331024,
      -0.6193471550941467,
      -0.6212155222892761,
      -0.22143658995628357,
      -0.09343729168176651,
      -0.2114894837141037,
      0.9215803742408752,
      -0.12274066358804703,
      0.6460646986961365,
      -0.38095182180404663,
      0.5024778246879578,
      0.5438540577888489,
      -0.23751887679100037,
      -0.6420528888702393,
      0.4670218825340271,
      -0.36505934596061707,
      0.42819127440452576,
      0.7451194524765015,
      -0.42126452922821045,
      0.1910378783941269,
      0.12360554933547974,
      -1.29574453830719,
      -0.02256069891154766,
      -0.3436805307865143,
      -0.125782310962677,
      0.0625302642583847,
      0.6247068643569946,
      0.8936501741409302,
      -0.9929952025413513,
      -1.2583529949188232,
      0.2027452141046524,
      -0.42196178436279297,
      -0.2134092152118683,
      -0.04590677097439766,
      -0.25700312852859497,
      -0.9683729410171509,
      0.4124543368816376,
      -0.37357038259506226,
      1.1173824071884155,
      -0.633766770362854,
      -0.4135441780090332,
      0.10707008093595505,
      -0.17194584012031555,
      0.6279013156890869,
      -0.9710978269577026,
      0.13287962973117828,
      0.8276717066764832,
      -0.8466805219650269,
      0.832612156867981,
      0.4594210684299469,
      0.6354184746742249,
      -0.11016271263360977,
      0.9664373993873596,
      0.2661782503128052,
      -0.15210849046707153,
      0.28786203265190125,
      -0.837405264377594,
      -0.7630923390388489,
      0.3311291038990021,
      -0.13997402787208557,
      -0.292479008436203,
      0.4067290127277374,
      -0.27597948908805847,
      -0.5332264304161072,
      0.1911458820104599,
      -0.13571937382221222,
      -0.5138310194015503,
      1.1663360595703125,
      1.1216113567352295,
      -0.2767777740955353,
      0.5599650740623474,
      -0.21915973722934723,
      0.16377511620521545,
      -0.402197003364563,
      0.669974148273468,
      -0.3076359033584595,
      -0.9799914360046387,
      -0.02609984017908573,
      0.07342424243688583,
      -0.041239868849515915,
      -0.6194941401481628,
      -0.8851182460784912,
      0.478499174118042,
      0.136796236038208,
      -0.5938359498977661,
      -0.35498419404029846,
      -0.34623876214027405,
      -0.22789064049720764,
      0.385562539100647,
      -0.9781742691993713,
      0.772192656993866,
      -0.272090345621109,
      -0.2406446933746338,
      0.132803812623024,
      -0.7048537135124207,
      0.10687245428562164,
      -0.9220345616340637,
      1.1795966625213623,
      -0.5148711204528809,
      0.30444929003715515,
      -0.5454601645469666,
      0.4355773627758026,
      0.6308014988899231,
      0.17444771528244019,
      -0.3755210041999817,
      -0.015077782794833183,
      0.04012655094265938,
      -0.6159166097640991,
      0.6019113659858704,
      -0.24700157344341278,
      -0.454768568277359,
      -0.21739837527275085,
      0.15642395615577698,
      -0.6931068897247314,
      1.16586172580719,
      -0.13063253462314606,
      0.66219162940979,
      -0.9532550573348999,
      0.25689634680747986,
      0.3390955924987793,
      -0.4689803421497345,
      -0.19009852409362793,
      -0.9161831140518188,
      -1.4844352006912231,
      0.11801154166460037,
      -0.34248825907707214,
      -0.7852648496627808,
      0.7546980977058411,
      0.9279314279556274,
      1.0344197750091553,
      -0.2788476049900055,
      0.3545396327972412,
      -0.2558669149875641,
      0.9802438616752625,
      0.609729528427124,
      0.8686487674713135,
      -1.1322165727615356,
      -0.026138052344322205,
      0.18853618204593658,
      -0.4698268473148346,
      -0.7250267863273621,
      0.9323603510856628,
      0.1411374807357788,
      0.03440453112125397,
      0.3115570843219757,
      0.6355058550834656,
      1.239438533782959,
      -0.8576072454452515,
      -0.09376431256532669,
      -0.23587197065353394,
      0.6157219409942627,
      -0.41585320234298706,
      0.5118923783302307,
      -0.1335318237543106,
      -0.22882117331027985,
      -0.5062052011489868,
      -0.5177921056747437,
      -0.9479345083236694,
      -0.5572016835212708,
      0.24869704246520996,
      0.39811578392982483,
      -0.1712551862001419,
      0.28575852513313293,
      0.37788739800453186,
      0.5146979093551636,
      1.160348892211914,
      0.8518176078796387,
      0.03020917810499668,
      -0.036650605499744415,
      0.03600044921040535,
      0.17843548953533173,
      0.2054842859506607,
      -0.7827067971229553,
      -1.0045089721679688,
      -0.4495639503002167,
      0.034100282937288284,
      -0.1613088697195053,
      -0.0217690821737051,
      0.37409424781799316,
      0.8077681660652161,
      0.07127737253904343,
      0.5568349361419678,
      0.045400626957416534,
      -0.6546531319618225,
      0.17505156993865967,
      0.63597172498703,
      0.4087713956832886,
      0.3709550201892853,
      0.8931118845939636,
      -0.5001801252365112,
      -0.13443683087825775,
      -0.6250985860824585,
      0.7188225388526917,
      0.43937042355537415,
      0.6062557697296143,
      0.696512758731842,
      0.04559815302491188,
      0.06995271146297455,
      0.29684194922447205,
      -0.062108561396598816,
      -0.12297211587429047,
      -0.007702655158936977,
      0.07839690893888474,
      0.30731138586997986,
      -0.1240314245223999,
      0.6315097212791443,
      -0.1059240847826004,
      0.1885906606912613,
      0.06432770937681198,
      0.38216885924339294,
      0.3763859272003174,
      0.5708051919937134,
      -0.6865923404693604,
      -0.6925697922706604,
      0.06428390741348267,
      0.10909251123666763,
      -0.7818992137908936,
      1.0017458200454712,
      -0.2439277172088623,
      0.6926409602165222,
      0.610433042049408,
      -0.19366894662380219,
      0.5745789408683777,
      0.40881791710853577,
      0.10725957900285721,
      -1.4423950910568237,
      -0.7329086065292358,
      -0.39652085304260254,
      -0.1885177046060562,
      -0.059121038764715195,
      -0.14575102925300598,
      1.053783655166626,
      0.060533307492733,
      0.27491113543510437,
      1.0000990629196167,
      -0.5050237774848938,
      0.15985655784606934,
      -0.12321434170007706,
      -1.3562145233154297,
      -0.40960392355918884,
      0.03262313827872276,
      0.34087201952934265,
      -0.10998980700969696,
      -0.09704116731882095,
      -0.1032203733921051,
      -0.16993717849254608,
      -0.23573307693004608,
      0.22017638385295868,
      0.5135910511016846,
      0.12748317420482635,
      0.1483248919248581,
      0.2541292607784271,
      1.1233890056610107,
      -0.10374847054481506,
      -0.21178363263607025,
      0.9269858002662659,
      0.17202694714069366,
      0.4351941645145416,
      0.6255068182945251,
      0.5310817956924438,
      0.14268140494823456,
      0.08409319818019867,
      -0.22328628599643707,
      0.334419310092926,
      0.2243082970380783,
      0.22919978201389313,
      -0.7249521613121033,
      -0.1501869261264801,
      -0.9277195334434509,
      0.5199143886566162,
      0.011528649367392063,
      0.8440273404121399,
      -0.32774609327316284,
      -1.2082874774932861,
      0.1094384640455246,
      0.21230396628379822,
      1.021812915802002,
      0.870313823223114,
      0.06080267205834389,
      -0.3010271489620209,
      0.38098496198654175,
      1.3262605667114258,
      0.0319354385137558,
      -0.5374624133110046,
      -0.13377808034420013,
      -1.2334240674972534,
      0.6270917057991028,
      -0.22570717334747314,
      1.4591065645217896,
      0.4537574350833893,
      -0.1135883629322052,
      0.7603508830070496,
      -1.9593161344528198,
      -0.734106719493866,
      -0.19693179428577423,
      -0.36433038115501404,
      -0.4243738353252411,
      -0.5505930781364441,
      0.580176830291748,
      -0.15794599056243896,
      0.32941535115242004,
      -0.4073696732521057,
      0.277010440826416,
      0.23641569912433624,
      -0.18061821162700653,
      -1.2663376331329346,
      0.8255700469017029,
      -0.11118888109922409,
      0.7451795935630798,
      0.42298805713653564,
      -1.058740258216858,
      -0.7454977631568909,
      0.3363431990146637,
      0.40766528248786926,
      -0.3499118685722351,
      -0.4705415666103363,
      0.7935998439788818,
      0.9436716437339783,
      1.2117129564285278,
      1.3332936763763428,
      0.6491208076477051,
      -1.7818492650985718,
      -0.02921857126057148,
      0.8713350296020508,
      0.9487050175666809,
      -0.045298390090465546,
      -0.856479287147522,
      -0.4448435306549072,
      -0.4870627820491791,
      1.0888206958770752,
      -0.750598669052124,
      0.7580094337463379,
      1.1115970611572266,
      -0.4742594361305237,
      -1.2753891944885254,
      -0.48618918657302856,
      0.39139559864997864,
      0.4975608289241791,
      1.2554919719696045,
      -1.2996124029159546,
      -1.6507136821746826,
      1.323961615562439,
      -0.4237472414970398,
      0.3798649311065674,
      0.4020594358444214,
      0.18260204792022705,
      1.7960166931152344,
      -0.7137365937232971,
      -0.2069776952266693,
      -0.1663181185722351,
      -0.32318422198295593,
      0.0637964978814125,
      -0.2729015052318573,
      -0.06962807476520538,
      -1.4584555625915527,
      -0.21294833719730377,
      -0.03817819058895111,
      -0.8136679530143738,
      -0.3138190805912018,
      -0.3189070522785187,
      0.6361300945281982,
      1.3363037109375,
      -0.012841006740927696,
      -0.5670177340507507,
      0.4912317395210266,
      -0.5254680514335632,
      0.6475903391838074,
      0.06286261975765228,
      0.1531369388103485,
      0.36142081022262573,
      -0.019029326736927032,
      0.41087213158607483,
      0.2811953127384186,
      -1.9330089092254639,
      -0.4267633855342865,
      -0.2965144217014313,
      -0.8857442736625671,
      1.4537017345428467,
      -0.007553969509899616,
      -0.6308493614196777,
      0.5357566475868225,
      0.380602091550827,
      0.6698125004768372,
      -0.30207934975624084,
      0.08973543345928192,
      0.5401290059089661,
      -0.15048275887966156,
      -0.6220264434814453,
      0.020949145779013634,
      1.0792243480682373,
      -0.05059849098324776,
      0.727841854095459,
      0.41885891556739807,
      0.3923332393169403,
      -0.7115256786346436,
      0.6358572244644165,
      0.5257166028022766,
      -0.07915380597114563,
      1.328758716583252,
      -0.4982118010520935,
      -0.680311918258667,
      -1.0079641342163086,
      0.4302903115749359,
      -0.23297110199928284,
      -0.10489197820425034,
      -0.19519071280956268,
      0.41885828971862793,
      -1.5608716011047363,
      0.4364301860332489,
      -0.47747451066970825,
      -1.5282772779464722,
      -0.5099461674690247,
      0.16443748772144318,
      -0.23240123689174652,
      -0.3901577293872833,
      -0.8027650713920593,
      -0.8642677664756775,
      -0.17868392169475555,
      0.12006925791501999,
      -1.5328843593597412,
      0.3517475724220276,
      -0.32320448756217957,
      -0.047133151441812515,
      0.18869376182556152,
      -1.3052796125411987,
      0.3172978162765503,
      0.704983115196228,
      -0.2124902755022049,
      -0.35985255241394043,
      1.1954466104507446,
      0.16453416645526886,
      -0.0010694771772250533,
      -0.11078058928251266,
      1.122162103652954,
      0.22124901413917542,
      0.22110463678836823,
      -0.5283962488174438,
      0.21250955760478973,
      0.17135411500930786,
      0.8089427947998047,
      0.36169758439064026,
      -0.9474846720695496,
      -0.5887752771377563,
      -0.8096703886985779,
      0.5064155459403992,
      -0.6868817806243896,
      -0.3067076504230499,
      -0.4484475255012512,
      -0.5079545378684998,
      -0.7826540470123291,
      -0.427216112613678,
      -0.47915101051330566,
      -1.0537059307098389,
      -0.11445046961307526,
      1.9648516178131104,
      0.28991755843162537,
      0.7441409230232239,
      -0.7241467833518982,
      -0.2996033728122711,
      1.1826863288879395,
      0.012376426719129086,
      0.6743956804275513,
      -0.41569283604621887,
      -1.049214482307434,
      -0.3117334544658661,
      0.27593496441841125,
      -0.2825459837913513,
      0.8455010652542114,
      0.5846030712127686,
      0.6010041236877441,
      -0.7639645338058472,
      -0.4138045012950897,
      0.25075364112854004,
      -1.2196041345596313,
      -0.2940203547477722,
      0.11400623619556427,
      0.09604813903570175,
      0.7126340866088867,
      0.05363641679286957,
      -1.0088478326797485,
      0.3641492426395416,
      0.02223634161055088,
      -1.2782071828842163,
      -0.2547544240951538,
      1.0396630764007568,
      -0.06466271728277206,
      0.5095555782318115,
      0.2758674621582031,
      -0.9181893467903137,
      -0.010890444740653038,
      -0.1496170312166214,
      -1.366326928138733,
      0.6044136881828308,
      0.6929365396499634,
      1.2870312929153442,
      -1.8880695104599,
      0.06437285989522934,
      1.6604503393173218,
      -0.2451818585395813,
      0.36860352754592896,
      -0.5802261233329773,
      0.5516313910484314,
      0.5198588371276855,
      -0.0775817483663559,
      -0.3981930613517761,
      -0.11647948622703552,
      0.09062463045120239,
      -0.8570040464401245,
      0.2049308717250824,
      0.16699711978435516,
      0.5322800874710083,
      -0.20608852803707123,
      -0.3363263010978699,
      -0.7608289122581482,
      1.0644981861114502,
      -0.8025806546211243,
      1.1419823169708252,
      -0.034805722534656525,
      -0.7296366095542908,
      -0.15809662640094757,
      -0.2954184114933014,
      0.0733630433678627,
      -1.2670925855636597,
      -0.11655612289905548,
      -2.42439603805542,
      0.03264031559228897,
      -1.2086395025253296,
      0.9506714344024658,
      0.03555374592542648,
      0.445629745721817,
      0.1476932168006897,
      1.128832459449768,
      0.0776844248175621,
      0.3801369369029999,
      -0.30199289321899414,
      1.2321467399597168,
      0.9358570575714111,
      -1.662224531173706,
      0.5294094085693359,
      0.6117396950721741,
      0.0459912046790123,
      0.21313028037548065,
      0.49944064021110535,
      1.5229897499084473,
      -0.39930105209350586,
      0.40310707688331604,
      1.224005937576294,
      -0.624936044216156,
      0.36489254236221313,
      -0.15955717861652374,
      -1.5630977153778076,
      -0.3980841636657715,
      0.2700444757938385,
      -0.5814537405967712,
      -1.121662974357605,
      -0.3088645040988922,
      0.6740483045578003,
      0.2513735890388489,
      0.2174607813358307,
      0.6153920292854309,
      -0.22517091035842896,
      -0.8958568572998047,
      -0.11951455473899841,
      0.034691233187913895,
      0.1438448131084442,
      0.7451512217521667,
      0.4560279846191406,
      -0.00666382210329175,
      1.0948271751403809,
      1.0053597688674927,
      -0.551991879940033,
      -0.28673630952835083,
      1.2674319744110107,
      -0.2788892388343811,
      1.231163740158081,
      -0.5731390118598938,
      0.28625211119651794,
      -1.0088940858840942,
      0.34597793221473694,
      -1.335856318473816,
      -0.6558186411857605,
      -0.7121229767799377,
      0.16659624874591827,
      -0.1361307054758072,
      0.4858986437320709,
      -0.27053382992744446,
      -0.5068057775497437,
      0.8256649374961853,
      0.08567953109741211,
      -0.8668919205665588,
      -0.12977565824985504,
      1.2205547094345093,
      0.4027250409126282,
      -0.10305435210466385,
      -0.025210939347743988,
      0.6236564517021179,
      1.0381323099136353,
      -0.09709976613521576,
      0.31836774945259094,
      0.14656202495098114,
      -1.1981052160263062,
      -1.0297889709472656,
      -0.8768371939659119,
      0.5658426880836487,
      -0.054676901549100876,
      1.8319319486618042,
      -0.5459964275360107,
      0.7095913887023926,
      0.22033242881298065,
      -0.542150616645813,
      -0.017879704013466835,
      -0.014311781153082848,
      0.28708985447883606,
      -0.06749115884304047,
      -0.8755293488502502,
      0.7342722415924072,
      -0.5535063743591309,
      0.1436825841665268,
      -0.44874122738838196,
      -0.004789547063410282,
      -0.2182711362838745,
      0.03486138582229614,
      -1.3170642852783203,
      0.010552012361586094,
      -1.5036349296569824,
      1.2470057010650635,
      -0.6038963198661804,
      -0.37465575337409973,
      -0.13515907526016235,
      -0.72682785987854,
      -0.7819244265556335,
      -0.025062933564186096,
      -1.3749765157699585,
      0.41826626658439636,
      0.5477591156959534,
      0.5334586501121521,
      -0.9234397411346436,
      -0.103709377348423,
      -0.29330024123191833,
      0.9707263112068176,
      0.15797902643680573,
      -0.2614198327064514,
      0.25262245535850525,
      0.13004842400550842,
      -0.5618574619293213,
      0.2637346386909485,
      -0.056013405323028564,
      -0.23451966047286987,
      -0.6872797012329102,
      1.0946617126464844,
      0.9234509468078613,
      0.23987270891666412,
      -0.22775015234947205,
      -0.6414229273796082,
      0.10540836304426193,
      -0.025722675025463104,
      -0.07794399559497833,
      -1.2152601480484009,
      -0.04734891280531883,
      -0.7965084314346313
    ],
    "label": {
      "level1": "AMO",
      "level2": "F",
      "level3": "F",
      "leafContractCategory": "F",
      "rootCause": "Missing Required State-specific Method Order",
      "effect": "BP",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model construction",
      "detectionTechnique": "Runtime Checking",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): AMO (API Method Order)\nThe issue stems from incorrect ordering of method calls�BatchNormalization is not properly placed in the model's layer structure.\n\nLevel 2: F (Eventually Required Condition)\nBatchNormalization must be positioned between Dense and Activation layers to function correctly.\n\nLevel 3 (Hybrid Patterns): F (Eventually Required Condition), F (Eventually Required Condition)\nThe normalization step needs to be applied at the correct location, ensuring proper input scaling before activation functions.\n\nLeaf Contract Category: F (Eventually Required Condition)\nThe issue arises because the layer was not placed where it is needed for effective normalization.\n\nRoot Cause: Missing Required State-specific Method Order\nThe BatchNormalization layer was not inserted in the right sequence, leading to no meaningful change in training behavior.\n\nEffect: BP (Bad Prediction)\nThe model trains, but predictions remain unaffected, indicating ineffective normalization.\n\nML Library: Keras\nThe issue specifically relates to Keras' model construction and layer ordering.\n\nContract Violation Location: Model Construction\nThe problem occurs when building the model structure before training.\n\nDetection Technique: Runtime Checking\nThe issue is detected at runtime, as the user notices no significant difference in model performance despite using BatchNormalization incorrectly.\n\n\n"
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/48846332",
    "title": "",
    "question": "10\n\nI train a model A and try to use the output of the intermediate layer with the name=\"layer_x\" as an additional input for model B.\n\nI tried to use the output of the intermediate layer like on the Keras doc https://keras.io/getting-started/faq/#how-can-i-obtain-the-output-of-an-intermediate-layer.\n\nModel A:\n\ninputs = Input(shape=(100,))\ndnn = Dense(1024, activation='relu')(inputs)\ndnn = Dense(128, activation='relu', name=\"layer_x\")(dnn)\ndnn = Dense(1024, activation='relu')(dnn)\noutput = Dense(10, activation='softmax')(dnn)\nModel B:\n\ninput_1 = Input(shape=(200,))\ninput_2 = Input(shape=(100,)) # input for model A\n\n# loading model A\nmodel_a = keras.models.load_model(path_to_saved_model_a)\n\nintermediate_layer_model = Model(inputs=model_a.input, \n                                 outputs=model_a.get_layer(\"layer_x\").output)\n\nintermediate_output = intermediate_layer_model.predict(data)\n\nmerge_layer = concatenate([input_1, intermediate_output])\ndnn_layer = Dense(512, activation=\"relu\")(merge_layer)\noutput = Dense(5, activation=\"sigmoid\")(dnn_layer)\nmodel = keras.models.Model(inputs=[input_1, input_2], outputs=output)\nWhen I debug I get an error on this line:\n\nintermediate_layer_model = Model(inputs=model_a.input, \n                                 outputs=model_a.get_layer(\"layer_x\").output)\n\nFile \"..\", line 89, in set_model\n  outputs=self.neural_net_asc.model.get_layer(\"layer_x\").output)\nFile \"C:\\WinPython\\python-3.5.3.amd64\\lib\\site-packages\\keras\\legacy\\interfaces.py\", line 87, in wrapper\n  return func(*args, **kwargs)\nFile \"C:\\WinPython\\python-3.5.3.amd64\\lib\\site-packages\\keras\\engine\\topology.py\", line 1592, in __init__\n  mask = node.output_masks[tensor_index]\nAttributeError: 'Node' object has no attribute 'output_masks'\nI can access the tensor with get_layer(\"layer_x\").output and the output_mask is None. Do I have to set manually an output mask and how do I set up this output mask if needed?",
    "answer": "There are two things that you seem to be doing wrong :\n\nintermediate_output = intermediate_layer_model.predict(data)\nwhen you do .predict(), you are actually passing data through the graph and asking what will be the result. When you do that, intermediate_output will be a numpy array and not a layer as you would like it to be.\n\nSecondly, you don't need to recreate a new intermediate model. You can directly use the part of model_a that interest you.\n\nHere is a code that \"compiles\" for me :\n\nfrom keras.layers import Input, Dense, concatenate\nfrom keras.models import Model\n\ninputs = Input(shape=(100,))\ndnn = Dense(1024, activation='relu')(inputs)\ndnn = Dense(128, activation='relu', name=\"layer_x\")(dnn)\ndnn = Dense(1024, activation='relu')(dnn)\noutput = Dense(10, activation='softmax')(dnn)\n\nmodel_a = Model(inputs=inputs, outputs=output)\n\n# You don't need to recreate an input for the model_a, \n# it already has one and you can reuse it\ninput_b = Input(shape=(200,))\n\n# Here you get the layer that interests you from model_a, \n# it is still linked to its input layer, you just need to remember it for later\nintermediate_from_a = model_a.get_layer(\"layer_x\").output\n\n# Since intermediate_from_a is a layer, you can concatenate it with the other input\nmerge_layer = concatenate([input_b, intermediate_from_a])\ndnn_layer = Dense(512, activation=\"relu\")(merge_layer)\noutput_b = Dense(5, activation=\"sigmoid\")(dnn_layer)\n# Here you remember that one input is input_b and the other one is from model_a\nmodel_b = Model(inputs=[input_b, model_a.input], outputs=output_b)\nI hope this is what you wanted to do.\n\nPlease tell me if something isn't clear :-)",
    "mlApiName": "keras.models.Model, keras.models.model.predict",
    "embedding": [
      -0.4650104343891144,
      0.48328742384910583,
      -2.4318325519561768,
      -1.1593674421310425,
      0.9746169447898865,
      -0.6221532225608826,
      0.1435920149087906,
      0.4343102276325226,
      -0.23591406643390656,
      -0.47529008984565735,
      -1.0313342809677124,
      0.793775200843811,
      2.1677908897399902,
      -0.04306214675307274,
      0.3220504820346832,
      -0.3387223184108734,
      0.9259517788887024,
      -0.12306175380945206,
      0.7340624928474426,
      0.4867074489593506,
      -0.2168586254119873,
      -0.7705816030502319,
      0.4002837538719177,
      -0.5328393578529358,
      1.6273390054702759,
      0.24683810770511627,
      -0.543644905090332,
      0.21017493307590485,
      -0.3301180303096771,
      0.0714074894785881,
      0.6888311505317688,
      -1.166257619857788,
      0.36773863434791565,
      -0.634563148021698,
      -1.8932726383209229,
      -1.0549627542495728,
      0.7075686454772949,
      -0.18311887979507446,
      -0.46667495369911194,
      0.20304562151432037,
      1.3318281173706055,
      -0.18115274608135223,
      -0.22444692254066467,
      0.4655883312225342,
      -0.5120337009429932,
      -0.037318598479032516,
      0.8910084366798401,
      0.26399174332618713,
      0.15126021206378937,
      -0.6705260872840881,
      0.6727973818778992,
      0.9592518210411072,
      0.356463760137558,
      0.06344606727361679,
      1.489815354347229,
      0.4180326461791992,
      0.386984646320343,
      -0.17431968450546265,
      1.4215329885482788,
      -0.7651064395904541,
      0.4196842312812805,
      1.3712905645370483,
      -0.9402152299880981,
      1.1740057468414307,
      0.7166225910186768,
      -0.10539744049310684,
      -0.8827913999557495,
      0.9875532388687134,
      -0.6534314155578613,
      -0.3919272720813751,
      0.18039217591285706,
      0.40885233879089355,
      0.2092890739440918,
      0.09701089560985565,
      -0.2013741284608841,
      0.12693756818771362,
      -0.5177736878395081,
      -0.3757094144821167,
      -0.014180254191160202,
      0.9410805106163025,
      0.5123916864395142,
      0.9836738109588623,
      1.305922031402588,
      -0.5367904901504517,
      -0.08633093535900116,
      0.7045055031776428,
      -1.2250179052352905,
      -0.3719531297683716,
      -0.9259833097457886,
      1.0592821836471558,
      -0.34722036123275757,
      0.31082332134246826,
      0.19690236449241638,
      1.0969600677490234,
      -0.776512086391449,
      -0.8928079009056091,
      -0.1538301706314087,
      0.5267297029495239,
      -0.44967153668403625,
      -0.02974054403603077,
      -0.24395544826984406,
      0.5982042551040649,
      -0.11609409749507904,
      -1.2899692058563232,
      0.1257128119468689,
      1.2183486223220825,
      -0.08373810350894928,
      -0.7614830136299133,
      0.25807997584342957,
      -0.1398618072271347,
      -1.1244310140609741,
      0.25643494725227356,
      -0.30072009563446045,
      -0.1476820409297943,
      -0.1320587694644928,
      -0.5796532034873962,
      0.34204983711242676,
      0.28102928400039673,
      0.25410622358322144,
      0.33779177069664,
      0.006934052798897028,
      -0.18310953676700592,
      0.6257924437522888,
      -0.45018866658210754,
      0.23916421830654144,
      0.9262231588363647,
      -0.9930362105369568,
      0.037877731025218964,
      0.08750994503498077,
      -0.8621418476104736,
      0.3042832314968109,
      -0.15000593662261963,
      -0.14713096618652344,
      0.9312555193901062,
      1.1777962446212769,
      1.4297086000442505,
      -0.8420697450637817,
      -1.3458000421524048,
      0.4560248553752899,
      0.3584398329257965,
      0.5496537685394287,
      0.242206409573555,
      -0.3752237558364868,
      -1.0923025608062744,
      0.2818169593811035,
      -0.40419802069664,
      0.6960934400558472,
      -0.29178062081336975,
      -0.7772154808044434,
      0.3858278691768646,
      0.16293813288211823,
      0.7591798305511475,
      -0.906725287437439,
      0.7501909136772156,
      0.4615146219730377,
      -0.8011388182640076,
      0.44663357734680176,
      -0.27877774834632874,
      0.2444295436143875,
      0.22769849002361298,
      1.2276291847229004,
      -0.22443655133247375,
      -0.31786230206489563,
      0.6600750088691711,
      -0.8213483691215515,
      -1.0544462203979492,
      0.08007949590682983,
      0.055545222014188766,
      -0.1678883582353592,
      0.16314421594142914,
      -0.3403097093105316,
      -0.25880277156829834,
      -0.2262343019247055,
      0.2972296476364136,
      0.29972267150878906,
      0.4049653112888336,
      1.3750766515731812,
      -0.42691361904144287,
      0.4016963541507721,
      -0.23622997105121613,
      1.5303034782409668,
      -0.37186199426651,
      1.0274897813796997,
      -0.11357195675373077,
      -0.7449495792388916,
      0.2096167653799057,
      -0.15682002902030945,
      0.18164047598838806,
      0.0014349124394357204,
      -0.3950617015361786,
      0.4744400084018707,
      0.24412891268730164,
      -0.7441078424453735,
      -0.47940540313720703,
      -0.14003407955169678,
      0.5662459135055542,
      0.6545149683952332,
      -1.0259168148040771,
      1.081650733947754,
      0.16315396130084991,
      0.11736223846673965,
      0.47005292773246765,
      -0.4892858564853668,
      0.5441755056381226,
      -1.1204427480697632,
      0.9176676869392395,
      -0.47350209951400757,
      0.32950031757354736,
      -0.20861701667308807,
      0.2404877245426178,
      0.8782094120979309,
      -0.1465556025505066,
      0.6627370715141296,
      0.336019366979599,
      0.038734838366508484,
      -0.5369941592216492,
      0.6181209087371826,
      -0.3617705702781677,
      -0.11700743436813354,
      -0.31312382221221924,
      -0.03117273934185505,
      -0.4795263707637787,
      0.8665482997894287,
      0.7045450806617737,
      0.3850518465042114,
      -0.54205322265625,
      -0.25813761353492737,
      0.27879300713539124,
      -1.0965001583099365,
      0.019543932750821114,
      -0.35611435770988464,
      -1.424246907234192,
      0.11071229726076126,
      0.3196040391921997,
      -0.006015715189278126,
      0.08245410770177841,
      1.2135040760040283,
      0.8918235898017883,
      -0.35028448700904846,
      0.3602142333984375,
      -0.29757097363471985,
      0.07955411076545715,
      0.06452587991952896,
      -0.026721077039837837,
      -1.5818018913269043,
      0.5710256695747375,
      -0.08419912308454514,
      -0.48607543110847473,
      0.04744601249694824,
      0.8244478702545166,
      0.20278114080429077,
      0.8276166915893555,
      0.4848414659500122,
      0.016330575570464134,
      1.1683311462402344,
      -0.8745618462562561,
      -0.50655198097229,
      0.17150385677814484,
      0.25423896312713623,
      -0.254822313785553,
      0.222370445728302,
      0.16140221059322357,
      0.09718266874551773,
      -0.39129209518432617,
      -0.8101216554641724,
      -0.7348094582557678,
      0.01302833016961813,
      0.03964391350746155,
      0.3348475694656372,
      -0.5063341856002808,
      -0.6826372742652893,
      0.21150802075862885,
      0.8065550327301025,
      0.6454989314079285,
      0.26305854320526123,
      0.8108906149864197,
      0.1688702255487442,
      -0.04454849660396576,
      0.22125419974327087,
      -0.5789564251899719,
      -0.8900833129882812,
      -0.7513788938522339,
      -0.15944650769233704,
      -0.27869492769241333,
      -0.36519166827201843,
      -0.11663749068975449,
      -0.005599877331405878,
      0.6805993914604187,
      0.6449997425079346,
      0.5292350053787231,
      -0.056613489985466,
      -0.19637170433998108,
      -0.18396243453025818,
      -0.025437546893954277,
      0.03792442008852959,
      0.22767086327075958,
      1.164040446281433,
      -0.013379955664277077,
      -0.13626432418823242,
      -0.8172635436058044,
      0.5346799492835999,
      0.09836918860673904,
      0.5733466148376465,
      -0.014332831837236881,
      -0.1820572018623352,
      -0.6299193501472473,
      0.06705193966627121,
      0.5139315724372864,
      0.32912755012512207,
      -0.5536649227142334,
      -0.11672457307577133,
      0.04210913926362991,
      -0.21703872084617615,
      0.5676979422569275,
      -0.1490030735731125,
      0.6337954998016357,
      0.5159344673156738,
      0.02091912552714348,
      0.318263977766037,
      0.18152490258216858,
      -0.14351600408554077,
      -0.041550714522600174,
      0.4340006709098816,
      0.24740462005138397,
      -0.5619291067123413,
      0.7391416430473328,
      -0.14922703802585602,
      0.30617398023605347,
      -0.5871717929840088,
      -0.7971293926239014,
      1.1264164447784424,
      0.16921794414520264,
      0.02342608943581581,
      -1.1206320524215698,
      -0.6361084580421448,
      -0.5630738139152527,
      -0.06574565917253494,
      0.23993030190467834,
      0.2703711986541748,
      0.8292894959449768,
      0.6584795117378235,
      -0.1786670684814453,
      0.5743860006332397,
      0.03848731517791748,
      -0.4385632574558258,
      0.1936866044998169,
      -1.2374424934387207,
      -0.8308589458465576,
      0.037363965064287186,
      0.5210838913917542,
      -0.646998405456543,
      0.36288559436798096,
      0.3374922275543213,
      -0.28017064929008484,
      0.0661657303571701,
      -0.39982911944389343,
      0.8211367726325989,
      0.242132306098938,
      0.312762975692749,
      0.8528202176094055,
      0.9630360007286072,
      0.0489923357963562,
      0.11752764880657196,
      -0.21625323593616486,
      0.09580648690462112,
      0.45775118470191956,
      1.0711692571640015,
      -0.10239774733781815,
      0.5901105999946594,
      0.0489807203412056,
      -0.0568409226834774,
      -0.10628682374954224,
      -0.5989201664924622,
      0.0906800925731659,
      -0.9121063351631165,
      -0.27713003754615784,
      -0.8067693710327148,
      0.3465065062046051,
      -0.5748224854469299,
      0.40999898314476013,
      0.13238100707530975,
      -0.17894695699214935,
      -0.5694050192832947,
      0.6358469724655151,
      0.6158693432807922,
      0.7359465956687927,
      0.4609113931655884,
      -0.6051205396652222,
      0.18961989879608154,
      1.1601483821868896,
      0.31359362602233887,
      -0.24624966084957123,
      -0.5940002202987671,
      -0.38574346899986267,
      0.11693713068962097,
      -0.6483597755432129,
      0.9451500773429871,
      0.27053195238113403,
      -0.3338315486907959,
      0.33029624819755554,
      -0.793091893196106,
      -0.8416880965232849,
      0.16321448981761932,
      -0.019380997866392136,
      -0.5324511528015137,
      -0.014947209507226944,
      0.2263479381799698,
      -0.5280014872550964,
      0.8648876547813416,
      0.4910682737827301,
      0.251481294631958,
      -0.0975600928068161,
      0.0018336301436647773,
      -1.4434292316436768,
      0.1776469349861145,
      0.1302395612001419,
      0.676464319229126,
      0.9738465547561646,
      -0.9767321944236755,
      -0.17435918748378754,
      0.04902807995676994,
      0.8316149711608887,
      -0.05882912129163742,
      -0.31061220169067383,
      1.282828450202942,
      0.3100601136684418,
      0.47803813219070435,
      1.1785953044891357,
      -0.1149604544043541,
      -1.9560282230377197,
      0.29535144567489624,
      0.10787288099527359,
      0.4400407671928406,
      -0.5826989412307739,
      -1.1276980638504028,
      0.09859143942594528,
      -0.3152523934841156,
      0.7562762498855591,
      0.027454940602183342,
      0.8756536841392517,
      1.4844874143600464,
      -0.13149738311767578,
      -0.6780465841293335,
      -0.8571052551269531,
      0.6253972053527832,
      0.8696809411048889,
      0.7327823638916016,
      -0.8467544317245483,
      -1.3234529495239258,
      0.923729658126831,
      -0.4760729670524597,
      -0.48923563957214355,
      0.2806171178817749,
      0.128834530711174,
      1.5592410564422607,
      0.0516740083694458,
      0.36518165469169617,
      0.39589959383010864,
      -0.08046125620603561,
      -0.0013693273067474365,
      0.25685784220695496,
      0.62523353099823,
      -0.8997454643249512,
      -0.15928830206394196,
      -0.30399808287620544,
      -1.079440712928772,
      -0.48426514863967896,
      0.08916217088699341,
      0.4885501265525818,
      1.0706136226654053,
      -0.7908123731613159,
      0.045919664204120636,
      0.9105437397956848,
      0.02144451066851616,
      0.2633278965950012,
      -0.553981602191925,
      -0.11704575270414352,
      0.06698181480169296,
      0.16816744208335876,
      0.809172511100769,
      -0.39798504114151,
      -0.9441299438476562,
      -0.6592233180999756,
      -0.29619020223617554,
      -0.013555004261434078,
      1.2721728086471558,
      0.1059148982167244,
      0.2685301899909973,
      0.38666045665740967,
      -0.07385922223329544,
      0.31994885206222534,
      -0.06084105372428894,
      -0.524603009223938,
      0.10745412856340408,
      -0.3342045843601227,
      -0.4077983498573303,
      0.1763341724872589,
      0.6599382162094116,
      0.3270822763442993,
      0.8954288363456726,
      0.08388406783342361,
      0.5866706967353821,
      -0.2622530460357666,
      0.004750709980726242,
      0.8441013693809509,
      -0.5851930975914001,
      0.699709415435791,
      -0.4873298108577728,
      -0.1900217980146408,
      0.18249371647834778,
      0.018335441127419472,
      -0.03882548585534096,
      -0.15689806640148163,
      0.3380638062953949,
      0.031932149082422256,
      -0.9034509062767029,
      0.36186084151268005,
      0.7104986906051636,
      -1.0721038579940796,
      -0.2983112931251526,
      0.6784744262695312,
      -0.6363930702209473,
      -0.5066967606544495,
      -0.49357783794403076,
      -1.1562747955322266,
      0.0063982270658016205,
      0.03514338284730911,
      -1.645941972732544,
      -0.05216413363814354,
      -0.4682062566280365,
      -0.0638112723827362,
      -0.43312370777130127,
      -1.1533006429672241,
      0.22494293749332428,
      0.2583562135696411,
      0.03466702252626419,
      0.13627876341342926,
      0.7321192026138306,
      0.2427276372909546,
      -0.09889661520719528,
      0.26428377628326416,
      1.373353362083435,
      0.04639492183923721,
      -0.5523256063461304,
      0.0026625387836247683,
      0.05127263069152832,
      0.1071707159280777,
      1.0894896984100342,
      0.7915325164794922,
      -1.0995060205459595,
      0.1279468983411789,
      -1.2397953271865845,
      0.77620929479599,
      -0.7516998648643494,
      -0.23171496391296387,
      -0.8097540736198425,
      -0.2308608591556549,
      -0.869551956653595,
      -0.5114036202430725,
      -0.1390080600976944,
      -1.3089796304702759,
      0.14525584876537323,
      1.7732174396514893,
      0.7181856036186218,
      -0.5773134231567383,
      -0.405043363571167,
      -1.0682039260864258,
      0.37749379873275757,
      0.51027512550354,
      0.42883583903312683,
      0.11461351066827774,
      -1.1490709781646729,
      -0.3341160714626312,
      0.5843386054039001,
      -0.5794168710708618,
      0.041772160679101944,
      0.9866519570350647,
      0.053181640803813934,
      -0.31581205129623413,
      0.11262746900320053,
      -0.1141112670302391,
      -1.4366551637649536,
      0.3847983479499817,
      0.6886003017425537,
      0.03196699172258377,
      0.6212137341499329,
      -0.34473487734794617,
      -0.28131598234176636,
      0.2894146740436554,
      0.3172762095928192,
      -0.9605560898780823,
      -0.7465735077857971,
      0.9953244924545288,
      -0.691166341304779,
      0.2996383011341095,
      0.026682566851377487,
      -0.3519827127456665,
      0.4081082046031952,
      -0.4459482729434967,
      -1.143115758895874,
      -0.28719738125801086,
      0.6131977438926697,
      1.5542693138122559,
      -1.6415672302246094,
      0.22978928685188293,
      1.236132264137268,
      -0.7677123546600342,
      -0.026203572750091553,
      -0.3009245693683624,
      0.48793333768844604,
      0.14025743305683136,
      -0.2642715573310852,
      -0.20289954543113708,
      -0.31709057092666626,
      0.5513659119606018,
      -0.723116397857666,
      0.7669246792793274,
      -0.06904828548431396,
      -0.5252696871757507,
      -0.43790555000305176,
      -0.07334373891353607,
      -0.9751201868057251,
      1.163024663925171,
      -1.6682292222976685,
      0.35231226682662964,
      -1.213644027709961,
      -0.23184306919574738,
      -0.25791677832603455,
      0.25450563430786133,
      1.1393074989318848,
      -1.7447689771652222,
      0.018102163448929787,
      -2.0174272060394287,
      -0.2968871593475342,
      -0.953534722328186,
      0.9412194490432739,
      -0.2382611483335495,
      0.43402233719825745,
      0.8142035603523254,
      1.1159155368804932,
      0.13018684089183807,
      -0.06644229590892792,
      -1.2966220378875732,
      1.2033872604370117,
      0.02438282035291195,
      -1.3076342344284058,
      0.9154815077781677,
      1.1816235780715942,
      -0.19252467155456543,
      0.10901135951280594,
      0.7608508467674255,
      0.4997883141040802,
      -0.1745615005493164,
      -0.49196717143058777,
      0.6406189799308777,
      0.06264719367027283,
      0.19260504841804504,
      -0.01712176948785782,
      -0.84551602602005,
      0.09645235538482666,
      0.5858830213546753,
      -0.4834758937358856,
      -0.6654285788536072,
      -0.23973384499549866,
      -0.1562865674495697,
      -0.5910990834236145,
      -0.45815446972846985,
      0.13513930141925812,
      -0.21786393225193024,
      -0.7112246155738831,
      0.19620224833488464,
      0.17600174248218536,
      -0.07743269205093384,
      0.2750062346458435,
      -0.015461625531315804,
      0.23115818202495575,
      0.5509153604507446,
      0.5744243264198303,
      -0.1810273826122284,
      -0.45735251903533936,
      0.3264845013618469,
      0.20454782247543335,
      0.6861676573753357,
      -0.4039528965950012,
      0.26905810832977295,
      -1.147547721862793,
      0.19181862473487854,
      -1.0871505737304688,
      -0.4201788902282715,
      0.014091159217059612,
      -0.09901794791221619,
      0.29674890637397766,
      0.5931455492973328,
      -0.10983283072710037,
      -0.6111501455307007,
      0.4914305508136749,
      -0.3826315104961395,
      -1.0630325078964233,
      0.7152078151702881,
      0.8297972083091736,
      0.45128729939460754,
      0.17444361746311188,
      -0.5179855227470398,
      0.30781471729278564,
      -0.44495707750320435,
      -0.22814340889453888,
      0.25968462228775024,
      0.5863732099533081,
      -0.1391814947128296,
      -0.32024452090263367,
      -0.084444060921669,
      -0.01083912793546915,
      -0.6197940111160278,
      1.3966503143310547,
      -0.7994885444641113,
      1.0836107730865479,
      0.23336146771907806,
      -0.23877178132534027,
      -0.6867891550064087,
      0.15098293125629425,
      -0.34459131956100464,
      -0.3356545567512512,
      -0.9710229635238647,
      0.8161712288856506,
      -0.9283190369606018,
      -0.247319296002388,
      0.40569332242012024,
      -0.5026513338088989,
      -0.38300225138664246,
      0.3205610513687134,
      -0.46374234557151794,
      0.5066477656364441,
      -1.3117555379867554,
      0.8228801488876343,
      -0.7008265256881714,
      -0.4905520975589752,
      -1.0111603736877441,
      -0.8686239719390869,
      -1.0310808420181274,
      -0.3829992711544037,
      -1.061658263206482,
      -0.16706301271915436,
      0.576403021812439,
      -0.2826421856880188,
      -0.2880844473838806,
      -0.4287899434566498,
      -0.1554838865995407,
      1.2063459157943726,
      -0.17233937978744507,
      -0.2431308776140213,
      0.5449478626251221,
      -0.023066500201821327,
      -0.5001013278961182,
      -0.09369591623544693,
      0.022826729342341423,
      -0.39863118529319763,
      -0.8199594616889954,
      1.253576397895813,
      1.0983755588531494,
      0.2713065445423126,
      -0.18707500398159027,
      -0.852885901927948,
      0.2017495036125183,
      0.5250211358070374,
      -0.5880599021911621,
      -0.4832622706890106,
      0.25222504138946533,
      -0.8030389547348022
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "F",
      "level3": "F",
      "leafContractCategory": "AMO(Level-2)",
      "rootCause": "Missing Options",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Prediction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): Hybrid\nThe issue involves combining multiple Keras models (Model A and Model B) and incorrectly handling intermediate layer outputs, leading to a hybrid contract violation.\n\nLevel 2: F (Eventually Required Condition)\nThe intermediate layer must remain part of the TensorFlow computation graph, but calling predict() prematurely converts it into a NumPy array, breaking this requirement.\n\nLevel 3 (Hybrid Patterns): F (Eventually Required Condition), IC-1 (Intra-argument Contract)\nThe function expects a tensor but receives an incorrect argument type, violating both expected execution flow and argument structure.\n\nLeaf Contract Category: AMO (Level-2)\nThe violation stems from incorrect method order�predict() is used instead of passing the tensor output directly.\n\nRoot Cause: Missing Options\nThe user did not properly extract the intermediate output while maintaining its graph dependency.\n\nEffect: Crash\nThe incorrect API usage results in an AttributeError, leading to program failure.\n\nML Library: Keras\nThe issue is specific to Keras' functional API and model composition.\n\nContract Violation Location: Prediction\nThe error occurs when attempting to use an intermediate layer output as input for another model.\n\nDetection Technique: Static\nThe mistake can be detected by verifying that intermediate layers are properly referenced within the functional API instead of being converted to NumPy arrays."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/51100508",
    "title": "",
    "question": "9\n\nI need some help with keras loss function. I have been implementing custom loss function on keras with Tensorflow backend.\n\nI have implemented the custom loss function in numpy but it would be great if it could be translated into keras loss function. The loss function takes dataframe and series of user id. The Euclidean distance for same user_id are positive and negative if the user_id are different. The function returns summed up scalar distance of the dataframe.\n\ndef custom_loss_numpy (encodings, user_id):\n# user_id: a pandas series of users\n# encodings: a pandas dataframe of encodings\n\n    batch_dist = 0\n\n    for i in range(len(user_id)):\n         first_row = encodings.iloc[i,:].values\n         first_user = user_id[i]\n\n         for j in range(i+1, len(user_id)):\n              second_user = user_id[j]\n              second_row = encodings.iloc[j,:].values\n\n        # compute distance: if the users are same then Euclidean distance is positive otherwise negative.\n            if first_user == second_user:\n                tmp_dist = np.linalg.norm(first_row - second_row)\n            else:\n                tmp_dist = -np.linalg.norm(first_row - second_row)\n\n            batch_dist += tmp_dist\n\n    return batch_dist\nI have tried to implement into keras loss function. I extracted numpy array from y_true and y_pred tensor objects.\n\ndef custom_loss_keras(y_true, y_pred):\n    # session of my program\n    sess = tf_session.TF_Session().get()\n\n    with sess.as_default():\n        array_pred = y_pred.eval()\n        print(array_pred)\nBut I get the following error.\n\ntensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'dense_1_input' with dtype float and shape [?,102]\n [[Node: dense_1_input = Placeholder[dtype=DT_FLOAT, shape=[?,102], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\nAny kind of help would be really appreciated.",
    "answer": "First of all, it is not possible to \"extract numpy array from y_true and y_pred\" in Keras loss functions. You have to operate the tensors with Keras backend functions (or TF functions) to calculate the loss.\n\nIn other words, it would be better to think about a \"vectorized\" way to calculate the loss, without using if-else and loops.\n\nYour loss function can be computed in the following steps:\n\nGenerate a matrix of pairwise Euclidean distances, between all pairs of vectors in encodings.\nGenerate a matrix I whose element I_ij is 1 if user_i == user_j, and -1 if user_i != user_j.\nElement-wise multiply the two matrices, and sum up the elements to get the final loss.\nHere's an implementation:\n\ndef custom_loss_keras(user_id, encodings):\n    # calculate pairwise Euclidean distance matrix\n    pairwise_diff = K.expand_dims(encodings, 0) - K.expand_dims(encodings, 1)\n    pairwise_squared_distance = K.sum(K.square(pairwise_diff), axis=-1)\n\n    # add a small number before taking K.sqrt for numerical safety\n    # (K.sqrt(0) sometimes becomes nan)\n    pairwise_distance = K.sqrt(pairwise_squared_distance + K.epsilon())\n\n    # this will be a pairwise matrix of True and False, with shape (batch_size, batch_size)\n    pairwise_equal = K.equal(K.expand_dims(user_id, 0), K.expand_dims(user_id, 1))\n\n    # convert True and False to 1 and -1\n    pos_neg = K.cast(pairwise_equal, K.floatx()) * 2 - 1\n\n    # divide by 2 to match the output of `custom_loss_numpy`, but it's not really necessary\n    return K.sum(pairwise_distance * pos_neg, axis=-1) / 2\nI've assumed that user_id are integers in the code above. The trick here is to use K.expand_dims for implementing pairwise operations. It's probably a bit difficult to understand at a first glance, but it's quite useful.\n\nIt should give about the same loss value as custom_loss_numpy (there will be a little bit difference because of K.epsilon()):\n\nencodings = np.random.rand(32, 10)\nuser_id = np.random.randint(10, size=32)\n\nprint(K.eval(custom_loss_keras(K.variable(user_id), K.variable(encodings))).sum())\n-478.4245\n\nprint(custom_loss_numpy(pd.DataFrame(encodings), pd.Series(user_id)))\n-478.42953553795815\nI've made a mistake in the loss function.\n\nWhen this function is used in training, since Keras automatically changes y_true to be at least 2D, the argument user_id is no longer a 1D tensor. The shape of it will be (batch_size, 1).\n\nIn order to use this function, the extra axis must be removed:\n\ndef custom_loss_keras(user_id, encodings):\n    pairwise_diff = K.expand_dims(encodings, 0) - K.expand_dims(encodings, 1)\n    pairwise_squared_distance = K.sum(K.square(pairwise_diff), axis=-1)\n    pairwise_distance = K.sqrt(pairwise_squared_distance + K.epsilon())\n\n    user_id = K.squeeze(user_id, axis=1)  # remove the axis added by Keras\n    pairwise_equal = K.equal(K.expand_dims(user_id, 0), K.expand_dims(user_id, 1))\n\n    pos_neg = K.cast(pairwise_equal, K.floatx()) * 2 - 1\n    return K.sum(pairwise_distance * pos_neg, axis=-",
    "mlApiName": "keras.backend.sqrt, keras.backend.expand_dims",
    "embedding": [
      0.6151361465454102,
      0.9903758764266968,
      -1.8390283584594727,
      -1.3236243724822998,
      0.49946245551109314,
      -0.7247634530067444,
      0.5426998138427734,
      0.5252551436424255,
      0.044121094048023224,
      -0.8204479813575745,
      -0.45570722222328186,
      0.805387556552887,
      2.090862989425659,
      -0.3474668264389038,
      -0.37595877051353455,
      -0.3257966935634613,
      -0.010967254638671875,
      -0.30470576882362366,
      -0.17697475850582123,
      1.5835968255996704,
      -0.6309775114059448,
      0.0543060302734375,
      -0.10121676325798035,
      -0.18965505063533783,
      1.3940813541412354,
      -0.05669660493731499,
      -0.3027142286300659,
      0.6498882174491882,
      -0.6000242829322815,
      0.4703536927700043,
      0.9113453030586243,
      -0.15145650506019592,
      0.22569289803504944,
      -0.5881907939910889,
      -0.9289557337760925,
      -0.03320416435599327,
      1.1109185218811035,
      -0.4036443531513214,
      0.4621279835700989,
      -0.09949710220098495,
      -0.08483504503965378,
      -0.5747291445732117,
      0.1737987995147705,
      0.6406087875366211,
      0.7428897619247437,
      -0.6301500797271729,
      0.9020625948905945,
      0.3053666651248932,
      0.20613428950309753,
      -0.6312211751937866,
      0.051586590707302094,
      0.12050691246986389,
      -0.3927863836288452,
      0.03742637112736702,
      0.7114599943161011,
      0.7052819728851318,
      -0.47819799184799194,
      -0.5521119832992554,
      1.094827651977539,
      -0.6213499903678894,
      0.38058993220329285,
      1.0211291313171387,
      -0.9746139049530029,
      0.12751451134681702,
      0.9808342456817627,
      -0.4678956866264343,
      -0.9338602423667908,
      0.6823939681053162,
      -0.5186803936958313,
      -0.4083353281021118,
      0.8894416093826294,
      0.5174710750579834,
      -0.05455614626407623,
      0.6284884810447693,
      -0.3719739615917206,
      0.5850956439971924,
      -0.14172863960266113,
      -0.2110298126935959,
      0.21027818322181702,
      0.565994918346405,
      -0.4664230942726135,
      0.7305306792259216,
      1.1459965705871582,
      -0.1414766162633896,
      -0.03283189237117767,
      0.19347061216831207,
      -0.09023948013782501,
      -0.5441738963127136,
      -0.4117574989795685,
      1.2541441917419434,
      -0.41624149680137634,
      -0.5348508954048157,
      0.9923195242881775,
      1.0751464366912842,
      -0.553922176361084,
      -0.36106038093566895,
      -0.3355882167816162,
      -0.2965964078903198,
      -0.09947072714567184,
      -0.29608815908432007,
      0.33092278242111206,
      -0.07945134490728378,
      -0.5555368661880493,
      -1.1260780096054077,
      -0.24048678576946259,
      0.6518555283546448,
      0.4752717912197113,
      0.5304369926452637,
      0.44364482164382935,
      -0.1913721263408661,
      -0.48900848627090454,
      -0.5987346768379211,
      -0.6658207178115845,
      -1.1353517770767212,
      0.6524855494499207,
      -0.28800907731056213,
      0.5294590592384338,
      -1.1107878684997559,
      0.39645540714263916,
      0.6271027326583862,
      -0.39850130677223206,
      0.1323830634355545,
      0.8088390231132507,
      0.02933266945183277,
      -0.30027031898498535,
      0.7877088189125061,
      -0.38294684886932373,
      0.027409227564930916,
      0.21772931516170502,
      -0.5369167327880859,
      -0.006745701655745506,
      -1.0582599639892578,
      -0.7139063477516174,
      0.4121812880039215,
      0.3978765904903412,
      1.007628321647644,
      -0.4744972288608551,
      -0.4761655032634735,
      0.21828578412532806,
      0.5139344930648804,
      0.6723096370697021,
      -0.21189768612384796,
      -0.37947922945022583,
      -0.45752015709877014,
      0.09209728240966797,
      -0.8698407411575317,
      0.7283814549446106,
      -0.6650956273078918,
      -0.3312758505344391,
      -0.38758108019828796,
      0.6974374055862427,
      0.26603952050209045,
      -0.8815869092941284,
      -0.104163758456707,
      1.1904340982437134,
      -0.6298632621765137,
      0.3572751581668854,
      0.9819542169570923,
      0.39070743322372437,
      -0.21781371533870697,
      0.5386306643486023,
      0.7759667038917542,
      -0.5046765804290771,
      1.1562578678131104,
      -0.3526628613471985,
      -0.7569900751113892,
      0.5312435626983643,
      0.0002402707759756595,
      -0.44262465834617615,
      -0.15331391990184784,
      -0.6547808051109314,
      -0.9862185716629028,
      0.35317888855934143,
      -0.5331567525863647,
      -0.4113917946815491,
      1.2156667709350586,
      0.7202939987182617,
      -0.36172887682914734,
      0.15501926839351654,
      -0.18185926973819733,
      0.4386924207210541,
      -0.3805149793624878,
      0.9607279896736145,
      0.19884932041168213,
      -0.288163959980011,
      0.2536017894744873,
      0.5638957023620605,
      0.42979106307029724,
      -0.3102673888206482,
      -0.6133341789245605,
      0.4952037036418915,
      0.06464748084545135,
      -0.09822796285152435,
      -0.38147982954978943,
      -0.2522439658641815,
      0.13447795808315277,
      0.8755766153335571,
      -0.304720014333725,
      1.0665303468704224,
      0.39892277121543884,
      -0.3457469642162323,
      0.9918881058692932,
      -0.6495260000228882,
      0.2693670690059662,
      0.022505508735775948,
      -0.25042954087257385,
      -0.21521152555942535,
      0.23325467109680176,
      -0.15813247859477997,
      -0.12490908801555634,
      0.2755623459815979,
      -0.3549850881099701,
      -0.3653353154659271,
      0.912596583366394,
      0.501247227191925,
      -0.06306444853544235,
      0.43821823596954346,
      -0.317579060792923,
      -0.38758713006973267,
      0.5507844686508179,
      0.555705726146698,
      -0.42335569858551025,
      0.21890889108181,
      -0.030142996460199356,
      0.3812389671802521,
      -0.32557034492492676,
      -0.17678074538707733,
      -0.6445797681808472,
      -0.9874491691589355,
      -0.09894674271345139,
      -1.1357529163360596,
      -0.19328805804252625,
      0.5874528884887695,
      0.10366324335336685,
      0.01644769124686718,
      1.0743799209594727,
      0.8533861637115479,
      0.6725054979324341,
      -0.06454895436763763,
      0.5123730897903442,
      0.19062499701976776,
      0.33359163999557495,
      0.2861489951610565,
      0.7300803065299988,
      -0.8492031693458557,
      -0.10619828850030899,
      -0.5717687010765076,
      -1.4187889099121094,
      0.09741706401109695,
      0.7025658488273621,
      0.0074857003055512905,
      0.6031394600868225,
      0.914521336555481,
      0.15115593373775482,
      0.9111050963401794,
      -0.2076798528432846,
      -0.7770446538925171,
      -0.6828076839447021,
      1.1206649541854858,
      -0.7683004140853882,
      0.38008368015289307,
      0.5331870317459106,
      0.02107401378452778,
      -0.20783820748329163,
      -0.5748941898345947,
      -0.3930656611919403,
      -0.43556106090545654,
      0.22929954528808594,
      -0.07908754050731659,
      -0.2870681881904602,
      -0.19574236869812012,
      0.5917990207672119,
      1.0781804323196411,
      0.5391900539398193,
      0.7129382491111755,
      0.09318025410175323,
      0.14152799546718597,
      -0.07549458742141724,
      0.14732588827610016,
      0.34665095806121826,
      -0.058730099350214005,
      -0.4486324191093445,
      -1.0021612644195557,
      -0.01165971253067255,
      -0.15331970155239105,
      0.0017770298290997744,
      0.3906744122505188,
      0.8005526661872864,
      0.04988294839859009,
      0.5012906193733215,
      -0.037444181740283966,
      0.5003465414047241,
      0.07225780189037323,
      0.3275448977947235,
      0.48835983872413635,
      1.0605181455612183,
      1.0151951313018799,
      -0.4739416837692261,
      -0.16331863403320312,
      -0.4677303731441498,
      0.20614925026893616,
      0.5824252963066101,
      0.5905711650848389,
      0.10997503995895386,
      -0.4642438590526581,
      -0.058118414133787155,
      0.11152653396129608,
      -0.07002762705087662,
      0.39748871326446533,
      0.11637811362743378,
      -0.19147886335849762,
      -0.11462708562612534,
      -0.4392518997192383,
      0.8699505925178528,
      -0.6169642210006714,
      0.2762894928455353,
      1.1872743368148804,
      0.33480629324913025,
      0.23620659112930298,
      0.1587730199098587,
      0.3113805055618286,
      -0.9737349152565002,
      -0.12221688032150269,
      0.4167810082435608,
      -0.20607517659664154,
      0.5164949297904968,
      -0.78392094373703,
      -0.15012884140014648,
      0.5586521029472351,
      -0.05817822739481926,
      -0.29562848806381226,
      0.3426233232021332,
      0.4173393249511719,
      -1.4448682069778442,
      -1.594042420387268,
      0.17057031393051147,
      -0.17434853315353394,
      -0.19404885172843933,
      -0.06886223703622818,
      0.8705528974533081,
      0.09975752979516983,
      -0.0913795530796051,
      -0.17053177952766418,
      -0.967799723148346,
      -0.49591395258903503,
      0.4699693024158478,
      -0.573424756526947,
      -0.22509647905826569,
      0.8146203756332397,
      -0.6499379277229309,
      0.06758282333612442,
      -0.5833997130393982,
      0.4390779733657837,
      -0.23824304342269897,
      -0.0980759933590889,
      0.21684296429157257,
      0.9484080076217651,
      -0.3370527923107147,
      0.00952584482729435,
      0.3903660774230957,
      0.6046985983848572,
      -0.4717922806739807,
      0.035137925297021866,
      0.0431060753762722,
      -0.09462548047304153,
      -0.4199827313423157,
      1.2012414932250977,
      0.2464175969362259,
      0.07132109254598618,
      -0.06399769335985184,
      -0.29032525420188904,
      0.0012422200525179505,
      -0.23196691274642944,
      0.02614830806851387,
      -0.5985729098320007,
      -0.2070552110671997,
      -0.9799791574478149,
      0.15986137092113495,
      -0.5026500225067139,
      0.6341530680656433,
      0.3480462431907654,
      -0.07537230104207993,
      0.49523118138313293,
      -0.16059042513370514,
      0.3252514898777008,
      0.14924465119838715,
      0.602010190486908,
      -1.2805174589157104,
      0.5344099998474121,
      0.9442745447158813,
      -0.0744851604104042,
      -0.9476531147956848,
      -1.2477582693099976,
      -0.4306989014148712,
      0.5678215622901917,
      -0.6059122085571289,
      0.45638665556907654,
      0.14383018016815186,
      -0.5565954446792603,
      0.5372970104217529,
      -1.7788172960281372,
      -0.47592467069625854,
      0.5261930227279663,
      -0.39759814739227295,
      -0.052360229194164276,
      -0.9081955552101135,
      0.1812528818845749,
      -0.03746018931269646,
      0.06899835169315338,
      -0.258585125207901,
      0.3589041233062744,
      0.7213433980941772,
      0.28346818685531616,
      -1.4220367670059204,
      1.2226345539093018,
      0.18676376342773438,
      1.0462948083877563,
      0.3789651691913605,
      -0.23474524915218353,
      -0.7243919372558594,
      -0.3845667243003845,
      0.5190105438232422,
      -0.6460258960723877,
      0.5503933429718018,
      0.541464626789093,
      0.41861534118652344,
      -0.15191110968589783,
      0.5671065449714661,
      1.0088763236999512,
      -1.0863369703292847,
      -0.1219152957201004,
      0.8208300471305847,
      0.2482190728187561,
      0.16506658494472504,
      -0.1410859376192093,
      -0.42644673585891724,
      0.19334372878074646,
      0.25477561354637146,
      -0.23541665077209473,
      1.5436477661132812,
      0.5494133234024048,
      -0.24100448191165924,
      -0.8393931984901428,
      -0.4588276147842407,
      0.7107211351394653,
      0.1683277040719986,
      0.6199026107788086,
      -0.5263619422912598,
      -0.5728567838668823,
      1.0654354095458984,
      -0.2699282467365265,
      0.388178288936615,
      0.7607135772705078,
      -0.02872234769165516,
      1.0933822393417358,
      -0.3937590718269348,
      -0.4780903160572052,
      -0.6841344237327576,
      0.21713301539421082,
      0.5729633569717407,
      -0.651722252368927,
      0.6026932001113892,
      -0.8394325375556946,
      -0.2658235728740692,
      -0.25380346179008484,
      -0.3597436547279358,
      0.1997135430574417,
      -0.17690427601337433,
      0.45855027437210083,
      0.6743780970573425,
      -1.346298336982727,
      -0.3557111322879791,
      0.5286535024642944,
      -0.26314249634742737,
      -0.7618408203125,
      0.11273417621850967,
      -0.2677840292453766,
      -0.2607062757015228,
      0.902783989906311,
      0.6855131983757019,
      0.05687003210186958,
      -1.1101633310317993,
      -0.6668931841850281,
      -0.48611387610435486,
      -0.09177713096141815,
      1.316652536392212,
      0.14302432537078857,
      -0.36056122183799744,
      0.10900144279003143,
      -0.2444850504398346,
      0.39642173051834106,
      -0.35607799887657166,
      -0.40285390615463257,
      -0.057754743844270706,
      0.15267246961593628,
      -0.34778448939323425,
      -0.2328047901391983,
      0.8280481100082397,
      0.14734488725662231,
      0.49166929721832275,
      -0.22262734174728394,
      0.3305342197418213,
      -0.9153265357017517,
      -0.1723891943693161,
      0.6386838555335999,
      -0.3716004192829132,
      0.89189213514328,
      -0.6474069952964783,
      -0.45882710814476013,
      0.0031401384621858597,
      0.006916303653270006,
      0.18523520231246948,
      0.5115411877632141,
      0.2590082585811615,
      -0.2764942944049835,
      -0.8972863554954529,
      0.5262073874473572,
      0.938892126083374,
      -0.9064674377441406,
      0.31354042887687683,
      0.552483081817627,
      -0.18292784690856934,
      0.18000030517578125,
      -0.42312368750572205,
      -0.5505498647689819,
      -0.046249955892562866,
      0.329976350069046,
      -0.4347327649593353,
      -0.010600568726658821,
      -0.4028864800930023,
      -0.024318493902683258,
      -0.5375872254371643,
      -1.6445057392120361,
      -0.411472350358963,
      -0.12302257865667343,
      -0.31841591000556946,
      -0.732695996761322,
      0.9242873787879944,
      0.4222753047943115,
      -0.3869306147098541,
      0.5929485559463501,
      1.0179554224014282,
      -0.21023383736610413,
      -0.21033187210559845,
      -0.6024681329727173,
      -0.011533414013683796,
      -0.20748503506183624,
      0.19061000645160675,
      1.085344672203064,
      -1.0397183895111084,
      0.09946755319833755,
      -0.44971540570259094,
      0.3734123706817627,
      -1.0407207012176514,
      0.18045787513256073,
      -0.8383745551109314,
      -0.6209462285041809,
      -0.567230224609375,
      -0.31729575991630554,
      -0.3283958435058594,
      -0.7494322657585144,
      0.24029351770877838,
      1.2098785638809204,
      0.15502746403217316,
      -0.20759697258472443,
      -0.9633623361587524,
      0.03251028060913086,
      0.399618923664093,
      0.7189967036247253,
      0.24032087624073029,
      -0.16964295506477356,
      -1.223054051399231,
      0.2765752971172333,
      -0.20595231652259827,
      0.0009995709406211972,
      0.7235413789749146,
      0.18058334290981293,
      -0.38699331879615784,
      -0.6303367018699646,
      -0.38616320490837097,
      -0.18415243923664093,
      -0.5557891130447388,
      0.6989156007766724,
      0.012216154485940933,
      -0.17302508652210236,
      0.5840646028518677,
      0.4779832065105438,
      -0.6090670824050903,
      0.2716444134712219,
      -0.5726258158683777,
      -0.8860461711883545,
      -0.19725097715854645,
      0.8682233095169067,
      -0.5778679251670837,
      -0.3727644085884094,
      -0.16996391117572784,
      -0.6286662817001343,
      0.38219431042671204,
      -0.4829021990299225,
      -1.0681064128875732,
      -0.23957335948944092,
      0.8268524408340454,
      1.3175556659698486,
      -1.4232110977172852,
      0.3172077238559723,
      1.2286112308502197,
      -0.13768981397151947,
      -0.024869564920663834,
      -0.16460886597633362,
      0.07932306081056595,
      0.6831158399581909,
      0.11421205848455429,
      -0.002103194361552596,
      0.1815747618675232,
      -0.003421726869419217,
      -0.9688718318939209,
      1.429883360862732,
      0.28030744194984436,
      -0.6500784754753113,
      -0.020533811300992966,
      -0.32606497406959534,
      -1.2565826177597046,
      0.4246367812156677,
      -0.7375932335853577,
      0.5931630730628967,
      0.10251755267381668,
      -1.0303045511245728,
      -0.4990937113761902,
      0.27052101492881775,
      0.6732022166252136,
      -0.9080826044082642,
      -0.17151983082294464,
      -0.6619327664375305,
      -0.08460727334022522,
      -0.9575347900390625,
      1.760115623474121,
      -0.34628745913505554,
      0.9426456093788147,
      0.8557984232902527,
      0.4430154263973236,
      -0.4590630829334259,
      -0.06242310255765915,
      -0.40770846605300903,
      0.08230824023485184,
      -1.0248602628707886,
      -0.012128428556025028,
      0.6964672803878784,
      1.1615464687347412,
      -0.058470141142606735,
      -0.3904036581516266,
      1.0811622142791748,
      1.177308201789856,
      0.04352718964219093,
      0.005792906973510981,
      0.442952036857605,
      -0.1407761424779892,
      -0.0820203423500061,
      -1.0357643365859985,
      -0.8131906986236572,
      -0.09410476684570312,
      0.5012479424476624,
      -0.4188586473464966,
      -0.8080695271492004,
      -0.09731942415237427,
      0.5882245898246765,
      0.31246218085289,
      -0.069560706615448,
      0.31258511543273926,
      -0.3189416825771332,
      -0.6032282710075378,
      0.5941606163978577,
      0.8570531010627747,
      -0.9491569399833679,
      0.5422801971435547,
      0.6598121523857117,
      0.12384092062711716,
      0.8902830481529236,
      0.4607034921646118,
      -0.6743221282958984,
      -0.011093906126916409,
      0.5639636516571045,
      -0.6498512029647827,
      0.3895137906074524,
      -0.19615471363067627,
      0.014437660574913025,
      -0.45300257205963135,
      0.10828898102045059,
      -0.8925288915634155,
      0.5228829383850098,
      -0.30012449622154236,
      -0.4915289580821991,
      -0.0006335398065857589,
      0.11857634782791138,
      -0.3041935861110687,
      -0.32542046904563904,
      0.12909512221813202,
      0.4057665467262268,
      -0.754246175289154,
      0.26138776540756226,
      0.7703902125358582,
      0.014508920721709728,
      -0.1379576027393341,
      0.09504999220371246,
      0.3365844190120697,
      0.6274824142456055,
      -0.08998298645019531,
      0.5903165340423584,
      -0.2819814682006836,
      -0.08554203808307648,
      -0.21913516521453857,
      0.7952301502227783,
      0.06892116367816925,
      -0.6343027353286743,
      0.6786884665489197,
      0.06681868433952332,
      0.6617565155029297,
      0.012198799289762974,
      -0.7843531966209412,
      0.09893085062503815,
      -1.1171704530715942,
      0.2132565826177597,
      -0.4807000756263733,
      -0.9526020288467407,
      -0.1404864490032196,
      -0.5373795032501221,
      -0.8439663052558899,
      0.26711833477020264,
      0.035604286938905716,
      -0.9779128432273865,
      -0.36693239212036133,
      -0.7022392153739929,
      -0.07817963510751724,
      -0.7946177124977112,
      0.9745350480079651,
      -0.37388351559638977,
      0.09108716994524002,
      -0.9826957583427429,
      -0.6331389546394348,
      -0.9871283173561096,
      0.1673080176115036,
      -0.8678600788116455,
      0.3472423553466797,
      -0.0862605944275856,
      -0.2885151207447052,
      -0.1154952272772789,
      -0.5978735685348511,
      -0.5220205783843994,
      1.3015527725219727,
      0.17489224672317505,
      -0.7286540865898132,
      -0.1780344396829605,
      -0.6143050193786621,
      0.12220701575279236,
      0.4712733328342438,
      0.12550358474254608,
      0.46710118651390076,
      -0.15405629575252533,
      0.8547183871269226,
      0.734375,
      0.13824868202209473,
      0.3591843843460083,
      -0.5302724838256836,
      -0.1924431324005127,
      0.308345228433609,
      -0.2842712700366974,
      -0.4137303829193115,
      -0.1987966150045395,
      -0.0565849207341671
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SL",
      "level3": "F, IC-1",
      "leafContractCategory": "Comb. of SAM(Level 3) and AMO(Level 2)",
      "rootCause": "Missing Options",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): Hybrid\nThe issue involves multiple Keras API functions (K.sqrt, K.expand_dims) in a custom loss function, making it a hybrid contract violation.\n\nLevel 2: SL (Selection Issue)\nThe user incorrectly selects NumPy-style operations instead of TensorFlow/Keras backend functions for tensor calculations.\n\nLevel 3 (Hybrid Patterns): F (Eventually Required Condition), IC-1 (Intra-argument Contract)\nThe function fails because it does not properly handle tensor-based operations, which Keras loss functions require.\n\nLeaf Contract Category: Combination of SAM(Level 3) and AMO(Level 2)\nThe issue stems from both single API method misuse (K.sqrt, K.expand_dims) and method-order dependencies (ensuring proper tensor operations before evaluation).\n\nRoot Cause: Missing Options\nThe user attempts to extract NumPy arrays from Keras tensors, which is not possible within a loss function.\n\nEffect: Crash\nThe program fails with an InvalidArgumentError due to improper use of Keras backend functions in loss computation.\n\nML Library: Keras\nThe issue is specific to Keras� backend operations in defining a custom loss function.\n\nContract Violation Location: Model Construction\nThe error occurs while constructing the model with an incorrectly implemented loss function.\n\nDetection Technique: Static\nThe mistake can be identified through static analysis by ensuring that loss functions use valid Keras/TensorFlow operations instead of NumPy-based calculations.\n\n\n"
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/41378461",
    "title": "",
    "question": "21\n\nI want to get pretrained VGG16 model in Keras, remove its output layer, and then put a new output layer with the number of classes suited for my problem, and then to fit it on new data. For this reason, I am trying to use the model here: https://keras.io/applications/#vgg16, but since it is not Sequential, I cannot just model.pop(). Popping from layers and adding it also does not work, because in the predictions it still expects the old shape. How would I do that? Is there a way to convert this type of model to Sequential?",
    "answer": "56\n\nYou can use pop() on model.layers and then use model.layers[-1].output to create new layers.\n\nExample:\n\nfrom keras.models import Model\nfrom keras.layers import Dense,Flatten\nfrom keras.applications import vgg16\nfrom keras import backend as K\n\nmodel = vgg16.VGG16(weights='imagenet', include_top=True)\n\nmodel.input\n\nmodel.summary(line_length=150)\n\nmodel.layers.pop()\nmodel.layers.pop()\n\nmodel.summary(line_length=150)\n\nnew_layer = Dense(10, activation='softmax', name='my_dense')\n\ninp = model.input\nout = new_layer(model.layers[-1].output)\n\nmodel2 = Model(inp, out)\nmodel2.summary(line_length=150)\nAlternatively, you can use include_top=False option of these models. In this case if you need to use flatten the layer then you need to pass the input_shape also.\n\nmodel3 = vgg16.VGG16(weights='imagenet', include_top=False, input_shape=(224, 224, 3))\nmodel3.summary(line_length=150)\n\nflatten = Flatten()\nnew_layer2 = Dense(10, activation='softmax', name='my_dense_2')\n\ninp2 = model3.input\nout2 = new_layer2(flatten(model3.output))\n\nmodel4 = Model(inp2, out2)\nmodel4.summary(line_length=150)",
    "mlApiName": "keras.models.pop, keras.applications.vgg16.VGG16, keras.layers, keras.models",
    "embedding": [
      -0.34314945340156555,
      0.7096837162971497,
      -2.187499761581421,
      -1.1419297456741333,
      0.6490744948387146,
      -0.08780517429113388,
      0.28248125314712524,
      0.26271185278892517,
      -0.34402817487716675,
      -0.7383495569229126,
      -0.4349890351295471,
      0.32249748706817627,
      2.1792080402374268,
      0.5220601558685303,
      0.02093454822897911,
      -0.6156741380691528,
      0.17030547559261322,
      -0.03270093724131584,
      -0.23697155714035034,
      0.6963582634925842,
      0.46322211623191833,
      -1.3297767639160156,
      0.5193957090377808,
      -0.7053171396255493,
      0.9843242764472961,
      -0.18726177513599396,
      -0.1597829908132553,
      0.3869946002960205,
      -0.35713425278663635,
      0.4896189272403717,
      1.4417582750320435,
      -0.8683505654335022,
      0.2551843225955963,
      -1.1117008924484253,
      -1.1664910316467285,
      -0.4678346514701843,
      1.3221521377563477,
      -0.3401321470737457,
      -0.5013926029205322,
      0.21030022203922272,
      1.4270837306976318,
      0.5161500573158264,
      0.23594318330287933,
      0.6225715279579163,
      -0.5009734034538269,
      0.14714877307415009,
      1.361777663230896,
      0.46966272592544556,
      0.7341230511665344,
      -0.8711525201797485,
      0.40246257185935974,
      0.7991181015968323,
      0.08454160392284393,
      -0.30014991760253906,
      0.8298136591911316,
      0.7231127023696899,
      0.3599928915500641,
      0.35028988122940063,
      1.0225157737731934,
      -1.1969162225723267,
      -0.4022766053676605,
      1.430484652519226,
      -1.3977922201156616,
      2.0530667304992676,
      0.2513192296028137,
      0.3827289938926697,
      -0.9211474061012268,
      0.30437973141670227,
      -0.41346848011016846,
      -1.0357269048690796,
      0.21668894588947296,
      0.9621140956878662,
      0.22722841799259186,
      -0.42416152358055115,
      -0.4925954043865204,
      -0.42443227767944336,
      -0.31133994460105896,
      -0.904336154460907,
      -0.2952762544155121,
      0.4817681908607483,
      0.11260879039764404,
      1.260175108909607,
      1.2598203420639038,
      -0.7802802920341492,
      -0.024803001433610916,
      0.21611501276493073,
      -1.0122721195220947,
      -0.4379938542842865,
      -1.1317797899246216,
      1.442022442817688,
      -0.26137951016426086,
      -1.056643009185791,
      0.5931691527366638,
      0.925129234790802,
      -1.1978806257247925,
      -0.9152401089668274,
      -0.09913483262062073,
      -0.027832310646772385,
      -0.1226697787642479,
      -0.4329957664012909,
      -0.029225880280137062,
      0.2156027853488922,
      -0.26091137528419495,
      -1.173258900642395,
      -0.6253873705863953,
      1.3161057233810425,
      -0.3631710410118103,
      0.11158289760351181,
      0.9225425720214844,
      -0.30043521523475647,
      -0.8439539670944214,
      0.16008731722831726,
      0.09858318418264389,
      0.4831346869468689,
      -0.18325018882751465,
      -0.36008769273757935,
      0.2648746371269226,
      0.0442936047911644,
      0.12847575545310974,
      0.45264238119125366,
      0.008206729777157307,
      -0.8176582455635071,
      0.7970998883247375,
      -0.34188151359558105,
      -0.14795275032520294,
      0.41505178809165955,
      -0.9730260372161865,
      0.09926094114780426,
      0.2585766911506653,
      -0.9538205862045288,
      0.33608579635620117,
      -0.558521568775177,
      -0.020246941596269608,
      1.067918062210083,
      1.0948339700698853,
      1.9136078357696533,
      -0.8655277490615845,
      -1.0966160297393799,
      0.8360795974731445,
      0.38032835721969604,
      0.5347655415534973,
      0.14330029487609863,
      -0.12575629353523254,
      -0.6281718611717224,
      0.3562298119068146,
      -0.06539854407310486,
      0.7847294807434082,
      -0.2975509762763977,
      -0.9452906847000122,
      0.7658286094665527,
      -0.026176927611231804,
      0.5182640552520752,
      -1.0755419731140137,
      -0.13447833061218262,
      0.8767738342285156,
      -1.0353596210479736,
      0.7536426186561584,
      0.7586588859558105,
      0.45894932746887207,
      -0.8375564217567444,
      1.0393569469451904,
      -0.34078025817871094,
      -0.27624738216400146,
      0.19060420989990234,
      -0.13084372878074646,
      -0.9474660158157349,
      -0.44326409697532654,
      0.10307278484106064,
      -0.5241703391075134,
      0.8146645426750183,
      -0.47453370690345764,
      -0.42316365242004395,
      -0.542643129825592,
      0.3654581308364868,
      0.27535057067871094,
      0.6821163296699524,
      1.8044551610946655,
      -0.3568975627422333,
      1.0214279890060425,
      0.12362780421972275,
      1.20094633102417,
      -0.15676501393318176,
      0.9084635376930237,
      -0.11226961761713028,
      -0.6367580890655518,
      0.3925482928752899,
      0.225025936961174,
      0.12505754828453064,
      0.464408814907074,
      -0.5573320388793945,
      0.48377931118011475,
      0.2645733654499054,
      -0.42363810539245605,
      -0.45169976353645325,
      0.1352851539850235,
      0.10224127769470215,
      1.2342814207077026,
      -0.45005008578300476,
      0.7344216704368591,
      -0.2265133261680603,
      0.17397341132164001,
      0.6740149855613708,
      -0.3793848752975464,
      0.2640833258628845,
      -0.9478070735931396,
      0.5707705020904541,
      -0.27188506722450256,
      0.7599101662635803,
      -0.3810545802116394,
      0.07484318315982819,
      0.44343578815460205,
      0.051328495144844055,
      0.6873103380203247,
      0.5449204444885254,
      0.21518327295780182,
      -0.03796444088220596,
      0.6758113503456116,
      -0.45110711455345154,
      0.10700374096632004,
      -0.19885039329528809,
      0.3213498592376709,
      -0.20091186463832855,
      0.5181537866592407,
      0.26081544160842896,
      0.739168107509613,
      -1.2828710079193115,
      0.6326103806495667,
      0.015538157895207405,
      -1.2550311088562012,
      -0.10664446651935577,
      -0.11713384836912155,
      -0.9628524780273438,
      -0.06472668796777725,
      0.5183884501457214,
      -0.36320412158966064,
      0.2306605577468872,
      1.0144942998886108,
      1.0780926942825317,
      -0.8785692453384399,
      -0.10900045931339264,
      -0.11078869551420212,
      0.4613487720489502,
      0.26501888036727905,
      -0.21795104444026947,
      -0.8882887363433838,
      0.0687277764081955,
      0.16810499131679535,
      -0.13214488327503204,
      0.45405593514442444,
      0.8525168299674988,
      0.24699340760707855,
      0.31112685799598694,
      0.9289403557777405,
      -0.10756173729896545,
      1.134413242340088,
      -0.7797865867614746,
      -0.7592763900756836,
      -0.14131824672222137,
      0.5310340523719788,
      -0.3235212564468384,
      0.40195825695991516,
      0.4274705648422241,
      -0.4821755588054657,
      0.2086700052022934,
      -0.26228079199790955,
      -0.7450588345527649,
      -0.21978528797626495,
      -0.5715637803077698,
      0.3668050169944763,
      -0.05033138394355774,
      -0.0666826069355011,
      0.6606330871582031,
      0.8224706649780273,
      1.1353356838226318,
      0.8516110181808472,
      0.10250254720449448,
      0.44808703660964966,
      0.2410344034433365,
      -0.1638600379228592,
      0.28536534309387207,
      -0.49183323979377747,
      -1.488019347190857,
      -0.5336757302284241,
      -0.4394102394580841,
      0.08523083478212357,
      -0.3568302094936371,
      -0.15009050071239471,
      -0.29277053475379944,
      0.2766760587692261,
      0.35412654280662537,
      -0.5014849305152893,
      0.07330866903066635,
      -0.27909594774246216,
      0.4471224546432495,
      -0.4999848008155823,
      0.037373073399066925,
      0.6436576843261719,
      -0.005382081959396601,
      0.21618804335594177,
      -0.8074250817298889,
      0.2295132726430893,
      0.7801842093467712,
      1.2257267236709595,
      0.340827077627182,
      0.35866501927375793,
      -0.1185145452618599,
      0.43742167949676514,
      -0.17092646658420563,
      0.05094926059246063,
      -0.6172914505004883,
      -1.0633095502853394,
      -0.026093825697898865,
      -0.4924677610397339,
      1.0939806699752808,
      -0.32415780425071716,
      -0.033301014453172684,
      0.15245848894119263,
      0.3939287066459656,
      -0.21650755405426025,
      -0.21578140556812286,
      -0.24003155529499054,
      0.39613258838653564,
      0.4007963538169861,
      0.40621206164360046,
      -0.944124162197113,
      0.7603068947792053,
      -0.3770727813243866,
      -0.258698433637619,
      0.47982001304626465,
      0.0004907543188892305,
      0.6898106336593628,
      0.09629876166582108,
      0.305667519569397,
      -1.379646897315979,
      -0.6751779317855835,
      0.21077238023281097,
      0.16545423865318298,
      0.2069089114665985,
      0.3942260146141052,
      0.8146911859512329,
      -0.3805370330810547,
      0.03051142767071724,
      0.43178415298461914,
      -0.23514388501644135,
      -0.566754937171936,
      0.25625550746917725,
      -1.3470572233200073,
      -1.398388147354126,
      0.6694064736366272,
      0.2613275647163391,
      -0.3694893717765808,
      0.6249943971633911,
      -0.29119545221328735,
      -0.4344371259212494,
      0.11467868089675903,
      -0.5120677947998047,
      0.4721078872680664,
      0.368132084608078,
      0.43994754552841187,
      0.6179894804954529,
      0.971804678440094,
      -1.0077258348464966,
      0.1038210466504097,
      0.4766106903553009,
      0.14884869754314423,
      0.22742944955825806,
      0.5590846538543701,
      -0.2409507781267166,
      0.9175295233726501,
      0.017966700717806816,
      0.015822337940335274,
      -0.6237718462944031,
      -0.2597549855709076,
      0.2878183424472809,
      -0.23970948159694672,
      0.26819151639938354,
      -0.790553092956543,
      0.33909258246421814,
      -0.6453604102134705,
      -0.447054922580719,
      0.43329018354415894,
      -0.7528014779090881,
      0.4920858144760132,
      -0.19492754340171814,
      0.21536579728126526,
      0.8703461289405823,
      0.7531800866127014,
      -0.24313363432884216,
      0.07328394800424576,
      1.6219853162765503,
      0.13119490444660187,
      -0.187844917178154,
      -0.28856131434440613,
      -0.23693566024303436,
      0.01982288248836994,
      -0.6461929678916931,
      0.7645388841629028,
      0.02309303916990757,
      -0.8153196573257446,
      -0.011969021521508694,
      -1.536580204963684,
      -0.5489400625228882,
      0.2315952032804489,
      -0.04327479004859924,
      -0.27191394567489624,
      -0.15776057541370392,
      0.11060252040624619,
      -0.313557505607605,
      0.596110463142395,
      -0.058782245963811874,
      -0.10121915489435196,
      -0.36950966715812683,
      -0.02825174666941166,
      -1.6332944631576538,
      0.8266569375991821,
      -0.07732494175434113,
      0.686221182346344,
      1.2075879573822021,
      -0.7340716123580933,
      -0.48595818877220154,
      -0.4348644018173218,
      0.3969273567199707,
      -0.25939130783081055,
      -0.15405608713626862,
      0.8282293081283569,
      0.9026241898536682,
      0.32417482137680054,
      0.916415810585022,
      0.19368654489517212,
      -2.063034772872925,
      0.5151289701461792,
      -0.0558491088449955,
      0.735634446144104,
      -0.9209222197532654,
      -0.8563986420631409,
      -0.01759943924844265,
      -0.25615668296813965,
      1.2426358461380005,
      -0.5240223407745361,
      0.1189480796456337,
      1.1662954092025757,
      -0.41807109117507935,
      -0.622286319732666,
      -0.4193563163280487,
      0.3477589786052704,
      0.23152382671833038,
      0.7074721455574036,
      -0.8055927157402039,
      -1.4347323179244995,
      1.790922999382019,
      -0.31513893604278564,
      -0.4768744707107544,
      0.18183566629886627,
      1.1245923042297363,
      1.6800222396850586,
      -0.14861489832401276,
      -0.10739292204380035,
      -0.0018246264662593603,
      -0.3874798119068146,
      0.3019680976867676,
      0.25698596239089966,
      0.46593356132507324,
      -0.7311903834342957,
      -0.15178106725215912,
      -0.4096657633781433,
      -1.2573962211608887,
      -0.14364951848983765,
      -0.20630696415901184,
      0.8947601318359375,
      1.2506250143051147,
      -0.7386282682418823,
      -0.2905386686325073,
      0.5610392093658447,
      -0.3356013894081116,
      0.23862706124782562,
      0.3996537923812866,
      -0.14995507895946503,
      -0.05482980236411095,
      -0.3235500454902649,
      0.17069412767887115,
      0.2534346282482147,
      -1.7183274030685425,
      -0.3945651948451996,
      -0.7889813780784607,
      -0.2220904380083084,
      1.6978271007537842,
      -0.019128931686282158,
      0.30852437019348145,
      0.27849435806274414,
      -0.11224948614835739,
      0.6953031420707703,
      -0.2857879102230072,
      -0.34646543860435486,
      0.17273078858852386,
      0.3095396161079407,
      -0.08770641684532166,
      0.2006525993347168,
      1.2823735475540161,
      0.23979265987873077,
      0.9740685820579529,
      0.04331641644239426,
      0.31167563796043396,
      -0.7803704738616943,
      0.01746365614235401,
      0.9371495246887207,
      -0.5097145438194275,
      0.7121241092681885,
      -0.8059400320053101,
      -0.011251814663410187,
      -0.16269174218177795,
      0.7426297068595886,
      -0.43900078535079956,
      -0.04367780685424805,
      0.1879146248102188,
      0.5349940061569214,
      -1.3456250429153442,
      -0.21359670162200928,
      0.600517988204956,
      -1.123787760734558,
      0.20656953752040863,
      0.4812982976436615,
      -0.7549430131912231,
      -0.28626909852027893,
      -0.5318687558174133,
      -0.7170954346656799,
      0.2604646384716034,
      0.13582651317119598,
      -1.4684624671936035,
      0.8189077973365784,
      -0.9535617828369141,
      0.4502117335796356,
      -0.20389984548091888,
      -1.245047688484192,
      -0.15172138810157776,
      0.129477858543396,
      -0.04924183338880539,
      -0.4096590280532837,
      1.32972252368927,
      0.7220836281776428,
      -0.24910633265972137,
      0.2536824941635132,
      1.1315550804138184,
      0.17373529076576233,
      -0.7754939794540405,
      -1.0326554775238037,
      0.2072533369064331,
      0.09907499700784683,
      1.4261622428894043,
      0.4813416004180908,
      -0.39852282404899597,
      -0.30147361755371094,
      -1.379478096961975,
      0.49882352352142334,
      -0.6787986755371094,
      -0.1560954600572586,
      -1.0358566045761108,
      -0.7818127870559692,
      -0.8357996940612793,
      -0.4902859926223755,
      -0.43460357189178467,
      -1.283258318901062,
      0.1482870876789093,
      1.7874751091003418,
      -0.07566215097904205,
      -0.37946730852127075,
      -0.20546916127204895,
      -0.7082250118255615,
      0.7788591384887695,
      0.08076811581850052,
      0.25874361395835876,
      -0.2881796658039093,
      -1.3065935373306274,
      0.39436453580856323,
      0.42912060022354126,
      -0.5638037323951721,
      0.09090211987495422,
      0.9382649660110474,
      0.5754433274269104,
      -0.5469726920127869,
      0.2500726282596588,
      -0.5483882427215576,
      -1.6145693063735962,
      -0.11487118154764175,
      0.19307492673397064,
      0.2129633128643036,
      0.43283501267433167,
      -0.24543194472789764,
      -0.9868389368057251,
      -0.2934112250804901,
      0.46111157536506653,
      -1.1446486711502075,
      -0.9864574670791626,
      0.5671413540840149,
      -0.26486772298812866,
      0.9030948281288147,
      0.3200562596321106,
      -0.7490626573562622,
      0.6873812675476074,
      0.02153133600950241,
      -1.6380267143249512,
      -0.1566164344549179,
      0.45300838351249695,
      1.5077999830245972,
      -1.5763965845108032,
      0.2562865912914276,
      0.9861284494400024,
      -1.1069869995117188,
      0.8233884572982788,
      -0.06745608896017075,
      -0.09355831146240234,
      0.35189682245254517,
      -0.07692442834377289,
      -0.04450682923197746,
      0.007666118908673525,
      0.8833319544792175,
      -1.2413510084152222,
      0.7075419425964355,
      -0.008648145943880081,
      -0.1296677440404892,
      -0.9114473462104797,
      -1.206993579864502,
      -0.7941491007804871,
      1.5554741621017456,
      -1.8776299953460693,
      0.44100964069366455,
      -0.49506816267967224,
      -0.4322652220726013,
      0.12286173552274704,
      0.9105068445205688,
      0.6039065718650818,
      -1.3081167936325073,
      0.44975700974464417,
      -2.004760265350342,
      0.21063831448554993,
      -0.4973263442516327,
      1.9518705606460571,
      -0.2135450839996338,
      0.5883602499961853,
      0.28736528754234314,
      0.5085251331329346,
      0.19214339554309845,
      0.3330208659172058,
      -0.3280506134033203,
      0.68116694688797,
      0.11448100954294205,
      -0.748257577419281,
      0.9777892231941223,
      0.33637070655822754,
      0.14973023533821106,
      0.18505531549453735,
      0.7149679660797119,
      1.0559847354888916,
      -0.1422295868396759,
      -0.8873248100280762,
      0.5455769300460815,
      -0.19693520665168762,
      -0.028727130964398384,
      -0.3059862554073334,
      -0.7714700698852539,
      0.2500872313976288,
      -0.429051011800766,
      -0.7072925567626953,
      -0.4839009940624237,
      -0.5073434710502625,
      0.6147500872612,
      0.2448754906654358,
      -0.09705114364624023,
      0.6380929946899414,
      -0.13547350466251373,
      -0.8953201770782471,
      -0.32378914952278137,
      0.373305082321167,
      -0.5555539727210999,
      0.633120059967041,
      0.955662727355957,
      -0.23091809451580048,
      0.8877434134483337,
      0.8451272249221802,
      0.17028580605983734,
      -0.4218684434890747,
      0.7079434990882874,
      0.10630272328853607,
      0.9454130530357361,
      0.9711467623710632,
      0.22018294036388397,
      -1.6061770915985107,
      0.303497314453125,
      -1.0846117734909058,
      0.5281985402107239,
      0.594160795211792,
      -0.35280853509902954,
      -0.029919011518359184,
      0.36398667097091675,
      0.3137912154197693,
      -0.5821935534477234,
      0.2977582514286041,
      -0.7571553587913513,
      -1.4959441423416138,
      0.3695777654647827,
      1.0295872688293457,
      0.7755815386772156,
      0.3624083697795868,
      -0.28972578048706055,
      0.425690621137619,
      -0.15603554248809814,
      -0.05914889648556709,
      0.22314170002937317,
      -0.06161760911345482,
      -0.23595283925533295,
      -0.9410160183906555,
      -0.8812442421913147,
      0.005244663450866938,
      -0.138612300157547,
      1.540440320968628,
      -0.7957208156585693,
      0.6469881534576416,
      -0.6395713090896606,
      -0.11516542732715607,
      -0.5066565871238708,
      -0.5153315663337708,
      -0.1597375124692917,
      -0.7261143922805786,
      -1.1829581260681152,
      1.0180906057357788,
      -0.17381514608860016,
      -0.45938900113105774,
      -0.11004078388214111,
      -0.17166484892368317,
      -0.9711959958076477,
      0.06670968234539032,
      -1.0612848997116089,
      0.1027185469865799,
      -1.3511929512023926,
      1.5491372346878052,
      -0.7629420757293701,
      -0.39992302656173706,
      -0.7655559778213501,
      -0.5418020486831665,
      -0.5516892671585083,
      -0.7565922737121582,
      -1.2470463514328003,
      0.5411268472671509,
      0.6517308950424194,
      0.7523298859596252,
      -0.68711918592453,
      0.20916812121868134,
      -0.9403563141822815,
      1.6801475286483765,
      -0.47157058119773865,
      -0.08998779207468033,
      0.010294483043253422,
      0.1676979511976242,
      -0.5796738266944885,
      -0.2847687602043152,
      -1.0397266149520874,
      0.18327899277210236,
      -0.31382253766059875,
      0.9411560893058777,
      0.7311245203018188,
      0.033541157841682434,
      -0.14858107268810272,
      -0.753297746181488,
      0.795962929725647,
      0.105755515396595,
      0.2889242470264435,
      -0.6899824738502502,
      0.06889648735523224,
      -0.25491759181022644
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SL",
      "level3": "F, F, IC-1",
      "leafContractCategory": "Comb. of SAM(Level 3) and AMO(Level 2)",
      "rootCause": "Missing Options",
      "effect": "IF",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): Hybrid\nThe issue involves multiple Keras API methods (VGG16, pop, layers, models), leading to a hybrid contract violation.\n\nLevel 2: SL (Selection Issue)\nThe user incorrectly selects pop() to remove layers, which does not work for functional API models like VGG16.\n\nLevel 3 (Hybrid Patterns): F (Eventually Required Condition), F (Eventually Required Condition), IC-1 (Intra-argument Contract)\nThe model modification requires specific API calls to ensure proper structure, which was not followed.\n\nLeaf Contract Category: Combination of SAM(Level 3) and AMO(Level 2)\nThe violation arises due to a combination of single API misuse (pop()) and incorrect method ordering.\n\nRoot Cause: Missing Options\nThe user did not use the include_top=False argument when loading VGG16, which would allow proper customization.\n\nEffect: IF (Incorrect Functionality)\nThe model still expects the original output shape, leading to incorrect behavior.\n\nML Library: Keras\nThe issue is specific to modifying pre-trained Keras models.\n\nContract Violation Location: Model Construction\nThe error occurs during the modification of the model architecture.\n\nDetection Technique: Static\nThe incorrect use of pop() with functional API models can be identified through static analysis by verifying if layer modifications are properly reflected in the model structure."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/47599436",
    "title": "",
    "question": "12\n\nI am trying to make a simple proof-of-concept where I can see the probabilities of different classes for a given prediction.\n\nHowever, everything I try seems to only output the predicted class, even though I am using a softmax activation. I am new to machine learning, so I'm not sure if I am making a simple mistake or if this is a feature not available in Keras.\n\nI'm using Keras + TensorFlow. I have adapted one of the basic examples given by Keras for classifying the MNIST dataset.\n\nMy code below is exactly the same as the example, except for a few (commented) extra lines that exports the model to a local file.\n\n'''Trains a simple deep NN on the MNIST dataset.\nGets to 98.40% test accuracy after 20 epochs\n(there is *a lot* of margin for parameter tuning).\n2 seconds per epoch on a K520 GPU.\n'''\n\nfrom __future__ import print_function\n\nimport keras\nfrom keras.datasets import mnist\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Dropout\nfrom keras.optimizers import RMSprop\n\nimport h5py # added import because it is required for model.save\nmodel_filepath = 'test_model.h5' # added filepath config\n\nbatch_size = 128\nnum_classes = 10\nepochs = 20\n\n# the data, shuffled and split between train and test sets\n(x_train, y_train), (x_test, y_test) = mnist.load_data()\n\nx_train = x_train.reshape(60000, 784)\nx_test = x_test.reshape(10000, 784)\nx_train = x_train.astype('float32')\nx_test = x_test.astype('float32')\nx_train /= 255\nx_test /= 255\nprint(x_train.shape[0], 'train samples')\nprint(x_test.shape[0], 'test samples')\n\n# convert class vectors to binary class matrices\ny_train = keras.utils.to_categorical(y_train, num_classes)\ny_test = keras.utils.to_categorical(y_test, num_classes)\n\nmodel = Sequential()\nmodel.add(Dense(512, activation='relu', input_shape=(784,)))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(512, activation='relu'))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(num_classes, activation='softmax'))\n\nmodel.summary()\n\nmodel.compile(loss='categorical_crossentropy',\n          optimizer=RMSprop(),\n          metrics=['accuracy'])\n\nhistory = model.fit(x_train, y_train,\n                batch_size=batch_size,\n                epochs=epochs,\n                verbose=1,\n                validation_data=(x_test, y_test))\nscore = model.evaluate(x_test, y_test, verbose=0)\nprint('Test loss:', score[0])\nprint('Test accuracy:', score[1])\n\nmodel.save(model_filepath) # added saving model\nprint('Model saved') # added log\nThen the second part of this is a simple script that should import the model, predict the class for some given data, and print out the probabilities for each class. (I am using the same mnist class included with the Keras codebase to make an example as simple as possible).\n\nimport keras\nfrom keras.datasets import mnist\nfrom keras.models import Sequential\nimport keras.backend as K\n\nimport numpy\n\n# loading model saved locally in test_model.h5\nmodel_filepath = 'test_model.h5'\nprev_model = keras.models.load_model(model_filepath)\n\n# these lines are copied from the example for loading MNIST data\n(x_train, y_train), (x_test, y_test) = mnist.load_data()\nx_train = x_train.reshape(60000, 784)\n\n# for this example, I am only taking the first 10 images\nx_slice = x_train[slice(1, 11, 1)]\n\n# making the prediction\nprediction = prev_model.predict(x_slice)\n\n# logging each on a separate line\nfor single_prediction in prediction:\n    print(single_prediction)\nIf I run the first script to export the model, then the second script to classify some examples, I get the following output:\n\n[ 1.  0.  0.  0.  0.  0.  0.  0.  0.  0.]\n[ 0.  0.  0.  0.  1.  0.  0.  0.  0.  0.]\n[ 0.  1.  0.  0.  0.  0.  0.  0.  0.  0.]\n[ 0.  0.  0.  0.  0.  0.  0.  0.  0.  1.]\n[ 0.  0.  1.  0.  0.  0.  0.  0.  0.  0.]\n[ 0.  1.  0.  0.  0.  0.  0.  0.  0.  0.]\n[ 0.  0.  0.  1.  0.  0.  0.  0.  0.  0.]\n[ 0.  1.  0.  0.  0.  0.  0.  0.  0.  0.]\n[ 0.  0.  0.  0.  1.  0.  0.  0.  0.  0.]\n[ 0.  0.  0.  1.  0.  0.  0.  0.  0.  0.]\nThis is great for seeing which class each is predicted to be, but what if I want to see the relative probabilities of each class for each example? I am looking for something more like this:\n\n[ 0.94 0.01 0.02 0. 0. 0.01 0. 0.01 0.01 0.]\n[ 0. 0. 0. 0. 0.51 0. 0. 0. 0.49 0.]\n...\nIn other words, I need to know how sure each prediction is, not just the prediction itself. I thought seeing the relative probabilities was a part of using a softmax activation in the model, but I can't seem to find anything in the Keras documentation that would give me probabilities instead of the predicted answer. Am I making some kind of silly mistake, or is this feature not available?",
    "answer": "12\n\nSo it turns out that the problem was I was not fully normalizing the data in the prediction script.\n\nMy prediction script should have had the following lines:\n\n# these lines are copied from the example for loading MNIST data\n(x_train, y_train), (x_test, y_test) = mnist.load_data()\nx_train = x_train.reshape(60000, 784)\nx_train = x_train.astype('float32') # this line was missing\nx_train /= 255 # this line was missing too\nBecause the data was not cast to float, and divided by 255 (so it would be between 0 and 1), it was just showing up as 1s and 0s.",
    "mlApiName": "keras.models.fit",
    "embedding": [
      0.04333673045039177,
      0.2553447484970093,
      -2.6244215965270996,
      -0.7414609789848328,
      0.6871383190155029,
      -0.24369776248931885,
      0.2733178436756134,
      0.6907723546028137,
      -0.8381198048591614,
      -1.1797782182693481,
      0.05859263241291046,
      0.6226058602333069,
      2.4160494804382324,
      0.6515776515007019,
      -0.6309345364570618,
      -0.5323925018310547,
      0.8677600622177124,
      -0.4291844069957733,
      0.16031238436698914,
      0.48945343494415283,
      0.15486261248588562,
      0.1609390676021576,
      -0.6529535055160522,
      -0.19891953468322754,
      1.3655930757522583,
      0.04555617645382881,
      -1.0134894847869873,
      0.634871780872345,
      0.2719806432723999,
      0.7327618598937988,
      0.6263330578804016,
      -0.5794382691383362,
      -0.32684966921806335,
      -1.1297123432159424,
      -1.3645813465118408,
      -0.5247159004211426,
      0.6603143811225891,
      0.23351038992404938,
      0.21658997237682343,
      -0.17004522681236267,
      0.6630523800849915,
      0.5846182703971863,
      0.5063081383705139,
      -0.10912571847438812,
      0.06351594626903534,
      0.06902500987052917,
      1.171792984008789,
      0.48355019092559814,
      0.5341712236404419,
      -0.3631005883216858,
      0.012100668624043465,
      0.7151141166687012,
      0.3538646996021271,
      0.7281975150108337,
      1.9433149099349976,
      0.8190901875495911,
      -0.27520307898521423,
      0.13831129670143127,
      0.6593906283378601,
      -1.0138853788375854,
      0.6558762192726135,
      0.309887170791626,
      -1.471909523010254,
      0.8385305404663086,
      0.5819706320762634,
      -0.0022971155121922493,
      -0.7899839282035828,
      0.5298725962638855,
      -0.09193912148475647,
      -0.33061960339546204,
      0.6064087748527527,
      0.39101144671440125,
      0.15555889904499054,
      0.2318175584077835,
      -0.6808395981788635,
      0.3295707702636719,
      -0.5121163129806519,
      0.6517980098724365,
      -0.3956091105937958,
      0.7112101316452026,
      0.28054115176200867,
      0.9741576910018921,
      1.0471819639205933,
      -0.2387736588716507,
      0.22466933727264404,
      -0.10282721370458603,
      -0.7807435393333435,
      -0.02256729081273079,
      -0.27032628655433655,
      1.4380122423171997,
      0.14047746360301971,
      -0.20412667095661163,
      1.1350610256195068,
      0.5970417261123657,
      -0.6756459474563599,
      -0.0614473782479763,
      -0.20552091300487518,
      -0.22413748502731323,
      -0.5857731699943542,
      -0.594473123550415,
      0.3991977274417877,
      0.7315676212310791,
      -0.37750259041786194,
      -0.6256325840950012,
      -0.3226551413536072,
      0.9331368803977966,
      -0.26564139127731323,
      -0.047677814960479736,
      0.6915934085845947,
      -0.41901764273643494,
      -0.312003493309021,
      0.3973577320575714,
      -0.6685502529144287,
      -0.13892407715320587,
      -0.3923824429512024,
      -0.49071380496025085,
      0.19356423616409302,
      -0.10011055320501328,
      0.0242853295058012,
      0.051473218947649,
      0.007014460861682892,
      -0.3362351953983307,
      0.4334196150302887,
      0.08437004685401917,
      -0.2461608648300171,
      0.6028617024421692,
      -0.9878228902816772,
      0.16271451115608215,
      0.012805027887225151,
      -0.7794573903083801,
      0.236954465508461,
      0.2720341980457306,
      -0.12580178678035736,
      0.3353342115879059,
      0.6333486437797546,
      1.1315619945526123,
      -0.6997530460357666,
      -0.11723367124795914,
      0.10508004575967789,
      0.7521272897720337,
      0.11632554978132248,
      0.30728036165237427,
      0.009802266024053097,
      -0.4251508414745331,
      -0.08461293578147888,
      -1.0683139562606812,
      0.3016396462917328,
      -0.11037372797727585,
      -0.8913151621818542,
      0.46526601910591125,
      -0.03805619478225708,
      0.7161779403686523,
      -0.9615539908409119,
      0.6260618567466736,
      0.520876944065094,
      -0.5230221152305603,
      0.09286356717348099,
      0.14374014735221863,
      0.4453389048576355,
      0.16528257727622986,
      0.7629038691520691,
      -0.23595966398715973,
      -0.42529624700546265,
      0.1579035520553589,
      -0.37481197714805603,
      -0.8066821098327637,
      0.03911818936467171,
      0.49104374647140503,
      0.042233891785144806,
      0.48308053612709045,
      -0.3379864990711212,
      -0.827614426612854,
      0.2794857323169708,
      -0.5837350487709045,
      0.4880416989326477,
      0.7244146466255188,
      1.3424320220947266,
      -0.7970589399337769,
      0.6943829655647278,
      -0.04769051820039749,
      0.9975813627243042,
      -0.19609421491622925,
      1.5843403339385986,
      -0.5465252995491028,
      -0.2577603757381439,
      -0.5650548338890076,
      0.07867875695228577,
      1.175142526626587,
      -0.18987475335597992,
      -0.6183889508247375,
      0.3155520558357239,
      0.10289446264505386,
      -1.0754749774932861,
      -0.9171821475028992,
      0.2167852818965912,
      -0.412043958902359,
      0.6822283864021301,
      -0.5912848711013794,
      0.24824753403663635,
      0.45433393120765686,
      0.21161024272441864,
      0.5242189764976501,
      -0.8792805075645447,
      0.5003141760826111,
      -0.41322267055511475,
      0.3993382751941681,
      0.22845669090747833,
      0.7924334406852722,
      -0.40552419424057007,
      0.061557918787002563,
      0.24031445384025574,
      0.07735792547464371,
      -0.22299450635910034,
      0.8320379853248596,
      0.26576894521713257,
      -0.04520358145236969,
      0.5792457461357117,
      0.12477020919322968,
      -0.14564856886863708,
      0.10649991780519485,
      0.2741449177265167,
      -0.49626967310905457,
      0.44815149903297424,
      0.374112993478775,
      0.23813068866729736,
      -0.8596548438072205,
      0.08846892416477203,
      0.151102676987648,
      -0.47259625792503357,
      -0.1905348151922226,
      -0.7186661958694458,
      -1.1515265703201294,
      0.5512086749076843,
      0.5013976693153381,
      -0.10008209198713303,
      0.32201555371284485,
      0.6040948033332825,
      0.9190016388893127,
      -0.32708078622817993,
      -0.09383518248796463,
      0.49205589294433594,
      0.19955600798130035,
      -0.39547199010849,
      0.12521249055862427,
      -0.7191365361213684,
      -0.018471280112862587,
      -0.0862603485584259,
      -0.7142022252082825,
      0.5668849945068359,
      1.1529724597930908,
      -0.27314090728759766,
      1.1932373046875,
      0.7594480514526367,
      -0.001876935246400535,
      0.7170508503913879,
      -0.6849592924118042,
      -1.0138944387435913,
      -0.5006921887397766,
      0.2020520269870758,
      -0.23021307587623596,
      0.4899357557296753,
      0.5018067359924316,
      -0.04197530448436737,
      -0.2452513724565506,
      -0.37331798672676086,
      -1.140265703201294,
      0.14075836539268494,
      -0.45197156071662903,
      -0.13783590495586395,
      -0.43002942204475403,
      -0.22196754813194275,
      0.12728099524974823,
      1.0786648988723755,
      0.40570202469825745,
      0.6598203778266907,
      0.558086097240448,
      -0.13059093058109283,
      0.131818488240242,
      0.1787506639957428,
      0.07958424091339111,
      -0.7117631435394287,
      -0.7076989412307739,
      -0.3380683362483978,
      -0.20323967933654785,
      -0.21370044350624084,
      -0.48587357997894287,
      0.535304844379425,
      0.1798926293849945,
      0.9711503982543945,
      0.4920409321784973,
      0.019726116210222244,
      -0.06716754287481308,
      0.7286578416824341,
      0.6637719869613647,
      -0.606445848941803,
      0.11489862203598022,
      1.3029848337173462,
      -0.4335535168647766,
      0.23904523253440857,
      -0.5290517210960388,
      0.6901586055755615,
      1.075184941291809,
      0.5966669917106628,
      0.732475757598877,
      0.11300408095121384,
      -0.17786650359630585,
      -0.3781593143939972,
      -0.3607761859893799,
      0.0508357472717762,
      -0.39791059494018555,
      -0.7431504130363464,
      -0.4975886046886444,
      -0.18054653704166412,
      0.055465225130319595,
      -0.8754012584686279,
      -0.33656030893325806,
      -0.06356794387102127,
      0.7635398507118225,
      0.2252943217754364,
      -0.45146647095680237,
      0.20042577385902405,
      -0.21217305958271027,
      -0.2766740918159485,
      -0.11744775623083115,
      -0.304048627614975,
      0.4876033663749695,
      -0.47751718759536743,
      -0.23037578165531158,
      0.45492660999298096,
      -0.06498397141695023,
      1.1507056951522827,
      1.1026408672332764,
      0.33041542768478394,
      -1.054473876953125,
      -0.6121503710746765,
      -0.3588867485523224,
      -0.31157317757606506,
      0.26185253262519836,
      0.0664888247847557,
      0.8228209018707275,
      -0.19421906769275665,
      -0.21749164164066315,
      0.787679135799408,
      -0.2366052120923996,
      -0.24734777212142944,
      0.2574239671230316,
      -1.1068265438079834,
      -0.5696166753768921,
      1.053027868270874,
      -0.03360539302229881,
      -0.07084395736455917,
      -0.0784211978316307,
      -0.006078394129872322,
      0.017317408695816994,
      0.4938637912273407,
      -0.0785977765917778,
      0.1985054612159729,
      -0.30905207991600037,
      0.07322566956281662,
      -0.04097699001431465,
      0.9499908685684204,
      -0.07525700330734253,
      -0.4762095808982849,
      -0.6663438081741333,
      -0.3817214369773865,
      0.36230653524398804,
      0.9275551438331604,
      0.35651513934135437,
      0.9384907484054565,
      -0.6528638601303101,
      0.08286993205547333,
      -0.4469757676124573,
      -0.7294978499412537,
      0.6675002574920654,
      -0.16942301392555237,
      0.08269040286540985,
      -0.697300374507904,
      -0.33518150448799133,
      -0.8193051815032959,
      0.42029044032096863,
      0.5880746245384216,
      -0.0795074850320816,
      -0.05806376412510872,
      -0.05719844996929169,
      0.7960121035575867,
      0.3660449683666229,
      0.8235180974006653,
      -0.6603377461433411,
      -0.13720303773880005,
      0.7698208689689636,
      0.19990937411785126,
      -0.2252499908208847,
      -0.7383195161819458,
      -0.16104987263679504,
      0.6197792887687683,
      -1.179831624031067,
      1.1205832958221436,
      0.35377708077430725,
      -0.4088744819164276,
      0.5647351145744324,
      -1.6259056329727173,
      -0.41202718019485474,
      0.05447676032781601,
      -0.44012197852134705,
      -0.5179121494293213,
      -0.6515548229217529,
      -0.805590808391571,
      0.3050515055656433,
      -0.06270373612642288,
      -0.11946810036897659,
      0.3424213230609894,
      0.2869170010089874,
      -0.3878158926963806,
      -1.5532448291778564,
      0.35654526948928833,
      0.15934893488883972,
      1.1106855869293213,
      0.5632972121238708,
      -0.9167324900627136,
      -0.7747935056686401,
      -0.09268923103809357,
      0.2878117859363556,
      0.2293233722448349,
      -0.35983991622924805,
      0.8970223665237427,
      0.6032335758209229,
      0.7867025136947632,
      1.5377321243286133,
      0.29350101947784424,
      -1.8481618165969849,
      0.4693663716316223,
      0.1307019740343094,
      0.6662285327911377,
      -0.3867037296295166,
      -0.39493680000305176,
      0.2550227642059326,
      0.22484762966632843,
      0.516054093837738,
      0.028637994080781937,
      0.5884768962860107,
      0.6403316855430603,
      -0.3082599639892578,
      -1.077797770500183,
      -0.4811036288738251,
      0.21712028980255127,
      0.5558710098266602,
      0.7852084040641785,
      -0.3340874910354614,
      -1.2207154035568237,
      0.8407944440841675,
      -0.363484650850296,
      -0.19848082959651947,
      0.051510039716959,
      0.7050290703773499,
      1.3186744451522827,
      -0.6949924230575562,
      0.061424750834703445,
      -0.061231013387441635,
      0.3453146517276764,
      0.7171866297721863,
      -0.1410420536994934,
      -0.03391995653510094,
      -0.7730324864387512,
      0.4862675368785858,
      -0.14138513803482056,
      -0.9077260494232178,
      -0.44592371582984924,
      -0.20698153972625732,
      0.38815560936927795,
      0.9397301077842712,
      -0.4698536992073059,
      0.2705676257610321,
      0.7553006410598755,
      -1.0711735486984253,
      -0.403321772813797,
      0.3452233672142029,
      -0.3478689193725586,
      -0.0664495900273323,
      0.42801719903945923,
      0.6694850325584412,
      0.25920113921165466,
      -1.0781878232955933,
      -0.2338390201330185,
      -0.6013345718383789,
      0.06278980523347855,
      1.5910906791687012,
      0.6898638010025024,
      -0.3622024357318878,
      0.24648872017860413,
      -0.3859458565711975,
      0.47735679149627686,
      -0.49577754735946655,
      -0.06400458514690399,
      -0.03110392577946186,
      -0.4426145851612091,
      -0.17987217009067535,
      0.5450946092605591,
      0.6087042093276978,
      0.1297856867313385,
      0.8041492104530334,
      -0.32243162393569946,
      0.2299923151731491,
      0.35834985971450806,
      -0.05605465918779373,
      0.31142255663871765,
      -0.18544495105743408,
      0.6608944535255432,
      -0.7688905000686646,
      -0.17484943568706512,
      0.018488699570298195,
      -0.22172024846076965,
      0.06293162703514099,
      0.35330691933631897,
      0.35193952918052673,
      1.084101915359497,
      -1.3112950325012207,
      -0.06799735873937607,
      0.9294574856758118,
      -0.76139897108078,
      -0.2798742353916168,
      1.3061001300811768,
      -0.35096752643585205,
      -0.18032924830913544,
      -0.011105154640972614,
      -0.9927554726600647,
      -0.4385010898113251,
      -0.42290931940078735,
      -1.3220294713974,
      0.029802076518535614,
      -0.6317430734634399,
      0.6638196706771851,
      0.24531303346157074,
      -0.8271299004554749,
      0.14088352024555206,
      0.33075714111328125,
      0.1478482037782669,
      0.036554966121912,
      0.9721460342407227,
      0.5532824993133545,
      -0.40350577235221863,
      -0.10525288432836533,
      1.3859808444976807,
      0.15285629034042358,
      -0.6588326692581177,
      -0.68988037109375,
      0.12448244541883469,
      -0.0381157323718071,
      0.48579683899879456,
      0.6159592866897583,
      -1.1695666313171387,
      0.4697149395942688,
      -0.19872233271598816,
      -0.06175122782588005,
      -1.1444056034088135,
      0.33616921305656433,
      -0.0193471722304821,
      -0.1223139539361,
      -0.7621788382530212,
      -0.8709621429443359,
      -0.4508461058139801,
      -1.0652296543121338,
      0.307606041431427,
      1.9098865985870361,
      0.9126013517379761,
      -0.4182174801826477,
      0.0705588236451149,
      -0.6932264566421509,
      0.13485752046108246,
      0.12194302678108215,
      0.5579753518104553,
      0.266196608543396,
      -1.2146848440170288,
      0.7340562343597412,
      0.05169795826077461,
      -0.3470321595668793,
      -0.6537236571311951,
      0.958547830581665,
      0.5256817936897278,
      -0.3885379731655121,
      -0.6348633170127869,
      0.06055092066526413,
      -1.2877843379974365,
      -0.30534398555755615,
      0.4149976670742035,
      0.046192556619644165,
      0.7248735427856445,
      -0.030539119616150856,
      -0.8933117985725403,
      0.268693745136261,
      -0.08079894632101059,
      -0.719058632850647,
      -0.641965925693512,
      0.9909968376159668,
      -0.920829176902771,
      -0.005046089645475149,
      -0.5895981192588806,
      -0.20429708063602448,
      0.19561944901943207,
      -1.0885988473892212,
      -1.3415738344192505,
      0.417113333940506,
      0.16704340279102325,
      1.5943489074707031,
      -0.9542312622070312,
      0.08562659472227097,
      0.5832046866416931,
      -0.6985230445861816,
      0.42885705828666687,
      -0.3161287009716034,
      0.8327224850654602,
      -0.4092189371585846,
      -0.23929499089717865,
      0.13389401137828827,
      0.021257322281599045,
      0.3285033106803894,
      -1.340282678604126,
      1.2689636945724487,
      -0.14997777342796326,
      -0.6449759602546692,
      -0.3410460352897644,
      -0.19573938846588135,
      -0.2373834103345871,
      0.5644589066505432,
      -1.2782471179962158,
      0.45148083567619324,
      -0.2896679937839508,
      -0.3110157251358032,
      -0.1577359437942505,
      0.4996906518936157,
      0.370758056640625,
      -1.1454126834869385,
      0.37457266449928284,
      -1.8748492002487183,
      0.12294366210699081,
      -1.2992961406707764,
      1.0344887971878052,
      -0.7170132994651794,
      0.9839195609092712,
      0.33243894577026367,
      0.9237701296806335,
      0.09110718220472336,
      -0.13404108583927155,
      -0.6351365447044373,
      0.6399424076080322,
      -0.07752800732851028,
      -0.7785528898239136,
      1.3041030168533325,
      0.9150046110153198,
      0.1751662641763687,
      -0.47658613324165344,
      0.5538104176521301,
      0.5636770725250244,
      0.15601208806037903,
      -0.00027645876980386674,
      0.6324596405029297,
      0.3710302412509918,
      -0.27256444096565247,
      -0.6481689810752869,
      -0.7404221296310425,
      -0.43769600987434387,
      -0.06944601237773895,
      -0.7053540349006653,
      -0.5196812748908997,
      -0.5980066657066345,
      0.5632150769233704,
      -0.33866092562675476,
      -1.04169499874115,
      -0.013069292530417442,
      -0.6327828764915466,
      -1.2555781602859497,
      0.39059609174728394,
      0.4248891770839691,
      -0.3361993730068207,
      0.3552311062812805,
      0.787422239780426,
      -0.49180126190185547,
      0.7927083969116211,
      1.0327770709991455,
      -0.21097669005393982,
      -0.5141541957855225,
      0.12538868188858032,
      0.022072236984968185,
      0.6803664565086365,
      0.9510631561279297,
      0.4107856750488281,
      -0.7372175455093384,
      -0.49432215094566345,
      -1.2024985551834106,
      -0.3824807405471802,
      -0.33711034059524536,
      -0.908622145652771,
      -0.4653761088848114,
      0.6353919506072998,
      -0.23910081386566162,
      -0.5218656063079834,
      0.7191542387008667,
      -0.004058054648339748,
      -0.30684220790863037,
      0.4061574637889862,
      0.9822105765342712,
      -0.028688810765743256,
      1.1621625423431396,
      -0.30999118089675903,
      0.557267427444458,
      0.29229870438575745,
      -0.26784250140190125,
      0.34204918146133423,
      0.024208329617977142,
      0.04050629213452339,
      -0.6270627975463867,
      0.0749906599521637,
      0.5496881008148193,
      -0.4531736969947815,
      1.0052717924118042,
      -0.13351285457611084,
      0.3141828775405884,
      -0.5079845190048218,
      -0.701090931892395,
      -0.00965142622590065,
      -0.08755487203598022,
      -0.048439349979162216,
      -0.4972098767757416,
      -0.8540947437286377,
      0.8609127402305603,
      -0.19096051156520844,
      -1.369134783744812,
      -0.2114633470773697,
      0.29204291105270386,
      -0.443125456571579,
      0.10815928876399994,
      -0.8307193517684937,
      -0.3105379641056061,
      -1.1639126539230347,
      0.6405912041664124,
      -0.5507109761238098,
      0.17275890707969666,
      -0.42740723490715027,
      -0.7773892879486084,
      -0.896641731262207,
      -0.16081638634204865,
      -1.596834659576416,
      0.29117244482040405,
      1.0828428268432617,
      0.05808992683887482,
      -0.4432539641857147,
      -0.1320645958185196,
      -0.8561620712280273,
      0.7229328751564026,
      0.08882927894592285,
      -0.6064584255218506,
      0.5131648182868958,
      0.03815826401114464,
      -0.9543611407279968,
      0.41055071353912354,
      -0.9861866235733032,
      0.27110159397125244,
      0.35422512888908386,
      0.6165887117385864,
      0.8584294319152832,
      -0.3566696345806122,
      0.9117380380630493,
      -0.8096017837524414,
      -0.05763708055019379,
      0.03090018965303898,
      -0.8293471336364746,
      -0.6422852277755737,
      -0.1848299652338028,
      -0.32793793082237244
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Train",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): SAM (Single API Method)\nThe issue is related to incorrect usage of the model.fit() function, making it a single API method violation.\n\nLevel 2: BET (Behavioral Expectation Type)\nThe user expects softmax probabilities to be returned, but due to improper data preprocessing, the model behaves unexpectedly.\n\nLevel 3 (Hybrid Patterns): IC-1 (Intra-argument Contract)\nThe issue arises due to an internal argument inconsistency�the input data is not properly normalized, leading to incorrect softmax outputs.\n\nLeaf Contract Category: IC-1 (Intra-argument Contract)\nThe incorrect normalization affects internal consistency within the model, violating expected input constraints.\n\nRoot Cause: Unacceptable Input Value\nThe training data was not normalized (missing x_train = x_train.astype('float32') and x_train /= 255), leading to incorrect outputs.\n\nEffect: Crash\nThe model fails to return probability distributions as expected, instead outputting one-hot vectors.\n\nML Library: Keras\nThe issue specifically relates to Keras' model training process.\n\nContract Violation Location: Train\nThe problem occurs during the training phase when the dataset is improperly preprocessed.\n\nDetection Technique: Static\nThe issue can be detected by verifying the data preprocessing steps before training, ensuring normalization is correctly applied."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/49834380",
    "title": "",
    "question": "I have CNN models trained using Keras with Tensorflow backend. And I want to visualize my CNN filters with this tutorial: https://blog.keras.io/how-convolutional-neural-networks-see-the-world.html\n\nfrom keras import backend as K\nfrom keras.models import load_model\nimport numpy as np\n\nmodel = load_model('my_cnn_model.h5')\ninput_img = np.load('my_picture.npy')\n\n# get the symbolic outputs of each \"key\" layer (we gave them unique names).\nlayer_dict = dict([(layer.name, layer) for layer in model.layers])\n\nlayer_name = 'block5_conv3'\nfilter_index = 0  # can be any integer from 0 to 511, as there are 512 filters in that layer\n\n# build a loss function that maximizes the activation\n# of the nth filter of the layer considered\nlayer_output = layer_dict[layer_name].output\nloss = K.mean(layer_output[:, :, :, filter_index])\n\n# compute the gradient of the input picture wrt this loss\ngrads = K.gradients(loss, input_img)[0]\n\n# normalization trick: we normalize the gradient\ngrads /= (K.sqrt(K.mean(K.square(grads))) + 1e-5)\n\n# this function returns the loss and grads given the input picture\niterate = K.function([input_img], [loss, grads])\nHowever, when the code execute to this line:\ngrads = K.gradients(loss, input_img)[0]\nI found it returns nothing but None object, so the program fail to progress after that.\n\nI search for some solution. Some people say theinput_img should be tensorflow's Tensor type: https://github.com/keras-team/keras/issues/5455\n\nBut when I tried to convert the img to Tensor, the problem is still exist.\nI tried the solution in the link above, but still fail.\n\nThere is also someone say that this problem exists because your CNN model is not differentiable. https://github.com/keras-team/keras/issues/8478\n\nBut my model use only the activate function of ReLU and Sigmoid(at output layer). Is this problem really caused by nondifferentiable problem?\n\nCan anyone help me? Thank you very much!",
    "answer": "12\n\nIf you have a Model instance, then to take the gradient of the loss with respect to the input, you should do:\n\ngrads = K.gradients(loss, model.input)[0]\nmodel.input contains the symbolic tensor that represents the input to the model. Using a plain numpy array makes no sense because TensorFlow then has no idea how this connects to the computational graph, and returns None as the gradient.\n\nThen you should also rewrite the iterate function as:\n\niterate = K.function([model.input], [loss, grads])",
    "mlApiName": "keras.backend.function, keras.backend.gradients",
    "embedding": [
      0.2802380323410034,
      0.9093338251113892,
      -2.3699026107788086,
      -1.3793082237243652,
      1.5761913061141968,
      -0.31464430689811707,
      1.6517497301101685,
      0.34442612528800964,
      -0.6451453566551208,
      -0.30725643038749695,
      -0.5422173142433167,
      1.0557878017425537,
      2.4153623580932617,
      0.8518074154853821,
      -0.7872068285942078,
      -0.19602464139461517,
      0.3066425025463104,
      -0.07871730625629425,
      -0.08638352900743484,
      0.9500522017478943,
      -0.728140652179718,
      0.43928462266921997,
      0.34723249077796936,
      -0.322964072227478,
      1.7910263538360596,
      0.5907413959503174,
      -0.419310063123703,
      0.23764586448669434,
      -0.7891054749488831,
      0.7959131598472595,
      1.0495407581329346,
      -0.5062960982322693,
      -0.6746940016746521,
      -0.8952017426490784,
      -0.6308222413063049,
      0.047636497765779495,
      1.4302244186401367,
      0.1700558066368103,
      0.6954466104507446,
      -0.19523094594478607,
      0.7142972350120544,
      0.24827350676059723,
      -0.15040552616119385,
      0.36024823784828186,
      -0.12803521752357483,
      -0.2710087299346924,
      0.6625532507896423,
      0.19934290647506714,
      0.17694038152694702,
      -0.9320535063743591,
      0.3689282536506653,
      1.1795055866241455,
      -0.16984014213085175,
      -0.0494224913418293,
      0.5920311212539673,
      0.005845311563462019,
      0.20279692113399506,
      0.6322850584983826,
      0.8783469796180725,
      -0.8012695908546448,
      0.44520139694213867,
      2.000398635864258,
      -1.046337366104126,
      0.9974737167358398,
      0.49533388018608093,
      -0.6243356466293335,
      -1.1782206296920776,
      0.5794779062271118,
      -0.7498886585235596,
      0.18972726166248322,
      0.025029122829437256,
      0.20683656632900238,
      -0.16852006316184998,
      1.000138282775879,
      -0.5885657072067261,
      -0.03228141739964485,
      -0.06154651567339897,
      -0.29491159319877625,
      -0.2424701750278473,
      0.23560777306556702,
      0.020566580817103386,
      0.993800938129425,
      1.1355170011520386,
      -0.07688799500465393,
      0.5820594429969788,
      0.019903872162103653,
      -0.7680155038833618,
      -0.5748183131217957,
      -0.7752862572669983,
      1.6055015325546265,
      -0.6409239768981934,
      -0.21594233810901642,
      0.5520962476730347,
      1.16541588306427,
      -0.812199056148529,
      -0.6908398270606995,
      -0.3276367485523224,
      0.39788761734962463,
      -0.7352481484413147,
      -0.485410213470459,
      -0.391996294260025,
      0.23752321302890778,
      0.017985403537750244,
      -0.714059591293335,
      -0.1919901818037033,
      0.9612250924110413,
      0.7121155261993408,
      0.12098069489002228,
      0.2932938039302826,
      -1.032611608505249,
      -0.6449781656265259,
      -0.32553666830062866,
      -0.3319126069545746,
      -0.560213029384613,
      -0.23409749567508698,
      -0.5302499532699585,
      -0.42528200149536133,
      -0.5863650441169739,
      0.280025452375412,
      0.8443820476531982,
      -0.45244836807250977,
      -0.19757089018821716,
      0.49929752945899963,
      -0.27959907054901123,
      0.04079992696642876,
      1.24662184715271,
      -0.48060494661331177,
      -0.2845863401889801,
      0.296270489692688,
      -0.8331308364868164,
      0.27881452441215515,
      -1.042791485786438,
      -0.7825053930282593,
      0.001881687087006867,
      0.4078124761581421,
      1.7375373840332031,
      -0.8239284753799438,
      -1.0764645338058472,
      0.34920695424079895,
      0.6475324034690857,
      0.5665538907051086,
      -0.18251991271972656,
      -0.3654531240463257,
      -0.7446128726005554,
      0.04193531349301338,
      -0.8660824298858643,
      0.5727899074554443,
      -0.7341299653053284,
      -0.27782881259918213,
      -0.682314932346344,
      0.24005316197872162,
      0.7972826361656189,
      -1.1385966539382935,
      0.14609943330287933,
      1.2209692001342773,
      -1.5566052198410034,
      0.4594416320323944,
      0.9742980599403381,
      0.11931321769952774,
      -0.5449935793876648,
      1.4215532541275024,
      0.7954696416854858,
      -0.007355802226811647,
      0.8219864368438721,
      -0.42157629132270813,
      -1.2530988454818726,
      0.43090879917144775,
      0.05505315959453583,
      0.16511401534080505,
      0.2930113971233368,
      -0.9662258625030518,
      -0.20283913612365723,
      0.10376893728971481,
      -0.5952168107032776,
      -0.11030673235654831,
      1.1566851139068604,
      1.1891287565231323,
      -0.13378649950027466,
      0.7463290691375732,
      0.08469291031360626,
      0.45183947682380676,
      0.21040979027748108,
      0.7569423317909241,
      -0.48246848583221436,
      -0.38488122820854187,
      0.25863948464393616,
      -0.30066344141960144,
      0.44644883275032043,
      0.47779372334480286,
      -0.9117095470428467,
      1.0751179456710815,
      -0.1171840950846672,
      -0.5372952818870544,
      -0.7294618487358093,
      -0.4353489577770233,
      0.27254951000213623,
      0.1128179281949997,
      -0.6764655709266663,
      1.4787755012512207,
      0.4588140547275543,
      0.07319698482751846,
      0.7210211753845215,
      -0.9031257629394531,
      0.5654798746109009,
      -1.1650338172912598,
      0.4879192113876343,
      -0.1717088371515274,
      0.6662975549697876,
      -0.3351146876811981,
      0.13031591475009918,
      -0.47619134187698364,
      -0.09629223495721817,
      0.5766346454620361,
      0.2801538109779358,
      0.002005893737077713,
      0.008424527943134308,
      0.7750427722930908,
      -0.30887120962142944,
      -0.6711767911911011,
      0.27154409885406494,
      0.6438369154930115,
      -0.13696743547916412,
      0.3498438596725464,
      0.26807698607444763,
      0.3249298334121704,
      -0.663927435874939,
      -0.4468591511249542,
      -0.6259773373603821,
      -0.21514205634593964,
      0.10797525197267532,
      -0.9661828875541687,
      -0.7931243777275085,
      0.7508171200752258,
      0.6386501789093018,
      -0.016903523355722427,
      0.8982917666435242,
      0.6979238986968994,
      0.654569685459137,
      0.01972278207540512,
      0.793216347694397,
      -0.09250522404909134,
      0.6710925102233887,
      0.23410753905773163,
      0.5071344375610352,
      -0.9037304520606995,
      0.08767717331647873,
      -0.5070404410362244,
      -0.5512936115264893,
      0.1500365287065506,
      0.7500126361846924,
      0.426413357257843,
      0.571210503578186,
      0.9774879813194275,
      0.17261596024036407,
      0.937440812587738,
      -0.41258737444877625,
      -0.4011106491088867,
      -0.8366689682006836,
      1.2991690635681152,
      -0.4342634379863739,
      0.44421690702438354,
      0.6874442100524902,
      -0.17033910751342773,
      0.048696354031562805,
      -0.7451537847518921,
      -0.5787985324859619,
      -0.2751918435096741,
      -0.11458809673786163,
      0.21554142236709595,
      -0.2369915395975113,
      0.15394896268844604,
      0.8289396166801453,
      0.8407543301582336,
      0.5567484498023987,
      0.3377390205860138,
      0.7961851358413696,
      0.20417389273643494,
      -0.6347410082817078,
      -0.3417804539203644,
      -0.09084794670343399,
      -0.22238263487815857,
      -0.7193582057952881,
      -0.510066032409668,
      -0.2651602029800415,
      -0.1336822509765625,
      0.029956351965665817,
      0.1407720446586609,
      0.8244411945343018,
      0.1379985809326172,
      0.7858754992485046,
      -0.8241271376609802,
      0.22164541482925415,
      0.09665177017450333,
      -0.03600030019879341,
      -0.281907320022583,
      0.4083537757396698,
      1.1814767122268677,
      -0.8023631572723389,
      0.05698647350072861,
      -0.2645939588546753,
      0.5537629723548889,
      0.526249349117279,
      0.9571548104286194,
      0.631950318813324,
      -0.06764837354421616,
      -0.699634313583374,
      0.49309441447257996,
      -0.04476846009492874,
      0.17195194959640503,
      -0.014634066261351109,
      -0.5040701031684875,
      -0.5646952986717224,
      -0.11300644278526306,
      0.7373467087745667,
      0.2669124901294708,
      0.06858256459236145,
      0.3065686523914337,
      0.44460976123809814,
      0.37665167450904846,
      0.0161870326846838,
      0.2409299910068512,
      -0.3689285218715668,
      -0.1948080062866211,
      0.24450473487377167,
      -0.462443083524704,
      0.5332511067390442,
      -0.22646279633045197,
      -0.08709117025136948,
      0.834820032119751,
      -0.45752426981925964,
      0.2848131060600281,
      0.5685873031616211,
      0.20298956334590912,
      -0.7928487658500671,
      -0.21164275705814362,
      -0.07993046194314957,
      -0.4299391508102417,
      0.052104055881500244,
      -0.06964939087629318,
      0.688200831413269,
      0.1596672534942627,
      0.32900649309158325,
      -0.26546984910964966,
      -0.8798719048500061,
      -0.40220460295677185,
      0.07483244687318802,
      -0.7603268027305603,
      -1.0465266704559326,
      0.40140828490257263,
      0.27913811802864075,
      -0.07343742251396179,
      0.08962193876504898,
      0.4702851176261902,
      -0.7270633578300476,
      -0.0475882850587368,
      0.144966259598732,
      1.0747339725494385,
      0.3154332935810089,
      0.3984184265136719,
      0.39648789167404175,
      0.968878984451294,
      -0.2629442811012268,
      -0.28632450103759766,
      -0.06401492655277252,
      -0.13702492415905,
      -0.27619636058807373,
      0.9755738973617554,
      0.061949536204338074,
      -0.04848122224211693,
      -0.07003337144851685,
      0.1867169290781021,
      -0.2563127279281616,
      -0.2931370437145233,
      0.5626376867294312,
      -0.9478918313980103,
      -0.0009822148131206632,
      -0.998970627784729,
      0.7343906164169312,
      -0.06274035573005676,
      -0.1363246738910675,
      0.28360339999198914,
      -0.7828218936920166,
      0.4593668282032013,
      0.05591366067528725,
      0.8649713397026062,
      1.017784833908081,
      0.20611843466758728,
      -1.5461280345916748,
      0.21134567260742188,
      1.0536291599273682,
      0.20280256867408752,
      0.23894771933555603,
      -1.0229419469833374,
      -0.47510144114494324,
      0.3520751893520355,
      -0.9287738800048828,
      1.241041660308838,
      0.529149055480957,
      -0.11693423241376877,
      0.5186021327972412,
      -1.255773663520813,
      -0.3143051266670227,
      -0.09161964058876038,
      -0.18210411071777344,
      -0.3703518211841583,
      -0.2851068079471588,
      0.11297649890184402,
      -0.3740856945514679,
      -0.01105455867946148,
      0.11472534388303757,
      0.13351215422153473,
      0.054249588400125504,
      0.47863027453422546,
      -1.5104796886444092,
      1.113389492034912,
      0.3306143581867218,
      0.37759971618652344,
      0.8677293658256531,
      -0.5293616652488708,
      -1.1134425401687622,
      0.30199363827705383,
      0.6353142261505127,
      -0.49881982803344727,
      0.15534524619579315,
      0.5984231233596802,
      0.7616903781890869,
      0.6448993682861328,
      1.3394017219543457,
      0.1363116353750229,
      -1.589626431465149,
      0.27010539174079895,
      0.20750881731510162,
      0.5557224750518799,
      -0.46582934260368347,
      -0.242539644241333,
      0.25175943970680237,
      -0.2884279489517212,
      0.9092856049537659,
      -0.5498371124267578,
      1.0187556743621826,
      0.9503589868545532,
      0.08764126896858215,
      -1.239382028579712,
      -0.834441602230072,
      0.5505381226539612,
      0.4093064069747925,
      1.3959956169128418,
      -0.1620549112558365,
      -1.6230312585830688,
      1.079667568206787,
      -0.5509498119354248,
      0.49323770403862,
      -0.10015962272882462,
      0.40578433871269226,
      1.2734602689743042,
      -0.28499606251716614,
      -0.4802575409412384,
      -0.40999945998191833,
      -0.534745454788208,
      0.230855792760849,
      0.008697069250047207,
      0.31559887528419495,
      -0.9108787775039673,
      -0.25068357586860657,
      -0.3269939720630646,
      -1.1684876680374146,
      -0.20945967733860016,
      -0.042284175753593445,
      1.1530632972717285,
      0.706620454788208,
      -0.8775253891944885,
      0.008508182130753994,
      0.5034844875335693,
      -0.3016848862171173,
      -0.4756241738796234,
      0.20011959969997406,
      -0.01765226200222969,
      -0.06821412593126297,
      0.8658664226531982,
      0.794258177280426,
      0.1851106584072113,
      -1.702479600906372,
      -0.4495689272880554,
      -0.799468457698822,
      -0.5605219006538391,
      1.2300515174865723,
      -0.2995212972164154,
      -0.10452833771705627,
      0.06653131544589996,
      -0.07176888734102249,
      0.280667781829834,
      -0.09397737681865692,
      -0.03945641219615936,
      -0.06952602416276932,
      -0.08192892372608185,
      -0.2547057867050171,
      0.13385024666786194,
      1.1232539415359497,
      0.7772365808486938,
      0.5495808124542236,
      -0.30541688203811646,
      0.09686937928199768,
      -0.7762961983680725,
      0.39675989747047424,
      0.678290605545044,
      0.1109052449464798,
      0.608218252658844,
      -1.5473629236221313,
      -0.22653494775295258,
      0.3484768569469452,
      -0.2518697679042816,
      -0.32989415526390076,
      0.26615211367607117,
      0.1774762123823166,
      -0.28360334038734436,
      -1.4195877313613892,
      0.04799603298306465,
      0.14604149758815765,
      -1.3488508462905884,
      -0.02421552687883377,
      0.3784312903881073,
      -0.4307485520839691,
      -0.25594139099121094,
      -0.18786810338497162,
      -0.4698888957500458,
      0.35153064131736755,
      0.42754992842674255,
      -1.291371464729309,
      0.3155856430530548,
      -0.3711169362068176,
      -0.2229071706533432,
      0.10090077668428421,
      -1.3829115629196167,
      0.060131967067718506,
      0.5204328894615173,
      -0.563065767288208,
      0.10837874561548233,
      1.1359953880310059,
      0.043782833963632584,
      -0.26307398080825806,
      0.5601453185081482,
      1.5893691778182983,
      0.5366761088371277,
      -0.13315218687057495,
      -0.35603976249694824,
      0.29466649889945984,
      -0.24508266150951385,
      0.7934809327125549,
      0.45161885023117065,
      -1.943055272102356,
      0.04122983291745186,
      -1.1688467264175415,
      0.3343667685985565,
      -0.6903810501098633,
      -0.19108282029628754,
      -0.7760717272758484,
      -1.178687334060669,
      -1.1720778942108154,
      -1.0105218887329102,
      -0.5146966576576233,
      -0.37159815430641174,
      0.13598598539829254,
      1.838694453239441,
      -0.29011034965515137,
      -0.14927376806735992,
      -1.0741902589797974,
      -0.14484700560569763,
      0.7699655890464783,
      0.9253425002098083,
      0.0846467912197113,
      -0.4222683012485504,
      -1.4888713359832764,
      0.14092114567756653,
      0.38921231031417847,
      -0.1489647775888443,
      0.5196672677993774,
      0.6405491232872009,
      -0.21460002660751343,
      -0.9749982357025146,
      -0.527011513710022,
      0.5407425761222839,
      -1.3701046705245972,
      0.20603784918785095,
      0.13529382646083832,
      -0.16489440202713013,
      0.6798385381698608,
      0.06874973326921463,
      -0.47646066546440125,
      0.15792781114578247,
      0.39678269624710083,
      -1.1412349939346313,
      -0.44095438718795776,
      0.8885809183120728,
      -0.2666139602661133,
      0.4034700095653534,
      -0.5971649885177612,
      -0.484862357378006,
      0.6101691722869873,
      -0.546528697013855,
      -1.5240222215652466,
      -0.6310575008392334,
      0.5360201001167297,
      0.913618803024292,
      -1.74039888381958,
      0.32349303364753723,
      1.664615273475647,
      -0.6196466088294983,
      0.4414440989494324,
      -0.11325699836015701,
      0.4076790511608124,
      -0.007602515630424023,
      0.06735427677631378,
      0.13230568170547485,
      0.054739031940698624,
      0.25594934821128845,
      -0.8676996231079102,
      1.0232967138290405,
      -0.279687762260437,
      -0.6043407917022705,
      -0.6439492702484131,
      -0.8252193927764893,
      -0.5478948950767517,
      1.3519330024719238,
      -0.9140121936798096,
      0.7133415341377258,
      -0.10591282695531845,
      -0.7356990575790405,
      -0.06992742419242859,
      -0.1385039985179901,
      0.7234802842140198,
      -0.7770614624023438,
      0.10749030858278275,
      -1.0537267923355103,
      0.24457597732543945,
      -1.1816319227218628,
      0.9428962469100952,
      0.2879098951816559,
      0.8760092258453369,
      0.7570878863334656,
      0.28646472096443176,
      -0.09371138364076614,
      0.018845686689019203,
      -0.6255005598068237,
      0.2797212302684784,
      0.23094111680984497,
      -0.5345284342765808,
      0.38725292682647705,
      1.3898348808288574,
      -0.7904374599456787,
      -0.22268982231616974,
      1.2542656660079956,
      1.3506193161010742,
      0.37315624952316284,
      -0.5129342079162598,
      0.20617684721946716,
      -0.1820509284734726,
      -0.02446695975959301,
      -0.6311625242233276,
      -0.5784335732460022,
      -0.25408899784088135,
      0.019446222111582756,
      -0.6471755504608154,
      -1.1416981220245361,
      -0.2520568072795868,
      0.3625543713569641,
      0.0664200484752655,
      -0.8032317757606506,
      0.3232860863208771,
      -0.07116752862930298,
      -0.6340392231941223,
      0.25924479961395264,
      -0.09715051203966141,
      0.17552079260349274,
      1.005278468132019,
      0.08033759146928787,
      -0.0971394032239914,
      0.7430453896522522,
      1.0667632818222046,
      -0.05628237500786781,
      0.18040603399276733,
      1.1406654119491577,
      0.29427802562713623,
      0.8820747137069702,
      -0.07703403383493423,
      -0.2424965351819992,
      -1.4705853462219238,
      -0.17715808749198914,
      -1.5084214210510254,
      -0.07354056090116501,
      -0.3939417004585266,
      -0.7087161540985107,
      0.25755059719085693,
      0.0654304027557373,
      -0.7724072933197021,
      -0.41571617126464844,
      0.2291034609079361,
      -0.2427307665348053,
      -0.9857307076454163,
      0.5672225952148438,
      0.8284016251564026,
      0.3466731011867523,
      0.020479202270507812,
      -0.47697028517723083,
      0.1588558554649353,
      0.1835341453552246,
      -0.3411818742752075,
      0.41204264760017395,
      -0.4332478642463684,
      -0.23729300498962402,
      -0.34378620982170105,
      -0.24316181242465973,
      0.36622464656829834,
      -1.1484839916229248,
      1.6007882356643677,
      0.1478675752878189,
      0.7475766539573669,
      -0.09326823055744171,
      -1.006043791770935,
      -0.7455978393554688,
      -0.4967538118362427,
      0.25435855984687805,
      -0.05147656053304672,
      -1.3586078882217407,
      -0.11364329606294632,
      -0.40784981846809387,
      -0.3280683755874634,
      0.1133168637752533,
      -0.4487817883491516,
      -0.6911472678184509,
      -0.15434354543685913,
      -0.8774808645248413,
      0.3292963206768036,
      -1.233405351638794,
      1.1497571468353271,
      -0.05170217901468277,
      0.05757734924554825,
      -0.9238705039024353,
      -0.9000059366226196,
      -0.43317335844039917,
      -0.3722935914993286,
      -0.8243894577026367,
      0.5723150968551636,
      -0.2511494755744934,
      0.14661088585853577,
      -0.2151208370923996,
      -0.3038812577724457,
      -0.5495747923851013,
      0.8735551238059998,
      0.18711701035499573,
      -0.817583441734314,
      0.39416611194610596,
      -0.07973988354206085,
      0.13612031936645508,
      -0.02403082698583603,
      -0.23015041649341583,
      -0.006066931877285242,
      -0.4818107485771179,
      0.8274263739585876,
      1.3548047542572021,
      0.5614963173866272,
      0.22303076088428497,
      -0.963270902633667,
      0.041989196091890335,
      0.6665694713592529,
      -0.4562530517578125,
      -0.4679988920688629,
      -0.2965356409549713,
      -0.5066477656364441
    ],
    "label": {
      "level1": "AMO",
      "level2": "F",
      "level3": "F",
      "leafContractCategory": "F",
      "rootCause": "Missing Required State-specific Method Order",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Evaluation",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): AMO (API Method Order)\nThe issue occurs due to an incorrect sequence of method calls�using K.gradients with an invalid input type.\n\nLevel 2: F (Eventually Required Condition)\nThe computation graph requires that input_img be a TensorFlow tensor, but the user provides a NumPy array, breaking the required condition.\n\nLevel 3 (Hybrid Patterns): F (Eventually Required Condition), F (Eventually Required Condition)\nThe issue arises because K.gradients expects an input that is part of the computational graph, which wasn�t ensured.\n\nLeaf Contract Category: F (Eventually Required Condition)\nThe function relies on the input being properly set up in the computation graph, which wasn�t done.\n\nRoot Cause: Missing Required State-specific Method Order\nThe user did not pass a valid tensor to K.gradients, leading to an incorrect execution order.\n\nEffect: Crash\nThe function returns None, causing the program to fail when it tries to use the gradient.\n\nML Library: Keras\nThe issue is specific to Keras backend operations for computing gradients.\n\nContract Violation Location: Model Evaluation\nThe error occurs when attempting to compute gradients for CNN filter visualization.\n\nDetection Technique: Static\nThe issue can be detected through static analysis by checking whether all function arguments are valid TensorFlow tensors before calling K.gradients()."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/34716454",
    "title": "",
    "question": "213\n\nIf I want to use the BatchNormalization function in Keras, then do I need to call it once only at the beginning?\n\nI read this documentation for it: http://keras.io/layers/normalization/\n\nI don't see where I'm supposed to call it. Below is my code attempting to use it:\n\nmodel = Sequential()\nkeras.layers.normalization.BatchNormalization(epsilon=1e-06, mode=0, momentum=0.9, weights=None)\nmodel.add(Dense(64, input_dim=14, init='uniform'))\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(64, init='uniform'))\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(2, init='uniform'))\nmodel.add(Activation('softmax'))\n\nsgd = SGD(lr=0.1, decay=1e-6, momentum=0.9, nesterov=True)\nmodel.compile(loss='binary_crossentropy', optimizer=sgd)\nmodel.fit(X_train, y_train, nb_epoch=20, batch_size=16, show_accuracy=True, validation_split=0.2, verbose = 2)\nI ask because if I run the code with the second line including the batch normalization and if I run the code without the second line I get similar outputs. So either I'm not calling the function in the right place, or I guess it doesn't make that much of a difference.",
    "answer": "270\n\nAs Pavel said, Batch Normalization is just another layer, so you can use it as such to create your desired network architecture.\n\nThe general use case is to use BN between the linear and non-linear layers in your network, because it normalizes the input to your activation function, so that you're centered in the linear section of the activation function (such as Sigmoid). There's a small discussion of it here\n\nIn your case above, this might look like:\n\n# import BatchNormalization\nfrom keras.layers.normalization import BatchNormalization\n\n# instantiate model\nmodel = Sequential()\n\n# we can think of this chunk as the input layer\nmodel.add(Dense(64, input_dim=14, init='uniform'))\nmodel.add(BatchNormalization())\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.5))\n\n# we can think of this chunk as the hidden layer    \nmodel.add(Dense(64, init='uniform'))\nmodel.add(BatchNormalization())\nmodel.add(Activation('tanh'))\nmodel.add(Dropout(0.5))\n\n# we can think of this chunk as the output layer\nmodel.add(Dense(2, init='uniform'))\nmodel.add(BatchNormalization())\nmodel.add(Activation('softmax'))\n\n# setting up the optimization of our weights \nsgd = SGD(lr=0.1, decay=1e-6, momentum=0.9, nesterov=True)\nmodel.compile(loss='binary_crossentropy', optimizer=sgd)\n\n# running the fitting\nmodel.fit(X_train, y_train, nb_epoch=20, batch_size=1",
    "mlApiName": "keras.layers.Activation, keras.layers.BatchNormalization, keras.layers.Dense",
    "embedding": [
      0.34663647413253784,
      0.2868402898311615,
      -2.5969161987304688,
      -1.1955547332763672,
      1.2293308973312378,
      -0.4115574359893799,
      0.5301669239997864,
      0.26095813512802124,
      -0.9195118546485901,
      -1.5521341562271118,
      -0.9127912521362305,
      0.706669807434082,
      1.780336856842041,
      0.9888657331466675,
      0.05885624885559082,
      -1.4554717540740967,
      0.4412197470664978,
      0.20227386057376862,
      0.5062751173973083,
      0.6557356119155884,
      -0.2530590295791626,
      0.37141185998916626,
      0.14869125187397003,
      -0.758196234703064,
      2.2410941123962402,
      -0.07864828407764435,
      -0.5055260062217712,
      0.6964126229286194,
      -0.6106268763542175,
      0.0658382847905159,
      1.0703802108764648,
      -0.5969478487968445,
      0.2504919171333313,
      -0.9483304023742676,
      -1.5423412322998047,
      -0.5991878509521484,
      0.32557258009910583,
      -0.26268088817596436,
      -0.7088637351989746,
      -0.1607353836297989,
      0.9188835620880127,
      0.21554240584373474,
      0.5966442823410034,
      -0.17938482761383057,
      -0.19037935137748718,
      -0.25704479217529297,
      0.812025249004364,
      0.30284231901168823,
      1.1292394399642944,
      -1.5141072273254395,
      0.18393531441688538,
      0.9207490086555481,
      -0.6817387342453003,
      0.30637845396995544,
      1.5781558752059937,
      0.7154125571250916,
      0.21120920777320862,
      1.0846599340438843,
      0.8030111789703369,
      -0.23217804729938507,
      0.10311907529830933,
      1.2766222953796387,
      -0.8645831346511841,
      1.1275519132614136,
      0.3262021839618683,
      -0.09258457273244858,
      -0.5941025018692017,
      0.6233740448951721,
      -0.717024028301239,
      -0.22309502959251404,
      0.4622464179992676,
      -0.06778305023908615,
      -0.007541190832853317,
      -0.24588194489479065,
      -0.5761266946792603,
      0.3928699791431427,
      -0.07734904438257217,
      -0.4365198314189911,
      0.009266502223908901,
      1.0957638025283813,
      -0.6822286248207092,
      0.9589916467666626,
      1.5087740421295166,
      -0.6164706945419312,
      0.1752401441335678,
      0.9180614352226257,
      -0.3682592511177063,
      -0.4591546356678009,
      -0.6903842091560364,
      1.5125068426132202,
      -0.2720949351787567,
      -0.7755550742149353,
      0.07226398587226868,
      0.8977701663970947,
      -0.9013402462005615,
      -0.774381160736084,
      0.1297307163476944,
      0.3550591766834259,
      -0.2632397413253784,
      -0.18323884904384613,
      -0.3568280041217804,
      0.9066869020462036,
      0.16641512513160706,
      -0.8760225176811218,
      -0.5442391633987427,
      1.754785418510437,
      0.3981965184211731,
      0.14038871228694916,
      0.2618226408958435,
      -0.6148491501808167,
      -0.6163724064826965,
      -0.21605521440505981,
      -0.07388802617788315,
      -0.24847491085529327,
      0.9173327684402466,
      -0.12310843169689178,
      0.6390626430511475,
      -0.35516437888145447,
      0.519497811794281,
      0.5347728729248047,
      -0.25032439827919006,
      -0.6430013179779053,
      0.46304357051849365,
      -0.34749168157577515,
      0.4160597324371338,
      0.7537298798561096,
      -0.4333823323249817,
      0.1950354427099228,
      0.11042412370443344,
      -1.2806990146636963,
      -0.02766016684472561,
      -0.3602299988269806,
      -0.12046535313129425,
      0.05485071986913681,
      0.6152657866477966,
      0.8702149987220764,
      -0.9845771193504333,
      -1.2596057653427124,
      0.20689591765403748,
      -0.4022734463214874,
      -0.21219642460346222,
      -0.057171471416950226,
      -0.24313029646873474,
      -0.9450525045394897,
      0.3889501094818115,
      -0.35807210206985474,
      1.106760859489441,
      -0.6302250623703003,
      -0.4249510169029236,
      0.10032380372285843,
      -0.1708865612745285,
      0.6219187378883362,
      -0.980318546295166,
      0.1409396529197693,
      0.8410959243774414,
      -0.8369224667549133,
      0.8265479207038879,
      0.4839872419834137,
      0.6261280179023743,
      -0.14152632653713226,
      0.963926374912262,
      0.25933608412742615,
      -0.17147813737392426,
      0.32213613390922546,
      -0.8329729437828064,
      -0.7604948878288269,
      0.33063092827796936,
      -0.12023282051086426,
      -0.29744482040405273,
      0.3937530219554901,
      -0.2759324908256531,
      -0.5491108894348145,
      0.20175640285015106,
      -0.14166781306266785,
      -0.5369940996170044,
      1.1691840887069702,
      1.1318187713623047,
      -0.2669675648212433,
      0.5504260063171387,
      -0.22389349341392517,
      0.14380019903182983,
      -0.41085225343704224,
      0.670829713344574,
      -0.3219662010669708,
      -0.9585501551628113,
      -0.03557083010673523,
      0.05884205549955368,
      -0.0389825664460659,
      -0.5977088212966919,
      -0.8646295070648193,
      0.46409091353416443,
      0.128758043050766,
      -0.5886005163192749,
      -0.3730419874191284,
      -0.32809680700302124,
      -0.22663410007953644,
      0.3738517463207245,
      -0.983153760433197,
      0.7766226530075073,
      -0.27619266510009766,
      -0.26071813702583313,
      0.1259162276983261,
      -0.7228333353996277,
      0.10590524971485138,
      -0.9119147062301636,
      1.1709046363830566,
      -0.5286015868186951,
      0.32511526346206665,
      -0.5452262759208679,
      0.4460325539112091,
      0.6404754519462585,
      0.17001518607139587,
      -0.3678092360496521,
      -0.003997592721134424,
      0.04046076536178589,
      -0.6264570355415344,
      0.5945349335670471,
      -0.23249927163124084,
      -0.4355612099170685,
      -0.22377093136310577,
      0.1396002471446991,
      -0.6759439706802368,
      1.1886531114578247,
      -0.13604682683944702,
      0.665162980556488,
      -0.9397377967834473,
      0.276559442281723,
      0.33791401982307434,
      -0.4575756788253784,
      -0.1814402937889099,
      -0.9101603627204895,
      -1.4771329164505005,
      0.10777321457862854,
      -0.3144983947277069,
      -0.8128571510314941,
      0.7724244594573975,
      0.9064616560935974,
      1.0596803426742554,
      -0.2708127200603485,
      0.3605523109436035,
      -0.2688567042350769,
      0.9819837808609009,
      0.5933104157447815,
      0.8725137114524841,
      -1.1303858757019043,
      -0.0017478090012446046,
      0.16718362271785736,
      -0.4582099914550781,
      -0.7329745888710022,
      0.9309808611869812,
      0.1262550801038742,
      0.016023552045226097,
      0.32043105363845825,
      0.6431584358215332,
      1.255393385887146,
      -0.8781046271324158,
      -0.0892850011587143,
      -0.24263158440589905,
      0.6064497232437134,
      -0.4392669200897217,
      0.508380651473999,
      -0.1458040028810501,
      -0.21423903107643127,
      -0.4871006906032562,
      -0.512569010257721,
      -0.9357974529266357,
      -0.5443152785301208,
      0.2568187117576599,
      0.3949078321456909,
      -0.1588880568742752,
      0.28555160760879517,
      0.363898366689682,
      0.5171829462051392,
      1.146343469619751,
      0.8585655093193054,
      0.04300665855407715,
      -0.029048027470707893,
      0.0025151213631033897,
      0.1633099913597107,
      0.21100035309791565,
      -0.7794723510742188,
      -1.0145421028137207,
      -0.45453503727912903,
      0.04167530685663223,
      -0.1690942794084549,
      -0.015360243618488312,
      0.3856293261051178,
      0.8050635457038879,
      0.06560003757476807,
      0.5500908493995667,
      0.03527054563164711,
      -0.6477905511856079,
      0.17633716762065887,
      0.6737048029899597,
      0.39942044019699097,
      0.3790735900402069,
      0.9036725163459778,
      -0.4679899215698242,
      -0.14877666532993317,
      -0.6277180910110474,
      0.7134214639663696,
      0.436077356338501,
      0.585803747177124,
      0.7001438140869141,
      0.05578071251511574,
      0.08558014780282974,
      0.2918359041213989,
      -0.0757535845041275,
      -0.1410529613494873,
      -0.026598429307341576,
      0.09407412260770798,
      0.30526307225227356,
      -0.14136968553066254,
      0.6516897082328796,
      -0.10772833973169327,
      0.1747613251209259,
      0.06073776260018349,
      0.3743477165699005,
      0.38128265738487244,
      0.5622608661651611,
      -0.6766833066940308,
      -0.7040315866470337,
      0.10898201912641525,
      0.09996837377548218,
      -0.7836597561836243,
      1.00150465965271,
      -0.23795554041862488,
      0.7014358043670654,
      0.6317033767700195,
      -0.18728849291801453,
      0.5624988079071045,
      0.3895290195941925,
      0.09990032017230988,
      -1.442794680595398,
      -0.7425453662872314,
      -0.38360676169395447,
      -0.1791173815727234,
      -0.0730598121881485,
      -0.1485527753829956,
      1.0681121349334717,
      0.09119970351457596,
      0.2939724326133728,
      0.9988362789154053,
      -0.5067015886306763,
      0.17436595261096954,
      -0.13589340448379517,
      -1.3201966285705566,
      -0.388107031583786,
      0.0462610125541687,
      0.3692043125629425,
      -0.10819905251264572,
      -0.08916983008384705,
      -0.11023537069559097,
      -0.1444750875234604,
      -0.2222735732793808,
      0.23863428831100464,
      0.49734601378440857,
      0.11704113334417343,
      0.16315044462680817,
      0.23939596116542816,
      1.125902771949768,
      -0.11688046157360077,
      -0.20937809348106384,
      0.9379510879516602,
      0.1742561012506485,
      0.39586251974105835,
      0.6104611754417419,
      0.5015014410018921,
      0.14589764177799225,
      0.08452674746513367,
      -0.2119036763906479,
      0.31658440828323364,
      0.2351241111755371,
      0.2338530719280243,
      -0.7341039776802063,
      -0.16714796423912048,
      -0.9175372123718262,
      0.5317378044128418,
      -0.0036812310572713614,
      0.8233296871185303,
      -0.32438915967941284,
      -1.182171106338501,
      0.12009306252002716,
      0.20541802048683167,
      1.0146230459213257,
      0.8540917038917542,
      0.06831838935613632,
      -0.3073503077030182,
      0.3762757480144501,
      1.3048617839813232,
      0.04652724787592888,
      -0.554025411605835,
      -0.12809500098228455,
      -1.2287265062332153,
      0.6045948266983032,
      -0.21530590951442719,
      1.4682127237319946,
      0.4398954212665558,
      -0.12283872067928314,
      0.7464475035667419,
      -1.937319278717041,
      -0.7281116247177124,
      -0.1951095163822174,
      -0.35996586084365845,
      -0.4132598042488098,
      -0.5345492362976074,
      0.580101728439331,
      -0.14724227786064148,
      0.3154276907444,
      -0.41013404726982117,
      0.26408514380455017,
      0.23040875792503357,
      -0.22477900981903076,
      -1.2759857177734375,
      0.830589234828949,
      -0.11094842851161957,
      0.7378976941108704,
      0.4322819411754608,
      -1.0560365915298462,
      -0.7470470070838928,
      0.3331286907196045,
      0.3676236569881439,
      -0.3492085933685303,
      -0.460738867521286,
      0.7747034430503845,
      0.9325467348098755,
      1.1990065574645996,
      1.349280595779419,
      0.6557033658027649,
      -1.8071794509887695,
      -0.035937365144491196,
      0.8553653955459595,
      0.9427812099456787,
      -0.010956628248095512,
      -0.8295371532440186,
      -0.43790462613105774,
      -0.48839491605758667,
      1.086488127708435,
      -0.7356663346290588,
      0.7669497132301331,
      1.1183316707611084,
      -0.45715874433517456,
      -1.2800673246383667,
      -0.46110066771507263,
      0.386030912399292,
      0.4999854564666748,
      1.2645344734191895,
      -1.282167673110962,
      -1.6673924922943115,
      1.3175047636032104,
      -0.4142462909221649,
      0.367534875869751,
      0.39025551080703735,
      0.18109264969825745,
      1.7994939088821411,
      -0.7013653516769409,
      -0.20913997292518616,
      -0.17917397618293762,
      -0.31926262378692627,
      0.05480551719665527,
      -0.26786381006240845,
      -0.050667524337768555,
      -1.4608224630355835,
      -0.20223291218280792,
      -0.027129797264933586,
      -0.8323051929473877,
      -0.2808142602443695,
      -0.3503628373146057,
      0.5996574759483337,
      1.3442777395248413,
      -0.017561398446559906,
      -0.5704108476638794,
      0.5004172325134277,
      -0.5261342525482178,
      0.6396566033363342,
      0.05267620459198952,
      0.1334700584411621,
      0.3762985169887543,
      -0.005870755761861801,
      0.42068952322006226,
      0.27653563022613525,
      -1.9216173887252808,
      -0.4337189793586731,
      -0.31265586614608765,
      -0.8955299854278564,
      1.4541094303131104,
      -0.018854213878512383,
      -0.623499870300293,
      0.5351808071136475,
      0.3816973865032196,
      0.6782217025756836,
      -0.3242039382457733,
      0.11472330242395401,
      0.5441240668296814,
      -0.1359352469444275,
      -0.6202507615089417,
      0.01916569098830223,
      1.0807578563690186,
      -0.030412139371037483,
      0.7307640314102173,
      0.4242938160896301,
      0.3590857684612274,
      -0.7068548798561096,
      0.6420493125915527,
      0.5387660264968872,
      -0.08173549920320511,
      1.30166757106781,
      -0.48515310883522034,
      -0.6824691295623779,
      -0.9985663890838623,
      0.42242419719696045,
      -0.22973987460136414,
      -0.08505323529243469,
      -0.18598859012126923,
      0.4166504740715027,
      -1.53874671459198,
      0.425760954618454,
      -0.4731498062610626,
      -1.5423686504364014,
      -0.5015088319778442,
      0.16770882904529572,
      -0.24821722507476807,
      -0.40912121534347534,
      -0.7894755005836487,
      -0.8489132523536682,
      -0.17978303134441376,
      0.13581766188144684,
      -1.5157417058944702,
      0.3362152874469757,
      -0.33496108651161194,
      -0.04027396813035011,
      0.1795995533466339,
      -1.3134548664093018,
      0.30638015270233154,
      0.6931709051132202,
      -0.19172856211662292,
      -0.3722445070743561,
      1.1905395984649658,
      0.15124870836734772,
      0.013264193199574947,
      -0.11314371228218079,
      1.13832426071167,
      0.19941334426403046,
      0.22189275920391083,
      -0.5282791256904602,
      0.2057419866323471,
      0.12732605636119843,
      0.8116743564605713,
      0.3525489270687103,
      -0.926963746547699,
      -0.5712082386016846,
      -0.8305656909942627,
      0.5070466995239258,
      -0.6920772194862366,
      -0.3088046908378601,
      -0.44863277673721313,
      -0.510835587978363,
      -0.7722590565681458,
      -0.45280465483665466,
      -0.48754775524139404,
      -1.0646709203720093,
      -0.10866975039243698,
      1.9863160848617554,
      0.28474289178848267,
      0.7311086058616638,
      -0.7287871241569519,
      -0.2803684175014496,
      1.1563267707824707,
      0.019047459587454796,
      0.6519739627838135,
      -0.435101717710495,
      -1.0619598627090454,
      -0.29263296723365784,
      0.2657369077205658,
      -0.2719572186470032,
      0.83411705493927,
      0.5638308525085449,
      0.5687089562416077,
      -0.7762603163719177,
      -0.4096427261829376,
      0.24386882781982422,
      -1.218782901763916,
      -0.3078453540802002,
      0.10680389404296875,
      0.07406312227249146,
      0.7158380746841431,
      0.0358581580221653,
      -1.0152117013931274,
      0.367076575756073,
      0.023640180006623268,
      -1.270984172821045,
      -0.24440060555934906,
      1.0423747301101685,
      -0.06650228053331375,
      0.49168524146080017,
      0.2966271936893463,
      -0.9269207715988159,
      0.00216410169377923,
      -0.15772493183612823,
      -1.3663791418075562,
      0.6037958860397339,
      0.6760765314102173,
      1.2954694032669067,
      -1.8764994144439697,
      0.058838989585638046,
      1.655985713005066,
      -0.2559286653995514,
      0.3864757716655731,
      -0.5876203775405884,
      0.5431703329086304,
      0.5057311654090881,
      -0.07965955883264542,
      -0.4034675359725952,
      -0.11864008754491806,
      0.07622052729129791,
      -0.8442846536636353,
      0.18973222374916077,
      0.17941541969776154,
      0.5191262364387512,
      -0.21971730887889862,
      -0.3402501344680786,
      -0.7664340734481812,
      1.0724716186523438,
      -0.8190324902534485,
      1.1424883604049683,
      -0.03708122670650482,
      -0.7306402921676636,
      -0.1564880609512329,
      -0.29329344630241394,
      0.08527392148971558,
      -1.2768725156784058,
      -0.13524195551872253,
      -2.4315567016601562,
      0.04119442403316498,
      -1.1891950368881226,
      0.9609746932983398,
      0.011287975125014782,
      0.45916271209716797,
      0.13687460124492645,
      1.1311757564544678,
      0.06571286916732788,
      0.3826422095298767,
      -0.30678045749664307,
      1.2070850133895874,
      0.9166736006736755,
      -1.6482369899749756,
      0.5316627025604248,
      0.5841407775878906,
      0.04842635244131088,
      0.20437446236610413,
      0.5059977173805237,
      1.5265891551971436,
      -0.4058131277561188,
      0.40210601687431335,
      1.2332457304000854,
      -0.6188704371452332,
      0.3557491898536682,
      -0.1543886661529541,
      -1.5447278022766113,
      -0.42699989676475525,
      0.2856582701206207,
      -0.6009941697120667,
      -1.1029599905014038,
      -0.29004916548728943,
      0.6944897770881653,
      0.26154765486717224,
      0.21938635408878326,
      0.6013836860656738,
      -0.21585725247859955,
      -0.892293393611908,
      -0.10950551927089691,
      0.028894243761897087,
      0.13372176885604858,
      0.73270183801651,
      0.45252305269241333,
      0.0005063150310888886,
      1.096902847290039,
      1.0083720684051514,
      -0.5196282863616943,
      -0.25213614106178284,
      1.2839092016220093,
      -0.2914317846298218,
      1.2300208806991577,
      -0.5552542209625244,
      0.2833029329776764,
      -0.9892590641975403,
      0.3574444353580475,
      -1.3225535154342651,
      -0.6418071985244751,
      -0.7322000861167908,
      0.17413167655467987,
      -0.13232500851154327,
      0.47555336356163025,
      -0.2770843803882599,
      -0.5057743787765503,
      0.8162935376167297,
      0.08437006920576096,
      -0.8550499677658081,
      -0.14145764708518982,
      1.2076267004013062,
      0.4073682129383087,
      -0.1121588870882988,
      -0.02068072184920311,
      0.619512677192688,
      1.0182604789733887,
      -0.10476174205541611,
      0.3272801637649536,
      0.135206401348114,
      -1.1776342391967773,
      -1.0226950645446777,
      -0.8708892464637756,
      0.5410211682319641,
      -0.05115727335214615,
      1.8174692392349243,
      -0.5247374176979065,
      0.7362733483314514,
      0.22354157269001007,
      -0.5553700923919678,
      -0.03322063386440277,
      -0.03407100960612297,
      0.2975130081176758,
      -0.045373231172561646,
      -0.8600000739097595,
      0.71467524766922,
      -0.528014063835144,
      0.13574661314487457,
      -0.4452384114265442,
      -0.008282720111310482,
      -0.2021644562482834,
      0.03153728321194649,
      -1.3145134449005127,
      0.006137854885309935,
      -1.5301103591918945,
      1.2442008256912231,
      -0.5771773457527161,
      -0.36054736375808716,
      -0.1278233677148819,
      -0.7132222056388855,
      -0.7845660448074341,
      -0.008984376676380634,
      -1.3763914108276367,
      0.4247513711452484,
      0.5574753284454346,
      0.5386925935745239,
      -0.9344170093536377,
      -0.11572352796792984,
      -0.3057883381843567,
      0.9558960795402527,
      0.1508321613073349,
      -0.24974395334720612,
      0.2534942924976349,
      0.12575015425682068,
      -0.5546309351921082,
      0.2649005651473999,
      -0.05770764499902725,
      -0.23782630264759064,
      -0.6788111925125122,
      1.090399146080017,
      0.9033443331718445,
      0.2395644336938858,
      -0.2454380989074707,
      -0.6248010993003845,
      0.10044366121292114,
      -0.018312035128474236,
      -0.06424175202846527,
      -1.1996831893920898,
      -0.03754022344946861,
      -0.7927515506744385
    ],
    "label": {
      "level1": "AMO",
      "level2": "F",
      "level3": "F",
      "leafContractCategory": "F",
      "rootCause": "Missing Required State-specific Method Order",
      "effect": "BP",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model construction",
      "detectionTechnique": "Runtime Checking",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): AMO (API Method Order)\nThe issue arises due to incorrect ordering of API calls�BatchNormalization is not properly placed within the model's architecture.\n\nLevel 2: F (Eventually Required Condition)\nBatchNormalization should be positioned correctly between layers (before activation) for optimal functionality.\n\nLevel 3 (Hybrid Patterns): F (Eventually Required Condition), F (Eventually Required Condition)\nThe normalization step is not properly applied in the layer sequence, preventing it from functioning as expected.\n\nLeaf Contract Category: F (Eventually Required Condition)\nThe user�s incorrect ordering of layers violates the eventual requirement for proper feature scaling.\n\nRoot Cause: Missing Required State-specific Method Order\nThe user added BatchNormalization incorrectly, expecting it to work without integrating it properly into the computational graph.\n\nEffect: BP (Bad Prediction)\nThe model trains, but predictions remain unaffected, meaning BatchNormalization isn't applied where needed.\n\nML Library: Keras\nThe issue relates specifically to Keras model construction and layer ordering.\n\nContract Violation Location: Model Construction\nThe problem occurs at model setup, where layers are incorrectly arranged.\n\nDetection Technique: Runtime Checking\nThe issue becomes evident at runtime when the model does not behave as expected despite the presence of BatchNormalization."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/48846332",
    "title": "",
    "question": "10\n\nI train a model A and try to use the output of the intermediate layer with the name=\"layer_x\" as an additional input for model B.\n\nI tried to use the output of the intermediate layer like on the Keras doc https://keras.io/getting-started/faq/#how-can-i-obtain-the-output-of-an-intermediate-layer.\n\nModel A:\n\ninputs = Input(shape=(100,))\ndnn = Dense(1024, activation='relu')(inputs)\ndnn = Dense(128, activation='relu', name=\"layer_x\")(dnn)\ndnn = Dense(1024, activation='relu')(dnn)\noutput = Dense(10, activation='softmax')(dnn)\nModel B:\n\ninput_1 = Input(shape=(200,))\ninput_2 = Input(shape=(100,)) # input for model A\n\n# loading model A\nmodel_a = keras.models.load_model(path_to_saved_model_a)\n\nintermediate_layer_model = Model(inputs=model_a.input, \n                                 outputs=model_a.get_layer(\"layer_x\").output)\n\nintermediate_output = intermediate_layer_model.predict(data)\n\nmerge_layer = concatenate([input_1, intermediate_output])\ndnn_layer = Dense(512, activation=\"relu\")(merge_layer)\noutput = Dense(5, activation=\"sigmoid\")(dnn_layer)\nmodel = keras.models.Model(inputs=[input_1, input_2], outputs=output)\nWhen I debug I get an error on this line:\n\nintermediate_layer_model = Model(inputs=model_a.input, \n                                 outputs=model_a.get_layer(\"layer_x\").output)\n\nFile \"..\", line 89, in set_model\n  outputs=self.neural_net_asc.model.get_layer(\"layer_x\").output)\nFile \"C:\\WinPython\\python-3.5.3.amd64\\lib\\site-packages\\keras\\legacy\\interfaces.py\", line 87, in wrapper\n  return func(*args, **kwargs)\nFile \"C:\\WinPython\\python-3.5.3.amd64\\lib\\site-packages\\keras\\engine\\topology.py\", line 1592, in __init__\n  mask = node.output_masks[tensor_index]\nAttributeError: 'Node' object has no attribute 'output_masks'\nI can access the tensor with get_layer(\"layer_x\").output and the output_mask is None. Do I have to set manually an output mask and how do I set up this output mask if needed?\n\npython",
    "answer": "There are two things that you seem to be doing wrong :\n\nintermediate_output = intermediate_layer_model.predict(data)\nwhen you do .predict(), you are actually passing data through the graph and asking what will be the result. When you do that, intermediate_output will be a numpy array and not a layer as you would like it to be.\n\nSecondly, you don't need to recreate a new intermediate model. You can directly use the part of model_a that interest you.\n\nHere is a code that \"compiles\" for me :\n\nfrom keras.layers import Input, Dense, concatenate\nfrom keras.models import Model\n\ninputs = Input(shape=(100,))\ndnn = Dense(1024, activation='relu')(inputs)\ndnn = Dense(128, activation='relu', name=\"layer_x\")(dnn)\ndnn = Dense(1024, activation='relu')(dnn)\noutput = Dense(10, activation='softmax')(dnn)\n\nmodel_a = Model(inputs=inputs, outputs=output)\n\n# You don't need to recreate an input for the model_a, \n# it already has one and you can reuse it\ninput_b = Input(shape=(200,))\n\n# Here you get the layer that interests you from model_a, \n# it is still linked to its input layer, you just need to remember it for later\nintermediate_from_a = model_a.get_layer(\"layer_x\").output\n\n# Since intermediate_from_a is a layer, you can concatenate it with the other input\nmerge_layer = concatenate([input_b, intermediate_from_a])\ndnn_layer = Dense(512, activation=\"relu\")(merge_layer)\noutput_b = Dense(5, activation=\"sigmoid\")(dnn_layer)\n# Here you remember that one input is input_b and the other one is from model_a\nmodel_b = Model(inputs=[input_b, model_a.input], outputs=output_b)\nI hope this is what you wanted to do.\n\nPlease tell me if something isn't clear :-)",
    "mlApiName": "keras.models.Model, keras.models.model.predict",
    "embedding": [
      -0.4966092109680176,
      0.4793910086154938,
      -2.4216814041137695,
      -1.175295114517212,
      1.0181105136871338,
      -0.5988538265228271,
      0.12195655703544617,
      0.4437204599380493,
      -0.205746129155159,
      -0.47255200147628784,
      -1.0400179624557495,
      0.7978058457374573,
      2.159543752670288,
      -0.05514572188258171,
      0.3191744089126587,
      -0.3527751564979553,
      0.934087872505188,
      -0.13232453167438507,
      0.7537052631378174,
      0.522570788860321,
      -0.22822637856006622,
      -0.7982613444328308,
      0.38578000664711,
      -0.5301415920257568,
      1.5889180898666382,
      0.2219216525554657,
      -0.526523232460022,
      0.2082618623971939,
      -0.31239625811576843,
      0.09777862578630447,
      0.6616866588592529,
      -1.1254427433013916,
      0.36307233572006226,
      -0.6622783541679382,
      -1.8769111633300781,
      -1.0542548894882202,
      0.7292400598526001,
      -0.16840893030166626,
      -0.4302513599395752,
      0.23316694796085358,
      1.333348274230957,
      -0.18308010697364807,
      -0.22828686237335205,
      0.48933613300323486,
      -0.496060311794281,
      -0.05211348086595535,
      0.8612571358680725,
      0.2430024892091751,
      0.10646501183509827,
      -0.6742061376571655,
      0.6782184839248657,
      0.9473119378089905,
      0.35740014910697937,
      0.06530221551656723,
      1.5064396858215332,
      0.4299655854701996,
      0.4262939691543579,
      -0.17119354009628296,
      1.437235951423645,
      -0.7730186581611633,
      0.4187462627887726,
      1.3593393564224243,
      -0.9320728778839111,
      1.17535400390625,
      0.712024450302124,
      -0.07953686267137527,
      -0.8659186959266663,
      1.0095542669296265,
      -0.6381961107254028,
      -0.39541444182395935,
      0.18279698491096497,
      0.39607736468315125,
      0.22433727979660034,
      0.08064569532871246,
      -0.1992851048707962,
      0.16527912020683289,
      -0.5412402153015137,
      -0.36973074078559875,
      -0.02468653954565525,
      0.9643398523330688,
      0.498477041721344,
      0.9846151471138,
      1.258682131767273,
      -0.536988377571106,
      -0.09935766458511353,
      0.6996992826461792,
      -1.2345958948135376,
      -0.3754311501979828,
      -0.9108482003211975,
      1.043006181716919,
      -0.36532264947891235,
      0.29999396204948425,
      0.18867871165275574,
      1.1191288232803345,
      -0.765472412109375,
      -0.8791975378990173,
      -0.1787051409482956,
      0.529901921749115,
      -0.44593825936317444,
      -0.009479852393269539,
      -0.25195083022117615,
      0.5944722294807434,
      -0.11303640156984329,
      -1.3339892625808716,
      0.14661215245723724,
      1.2083911895751953,
      -0.062105413526296616,
      -0.7940174341201782,
      0.26860591769218445,
      -0.14827649295330048,
      -1.1356263160705566,
      0.2826828360557556,
      -0.26209181547164917,
      -0.15201705694198608,
      -0.1568131297826767,
      -0.5727185606956482,
      0.3699728846549988,
      0.29475608468055725,
      0.2681979835033417,
      0.3528919816017151,
      0.011408538557589054,
      -0.17550784349441528,
      0.655587375164032,
      -0.4594062268733978,
      0.23728443682193756,
      0.9022045135498047,
      -0.9999457001686096,
      0.055887579917907715,
      0.10905056446790695,
      -0.8574100136756897,
      0.3420619070529938,
      -0.15199005603790283,
      -0.15798717737197876,
      0.9468492269515991,
      1.1777470111846924,
      1.4175946712493896,
      -0.8241807222366333,
      -1.349382758140564,
      0.45519962906837463,
      0.3533431589603424,
      0.5656389594078064,
      0.26037248969078064,
      -0.3639763295650482,
      -1.0829697847366333,
      0.2667848467826843,
      -0.40363478660583496,
      0.6881794333457947,
      -0.29900744557380676,
      -0.7713431715965271,
      0.3852783739566803,
      0.17118299007415771,
      0.7786331176757812,
      -0.8924029469490051,
      0.7510547041893005,
      0.4641626179218292,
      -0.7993264198303223,
      0.4461528956890106,
      -0.2546122968196869,
      0.25917941331863403,
      0.23554247617721558,
      1.240958571434021,
      -0.22902394831180573,
      -0.32140547037124634,
      0.6320796608924866,
      -0.8215140700340271,
      -1.0305242538452148,
      0.09798593074083328,
      0.009262392297387123,
      -0.19512495398521423,
      0.16305790841579437,
      -0.33051592111587524,
      -0.27637583017349243,
      -0.23785251379013062,
      0.2990691065788269,
      0.293287456035614,
      0.41448095440864563,
      1.3262776136398315,
      -0.4200112223625183,
      0.43004584312438965,
      -0.2197050154209137,
      1.5411218404769897,
      -0.39219340682029724,
      1.0369863510131836,
      -0.12181942909955978,
      -0.7555271983146667,
      0.210287407040596,
      -0.1478218287229538,
      0.19496093690395355,
      -0.008496305905282497,
      -0.37905070185661316,
      0.5049286484718323,
      0.2779315412044525,
      -0.7642374634742737,
      -0.5138611793518066,
      -0.1427200585603714,
      0.5671099424362183,
      0.6447021961212158,
      -1.0350937843322754,
      1.0860401391983032,
      0.15429063141345978,
      0.13042376935482025,
      0.45154494047164917,
      -0.4936842918395996,
      0.5450080633163452,
      -1.1325232982635498,
      0.9304105043411255,
      -0.4546443223953247,
      0.2900751531124115,
      -0.23006950318813324,
      0.23286695778369904,
      0.862694501876831,
      -0.14118655025959015,
      0.6542381644248962,
      0.3287714719772339,
      0.00623676273971796,
      -0.5523346662521362,
      0.6155616641044617,
      -0.3615841865539551,
      -0.11256623268127441,
      -0.32133597135543823,
      -0.04074595868587494,
      -0.46139246225357056,
      0.8438949584960938,
      0.7238460183143616,
      0.3894362449645996,
      -0.5131590366363525,
      -0.2839202284812927,
      0.2769624888896942,
      -1.1089880466461182,
      0.053462084382772446,
      -0.3381417691707611,
      -1.4079805612564087,
      0.10393387079238892,
      0.33001789450645447,
      0.003004842670634389,
      0.10226424038410187,
      1.2177375555038452,
      0.8829976320266724,
      -0.3703198730945587,
      0.33913540840148926,
      -0.31963157653808594,
      0.06656850129365921,
      0.05817751958966255,
      -0.04114473611116409,
      -1.583028793334961,
      0.5828685760498047,
      -0.07788770645856857,
      -0.4947623312473297,
      0.03549746051430702,
      0.8186786770820618,
      0.1810172200202942,
      0.8032560348510742,
      0.4780605137348175,
      0.007813213393092155,
      1.1879627704620361,
      -0.8515684604644775,
      -0.4878384470939636,
      0.17582140862941742,
      0.25412869453430176,
      -0.22665764391422272,
      0.24311955273151398,
      0.1533806174993515,
      0.09464948624372482,
      -0.3630269467830658,
      -0.8258888125419617,
      -0.7361636161804199,
      0.014019772410392761,
      0.023114411160349846,
      0.34392020106315613,
      -0.510689914226532,
      -0.6652823090553284,
      0.23238243162631989,
      0.810886025428772,
      0.6139939427375793,
      0.2572169303894043,
      0.8081878423690796,
      0.18521028757095337,
      -0.029573140665888786,
      0.2178676426410675,
      -0.5757237672805786,
      -0.8579519987106323,
      -0.7626368999481201,
      -0.17254777252674103,
      -0.2714473009109497,
      -0.3761235475540161,
      -0.10768739879131317,
      -0.027579711750149727,
      0.6697484850883484,
      0.6048232913017273,
      0.4983862042427063,
      -0.033244747668504715,
      -0.1896829903125763,
      -0.20722509920597076,
      -0.053079795092344284,
      0.0345173142850399,
      0.2436286360025406,
      1.1791375875473022,
      0.02922656387090683,
      -0.12573087215423584,
      -0.8088082671165466,
      0.5278415083885193,
      0.10648636519908905,
      0.5502951145172119,
      0.003057188121601939,
      -0.15915173292160034,
      -0.6287751197814941,
      0.055866263806819916,
      0.5228888392448425,
      0.32960954308509827,
      -0.5489728450775146,
      -0.10118211060762405,
      0.05419342219829559,
      -0.24051398038864136,
      0.5920696258544922,
      -0.12685421109199524,
      0.6526578068733215,
      0.5424643754959106,
      0.02385341189801693,
      0.31707048416137695,
      0.15488097071647644,
      -0.1324654519557953,
      -0.039957787841558456,
      0.44539129734039307,
      0.25037258863449097,
      -0.5443698167800903,
      0.7184320092201233,
      -0.1314101666212082,
      0.30518195033073425,
      -0.5946136713027954,
      -0.8161309361457825,
      1.1350021362304688,
      0.18315769731998444,
      0.0526660718023777,
      -1.1311061382293701,
      -0.6777924299240112,
      -0.5546587109565735,
      -0.049397628754377365,
      0.23763011395931244,
      0.28423741459846497,
      0.8322106599807739,
      0.6913920640945435,
      -0.19115851819515228,
      0.5633518695831299,
      0.025888705626130104,
      -0.4281729757785797,
      0.16523782908916473,
      -1.2065503597259521,
      -0.8404547572135925,
      0.03877706825733185,
      0.5209041237831116,
      -0.663017749786377,
      0.39411765336990356,
      0.3288096785545349,
      -0.2687220573425293,
      0.06396296620368958,
      -0.3947089612483978,
      0.834414005279541,
      0.2392483800649643,
      0.30807894468307495,
      0.8477007746696472,
      0.9560363292694092,
      0.051883384585380554,
      0.13169530034065247,
      -0.2224220633506775,
      0.11372379213571548,
      0.46920883655548096,
      1.0622926950454712,
      -0.11025302857160568,
      0.5697985291481018,
      0.05797289311885834,
      -0.05986335873603821,
      -0.11481638997793198,
      -0.5855836272239685,
      0.07025511562824249,
      -0.9198451638221741,
      -0.2779012620449066,
      -0.8139059543609619,
      0.3386952579021454,
      -0.5818542242050171,
      0.3974200487136841,
      0.12144597619771957,
      -0.19494865834712982,
      -0.598171591758728,
      0.6465035676956177,
      0.6233630180358887,
      0.7337701320648193,
      0.4492643177509308,
      -0.6202372312545776,
      0.19806630909442902,
      1.1360111236572266,
      0.33016806840896606,
      -0.2356943041086197,
      -0.5965771079063416,
      -0.3828025460243225,
      0.13337942957878113,
      -0.6415441632270813,
      0.9586734771728516,
      0.25040918588638306,
      -0.3642793297767639,
      0.3234943747520447,
      -0.7860363721847534,
      -0.8549458980560303,
      0.15245014429092407,
      -0.027362903580069542,
      -0.5592913031578064,
      -0.034178636968135834,
      0.23982785642147064,
      -0.5006459951400757,
      0.8712279796600342,
      0.504834771156311,
      0.2472236305475235,
      -0.1104864701628685,
      0.020611777901649475,
      -1.4524775743484497,
      0.14492352306842804,
      0.15096589922904968,
      0.6658710241317749,
      1.0004850625991821,
      -1.0089068412780762,
      -0.18267615139484406,
      0.040755871683359146,
      0.8194426894187927,
      -0.06709520518779755,
      -0.3058604896068573,
      1.266537070274353,
      0.29868534207344055,
      0.48325416445732117,
      1.1879266500473022,
      -0.09293840080499649,
      -1.9580857753753662,
      0.27842870354652405,
      0.12842869758605957,
      0.43617135286331177,
      -0.5590428113937378,
      -1.1229411363601685,
      0.08855503797531128,
      -0.3012087047100067,
      0.7502074837684631,
      0.009614570997655392,
      0.8939922451972961,
      1.4924540519714355,
      -0.13272717595100403,
      -0.6852862238883972,
      -0.8385009765625,
      0.623356819152832,
      0.8612773418426514,
      0.7555214762687683,
      -0.8337560296058655,
      -1.2840536832809448,
      0.9189758896827698,
      -0.4995977580547333,
      -0.4865814447402954,
      0.28548458218574524,
      0.11322087049484253,
      1.535369634628296,
      0.06183796003460884,
      0.3416528105735779,
      0.4082850217819214,
      -0.09103657305240631,
      -0.006711633875966072,
      0.25412917137145996,
      0.633298933506012,
      -0.902096688747406,
      -0.179786816239357,
      -0.30576610565185547,
      -1.0712745189666748,
      -0.4999069571495056,
      0.11530574411153793,
      0.46607518196105957,
      1.031272053718567,
      -0.7811118960380554,
      0.05980043113231659,
      0.8967465162277222,
      0.013683991506695747,
      0.24134165048599243,
      -0.5587272047996521,
      -0.11312271654605865,
      0.06968903541564941,
      0.1810600906610489,
      0.8170313835144043,
      -0.40877145528793335,
      -0.9653732180595398,
      -0.6644765138626099,
      -0.29749736189842224,
      -0.016800789162516594,
      1.2710943222045898,
      0.09112567454576492,
      0.2635086178779602,
      0.3802931308746338,
      -0.09764783084392548,
      0.30370599031448364,
      -0.04724647104740143,
      -0.5217894315719604,
      0.1051994040608406,
      -0.34098055958747864,
      -0.42656803131103516,
      0.1868661791086197,
      0.6724668741226196,
      0.3507089614868164,
      0.879672110080719,
      0.08912555873394012,
      0.5859465599060059,
      -0.26471078395843506,
      0.018455110490322113,
      0.8600034713745117,
      -0.5542631149291992,
      0.6953834295272827,
      -0.44713154435157776,
      -0.15838085114955902,
      0.20020881295204163,
      0.014549877494573593,
      -0.0464753694832325,
      -0.1792774200439453,
      0.33747997879981995,
      0.04586470127105713,
      -0.889931321144104,
      0.3666953444480896,
      0.7011849284172058,
      -1.0817195177078247,
      -0.30980008840560913,
      0.6864612102508545,
      -0.638952910900116,
      -0.46758541464805603,
      -0.5098809599876404,
      -1.1250956058502197,
      0.008420591242611408,
      0.04041978344321251,
      -1.6307611465454102,
      -0.046092551201581955,
      -0.4600411355495453,
      -0.07593610882759094,
      -0.44639909267425537,
      -1.176033616065979,
      0.1975451409816742,
      0.22305850684642792,
      0.003016919130459428,
      0.11881576478481293,
      0.7678982615470886,
      0.22079278528690338,
      -0.12392018735408783,
      0.2945237159729004,
      1.366474986076355,
      0.04584376886487007,
      -0.5376078486442566,
      0.02170856110751629,
      0.04347817599773407,
      0.12184872478246689,
      1.0634052753448486,
      0.7668911814689636,
      -1.097723364830017,
      0.14576463401317596,
      -1.2269192934036255,
      0.7787205576896667,
      -0.7278726100921631,
      -0.24720825254917145,
      -0.8331695795059204,
      -0.23123224079608917,
      -0.8674405217170715,
      -0.5204002261161804,
      -0.1510528326034546,
      -1.3136484622955322,
      0.15160664916038513,
      1.7657161951065063,
      0.731156051158905,
      -0.5750869512557983,
      -0.3603385090827942,
      -1.0910882949829102,
      0.36091533303260803,
      0.5076565146446228,
      0.4265957474708557,
      0.0818990021944046,
      -1.1892149448394775,
      -0.3333357274532318,
      0.5895633697509766,
      -0.5763067007064819,
      0.04667264595627785,
      0.9852676391601562,
      0.03317159786820412,
      -0.3160247802734375,
      0.11090902239084244,
      -0.11574040353298187,
      -1.4630022048950195,
      0.37658607959747314,
      0.7125445604324341,
      0.0448613166809082,
      0.6334853768348694,
      -0.33055970072746277,
      -0.267599880695343,
      0.2633933126926422,
      0.32574623823165894,
      -0.9498752951622009,
      -0.7685436606407166,
      0.9726768732070923,
      -0.6954542994499207,
      0.2756333649158478,
      0.024001536890864372,
      -0.38528987765312195,
      0.4114522933959961,
      -0.437813401222229,
      -1.141814947128296,
      -0.30583456158638,
      0.5854499340057373,
      1.5415798425674438,
      -1.6448822021484375,
      0.20373857021331787,
      1.2423664331436157,
      -0.7741885781288147,
      0.0030525648035109043,
      -0.30439525842666626,
      0.47705480456352234,
      0.13095493614673615,
      -0.2875818610191345,
      -0.18204335868358612,
      -0.3196936547756195,
      0.5327520966529846,
      -0.7274211049079895,
      0.7538415789604187,
      -0.055992722511291504,
      -0.5230292081832886,
      -0.42792487144470215,
      -0.08886300772428513,
      -0.967295229434967,
      1.1459436416625977,
      -1.6798120737075806,
      0.3589404821395874,
      -1.207958459854126,
      -0.22183600068092346,
      -0.2422119379043579,
      0.27194058895111084,
      1.135301113128662,
      -1.7302305698394775,
      0.024358568713068962,
      -2.0224781036376953,
      -0.2902590036392212,
      -0.9208001494407654,
      0.9503848552703857,
      -0.24291929602622986,
      0.43781208992004395,
      0.8342123627662659,
      1.1252580881118774,
      0.11739998310804367,
      -0.07915607839822769,
      -1.2750126123428345,
      1.1932053565979004,
      0.002007545903325081,
      -1.3023185729980469,
      0.90530925989151,
      1.2071911096572876,
      -0.20492322742938995,
      0.09342823922634125,
      0.7563263177871704,
      0.47019895911216736,
      -0.16367825865745544,
      -0.46780386567115784,
      0.660460352897644,
      0.0951661616563797,
      0.1934778243303299,
      -0.006527959834784269,
      -0.8412574529647827,
      0.09339720755815506,
      0.5955697298049927,
      -0.5161634683609009,
      -0.6782559752464294,
      -0.2487170249223709,
      -0.15209946036338806,
      -0.5791192650794983,
      -0.4711281657218933,
      0.13631108403205872,
      -0.21888695657253265,
      -0.7423906326293945,
      0.18971146643161774,
      0.16384555399417877,
      -0.07989822328090668,
      0.2860177755355835,
      -0.009430007077753544,
      0.2333037108182907,
      0.5566353797912598,
      0.566628098487854,
      -0.1659652292728424,
      -0.44303566217422485,
      0.350853830575943,
      0.19578081369400024,
      0.6720016598701477,
      -0.42429065704345703,
      0.28079506754875183,
      -1.1383899450302124,
      0.20375730097293854,
      -1.1061396598815918,
      -0.4263659715652466,
      0.012568936683237553,
      -0.10504955798387527,
      0.295491099357605,
      0.6113955974578857,
      -0.09613276273012161,
      -0.6189694404602051,
      0.49496111273765564,
      -0.3942073881626129,
      -1.079119086265564,
      0.7032970190048218,
      0.8136795163154602,
      0.47873151302337646,
      0.15991255640983582,
      -0.5414959192276001,
      0.27451005578041077,
      -0.4646107256412506,
      -0.20954342186450958,
      0.28225013613700867,
      0.6099340319633484,
      -0.12957505881786346,
      -0.3171509802341461,
      -0.07689603418111801,
      -0.005671755876392126,
      -0.6266652345657349,
      1.4211546182632446,
      -0.7945104241371155,
      1.089718222618103,
      0.2125551700592041,
      -0.23779919743537903,
      -0.6831468343734741,
      0.12488739937543869,
      -0.3504841923713684,
      -0.3209270238876343,
      -0.9615904092788696,
      0.8309516310691833,
      -0.9346337914466858,
      -0.24767576158046722,
      0.405611127614975,
      -0.5166705846786499,
      -0.3650652766227722,
      0.32179951667785645,
      -0.43385207653045654,
      0.5347133278846741,
      -1.307708978652954,
      0.7969444990158081,
      -0.7059311866760254,
      -0.4871804714202881,
      -0.994158148765564,
      -0.8862445950508118,
      -1.0132395029067993,
      -0.4048524498939514,
      -1.0505017042160034,
      -0.1502866894006729,
      0.5912928581237793,
      -0.2891782820224762,
      -0.2894428074359894,
      -0.4403548836708069,
      -0.17513449490070343,
      1.1645572185516357,
      -0.16254809498786926,
      -0.24820081889629364,
      0.5264496207237244,
      -0.036628883332014084,
      -0.5096572041511536,
      -0.08035129308700562,
      0.03760797157883644,
      -0.41673094034194946,
      -0.8127091526985168,
      1.2307627201080322,
      1.0794939994812012,
      0.30043625831604004,
      -0.17577186226844788,
      -0.8504472374916077,
      0.21480612456798553,
      0.5303621888160706,
      -0.5874956250190735,
      -0.4662330448627472,
      0.2796817719936371,
      -0.8244874477386475
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "F",
      "level3": "F",
      "leafContractCategory": "AMO(Level-2)",
      "rootCause": "Missing Options",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Prediction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): Hybrid\nThe issue involves multiple Keras models (Model A and Model B) and the incorrect handling of intermediate layer outputs, leading to a hybrid contract violation.\n\nLevel 2: F (Eventually Required Condition)\nThe intermediate layer output must remain part of the computation graph, but calling predict() prematurely converts it into a NumPy array, breaking this requirement.\n\nLevel 3 (Hybrid Patterns): F (Eventually Required Condition), IC-2 (Inter-argument Contract)\nThe issue arises from an improper method call sequence that disrupts the computational graph and an inter-argument contract violation due to mismatched data formats.\n\nLeaf Contract Category: AMO (Level-2)\nThe violation stems from incorrect method ordering�using predict() instead of correctly extracting the layer output.\n\nRoot Cause: Missing Options\nThe user failed to maintain the intermediate layer as a valid tensor in the computational graph, leading to incorrect execution.\n\nEffect: Crash\nThe incorrect API usage results in an AttributeError, causing a runtime failure.\n\nML Library: Keras\nThe issue is specific to Keras' functional API and model composition.\n\nContract Violation Location: Prediction\nThe error occurs while attempting to use an intermediate layer output as input for another model.\n\nDetection Technique: Static\nThe mistake can be detected by verifying that intermediate layers are properly referenced within the functional API instead of being converted to NumPy arrays."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/51100508",
    "title": "",
    "question": "9\n\nI need some help with keras loss function. I have been implementing custom loss function on keras with Tensorflow backend.\n\nI have implemented the custom loss function in numpy but it would be great if it could be translated into keras loss function. The loss function takes dataframe and series of user id. The Euclidean distance for same user_id are positive and negative if the user_id are different. The function returns summed up scalar distance of the dataframe.\n\ndef custom_loss_numpy (encodings, user_id):\n# user_id: a pandas series of users\n# encodings: a pandas dataframe of encodings\n\n    batch_dist = 0\n\n    for i in range(len(user_id)):\n         first_row = encodings.iloc[i,:].values\n         first_user = user_id[i]\n\n         for j in range(i+1, len(user_id)):\n              second_user = user_id[j]\n              second_row = encodings.iloc[j,:].values\n\n        # compute distance: if the users are same then Euclidean distance is positive otherwise negative.\n            if first_user == second_user:\n                tmp_dist = np.linalg.norm(first_row - second_row)\n            else:\n                tmp_dist = -np.linalg.norm(first_row - second_row)\n\n            batch_dist += tmp_dist\n\n    return batch_dist\nI have tried to implement into keras loss function. I extracted numpy array from y_true and y_pred tensor objects.\n\ndef custom_loss_keras(y_true, y_pred):\n    # session of my program\n    sess = tf_session.TF_Session().get()\n\n    with sess.as_default():\n        array_pred = y_pred.eval()\n        print(array_pred)\nBut I get the following error.\n\ntensorflow.python.framework.errors_impl.InvalidArgumentError: You must feed a value for placeholder tensor 'dense_1_input' with dtype float and shape [?,102]\n [[Node: dense_1_input = Placeholder[dtype=DT_FLOAT, shape=[?,102], _device=\"/job:localhost/replica:0/task:0/device:CPU:0\"]()]]\nAny kind of help would be really appreciated.",
    "answer": "12\n\nFirst of all, it is not possible to \"extract numpy array from y_true and y_pred\" in Keras loss functions. You have to operate the tensors with Keras backend functions (or TF functions) to calculate the loss.\n\nIn other words, it would be better to think about a \"vectorized\" way to calculate the loss, without using if-else and loops.\n\nYour loss function can be computed in the following steps:\n\nGenerate a matrix of pairwise Euclidean distances, between all pairs of vectors in encodings.\nGenerate a matrix I whose element I_ij is 1 if user_i == user_j, and -1 if user_i != user_j.\nElement-wise multiply the two matrices, and sum up the elements to get the final loss.\nHere's an implementation:\n\ndef custom_loss_keras(user_id, encodings):\n    # calculate pairwise Euclidean distance matrix\n    pairwise_diff = K.expand_dims(encodings, 0) - K.expand_dims(encodings, 1)\n    pairwise_squared_distance = K.sum(K.square(pairwise_diff), axis=-1)\n\n    # add a small number before taking K.sqrt for numerical safety\n    # (K.sqrt(0) sometimes becomes nan)\n    pairwise_distance = K.sqrt(pairwise_squared_distance + K.epsilon())\n\n    # this will be a pairwise matrix of True and False, with shape (batch_size, batch_size)\n    pairwise_equal = K.equal(K.expand_dims(user_id, 0), K.expand_dims(user_id, 1))\n\n    # convert True and False to 1 and -1\n    pos_neg = K.cast(pairwise_equal, K.floatx()) * 2 - 1\n\n    # divide by 2 to match the output of `custom_loss_numpy`, but it's not really necessary\n    return K.sum(pairwise_distance * pos_neg, axis=-1) / 2\nI've assumed that user_id are integers in the code above. The trick here is to use K.expand_dims for implementing pairwise operations. It's probably a bit difficult to understand at a first glance, but it's quite useful.\n\nIt should give about the same loss value as custom_loss_numpy (there will be a little bit difference because of K.epsilon()):\n\nencodings = np.random.rand(32, 10)\nuser_id = np.random.randint(10, size=32)\n\nprint(K.eval(custom_loss_keras(K.variable(user_id), K.variable(encodings))).sum())\n-478.4245\n\nprint(custom_loss_numpy(pd.DataFrame(encodings), pd.Series(user_id)))\n-478.42953553795815\nI've made a mistake in the loss function.\n\nWhen this function is used in training, since Keras automatically changes y_true to be at least 2D, the argument user_id is no longer a 1D tensor. The shape of it will be (batch_size, 1).\n\nIn order to use this function, the extra axis must be removed:\n\ndef custom_loss_keras(user_id, encodings):\n    pairwise_diff = K.expand_dims(encodings, 0) - K.expand_dims(encodings, 1)\n    pairwise_squared_distance = K.sum(K.square(pairwise_diff), axis=-1)\n    pairwise_distance = K.sqrt(pairwise_squared_distance + K.epsilon())\n\n    user_id = K.squeeze(user_id, axis=1)  # remove the axis added by Keras\n    pairwise_equal = K.equal(K.expand_dims(user_id, 0), K.expand_dims(user_id, 1))\n\n    pos_neg = K.cast(pairwise_equal, K.floatx()) * 2 - 1\n    return K.sum(pairwise_distance * pos_neg, axis=-",
    "mlApiName": "keras.backend.sqrt, keras.backend.expand_dims",
    "embedding": [
      0.6136118173599243,
      0.9829398989677429,
      -1.8445864915847778,
      -1.3282878398895264,
      0.4932653307914734,
      -0.7215901613235474,
      0.5375120639801025,
      0.5234196186065674,
      0.0470619760453701,
      -0.8257675170898438,
      -0.4625861942768097,
      0.7999088764190674,
      2.075103282928467,
      -0.3429865837097168,
      -0.3643539249897003,
      -0.329406201839447,
      -0.0202323030680418,
      -0.30157026648521423,
      -0.1795697808265686,
      1.5773636102676392,
      -0.6252486109733582,
      0.06467793881893158,
      -0.10025043785572052,
      -0.18054603040218353,
      1.3982053995132446,
      -0.06632044911384583,
      -0.31589648127555847,
      0.6496958136558533,
      -0.6117863655090332,
      0.4844200611114502,
      0.8907408714294434,
      -0.16734641790390015,
      0.22170604765415192,
      -0.5809249877929688,
      -0.9413115978240967,
      -0.03137478977441788,
      1.1066155433654785,
      -0.39633122086524963,
      0.44800320267677307,
      -0.08725819736719131,
      -0.10120046138763428,
      -0.5676285624504089,
      0.1815466582775116,
      0.6435759663581848,
      0.7439732551574707,
      -0.6318829655647278,
      0.9080817103385925,
      0.3030185401439667,
      0.21796782314777374,
      -0.6395041942596436,
      0.06126004830002785,
      0.13281001150608063,
      -0.3995681703090668,
      0.04261237755417824,
      0.7011903524398804,
      0.7149954438209534,
      -0.47852611541748047,
      -0.554945707321167,
      1.0967704057693481,
      -0.6117235422134399,
      0.3879338800907135,
      1.03243088722229,
      -0.9716848134994507,
      0.13436393439769745,
      0.9788765907287598,
      -0.4852050244808197,
      -0.9276500344276428,
      0.6848541498184204,
      -0.5329136848449707,
      -0.41513684391975403,
      0.8840603232383728,
      0.518247663974762,
      -0.05518490448594093,
      0.6183120608329773,
      -0.38157162070274353,
      0.5818957686424255,
      -0.14193840324878693,
      -0.22166134417057037,
      0.22212430834770203,
      0.5744182467460632,
      -0.4626881182193756,
      0.7193325161933899,
      1.1520805358886719,
      -0.14569056034088135,
      -0.02999335154891014,
      0.17827264964580536,
      -0.09689431637525558,
      -0.545050323009491,
      -0.3954194188117981,
      1.2507994174957275,
      -0.4021000266075134,
      -0.5296271443367004,
      0.9975710511207581,
      1.0859105587005615,
      -0.5484768748283386,
      -0.3481983542442322,
      -0.34365740418434143,
      -0.28925850987434387,
      -0.10017181932926178,
      -0.3161191940307617,
      0.347112238407135,
      -0.07138457894325256,
      -0.5513729453086853,
      -1.1298465728759766,
      -0.24221403896808624,
      0.6428337097167969,
      0.48398810625076294,
      0.5238500237464905,
      0.45700961351394653,
      -0.18576157093048096,
      -0.501665472984314,
      -0.5925585031509399,
      -0.6682668328285217,
      -1.1408787965774536,
      0.6676264405250549,
      -0.2828766703605652,
      0.5329787731170654,
      -1.1097432374954224,
      0.38771852850914,
      0.6264196038246155,
      -0.40683987736701965,
      0.12410154193639755,
      0.8061255812644958,
      0.024088053032755852,
      -0.2991756796836853,
      0.7768591046333313,
      -0.37781691551208496,
      0.02505626529455185,
      0.2289721518754959,
      -0.5366725325584412,
      -0.016515841707587242,
      -1.0579346418380737,
      -0.6859537959098816,
      0.41656652092933655,
      0.38832008838653564,
      0.9891898036003113,
      -0.4697297215461731,
      -0.47326162457466125,
      0.2148101031780243,
      0.5134797692298889,
      0.6765736937522888,
      -0.21313528716564178,
      -0.382220059633255,
      -0.4530552327632904,
      0.07776769995689392,
      -0.8618739247322083,
      0.7300689220428467,
      -0.6602989435195923,
      -0.33311858773231506,
      -0.37518414855003357,
      0.7014235258102417,
      0.2590269446372986,
      -0.8704400062561035,
      -0.0817781388759613,
      1.1919456720352173,
      -0.6426613330841064,
      0.3536701202392578,
      0.9830705523490906,
      0.38230547308921814,
      -0.21963809430599213,
      0.5395017862319946,
      0.780625581741333,
      -0.49979445338249207,
      1.159216284751892,
      -0.3475553095340729,
      -0.7657901644706726,
      0.5311057567596436,
      0.013426611199975014,
      -0.44280508160591125,
      -0.15285880863666534,
      -0.6538655757904053,
      -0.9896240234375,
      0.3466387093067169,
      -0.5372574329376221,
      -0.39212411642074585,
      1.2110439538955688,
      0.7072732448577881,
      -0.3605725169181824,
      0.1581723988056183,
      -0.17523661255836487,
      0.4504912495613098,
      -0.3739859163761139,
      0.9704877138137817,
      0.2034827321767807,
      -0.28732550144195557,
      0.25093337893486023,
      0.5508695244789124,
      0.4418250620365143,
      -0.30834710597991943,
      -0.6069300174713135,
      0.4729158282279968,
      0.08701533824205399,
      -0.09751857817173004,
      -0.3908708691596985,
      -0.23499660193920135,
      0.13987183570861816,
      0.876442015171051,
      -0.3057745695114136,
      1.0644795894622803,
      0.3996210992336273,
      -0.34406745433807373,
      0.9945781826972961,
      -0.6402064561843872,
      0.2710699141025543,
      0.02630280703306198,
      -0.25575026869773865,
      -0.21968720853328705,
      0.2331315577030182,
      -0.14742659032344818,
      -0.13307461142539978,
      0.2767311632633209,
      -0.348593145608902,
      -0.3601257801055908,
      0.9124522805213928,
      0.48432913422584534,
      -0.06427565962076187,
      0.4399038553237915,
      -0.3148331940174103,
      -0.37834569811820984,
      0.5388415455818176,
      0.567646861076355,
      -0.4221605658531189,
      0.2185811996459961,
      -0.019706230610609055,
      0.36653950810432434,
      -0.31630346179008484,
      -0.17947103083133698,
      -0.6487258672714233,
      -0.999811053276062,
      -0.08732511103153229,
      -1.1278287172317505,
      -0.20209051668643951,
      0.5986382365226746,
      0.11522607505321503,
      0.007705202791839838,
      1.0754836797714233,
      0.8546310663223267,
      0.6796653270721436,
      -0.06584014743566513,
      0.5124132037162781,
      0.18127474188804626,
      0.3362857699394226,
      0.289485901594162,
      0.7392787337303162,
      -0.8506832718849182,
      -0.09767480194568634,
      -0.5695077180862427,
      -1.4099727869033813,
      0.08776101469993591,
      0.6997542977333069,
      -0.0024180153850466013,
      0.6231103539466858,
      0.9124218225479126,
      0.1558365374803543,
      0.8992384672164917,
      -0.20290948450565338,
      -0.7709852457046509,
      -0.6797489523887634,
      1.1189213991165161,
      -0.764396071434021,
      0.3787288963794708,
      0.5326611995697021,
      0.020114053040742874,
      -0.20906464755535126,
      -0.5747570991516113,
      -0.39919883012771606,
      -0.4319712221622467,
      0.22019462287425995,
      -0.0773703008890152,
      -0.28527334332466125,
      -0.19127847254276276,
      0.5794216990470886,
      1.0837414264678955,
      0.5284020304679871,
      0.7137160301208496,
      0.11242770403623581,
      0.14633581042289734,
      -0.08126711845397949,
      0.14465613663196564,
      0.3454938232898712,
      -0.05706743896007538,
      -0.44751936197280884,
      -0.9914190173149109,
      -0.00925520434975624,
      -0.16668462753295898,
      0.011968676932156086,
      0.38954880833625793,
      0.8222880363464355,
      0.04845109209418297,
      0.4984086751937866,
      -0.046449143439531326,
      0.48087558150291443,
      0.06698257476091385,
      0.3162780702114105,
      0.4698418378829956,
      1.0606517791748047,
      1.0065964460372925,
      -0.46757984161376953,
      -0.16154028475284576,
      -0.4842393398284912,
      0.21933424472808838,
      0.5685439705848694,
      0.5820054411888123,
      0.11229025572538376,
      -0.471242755651474,
      -0.0758182629942894,
      0.11782623082399368,
      -0.059506531804800034,
      0.39431339502334595,
      0.1151837557554245,
      -0.18925906717777252,
      -0.11565522849559784,
      -0.44216302037239075,
      0.8773894906044006,
      -0.6211015582084656,
      0.2832345962524414,
      1.1879103183746338,
      0.3482418358325958,
      0.23431721329689026,
      0.17804203927516937,
      0.30959999561309814,
      -0.9738926291465759,
      -0.12342160195112228,
      0.40676942467689514,
      -0.19845956563949585,
      0.5062745213508606,
      -0.7802480459213257,
      -0.15625764429569244,
      0.5493044257164001,
      -0.07086669653654099,
      -0.2874085307121277,
      0.34899038076400757,
      0.42232745885849,
      -1.4417073726654053,
      -1.5957221984863281,
      0.18031764030456543,
      -0.17170043289661407,
      -0.18611998856067657,
      -0.07438674569129944,
      0.8653104901313782,
      0.10856277495622635,
      -0.09455892443656921,
      -0.16810454428195953,
      -0.9621657133102417,
      -0.4921988248825073,
      0.4667271375656128,
      -0.5705276727676392,
      -0.21520215272903442,
      0.8247712254524231,
      -0.6373785138130188,
      0.060351863503456116,
      -0.5759703516960144,
      0.43477198481559753,
      -0.24253840744495392,
      -0.0947025939822197,
      0.22444887459278107,
      0.9393989443778992,
      -0.34265413880348206,
      0.022084994241595268,
      0.3942188322544098,
      0.602157473564148,
      -0.47771981358528137,
      0.04129277542233467,
      0.031345434486866,
      -0.08544900268316269,
      -0.4123592674732208,
      1.2114795446395874,
      0.24222032725811005,
      0.06829378753900528,
      -0.07884428650140762,
      -0.2740732729434967,
      0.007775548845529556,
      -0.21644330024719238,
      0.023253530263900757,
      -0.6114478707313538,
      -0.2216014415025711,
      -0.9736144542694092,
      0.1606065034866333,
      -0.49738842248916626,
      0.6403470635414124,
      0.34133246541023254,
      -0.08553087711334229,
      0.49609458446502686,
      -0.14710846543312073,
      0.3274797797203064,
      0.14956603944301605,
      0.5952114462852478,
      -1.2770849466323853,
      0.5287309885025024,
      0.9353018999099731,
      -0.08407928049564362,
      -0.9476156234741211,
      -1.2568479776382446,
      -0.43307286500930786,
      0.5522728562355042,
      -0.621137797832489,
      0.46293550729751587,
      0.15079763531684875,
      -0.5635989904403687,
      0.5365726947784424,
      -1.7805590629577637,
      -0.46800893545150757,
      0.5350528955459595,
      -0.4004201889038086,
      -0.05432787165045738,
      -0.899549663066864,
      0.18558602035045624,
      -0.03133567050099373,
      0.07658858597278595,
      -0.25741341710090637,
      0.3671129047870636,
      0.7112941741943359,
      0.28182560205459595,
      -1.4216392040252686,
      1.2207248210906982,
      0.18791696429252625,
      1.0502067804336548,
      0.3837577700614929,
      -0.21688894927501678,
      -0.7257692217826843,
      -0.38678666949272156,
      0.5361391305923462,
      -0.6617095470428467,
      0.5548744201660156,
      0.5308550596237183,
      0.419177770614624,
      -0.14957153797149658,
      0.575357973575592,
      1.0136576890945435,
      -1.0916320085525513,
      -0.11353474855422974,
      0.8133973479270935,
      0.23933245241641998,
      0.1452563852071762,
      -0.1521582305431366,
      -0.41914716362953186,
      0.18634922802448273,
      0.2551100552082062,
      -0.23193606734275818,
      1.5414918661117554,
      0.5530484914779663,
      -0.25281858444213867,
      -0.8446982502937317,
      -0.4644491672515869,
      0.7244599461555481,
      0.1699412316083908,
      0.6346046924591064,
      -0.5292388796806335,
      -0.5669744610786438,
      1.0593819618225098,
      -0.27686503529548645,
      0.37668463587760925,
      0.7523588538169861,
      -0.02721504308283329,
      1.0925301313400269,
      -0.4029802680015564,
      -0.4760696589946747,
      -0.6839232444763184,
      0.2255893498659134,
      0.585161566734314,
      -0.6567579507827759,
      0.6011098623275757,
      -0.8351321220397949,
      -0.26581236720085144,
      -0.25412067770957947,
      -0.3695579469203949,
      0.1992209255695343,
      -0.1821509748697281,
      0.4680459201335907,
      0.6871702671051025,
      -1.3474254608154297,
      -0.35676783323287964,
      0.5425336956977844,
      -0.27125173807144165,
      -0.7762960195541382,
      0.1316555291414261,
      -0.27218717336654663,
      -0.2672549784183502,
      0.9023532271385193,
      0.694576621055603,
      0.05598025396466255,
      -1.1031044721603394,
      -0.6803175806999207,
      -0.4967496991157532,
      -0.10945124924182892,
      1.3068710565567017,
      0.135817289352417,
      -0.35519149899482727,
      0.11137422919273376,
      -0.242183655500412,
      0.39646464586257935,
      -0.3459136486053467,
      -0.4054376482963562,
      -0.06050125136971474,
      0.15160168707370758,
      -0.35164955258369446,
      -0.24001553654670715,
      0.8218063116073608,
      0.1344577670097351,
      0.4888906478881836,
      -0.21956610679626465,
      0.323545902967453,
      -0.9121065735816956,
      -0.17288455367088318,
      0.6447359323501587,
      -0.367786705493927,
      0.8961194157600403,
      -0.63252192735672,
      -0.46722128987312317,
      0.002443848177790642,
      0.010918141342699528,
      0.1785237193107605,
      0.512549877166748,
      0.259661465883255,
      -0.280473530292511,
      -0.8975916504859924,
      0.5286080837249756,
      0.947212815284729,
      -0.9126850366592407,
      0.3176296651363373,
      0.5595444440841675,
      -0.18921422958374023,
      0.1929095834493637,
      -0.41475710272789,
      -0.5542930960655212,
      -0.06209048256278038,
      0.3271346986293793,
      -0.43726855516433716,
      -0.007888826541602612,
      -0.4144042134284973,
      -0.01733226515352726,
      -0.5487515926361084,
      -1.6420670747756958,
      -0.40551477670669556,
      -0.11363201588392258,
      -0.3291969895362854,
      -0.7250437140464783,
      0.9163255095481873,
      0.4246123135089874,
      -0.3878103494644165,
      0.6011325120925903,
      1.022914171218872,
      -0.2008240520954132,
      -0.2090187817811966,
      -0.6002766489982605,
      -0.012876038439571857,
      -0.21124115586280823,
      0.18083453178405762,
      1.0805244445800781,
      -1.0417507886886597,
      0.1103874146938324,
      -0.449175626039505,
      0.36811500787734985,
      -1.050398349761963,
      0.1764550656080246,
      -0.8296782374382019,
      -0.618966281414032,
      -0.5767858624458313,
      -0.3133021593093872,
      -0.3306695818901062,
      -0.7544986605644226,
      0.23598827421665192,
      1.215919017791748,
      0.1718723624944687,
      -0.1996302455663681,
      -0.9591495990753174,
      0.031189564615488052,
      0.40036848187446594,
      0.7094012498855591,
      0.23110331594944,
      -0.16979575157165527,
      -1.2305958271026611,
      0.2727077901363373,
      -0.19266951084136963,
      0.020772850140929222,
      0.73381108045578,
      0.17848436534404755,
      -0.3923499286174774,
      -0.6267272233963013,
      -0.37855494022369385,
      -0.19068750739097595,
      -0.5621359348297119,
      0.683997631072998,
      0.020127836614847183,
      -0.17444679141044617,
      0.5806940793991089,
      0.4776858985424042,
      -0.6118683218955994,
      0.2619805634021759,
      -0.581591010093689,
      -0.8889986276626587,
      -0.20170733332633972,
      0.8769052028656006,
      -0.5748040676116943,
      -0.37126466631889343,
      -0.1629207730293274,
      -0.6268865466117859,
      0.37735220789909363,
      -0.4743610620498657,
      -1.0736415386199951,
      -0.23575767874717712,
      0.8187510371208191,
      1.312098741531372,
      -1.4216924905776978,
      0.32350587844848633,
      1.2211894989013672,
      -0.1382540464401245,
      -0.020680634304881096,
      -0.15835003554821014,
      0.07838574051856995,
      0.6748427152633667,
      0.10464878380298615,
      0.0011302989441901445,
      0.16493506729602814,
      -0.0043834177777171135,
      -0.9656574726104736,
      1.4344983100891113,
      0.28245607018470764,
      -0.6578108668327332,
      -0.025233926251530647,
      -0.31087595224380493,
      -1.2552284002304077,
      0.41824090480804443,
      -0.7242558598518372,
      0.6051604151725769,
      0.11817333102226257,
      -1.0280027389526367,
      -0.498617023229599,
      0.27471068501472473,
      0.6725512742996216,
      -0.901202917098999,
      -0.16685299575328827,
      -0.6510279774665833,
      -0.08658421784639359,
      -0.9546732902526855,
      1.759242057800293,
      -0.3396419882774353,
      0.9365094304084778,
      0.8528460264205933,
      0.43670782446861267,
      -0.45915496349334717,
      -0.06603372097015381,
      -0.4155246615409851,
      0.07988662272691727,
      -1.0041637420654297,
      -0.03606798127293587,
      0.7019559144973755,
      1.155973196029663,
      -0.047902774065732956,
      -0.38137486577033997,
      1.0808988809585571,
      1.1679238080978394,
      0.04259565845131874,
      0.008421777747571468,
      0.4417174458503723,
      -0.13723823428153992,
      -0.08982900530099869,
      -1.043487787246704,
      -0.8233168125152588,
      -0.09607093036174774,
      0.5006488561630249,
      -0.4129413664340973,
      -0.8141881227493286,
      -0.08828920871019363,
      0.5945453643798828,
      0.3014093041419983,
      -0.06836544722318649,
      0.31849512457847595,
      -0.33127135038375854,
      -0.6001484394073486,
      0.5920964479446411,
      0.8462600111961365,
      -0.9479687213897705,
      0.5388116240501404,
      0.647544801235199,
      0.11975537240505219,
      0.8971847295761108,
      0.4603477418422699,
      -0.6902198791503906,
      -0.012715318240225315,
      0.5632391571998596,
      -0.6531218886375427,
      0.39334836602211,
      -0.19599072635173798,
      0.012524626217782497,
      -0.46105656027793884,
      0.10682721436023712,
      -0.8892518877983093,
      0.5104461312294006,
      -0.3006759285926819,
      -0.5098655223846436,
      -0.0024970537051558495,
      0.12577947974205017,
      -0.30644887685775757,
      -0.3223915696144104,
      0.1230851337313652,
      0.40710437297821045,
      -0.7613397836685181,
      0.2539786696434021,
      0.781717836856842,
      0.0219811350107193,
      -0.12645015120506287,
      0.10076062381267548,
      0.3392912447452545,
      0.603346049785614,
      -0.07955488562583923,
      0.5813657641410828,
      -0.2800978124141693,
      -0.09430734068155289,
      -0.21679601073265076,
      0.7910283803939819,
      0.07829885929822922,
      -0.6516442894935608,
      0.6641318798065186,
      0.06253215670585632,
      0.6568127274513245,
      0.02223120629787445,
      -0.7749508619308472,
      0.09268202632665634,
      -1.1122974157333374,
      0.2253062129020691,
      -0.4865807592868805,
      -0.949468731880188,
      -0.13976341485977173,
      -0.5445074439048767,
      -0.8316227793693542,
      0.2755984365940094,
      0.03857742249965668,
      -0.9754851460456848,
      -0.366748183965683,
      -0.7001646757125854,
      -0.0750015377998352,
      -0.7938612103462219,
      0.9600031971931458,
      -0.38182398676872253,
      0.08140726387500763,
      -0.9860779047012329,
      -0.6199303865432739,
      -0.9860337376594543,
      0.16915470361709595,
      -0.8667542338371277,
      0.34537652134895325,
      -0.09041164070367813,
      -0.28419604897499084,
      -0.12054178863763809,
      -0.5934102535247803,
      -0.5190915465354919,
      1.2964072227478027,
      0.17404375970363617,
      -0.7147402763366699,
      -0.17722465097904205,
      -0.6094645857810974,
      0.12016496062278748,
      0.47661545872688293,
      0.13673466444015503,
      0.4673919081687927,
      -0.1433955878019333,
      0.8486759662628174,
      0.7420045733451843,
      0.14796745777130127,
      0.3564164340496063,
      -0.5374162197113037,
      -0.19592058658599854,
      0.313466340303421,
      -0.2837410271167755,
      -0.4092384874820709,
      -0.21490290760993958,
      -0.0599249005317688
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SL",
      "level3": "F, IC-1",
      "leafContractCategory": "Comb. of SAM(Level 3) and AMO(Level 2)",
      "rootCause": "Missing Options",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): Hybrid\nThe issue involves multiple Keras backend functions (K.sqrt, K.expand_dims) in a custom loss function, leading to a hybrid contract violation.\n\nLevel 2: SL (Selection Issue)\nThe user incorrectly selects NumPy-style operations instead of using proper Keras/TensorFlow tensor operations for loss computation.\n\nLevel 3 (Hybrid Patterns): F (Eventually Required Condition), IC-1 (Intra-argument Contract)\nThe function fails because it does not properly handle tensor-based operations, leading to incorrect computational graph execution.\n\nLeaf Contract Category: Combination of SAM (Level 3) and AMO (Level 2)\nThe issue involves both improper use of individual API methods (K.sqrt, K.expand_dims) and incorrect method ordering.\n\nRoot Cause: Missing Options\nThe user attempts to extract NumPy arrays from Keras tensors within a loss function, which is not allowed.\n\nEffect: Crash\nThe program fails with an InvalidArgumentError due to improper use of Keras backend functions in the loss calculation.\n\nML Library: Keras\nThe issue occurs in Keras� backend operations when defining a custom loss function.\n\nContract Violation Location: Model Construction\nThe error occurs while constructing the model with an incorrectly implemented loss function.\n\nDetection Technique: Static\nThe issue can be detected through static analysis by verifying that all loss function operations are performed using valid Keras/TensorFlow backend functions instead of NumPy operations.\n\n\n"
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/41378461",
    "title": "",
    "question": "21\n\nI want to get pretrained VGG16 model in Keras, remove its output layer, and then put a new output layer with the number of classes suited for my problem, and then to fit it on new data. For this reason, I am trying to use the model here: https://keras.io/applications/#vgg16, but since it is not Sequential, I cannot just model.pop(). Popping from layers and adding it also does not work, because in the predictions it still expects the old shape. How would I do that? Is there a way to convert this type of model to Sequential?",
    "answer": "56\n\nYou can use pop() on model.layers and then use model.layers[-1].output to create new layers.\n\nExample:\n\nfrom keras.models import Model\nfrom keras.layers import Dense,Flatten\nfrom keras.applications import vgg16\nfrom keras import backend as K\n\nmodel = vgg16.VGG16(weights='imagenet', include_top=True)\n\nmodel.input\n\nmodel.summary(line_length=150)\n\nmodel.layers.pop()\nmodel.layers.pop()\n\nmodel.summary(line_length=150)\n\nnew_layer = Dense(10, activation='softmax', name='my_dense')\n\ninp = model.input\nout = new_layer(model.layers[-1].output)\n\nmodel2 = Model(inp, out)\nmodel2.summary(line_length=150)\nAlternatively, you can use include_top=False option of these models. In this case if you need to use flatten the layer then you need to pass the input_shape also.\n\nmodel3 = vgg16.VGG16(weights='imagenet', include_top=False, input_shape=(224, 224, 3))\nmodel3.summary(line_length=150)\n\nflatten = Flatten()\nnew_layer2 = Dense(10, activation='softmax', name='my_dense_2')\n\ninp2 = model3.input\nout2 = new_layer2(flatten(model3.output))\n\nmodel4 = Model(inp2, out2)\nmodel4.summary(line_length=150)",
    "mlApiName": "keras.models.pop, keras.applications.vgg16.VGG16, keras.layers, keras.models",
    "embedding": [
      -0.34314945340156555,
      0.7096837162971497,
      -2.187499761581421,
      -1.1419297456741333,
      0.6490744948387146,
      -0.08780517429113388,
      0.28248125314712524,
      0.26271185278892517,
      -0.34402817487716675,
      -0.7383495569229126,
      -0.4349890351295471,
      0.32249748706817627,
      2.1792080402374268,
      0.5220601558685303,
      0.02093454822897911,
      -0.6156741380691528,
      0.17030547559261322,
      -0.03270093724131584,
      -0.23697155714035034,
      0.6963582634925842,
      0.46322211623191833,
      -1.3297767639160156,
      0.5193957090377808,
      -0.7053171396255493,
      0.9843242764472961,
      -0.18726177513599396,
      -0.1597829908132553,
      0.3869946002960205,
      -0.35713425278663635,
      0.4896189272403717,
      1.4417582750320435,
      -0.8683505654335022,
      0.2551843225955963,
      -1.1117008924484253,
      -1.1664910316467285,
      -0.4678346514701843,
      1.3221521377563477,
      -0.3401321470737457,
      -0.5013926029205322,
      0.21030022203922272,
      1.4270837306976318,
      0.5161500573158264,
      0.23594318330287933,
      0.6225715279579163,
      -0.5009734034538269,
      0.14714877307415009,
      1.361777663230896,
      0.46966272592544556,
      0.7341230511665344,
      -0.8711525201797485,
      0.40246257185935974,
      0.7991181015968323,
      0.08454160392284393,
      -0.30014991760253906,
      0.8298136591911316,
      0.7231127023696899,
      0.3599928915500641,
      0.35028988122940063,
      1.0225157737731934,
      -1.1969162225723267,
      -0.4022766053676605,
      1.430484652519226,
      -1.3977922201156616,
      2.0530667304992676,
      0.2513192296028137,
      0.3827289938926697,
      -0.9211474061012268,
      0.30437973141670227,
      -0.41346848011016846,
      -1.0357269048690796,
      0.21668894588947296,
      0.9621140956878662,
      0.22722841799259186,
      -0.42416152358055115,
      -0.4925954043865204,
      -0.42443227767944336,
      -0.31133994460105896,
      -0.904336154460907,
      -0.2952762544155121,
      0.4817681908607483,
      0.11260879039764404,
      1.260175108909607,
      1.2598203420639038,
      -0.7802802920341492,
      -0.024803001433610916,
      0.21611501276493073,
      -1.0122721195220947,
      -0.4379938542842865,
      -1.1317797899246216,
      1.442022442817688,
      -0.26137951016426086,
      -1.056643009185791,
      0.5931691527366638,
      0.925129234790802,
      -1.1978806257247925,
      -0.9152401089668274,
      -0.09913483262062073,
      -0.027832310646772385,
      -0.1226697787642479,
      -0.4329957664012909,
      -0.029225880280137062,
      0.2156027853488922,
      -0.26091137528419495,
      -1.173258900642395,
      -0.6253873705863953,
      1.3161057233810425,
      -0.3631710410118103,
      0.11158289760351181,
      0.9225425720214844,
      -0.30043521523475647,
      -0.8439539670944214,
      0.16008731722831726,
      0.09858318418264389,
      0.4831346869468689,
      -0.18325018882751465,
      -0.36008769273757935,
      0.2648746371269226,
      0.0442936047911644,
      0.12847575545310974,
      0.45264238119125366,
      0.008206729777157307,
      -0.8176582455635071,
      0.7970998883247375,
      -0.34188151359558105,
      -0.14795275032520294,
      0.41505178809165955,
      -0.9730260372161865,
      0.09926094114780426,
      0.2585766911506653,
      -0.9538205862045288,
      0.33608579635620117,
      -0.558521568775177,
      -0.020246941596269608,
      1.067918062210083,
      1.0948339700698853,
      1.9136078357696533,
      -0.8655277490615845,
      -1.0966160297393799,
      0.8360795974731445,
      0.38032835721969604,
      0.5347655415534973,
      0.14330029487609863,
      -0.12575629353523254,
      -0.6281718611717224,
      0.3562298119068146,
      -0.06539854407310486,
      0.7847294807434082,
      -0.2975509762763977,
      -0.9452906847000122,
      0.7658286094665527,
      -0.026176927611231804,
      0.5182640552520752,
      -1.0755419731140137,
      -0.13447833061218262,
      0.8767738342285156,
      -1.0353596210479736,
      0.7536426186561584,
      0.7586588859558105,
      0.45894932746887207,
      -0.8375564217567444,
      1.0393569469451904,
      -0.34078025817871094,
      -0.27624738216400146,
      0.19060420989990234,
      -0.13084372878074646,
      -0.9474660158157349,
      -0.44326409697532654,
      0.10307278484106064,
      -0.5241703391075134,
      0.8146645426750183,
      -0.47453370690345764,
      -0.42316365242004395,
      -0.542643129825592,
      0.3654581308364868,
      0.27535057067871094,
      0.6821163296699524,
      1.8044551610946655,
      -0.3568975627422333,
      1.0214279890060425,
      0.12362780421972275,
      1.20094633102417,
      -0.15676501393318176,
      0.9084635376930237,
      -0.11226961761713028,
      -0.6367580890655518,
      0.3925482928752899,
      0.225025936961174,
      0.12505754828453064,
      0.464408814907074,
      -0.5573320388793945,
      0.48377931118011475,
      0.2645733654499054,
      -0.42363810539245605,
      -0.45169976353645325,
      0.1352851539850235,
      0.10224127769470215,
      1.2342814207077026,
      -0.45005008578300476,
      0.7344216704368591,
      -0.2265133261680603,
      0.17397341132164001,
      0.6740149855613708,
      -0.3793848752975464,
      0.2640833258628845,
      -0.9478070735931396,
      0.5707705020904541,
      -0.27188506722450256,
      0.7599101662635803,
      -0.3810545802116394,
      0.07484318315982819,
      0.44343578815460205,
      0.051328495144844055,
      0.6873103380203247,
      0.5449204444885254,
      0.21518327295780182,
      -0.03796444088220596,
      0.6758113503456116,
      -0.45110711455345154,
      0.10700374096632004,
      -0.19885039329528809,
      0.3213498592376709,
      -0.20091186463832855,
      0.5181537866592407,
      0.26081544160842896,
      0.739168107509613,
      -1.2828710079193115,
      0.6326103806495667,
      0.015538157895207405,
      -1.2550311088562012,
      -0.10664446651935577,
      -0.11713384836912155,
      -0.9628524780273438,
      -0.06472668796777725,
      0.5183884501457214,
      -0.36320412158966064,
      0.2306605577468872,
      1.0144942998886108,
      1.0780926942825317,
      -0.8785692453384399,
      -0.10900045931339264,
      -0.11078869551420212,
      0.4613487720489502,
      0.26501888036727905,
      -0.21795104444026947,
      -0.8882887363433838,
      0.0687277764081955,
      0.16810499131679535,
      -0.13214488327503204,
      0.45405593514442444,
      0.8525168299674988,
      0.24699340760707855,
      0.31112685799598694,
      0.9289403557777405,
      -0.10756173729896545,
      1.134413242340088,
      -0.7797865867614746,
      -0.7592763900756836,
      -0.14131824672222137,
      0.5310340523719788,
      -0.3235212564468384,
      0.40195825695991516,
      0.4274705648422241,
      -0.4821755588054657,
      0.2086700052022934,
      -0.26228079199790955,
      -0.7450588345527649,
      -0.21978528797626495,
      -0.5715637803077698,
      0.3668050169944763,
      -0.05033138394355774,
      -0.0666826069355011,
      0.6606330871582031,
      0.8224706649780273,
      1.1353356838226318,
      0.8516110181808472,
      0.10250254720449448,
      0.44808703660964966,
      0.2410344034433365,
      -0.1638600379228592,
      0.28536534309387207,
      -0.49183323979377747,
      -1.488019347190857,
      -0.5336757302284241,
      -0.4394102394580841,
      0.08523083478212357,
      -0.3568302094936371,
      -0.15009050071239471,
      -0.29277053475379944,
      0.2766760587692261,
      0.35412654280662537,
      -0.5014849305152893,
      0.07330866903066635,
      -0.27909594774246216,
      0.4471224546432495,
      -0.4999848008155823,
      0.037373073399066925,
      0.6436576843261719,
      -0.005382081959396601,
      0.21618804335594177,
      -0.8074250817298889,
      0.2295132726430893,
      0.7801842093467712,
      1.2257267236709595,
      0.340827077627182,
      0.35866501927375793,
      -0.1185145452618599,
      0.43742167949676514,
      -0.17092646658420563,
      0.05094926059246063,
      -0.6172914505004883,
      -1.0633095502853394,
      -0.026093825697898865,
      -0.4924677610397339,
      1.0939806699752808,
      -0.32415780425071716,
      -0.033301014453172684,
      0.15245848894119263,
      0.3939287066459656,
      -0.21650755405426025,
      -0.21578140556812286,
      -0.24003155529499054,
      0.39613258838653564,
      0.4007963538169861,
      0.40621206164360046,
      -0.944124162197113,
      0.7603068947792053,
      -0.3770727813243866,
      -0.258698433637619,
      0.47982001304626465,
      0.0004907543188892305,
      0.6898106336593628,
      0.09629876166582108,
      0.305667519569397,
      -1.379646897315979,
      -0.6751779317855835,
      0.21077238023281097,
      0.16545423865318298,
      0.2069089114665985,
      0.3942260146141052,
      0.8146911859512329,
      -0.3805370330810547,
      0.03051142767071724,
      0.43178415298461914,
      -0.23514388501644135,
      -0.566754937171936,
      0.25625550746917725,
      -1.3470572233200073,
      -1.398388147354126,
      0.6694064736366272,
      0.2613275647163391,
      -0.3694893717765808,
      0.6249943971633911,
      -0.29119545221328735,
      -0.4344371259212494,
      0.11467868089675903,
      -0.5120677947998047,
      0.4721078872680664,
      0.368132084608078,
      0.43994754552841187,
      0.6179894804954529,
      0.971804678440094,
      -1.0077258348464966,
      0.1038210466504097,
      0.4766106903553009,
      0.14884869754314423,
      0.22742944955825806,
      0.5590846538543701,
      -0.2409507781267166,
      0.9175295233726501,
      0.017966700717806816,
      0.015822337940335274,
      -0.6237718462944031,
      -0.2597549855709076,
      0.2878183424472809,
      -0.23970948159694672,
      0.26819151639938354,
      -0.790553092956543,
      0.33909258246421814,
      -0.6453604102134705,
      -0.447054922580719,
      0.43329018354415894,
      -0.7528014779090881,
      0.4920858144760132,
      -0.19492754340171814,
      0.21536579728126526,
      0.8703461289405823,
      0.7531800866127014,
      -0.24313363432884216,
      0.07328394800424576,
      1.6219853162765503,
      0.13119490444660187,
      -0.187844917178154,
      -0.28856131434440613,
      -0.23693566024303436,
      0.01982288248836994,
      -0.6461929678916931,
      0.7645388841629028,
      0.02309303916990757,
      -0.8153196573257446,
      -0.011969021521508694,
      -1.536580204963684,
      -0.5489400625228882,
      0.2315952032804489,
      -0.04327479004859924,
      -0.27191394567489624,
      -0.15776057541370392,
      0.11060252040624619,
      -0.313557505607605,
      0.596110463142395,
      -0.058782245963811874,
      -0.10121915489435196,
      -0.36950966715812683,
      -0.02825174666941166,
      -1.6332944631576538,
      0.8266569375991821,
      -0.07732494175434113,
      0.686221182346344,
      1.2075879573822021,
      -0.7340716123580933,
      -0.48595818877220154,
      -0.4348644018173218,
      0.3969273567199707,
      -0.25939130783081055,
      -0.15405608713626862,
      0.8282293081283569,
      0.9026241898536682,
      0.32417482137680054,
      0.916415810585022,
      0.19368654489517212,
      -2.063034772872925,
      0.5151289701461792,
      -0.0558491088449955,
      0.735634446144104,
      -0.9209222197532654,
      -0.8563986420631409,
      -0.01759943924844265,
      -0.25615668296813965,
      1.2426358461380005,
      -0.5240223407745361,
      0.1189480796456337,
      1.1662954092025757,
      -0.41807109117507935,
      -0.622286319732666,
      -0.4193563163280487,
      0.3477589786052704,
      0.23152382671833038,
      0.7074721455574036,
      -0.8055927157402039,
      -1.4347323179244995,
      1.790922999382019,
      -0.31513893604278564,
      -0.4768744707107544,
      0.18183566629886627,
      1.1245923042297363,
      1.6800222396850586,
      -0.14861489832401276,
      -0.10739292204380035,
      -0.0018246264662593603,
      -0.3874798119068146,
      0.3019680976867676,
      0.25698596239089966,
      0.46593356132507324,
      -0.7311903834342957,
      -0.15178106725215912,
      -0.4096657633781433,
      -1.2573962211608887,
      -0.14364951848983765,
      -0.20630696415901184,
      0.8947601318359375,
      1.2506250143051147,
      -0.7386282682418823,
      -0.2905386686325073,
      0.5610392093658447,
      -0.3356013894081116,
      0.23862706124782562,
      0.3996537923812866,
      -0.14995507895946503,
      -0.05482980236411095,
      -0.3235500454902649,
      0.17069412767887115,
      0.2534346282482147,
      -1.7183274030685425,
      -0.3945651948451996,
      -0.7889813780784607,
      -0.2220904380083084,
      1.6978271007537842,
      -0.019128931686282158,
      0.30852437019348145,
      0.27849435806274414,
      -0.11224948614835739,
      0.6953031420707703,
      -0.2857879102230072,
      -0.34646543860435486,
      0.17273078858852386,
      0.3095396161079407,
      -0.08770641684532166,
      0.2006525993347168,
      1.2823735475540161,
      0.23979265987873077,
      0.9740685820579529,
      0.04331641644239426,
      0.31167563796043396,
      -0.7803704738616943,
      0.01746365614235401,
      0.9371495246887207,
      -0.5097145438194275,
      0.7121241092681885,
      -0.8059400320053101,
      -0.011251814663410187,
      -0.16269174218177795,
      0.7426297068595886,
      -0.43900078535079956,
      -0.04367780685424805,
      0.1879146248102188,
      0.5349940061569214,
      -1.3456250429153442,
      -0.21359670162200928,
      0.600517988204956,
      -1.123787760734558,
      0.20656953752040863,
      0.4812982976436615,
      -0.7549430131912231,
      -0.28626909852027893,
      -0.5318687558174133,
      -0.7170954346656799,
      0.2604646384716034,
      0.13582651317119598,
      -1.4684624671936035,
      0.8189077973365784,
      -0.9535617828369141,
      0.4502117335796356,
      -0.20389984548091888,
      -1.245047688484192,
      -0.15172138810157776,
      0.129477858543396,
      -0.04924183338880539,
      -0.4096590280532837,
      1.32972252368927,
      0.7220836281776428,
      -0.24910633265972137,
      0.2536824941635132,
      1.1315550804138184,
      0.17373529076576233,
      -0.7754939794540405,
      -1.0326554775238037,
      0.2072533369064331,
      0.09907499700784683,
      1.4261622428894043,
      0.4813416004180908,
      -0.39852282404899597,
      -0.30147361755371094,
      -1.379478096961975,
      0.49882352352142334,
      -0.6787986755371094,
      -0.1560954600572586,
      -1.0358566045761108,
      -0.7818127870559692,
      -0.8357996940612793,
      -0.4902859926223755,
      -0.43460357189178467,
      -1.283258318901062,
      0.1482870876789093,
      1.7874751091003418,
      -0.07566215097904205,
      -0.37946730852127075,
      -0.20546916127204895,
      -0.7082250118255615,
      0.7788591384887695,
      0.08076811581850052,
      0.25874361395835876,
      -0.2881796658039093,
      -1.3065935373306274,
      0.39436453580856323,
      0.42912060022354126,
      -0.5638037323951721,
      0.09090211987495422,
      0.9382649660110474,
      0.5754433274269104,
      -0.5469726920127869,
      0.2500726282596588,
      -0.5483882427215576,
      -1.6145693063735962,
      -0.11487118154764175,
      0.19307492673397064,
      0.2129633128643036,
      0.43283501267433167,
      -0.24543194472789764,
      -0.9868389368057251,
      -0.2934112250804901,
      0.46111157536506653,
      -1.1446486711502075,
      -0.9864574670791626,
      0.5671413540840149,
      -0.26486772298812866,
      0.9030948281288147,
      0.3200562596321106,
      -0.7490626573562622,
      0.6873812675476074,
      0.02153133600950241,
      -1.6380267143249512,
      -0.1566164344549179,
      0.45300838351249695,
      1.5077999830245972,
      -1.5763965845108032,
      0.2562865912914276,
      0.9861284494400024,
      -1.1069869995117188,
      0.8233884572982788,
      -0.06745608896017075,
      -0.09355831146240234,
      0.35189682245254517,
      -0.07692442834377289,
      -0.04450682923197746,
      0.007666118908673525,
      0.8833319544792175,
      -1.2413510084152222,
      0.7075419425964355,
      -0.008648145943880081,
      -0.1296677440404892,
      -0.9114473462104797,
      -1.206993579864502,
      -0.7941491007804871,
      1.5554741621017456,
      -1.8776299953460693,
      0.44100964069366455,
      -0.49506816267967224,
      -0.4322652220726013,
      0.12286173552274704,
      0.9105068445205688,
      0.6039065718650818,
      -1.3081167936325073,
      0.44975700974464417,
      -2.004760265350342,
      0.21063831448554993,
      -0.4973263442516327,
      1.9518705606460571,
      -0.2135450839996338,
      0.5883602499961853,
      0.28736528754234314,
      0.5085251331329346,
      0.19214339554309845,
      0.3330208659172058,
      -0.3280506134033203,
      0.68116694688797,
      0.11448100954294205,
      -0.748257577419281,
      0.9777892231941223,
      0.33637070655822754,
      0.14973023533821106,
      0.18505531549453735,
      0.7149679660797119,
      1.0559847354888916,
      -0.1422295868396759,
      -0.8873248100280762,
      0.5455769300460815,
      -0.19693520665168762,
      -0.028727130964398384,
      -0.3059862554073334,
      -0.7714700698852539,
      0.2500872313976288,
      -0.429051011800766,
      -0.7072925567626953,
      -0.4839009940624237,
      -0.5073434710502625,
      0.6147500872612,
      0.2448754906654358,
      -0.09705114364624023,
      0.6380929946899414,
      -0.13547350466251373,
      -0.8953201770782471,
      -0.32378914952278137,
      0.373305082321167,
      -0.5555539727210999,
      0.633120059967041,
      0.955662727355957,
      -0.23091809451580048,
      0.8877434134483337,
      0.8451272249221802,
      0.17028580605983734,
      -0.4218684434890747,
      0.7079434990882874,
      0.10630272328853607,
      0.9454130530357361,
      0.9711467623710632,
      0.22018294036388397,
      -1.6061770915985107,
      0.303497314453125,
      -1.0846117734909058,
      0.5281985402107239,
      0.594160795211792,
      -0.35280853509902954,
      -0.029919011518359184,
      0.36398667097091675,
      0.3137912154197693,
      -0.5821935534477234,
      0.2977582514286041,
      -0.7571553587913513,
      -1.4959441423416138,
      0.3695777654647827,
      1.0295872688293457,
      0.7755815386772156,
      0.3624083697795868,
      -0.28972578048706055,
      0.425690621137619,
      -0.15603554248809814,
      -0.05914889648556709,
      0.22314170002937317,
      -0.06161760911345482,
      -0.23595283925533295,
      -0.9410160183906555,
      -0.8812442421913147,
      0.005244663450866938,
      -0.138612300157547,
      1.540440320968628,
      -0.7957208156585693,
      0.6469881534576416,
      -0.6395713090896606,
      -0.11516542732715607,
      -0.5066565871238708,
      -0.5153315663337708,
      -0.1597375124692917,
      -0.7261143922805786,
      -1.1829581260681152,
      1.0180906057357788,
      -0.17381514608860016,
      -0.45938900113105774,
      -0.11004078388214111,
      -0.17166484892368317,
      -0.9711959958076477,
      0.06670968234539032,
      -1.0612848997116089,
      0.1027185469865799,
      -1.3511929512023926,
      1.5491372346878052,
      -0.7629420757293701,
      -0.39992302656173706,
      -0.7655559778213501,
      -0.5418020486831665,
      -0.5516892671585083,
      -0.7565922737121582,
      -1.2470463514328003,
      0.5411268472671509,
      0.6517308950424194,
      0.7523298859596252,
      -0.68711918592453,
      0.20916812121868134,
      -0.9403563141822815,
      1.6801475286483765,
      -0.47157058119773865,
      -0.08998779207468033,
      0.010294483043253422,
      0.1676979511976242,
      -0.5796738266944885,
      -0.2847687602043152,
      -1.0397266149520874,
      0.18327899277210236,
      -0.31382253766059875,
      0.9411560893058777,
      0.7311245203018188,
      0.033541157841682434,
      -0.14858107268810272,
      -0.753297746181488,
      0.795962929725647,
      0.105755515396595,
      0.2889242470264435,
      -0.6899824738502502,
      0.06889648735523224,
      -0.25491759181022644
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SL",
      "level3": "F, F, IC-1",
      "leafContractCategory": "Comb. of SAM(Level 3) and AMO(Level 2)",
      "rootCause": "Missing Options",
      "effect": "IF",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "NA",
      "reasonsForLabeling": "Level 1 (Central Contract Category): Hybrid\nThe issue involves modifying a pre-trained VGG16 model by interacting with multiple Keras API methods (pop(), Model, layers), leading to a hybrid contract violation.\n\nLevel 2: SL (Selection Issue)\nThe user incorrectly selects pop() for removing layers from a functional model (VGG16), which does not work as expected.\n\nLevel 3 (Hybrid Patterns): F (Eventually Required Condition), F (Eventually Required Condition), IC-1 (Intra-argument Contract)\nThe functional model structure requires explicit modifications using include_top=False instead of pop(), and inter-argument dependencies must be preserved.\n\nLeaf Contract Category: Combination of SAM (Level 3) and AMO (Level 2)\nThe violation arises due to single API misuse (pop()) and incorrect method dependencies (include_top should be set properly).\n\nRoot Cause: Missing Options\nThe user failed to use the include_top=False argument, which is required to modify the pre-trained model correctly.\n\nEffect: IF (Incorrect Functionality)\nThe model still expects the original output shape, leading to incorrect behavior when trying to modify layers.\n\nML Library: Keras\nThe issue is specific to modifying pre-trained Keras models.\n\nContract Violation Location: Model Construction\nThe error occurs while modifying the model architecture.\n\nDetection Technique: Static\nThe incorrect use of pop() with functional API models can be identified through static analysis by verifying that layer modifications properly reflect in the model structure."
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/44627977",
    "title": "",
    "question": "\"I'm trying to build a model as ilustrated in below diagram. The idea is to take more than one categorical features (one-hot vectors) and embed them separately, then combine those embedded vectors with a 3D tensor for a LSTM.\n\nWith following code in Keras2.0.2, when creating the Model() object with multiple inputs, it raises an AttributeError: 'NoneType' object has no attribute 'inbound_nodes' similar to this question. Can anyone help me to figure out what's the problem?\n\nModel:\n\nCode:\n\nfrom keras.layers import Dense, LSTM, Input\nfrom keras.layers.merge import concatenate\nfrom keras import backend as K\nfrom keras.models import Model\n\ncat_feats_dims = [315, 14] # Dimensions of the cat_feats\nemd_inputs = [Input(shape=(in_size,)) for in_size in cat_feats_dims]\nemd_out = concatenate([Dense(20, use_bias=False)(inp) for inp in emd_inputs])\nemd_out_3d = K.repeat(emd_out, 10)\n\nlstm_input = Input(shape=(10,5))\n\nmerged = concatenate([emd_out_3d,lstm_input])\n\nlstm_output = LSTM(32)(merged)\ndense_output = Dense(1, activation='linear')(lstm_output)\n\nmodel = Model(inputs=emd_inputs+[lstm_input], outputs=[dense_output])\n\n#ERROR MESSAGE\nTraceback (most recent call last):\n  File \"\"C:\\Program Files\\Anaconda2\\envs\\mle-env\\lib\\site-packages\\IPython\\core\\interactiveshell.py\"\", line 2881, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"\"\"\", line 14, in \n    model = Model(inputs=emd_inputs+[lstm_input], outputs=[dense_output])\n  File \"\"C:\\Program Files\\Anaconda2\\envs\\mle-env\\lib\\site-packages\\keras\\legacy\\interfaces.py\"\", line 88, in wrapper\n    return func(*args, **kwargs)\n  File \"\"C:\\Program Files\\Anaconda2\\envs\\mle-env\\lib\\site-packages\\keras\\engine\\topology.py\"\", line 1648, in __init__\n    build_map_of_graph(x, seen_nodes, depth=0)\n  File \"\"C:\\Program Files\\Anaconda2\\envs\\mle-env\\lib\\site-packages\\keras\\engine\\topology.py\"\", line 1644, in build_map_of_graph\n    layer, node_index, tensor_index)\n  File \"\"C:\\Program Files\\Anaconda2\\envs\\mle-env\\lib\\site-packages\\keras\\engine\\topology.py\"\", line 1644, in build_map_of_graph\n    layer, node_index, tensor_index)\n  File \"\"C:\\Program Files\\Anaconda2\\envs\\mle-env\\lib\\site-packages\\keras\\engine\\topology.py\"\", line 1639, in build_map_of_graph\n    next_node = layer.inbound_nodes[node_index]\nAttributeError: 'NoneType' object has no attribute 'inbound_nodes'\"",
    "answer": "\"keras.backend.repeat is a function, not a layer. Try using keras.layers.core.RepeatVector instead. It has the same functionality as the function.\n\nemd_out_3d = RepeatVector(10)(emd_out)\"",
    "mlApiName": "keras.layers.RepeatVector",
    "embedding": [
      0.1290173977613449,
      0.8700963258743286,
      -2.2571089267730713,
      -0.8705036640167236,
      0.9738578200340271,
      -0.13648879528045654,
      -0.28239890933036804,
      0.8281176686286926,
      -1.1598830223083496,
      -0.8507964015007019,
      -0.5459505915641785,
      0.6748743653297424,
      2.2631888389587402,
      0.010573707520961761,
      -0.2690868675708771,
      -0.13497406244277954,
      0.18558450043201447,
      0.8466491103172302,
      0.13735425472259521,
      0.8815019130706787,
      -0.2755068838596344,
      0.3942779302597046,
      0.6136660575866699,
      -0.47973179817199707,
      1.7072292566299438,
      0.19643571972846985,
      0.19250309467315674,
      0.22398386895656586,
      -0.3476751744747162,
      -0.27870047092437744,
      0.9141083359718323,
      -0.011781144887208939,
      0.09629657119512558,
      -0.8182048797607422,
      -1.1307681798934937,
      -0.07362282276153564,
      1.0301034450531006,
      -0.03625029698014259,
      -0.14357423782348633,
      0.06792230159044266,
      0.781976580619812,
      -0.013550693169236183,
      0.15847007930278778,
      0.39827385544776917,
      -0.2114279866218567,
      0.09205611050128937,
      1.7211607694625854,
      0.43910524249076843,
      0.5278422236442566,
      -0.9632836580276489,
      0.34004631638526917,
      0.7479406595230103,
      0.12364159524440765,
      -0.10842645913362503,
      1.4605458974838257,
      0.36464422941207886,
      0.32988065481185913,
      0.3644014596939087,
      1.576185703277588,
      -0.62717205286026,
      -0.2993425726890564,
      1.1061604022979736,
      -1.0728062391281128,
      1.9063715934753418,
      0.8169053196907043,
      -0.6326650977134705,
      -1.007763385772705,
      0.9382449984550476,
      -0.9564540386199951,
      -0.08689524233341217,
      0.3874668776988983,
      -0.15512864291667938,
      0.5377610921859741,
      -0.07266132533550262,
      -0.36108332872390747,
      0.2339324802160263,
      -0.5328887104988098,
      -0.015348482877016068,
      0.02379382960498333,
      0.5314456224441528,
      -0.3299816846847534,
      1.4421765804290771,
      1.5228090286254883,
      -0.32853713631629944,
      0.38896292448043823,
      0.7588850855827332,
      -1.0694429874420166,
      -0.5775926113128662,
      -1.1855539083480835,
      1.1750409603118896,
      0.0876605436205864,
      -0.15929143130779266,
      -0.4641042649745941,
      0.4069426953792572,
      -0.3112812638282776,
      -0.7514812350273132,
      -0.1324167102575302,
      -0.15117590129375458,
      -0.6433600187301636,
      -0.5510616898536682,
      -0.6081158518791199,
      0.5950360894203186,
      -0.7593293190002441,
      -1.030638337135315,
      0.5644474029541016,
      1.3306937217712402,
      -0.05980280786752701,
      -0.20438101887702942,
      0.09297496825456619,
      0.16930034756660461,
      -0.7986671328544617,
      -0.14370280504226685,
      -0.08920412510633469,
      -0.0913177952170372,
      0.07580270618200302,
      -0.6474885940551758,
      0.2765793204307556,
      -0.028810586780309677,
      -0.2366720736026764,
      -0.15229707956314087,
      -0.15351004898548126,
      -1.0592786073684692,
      0.7843306660652161,
      0.3555055558681488,
      0.26553937792778015,
      1.5413832664489746,
      -0.08220289647579193,
      -0.565666139125824,
      -0.3786860704421997,
      -1.217365026473999,
      0.3987531065940857,
      -0.09656792134046555,
      -0.13229960203170776,
      -0.13635729253292084,
      0.33398470282554626,
      0.663592517375946,
      -1.0180299282073975,
      -0.8860387802124023,
      0.8983967304229736,
      0.48365235328674316,
      0.4975084364414215,
      0.05495041236281395,
      -0.20442035794258118,
      -0.9098650217056274,
      0.6736602187156677,
      -0.4277706742286682,
      0.9028086066246033,
      -0.7028855681419373,
      -0.36249998211860657,
      0.08207820355892181,
      0.040099214762449265,
      1.4985476732254028,
      -1.0482717752456665,
      -0.16246835887432098,
      0.24867157638072968,
      -0.5583651065826416,
      0.756232500076294,
      0.6439496278762817,
      0.6918366551399231,
      -0.6191731691360474,
      1.4776753187179565,
      0.5639318823814392,
      0.10463186353445053,
      0.4607549011707306,
      0.44285285472869873,
      -0.9679787755012512,
      0.13394702970981598,
      0.28180256485939026,
      0.24518486857414246,
      0.46651691198349,
      -0.7872533202171326,
      -0.7130942940711975,
      -0.18873482942581177,
      -0.0075353882275521755,
      -0.03980330005288124,
      0.8506694436073303,
      1.2096936702728271,
      -0.6189393401145935,
      0.9486716985702515,
      -0.26030367612838745,
      0.5867328643798828,
      0.05735444277524948,
      0.4032742977142334,
      -0.19118574261665344,
      -0.38466355204582214,
      0.050768204033374786,
      -0.2798718214035034,
      0.14227524399757385,
      -0.5347283482551575,
      -0.6745315194129944,
      0.6027956604957581,
      -0.17455533146858215,
      -0.4768887460231781,
      -0.059425417333841324,
      0.2136923223733902,
      0.0628833994269371,
      1.3636281490325928,
      -1.050877571105957,
      0.7913697361946106,
      -0.3011219799518585,
      0.18034628033638,
      0.7676357626914978,
      -0.2258903980255127,
      1.2100954055786133,
      -0.882191002368927,
      1.018707275390625,
      -1.4072396755218506,
      1.0510421991348267,
      -0.186561718583107,
      0.1787303388118744,
      0.632237434387207,
      -0.14502984285354614,
      0.016861869022250175,
      0.220036581158638,
      0.06628476828336716,
      -0.7891657948493958,
      1.0370988845825195,
      -0.6441152095794678,
      -0.2205023467540741,
      -0.4797964096069336,
      0.27406036853790283,
      -0.4750179648399353,
      0.8313384652137756,
      0.0607837475836277,
      0.15903684496879578,
      -0.5415161848068237,
      0.72697913646698,
      -0.13621743023395538,
      -0.7783463597297668,
      -0.4236568212509155,
      -0.9091044068336487,
      -0.7620304822921753,
      0.46722856163978577,
      -0.2617613971233368,
      -0.08883274346590042,
      0.3108680248260498,
      0.8961033821105957,
      0.7955060601234436,
      -0.6783855557441711,
      -0.2000746876001358,
      0.2786252796649933,
      0.27916544675827026,
      0.2989855408668518,
      -0.2864413261413574,
      -0.4251062870025635,
      0.14291098713874817,
      0.16434112191200256,
      -0.5701653957366943,
      0.154524028301239,
      1.2651803493499756,
      0.3014528453350067,
      -0.24546562135219574,
      0.3636366128921509,
      0.5503299832344055,
      0.8378167748451233,
      -0.5028315186500549,
      -0.1810310184955597,
      -0.41348424553871155,
      0.43229198455810547,
      -0.4296134114265442,
      0.6840454339981079,
      0.09450909495353699,
      -0.07307690382003784,
      -0.3563240170478821,
      -0.9862119555473328,
      -0.6497517824172974,
      -0.050630129873752594,
      -0.29339849948883057,
      0.8363550901412964,
      -0.34422945976257324,
      -0.5438461899757385,
      0.5093759298324585,
      0.3748897314071655,
      0.6289907693862915,
      0.8955361247062683,
      1.1122115850448608,
      -0.4745071828365326,
      -0.3580174744129181,
      -0.03499068319797516,
      0.10593000799417496,
      -0.5540485382080078,
      -0.7392880916595459,
      -0.38144558668136597,
      0.10964395850896835,
      -0.9174653887748718,
      0.3322942852973938,
      -0.00808789674192667,
      0.4789334237575531,
      0.46368271112442017,
      0.6860836148262024,
      -0.06836067885160446,
      -0.0856560543179512,
      -0.39011266827583313,
      0.19716677069664001,
      -0.2299351841211319,
      -0.013825989328324795,
      0.5204118490219116,
      -0.4376188814640045,
      -0.23268453776836395,
      -0.7459374070167542,
      0.827022135257721,
      0.7182016968727112,
      0.937423050403595,
      0.5390141606330872,
      -0.04587129130959511,
      -0.049429696053266525,
      0.10949499905109406,
      -0.1695348620414734,
      0.26577794551849365,
      -0.3415427505970001,
      -0.34096673130989075,
      -0.6096478700637817,
      0.020136356353759766,
      0.3053879141807556,
      0.13301320374011993,
      -0.18788689374923706,
      0.22656960785388947,
      0.5486082434654236,
      0.16162757575511932,
      -1.1492388248443604,
      -0.251968115568161,
      -0.019935963675379753,
      0.0054502724669873714,
      0.007752481382340193,
      -0.24084928631782532,
      1.0059080123901367,
      -0.10629433393478394,
      -0.017664330080151558,
      0.6166676878929138,
      -0.21396934986114502,
      -0.015675541013479233,
      0.3804316818714142,
      1.0452109575271606,
      -0.6942301392555237,
      -0.7259392142295837,
      -0.6295069456100464,
      -0.5754604935646057,
      0.02816816046833992,
      0.37108731269836426,
      1.2397006750106812,
      -0.29522037506103516,
      0.00941398274153471,
      0.4670329988002777,
      -0.3087517321109772,
      0.27102500200271606,
      0.38728854060173035,
      -1.7396512031555176,
      -0.3977198600769043,
      0.5508552193641663,
      0.21855665743350983,
      -0.04191574454307556,
      0.4349462389945984,
      0.42791634798049927,
      -0.13321059942245483,
      -0.08775938302278519,
      -0.4827970266342163,
      0.7566593885421753,
      -0.5441399812698364,
      -0.37449949979782104,
      0.19860337674617767,
      0.772708535194397,
      -0.30015119910240173,
      -0.06673580408096313,
      -0.19114309549331665,
      -0.07302136719226837,
      0.5396580100059509,
      1.7575383186340332,
      0.4196853041648865,
      1.3082867860794067,
      -0.1092018410563469,
      0.26176485419273376,
      -0.5576890707015991,
      -0.7452417016029358,
      -0.0059084203094244,
      -0.08388300985097885,
      -0.3715711534023285,
      -0.6642215847969055,
      -0.010201054625213146,
      -0.35891562700271606,
      -0.002086581429466605,
      0.21662138402462006,
      -0.42209142446517944,
      0.2761586606502533,
      -0.11983712017536163,
      0.7069644331932068,
      0.9430766701698303,
      0.6862243413925171,
      -0.25239068269729614,
      -0.10547446459531784,
      1.183988094329834,
      -0.07491108775138855,
      0.3284512162208557,
      -0.95482337474823,
      -0.8183087706565857,
      0.6522305607795715,
      -0.5058719515800476,
      1.0372272729873657,
      0.07396567612886429,
      0.1289234608411789,
      0.5706311464309692,
      -1.1105421781539917,
      -0.5200124382972717,
      -0.4391314387321472,
      -0.5929498672485352,
      -0.06823388487100601,
      -0.7215310335159302,
      0.2447185218334198,
      -0.12193146347999573,
      0.1789555698633194,
      0.05458877235651016,
      0.15517935156822205,
      0.46041664481163025,
      -0.043781083077192307,
      -1.0800814628601074,
      0.6010778546333313,
      -0.3778987526893616,
      0.8424376249313354,
      0.3589598536491394,
      -1.0510404109954834,
      -1.220617413520813,
      -0.4104822874069214,
      0.7456795573234558,
      -0.219985693693161,
      -0.2081638127565384,
      1.1070047616958618,
      0.41804003715515137,
      0.6910816431045532,
      1.3415124416351318,
      -0.2030503898859024,
      -1.2615635395050049,
      0.15869899094104767,
      0.44585567712783813,
      0.4614754915237427,
      -0.5901616215705872,
      -0.3893541991710663,
      0.08758341521024704,
      -0.653691291809082,
      1.197783350944519,
      -0.41247639060020447,
      0.9684861898422241,
      1.0612411499023438,
      -0.8227084875106812,
      -0.38499200344085693,
      -0.49265095591545105,
      0.49059438705444336,
      0.30050626397132874,
      0.8301901817321777,
      -0.8945004343986511,
      -1.5341811180114746,
      1.1563053131103516,
      -0.29589012265205383,
      0.07719104737043381,
      0.15092450380325317,
      0.16582563519477844,
      1.470445990562439,
      0.21189911663532257,
      -0.007658050395548344,
      -0.46490466594696045,
      -0.4428384602069855,
      -0.12390328198671341,
      0.30527395009994507,
      0.032663390040397644,
      -1.6821166276931763,
      -0.16001349687576294,
      -0.15811008214950562,
      -0.8804972767829895,
      -0.7136406302452087,
      0.42216944694519043,
      0.32784220576286316,
      0.7396056652069092,
      -0.15658801794052124,
      0.07297815382480621,
      0.4789685308933258,
      -0.083777517080307,
      0.6699755787849426,
      0.828801155090332,
      0.3180713355541229,
      -0.006266019772738218,
      0.37463441491127014,
      -0.06910426914691925,
      0.03613796830177307,
      -1.216720700263977,
      -0.38574114441871643,
      -0.8139103055000305,
      -0.22808825969696045,
      1.5803316831588745,
      -0.04915580153465271,
      0.2796337902545929,
      0.15236836671829224,
      0.24995467066764832,
      0.44355231523513794,
      -0.5427383184432983,
      -0.40425431728363037,
      -0.2919595241546631,
      -0.2138131558895111,
      -0.5750176906585693,
      0.14761103689670563,
      0.6508743762969971,
      0.19748817384243011,
      0.47608956694602966,
      -0.2598434388637543,
      0.02871868386864662,
      -0.7598792910575867,
      0.0935802236199379,
      0.9100939631462097,
      -0.257493257522583,
      0.8102763891220093,
      -0.9766238927841187,
      0.15142092108726501,
      -0.4028233289718628,
      0.2055162638425827,
      0.12709426879882812,
      0.16522234678268433,
      0.4360487759113312,
      0.03558932617306709,
      -0.7810268998146057,
      -0.05603674054145813,
      -0.18100742995738983,
      -0.9272875785827637,
      -0.1310756653547287,
      0.5784854888916016,
      -0.5190505981445312,
      -0.3536468744277954,
      -0.9441083669662476,
      -0.6507123708724976,
      0.834028959274292,
      0.8976094126701355,
      -1.483998417854309,
      -0.14597012102603912,
      0.026568403467535973,
      0.22729076445102692,
      0.16689012944698334,
      -1.3398723602294922,
      -0.10266103595495224,
      0.7200869917869568,
      -0.564879834651947,
      -0.05166149511933327,
      0.6011413335800171,
      0.03677807375788689,
      -0.26304611563682556,
      0.6492042541503906,
      0.7732043862342834,
      -0.661930501461029,
      -0.6406083703041077,
      -1.1620420217514038,
      0.1752907633781433,
      0.5483949780464172,
      0.5500556826591492,
      0.6173949837684631,
      -0.7871814370155334,
      -0.4492378532886505,
      -1.5467926263809204,
      0.47520712018013,
      -1.075565218925476,
      0.07677657157182693,
      -0.933881938457489,
      -0.8828039169311523,
      -0.6105219721794128,
      -0.10204117000102997,
      -0.8459519743919373,
      -0.6166073083877563,
      0.4070305824279785,
      1.7105717658996582,
      0.015750112012028694,
      -0.4197261929512024,
      -0.5994998812675476,
      -0.7098626494407654,
      0.8296809196472168,
      0.3091370165348053,
      0.006357803009450436,
      0.20778720080852509,
      -1.3710026741027832,
      0.11289910227060318,
      0.4353627860546112,
      0.21647679805755615,
      0.3233148455619812,
      0.9524891376495361,
      0.49978017807006836,
      -0.35135194659233093,
      -0.5157155990600586,
      0.44674816727638245,
      -0.795408308506012,
      0.17489056289196014,
      -0.35009750723838806,
      -0.08138736337423325,
      0.1641794592142105,
      -0.5085042119026184,
      -0.9615261554718018,
      0.42111921310424805,
      -0.2081417739391327,
      -0.429473876953125,
      0.28839293122291565,
      0.7709973454475403,
      -0.0015567441005259752,
      -0.33794525265693665,
      -0.13296104967594147,
      -0.4652767479419708,
      0.5870742797851562,
      -0.6705843210220337,
      -1.2461258172988892,
      -0.3796616792678833,
      0.700964629650116,
      1.3213849067687988,
      -0.688385546207428,
      0.0681343525648117,
      1.1946431398391724,
      -0.6771742105484009,
      -0.04525940865278244,
      -0.7676643133163452,
      0.925721287727356,
      0.8270480632781982,
      -0.6511850953102112,
      -0.33717769384384155,
      0.18158137798309326,
      0.5439024567604065,
      -0.4944199323654175,
      0.7270326018333435,
      0.22405698895454407,
      -0.08602843433618546,
      -0.5321145057678223,
      -0.7325002551078796,
      -0.3670080602169037,
      0.6433813571929932,
      -0.5740534067153931,
      0.28041568398475647,
      -0.8614473342895508,
      -0.7693327069282532,
      -0.2804214060306549,
      -0.23181907832622528,
      0.46889346837997437,
      -1.0541049242019653,
      -0.1430278718471527,
      -1.760799765586853,
      -0.307423859834671,
      -1.2006992101669312,
      0.9820955991744995,
      0.0807293951511383,
      0.57432621717453,
      1.0351758003234863,
      1.0046379566192627,
      -0.023211834952235222,
      0.34609660506248474,
      -0.4538686275482178,
      0.9532856345176697,
      0.7168433666229248,
      -1.5103403329849243,
      0.5179145336151123,
      0.17848840355873108,
      -0.604031503200531,
      0.06447528302669525,
      0.7813836336135864,
      1.511523723602295,
      0.023181574419140816,
      -0.6144751906394958,
      0.5314621925354004,
      -0.9386749863624573,
      0.5193156003952026,
      -0.6135736703872681,
      -0.6231916546821594,
      -0.010106640867888927,
      -0.3876233398914337,
      -0.15916618704795837,
      -0.8522483110427856,
      0.09048638492822647,
      0.4902973473072052,
      0.1053299829363823,
      -0.7440472841262817,
      -0.12525391578674316,
      -0.30326053500175476,
      -1.0163105726242065,
      0.1463131606578827,
      0.7434287071228027,
      -0.06705573201179504,
      0.9131928086280823,
      0.19874903559684753,
      -0.20198941230773926,
      1.2574530839920044,
      1.222287893295288,
      0.18529409170150757,
      -0.11431652307510376,
      0.4443518817424774,
      0.21183782815933228,
      0.8457888960838318,
      0.4071010649204254,
      0.6214959621429443,
      -1.6921395063400269,
      0.27561482787132263,
      -0.974472165107727,
      -0.3062320351600647,
      -0.4364047944545746,
      0.03398273512721062,
      -0.04459911584854126,
      0.11900411546230316,
      0.05737331509590149,
      -0.5278327465057373,
      0.6362068057060242,
      0.29708001017570496,
      -0.7248350977897644,
      0.13140347599983215,
      1.0178776979446411,
      0.22457391023635864,
      -0.07526267319917679,
      0.18316200375556946,
      0.6242861747741699,
      0.4481387138366699,
      0.2873038947582245,
      0.2745929956436157,
      0.3351849317550659,
      -0.317400723695755,
      -0.31867116689682007,
      -1.0778133869171143,
      -0.06946233659982681,
      -0.6932045817375183,
      1.4916099309921265,
      0.04912669584155083,
      1.0177773237228394,
      -0.1249779760837555,
      -0.7819758057594299,
      -0.2726841866970062,
      0.04999438673257828,
      -0.401143342256546,
      -0.04820280522108078,
      -0.8776786923408508,
      0.4742678701877594,
      -0.6690203547477722,
      -0.782203197479248,
      -0.05741060525178909,
      -0.3488939106464386,
      -0.3368617594242096,
      0.4308203160762787,
      -1.184067726135254,
      -0.16425427794456482,
      -1.2971305847167969,
      1.5747555494308472,
      -0.37118783593177795,
      -0.5763036608695984,
      -0.6875492334365845,
      -0.7722915410995483,
      -0.1554090529680252,
      -0.6494521498680115,
      -0.9687961935997009,
      -0.11008604615926743,
      0.445641428232193,
      -0.16898876428604126,
      -0.9939206838607788,
      0.1232047975063324,
      -1.2590751647949219,
      1.0615938901901245,
      0.13819649815559387,
      -0.15027427673339844,
      -0.23494699597358704,
      -0.4815772473812103,
      -0.3449707627296448,
      -0.5321705937385559,
      -0.2859210968017578,
      0.16584178805351257,
      -0.15119703114032745,
      1.0377616882324219,
      1.2561984062194824,
      0.11522699892520905,
      -0.10168813169002533,
      -1.096093773841858,
      0.4066146910190582,
      -0.019589990377426147,
      -0.10449910163879395,
      -0.38408058881759644,
      -0.5394664406776428,
      -0.5571950674057007
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Evaluation",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/51632716",
    "title": "",
    "question": "\"I just recently started playing around with Keras and got into making custom layers. However, I am rather confused by the many different types of layers with slightly different names but with the same functionality. \n\nFor example, there are 3 different forms of the concatenate function from https://keras.io/layers/merge/ and https://www.tensorflow.org/api_docs/python/tf/keras/backend/concatenate\n\nkeras.layers.Concatenate(axis=-1)\nkeras.layers.concatenate(inputs, axis=-1)\ntf.keras.backend.concatenate()\n\nI know the 2nd one is used for functional API but what is the difference between the 3? The documentation seems a bit unclear on this.\n\nAlso, for the 3rd one, I have seen a code that does this below. Why must there be the line ._keras_shape after the concatenation?\n\n# Concatenate the summed atom and bond features\natoms_bonds_features = K.concatenate([atoms, summed_bond_features], axis=-1)\n\n# Compute fingerprint\natoms_bonds_features._keras_shape = (None, max_atoms, num_atom_features + num_bond_features)\n\nLastly, under keras.layers, there always seems to be 2 duplicates. For example, Add() and add(), and so on.\"",
    "answer": "\"First, the backend: tf.keras.backend.concatenate()\nBackend functions are supposed to be used \"\"inside\"\" layers. You'd only use this in Lambda layers, custom layers, custom loss functions, custom metrics, etc.\nIt works directly on \"\"tensors\"\".\nIt's not the choice if you're not going deep on customizing. (And it was a bad choice in your example code -- See details at the end).\nIf you dive deep into keras code, you will notice that the Concatenate layer uses this function internally:\nimport keras.backend as K\nclass Concatenate(_Merge):  \n    #blablabla   \n    def _merge_function(self, inputs):\n        return K.concatenate(inputs, axis=self.axis)\n    #blablabla\n\nThen, the Layer: keras.layers.Concatenate(axis=-1)\nAs any other keras layers, you instantiate and call it on tensors.\nPretty straighforward:\n#in a functional API model:\ninputTensor1 = Input(shape) #or some tensor coming out of any other layer   \ninputTensor2 = Input(shape2) #or some tensor coming out of any other layer\n\n#first parentheses are creating an instance of the layer\n#second parentheses are \"\"calling\"\" the layer on the input tensors\noutputTensor = keras.layers.Concatenate(axis=someAxis)([inputTensor1, inputTensor2])\n\nThis is not suited for sequential models, unless the previous layer outputs a list (this is possible but not common).\n\nFinally, the concatenate function from the layers module: keras.layers.concatenate(inputs, axis=-1)\nThis is not a layer. This is a function that will return the tensor produced by an internal Concatenate layer.\nThe code is simple:\ndef concatenate(inputs, axis=-1, **kwargs):\n   #blablabla\n   return Concatenate(axis=axis, **kwargs)(inputs)\n\nOlder functions\nIn Keras 1, people had functions that were meant to receive \"\"layers\"\" as input and return an output \"\"layer\"\". Their names were related to the merge word.\nBut since Keras 2 doesn't mention or document these, I'd probably avoid using them, and if old code is found, I'd probably update it to a proper Keras 2 code.\n\nWhy the _keras_shape word?\nThis backend function was not supposed to be used in high level codes. The coder should have used a Concatenate layer.\natoms_bonds_features = Concatenate(axis=-1)([atoms, summed_bond_features])   \n#just this line is perfect\n\nKeras layers add the _keras_shape property to all their output tensors, and Keras uses this property for infering the shapes of the entire model.\nIf you use any backend function \"\"outside\"\" a layer or loss/metric, your output tensor will lack this property and an error will appear telling _keras_shape doesn't exist.\nThe coder is creating a bad workaround by adding the property manually, when it should have been added by a proper keras layer. (This may work now, but in case of keras updates this code will break while proper codes will remain ok)\"",
    "mlApiName": "keras.layers.Concatenate,tf.keras.backend.concatenate",
    "embedding": [
      0.6815778017044067,
      1.1700025796890259,
      -1.7935850620269775,
      -1.3835303783416748,
      0.6009564995765686,
      -0.8262782692909241,
      0.6413751244544983,
      0.33202269673347473,
      -0.9860402941703796,
      -1.268333911895752,
      -0.6422823071479797,
      0.24912524223327637,
      2.1974434852600098,
      0.4504445791244507,
      -0.16456566751003265,
      -1.4079478979110718,
      0.5719339847564697,
      0.8404655456542969,
      0.7307726144790649,
      1.1163568496704102,
      -1.0483721494674683,
      -0.16349658370018005,
      0.5014445185661316,
      -0.12067539244890213,
      1.2815762758255005,
      0.3618949353694916,
      -0.47065407037734985,
      0.2486322522163391,
      -0.4840145707130432,
      -0.465373694896698,
      1.2060573101043701,
      -0.006888398434966803,
      0.05660092085599899,
      -0.8052563667297363,
      -0.4487820565700531,
      -1.1699126958847046,
      1.1454989910125732,
      0.037778716534376144,
      -0.4834481179714203,
      0.06678491830825806,
      0.5300686955451965,
      0.9391613006591797,
      0.05266079679131508,
      -0.15416546165943146,
      0.6515550017356873,
      -0.36478784680366516,
      0.810904860496521,
      0.11848129332065582,
      0.6655828952789307,
      -1.9415591955184937,
      0.31440040469169617,
      1.033012866973877,
      -0.4327244758605957,
      0.07143213599920273,
      1.276642084121704,
      0.2880924642086029,
      0.13415592908859253,
      0.5917849540710449,
      1.1934614181518555,
      -0.9607583284378052,
      -0.24395106732845306,
      1.7031587362289429,
      -1.0292259454727173,
      1.686976671218872,
      1.0858210325241089,
      -0.2927151024341583,
      -1.0041515827178955,
      1.313264012336731,
      -0.3300703167915344,
      -0.5972423553466797,
      0.9162142276763916,
      -0.08891282975673676,
      0.5201653242111206,
      0.7544640302658081,
      -0.1655534952878952,
      0.22995823621749878,
      -0.28662559390068054,
      -0.6581452488899231,
      0.16165359318256378,
      0.4610274136066437,
      -0.19763979315757751,
      0.53801429271698,
      1.1765919923782349,
      -0.061299726366996765,
      0.1643638163805008,
      0.7662010192871094,
      -0.6868352890014648,
      -0.6936838030815125,
      -0.5260106325149536,
      1.830477237701416,
      -0.45777350664138794,
      -0.5973710417747498,
      0.27029871940612793,
      1.2110496759414673,
      -1.4134676456451416,
      -0.9071301221847534,
      0.3409323990345001,
      0.0362839512526989,
      -0.4265384376049042,
      -0.2903657853603363,
      -0.34163254499435425,
      0.45613646507263184,
      -0.18886211514472961,
      -0.7123224139213562,
      0.39988669753074646,
      0.9428899884223938,
      -0.01138088945299387,
      -0.16011887788772583,
      -0.2186632752418518,
      -0.3705276846885681,
      -0.4063914120197296,
      0.08471569418907166,
      -0.45950043201446533,
      -0.0921887680888176,
      0.08052308857440948,
      0.08740173280239105,
      -0.43095314502716064,
      -0.37887734174728394,
      0.5716217160224915,
      0.3374563753604889,
      -0.4709235429763794,
      -0.7943254113197327,
      0.6038429141044617,
      0.07747940719127655,
      -0.1368919312953949,
      1.1417700052261353,
      -0.13625562191009521,
      -0.6130599975585938,
      0.08458825945854187,
      -1.5058950185775757,
      0.44119101762771606,
      -0.133602574467659,
      0.042227815836668015,
      0.07929317653179169,
      0.14350846409797668,
      1.1219114065170288,
      -0.9127001166343689,
      -1.2234654426574707,
      0.6391308307647705,
      -0.0722619891166687,
      0.45195525884628296,
      -0.019066696986556053,
      -0.5092135071754456,
      -0.6292343139648438,
      0.4589022696018219,
      -1.2895150184631348,
      0.5429045557975769,
      -0.4721067547798157,
      -0.4553788900375366,
      0.19908596575260162,
      0.36939865350723267,
      0.5289397835731506,
      -0.9210589528083801,
      0.4534890353679657,
      0.3713896572589874,
      -0.6517075896263123,
      0.6064298748970032,
      0.8118512034416199,
      0.5150632262229919,
      0.24311445653438568,
      1.1705255508422852,
      0.4398269057273865,
      -0.08049944788217545,
      0.4118041694164276,
      -0.48306554555892944,
      -0.8629096746444702,
      -0.06602086871862411,
      0.15387898683547974,
      -0.40169844031333923,
      0.03275885060429573,
      -0.37878257036209106,
      -0.03535952791571617,
      -0.379576176404953,
      0.11154325306415558,
      0.0109434574842453,
      1.0064181089401245,
      1.619144320487976,
      -0.909096896648407,
      0.9414122104644775,
      0.2328857034444809,
      0.09011375159025192,
      0.13982586562633514,
      -0.0313376784324646,
      -0.13534128665924072,
      -0.07859683781862259,
      0.5591458678245544,
      0.2691679894924164,
      -0.4893367290496826,
      -0.8782024383544922,
      -0.365949422121048,
      0.5422273874282837,
      -0.673495352268219,
      -0.4697257876396179,
      -0.40562868118286133,
      -0.7014665007591248,
      0.5421707034111023,
      0.4084509611129761,
      -0.5990474224090576,
      0.8126421570777893,
      0.35961130261421204,
      -0.19130729138851166,
      0.37380075454711914,
      -0.3476548194885254,
      0.9698920249938965,
      -1.0472333431243896,
      1.3731979131698608,
      -0.8331085443496704,
      0.9592351317405701,
      -0.014287170954048634,
      0.2569250464439392,
      0.8287690281867981,
      -0.4111992418766022,
      -0.1362079232931137,
      0.23983079195022583,
      0.1644449532032013,
      -0.41389378905296326,
      0.8226897120475769,
      -0.23540057241916656,
      -0.936379075050354,
      0.14506463706493378,
      0.7476735711097717,
      -0.18293999135494232,
      1.1376914978027344,
      0.09106288105249405,
      0.6049501895904541,
      -0.6600037217140198,
      0.051513221114873886,
      -0.20044121146202087,
      -1.0746207237243652,
      -0.2924080789089203,
      -0.7423151731491089,
      -1.480814814567566,
      0.7169744968414307,
      0.2535620331764221,
      -0.2956424653530121,
      0.981679379940033,
      1.0807430744171143,
      0.7066876292228699,
      -0.3227447271347046,
      0.4459231495857239,
      0.33616700768470764,
      0.3724978566169739,
      0.44280874729156494,
      0.008011126890778542,
      -0.7943335771560669,
      0.1695781648159027,
      -0.6296884417533875,
      -0.8676738142967224,
      0.5491929650306702,
      0.8538105487823486,
      0.2578011155128479,
      -0.25617870688438416,
      0.4059971272945404,
      0.6615767478942871,
      0.7933104038238525,
      -0.36061733961105347,
      -0.5917467474937439,
      -0.09325488656759262,
      0.5696833729743958,
      -0.45484909415245056,
      0.4133487343788147,
      0.6671021580696106,
      -0.02949158474802971,
      -0.44491079449653625,
      -0.8185785412788391,
      -0.6013445854187012,
      -1.0840967893600464,
      0.12574921548366547,
      0.3487723469734192,
      -0.3198299705982208,
      -0.45691967010498047,
      0.557681679725647,
      0.33904117345809937,
      0.5827592015266418,
      0.4971628785133362,
      0.2541055977344513,
      -0.0038477089256048203,
      -0.670831024646759,
      0.09204231202602386,
      -0.027066677808761597,
      -0.13510090112686157,
      -0.6575900316238403,
      -0.22974097728729248,
      -0.08087518811225891,
      -0.6123156547546387,
      1.0384020805358887,
      -0.4204481840133667,
      0.6112977862358093,
      0.3025418221950531,
      0.7535271644592285,
      0.2779991924762726,
      0.2715359926223755,
      -0.09865933656692505,
      0.059610601514577866,
      0.48660674691200256,
      0.6148294806480408,
      1.1929047107696533,
      -0.6992416381835938,
      -0.5983628630638123,
      -0.35881751775741577,
      0.3549646735191345,
      1.087043285369873,
      1.1229950189590454,
      0.7404573559761047,
      0.33982568979263306,
      0.17913803458213806,
      0.1280556470155716,
      -0.3530334234237671,
      0.3912285566329956,
      -0.0009454579558223486,
      -0.03169639781117439,
      0.18586468696594238,
      0.23115859925746918,
      0.8786255717277527,
      0.1812753975391388,
      0.43889766931533813,
      0.3955334424972534,
      0.8087894916534424,
      0.25618451833724976,
      -0.19896560907363892,
      -0.6224979758262634,
      -0.21001684665679932,
      -0.1366417407989502,
      -0.17253147065639496,
      0.195099338889122,
      0.9532999396324158,
      -0.8260571360588074,
      0.00590004026889801,
      0.392360121011734,
      -0.6760270595550537,
      0.22907352447509766,
      0.3935238718986511,
      0.269275039434433,
      -1.4980663061141968,
      -1.3405877351760864,
      -0.7512903213500977,
      -0.49323540925979614,
      -0.11018623411655426,
      0.5133242011070251,
      0.9801499247550964,
      0.08880317956209183,
      0.0325845330953598,
      0.9372575879096985,
      -0.7701514363288879,
      -0.02808219939470291,
      0.09410546720027924,
      -0.8756251931190491,
      -0.377071738243103,
      0.638963520526886,
      0.3939676284790039,
      -0.1362106055021286,
      0.30716952681541443,
      0.2656731903553009,
      -0.09638014435768127,
      -0.02586928941309452,
      -0.17836254835128784,
      0.7006688714027405,
      0.3861285150051117,
      0.09602933377027512,
      0.5212198495864868,
      0.7305351495742798,
      -0.5848553776741028,
      0.3538827896118164,
      -0.5302701592445374,
      -0.0014591775834560394,
      0.29637980461120605,
      1.5089823007583618,
      0.09140032529830933,
      0.019011996686458588,
      -0.23348075151443481,
      -0.1608482450246811,
      -0.4121624231338501,
      -0.36431124806404114,
      0.49335211515426636,
      -0.07140740007162094,
      -0.11173184216022491,
      -1.5450341701507568,
      0.1516701877117157,
      0.36191150546073914,
      -0.4295506179332733,
      0.3514840602874756,
      -0.5218955874443054,
      0.7260845899581909,
      -0.038761261850595474,
      0.40068790316581726,
      0.4718003571033478,
      0.4150591194629669,
      -0.8421664834022522,
      0.03985251858830452,
      1.2256008386611938,
      0.4687920808792114,
      -0.0740508884191513,
      -0.7310562133789062,
      -1.1366976499557495,
      0.9425513744354248,
      -0.5660365223884583,
      0.6970579624176025,
      0.3389730155467987,
      -0.5341784358024597,
      0.5721530914306641,
      -0.9990319013595581,
      -1.218670129776001,
      -0.07512833178043365,
      -0.8650408387184143,
      0.0998849868774414,
      -0.4948309361934662,
      0.379486620426178,
      -0.665631890296936,
      0.1470743864774704,
      -0.2760455310344696,
      0.23188865184783936,
      0.31590092182159424,
      -0.02318624220788479,
      -1.1408835649490356,
      1.0721417665481567,
      -0.30324891209602356,
      0.6361435055732727,
      0.7549325823783875,
      -1.2925606966018677,
      -0.665766716003418,
      -0.7050207853317261,
      0.8050029873847961,
      -0.45323899388313293,
      0.09309298545122147,
      1.0488626956939697,
      0.800696849822998,
      0.8605225682258606,
      0.930907130241394,
      -0.11932114511728287,
      -1.515855073928833,
      0.432195246219635,
      0.4652855098247528,
      0.7751827836036682,
      -0.8180285096168518,
      -0.46431076526641846,
      -0.5079345703125,
      -0.7931284308433533,
      0.8363668918609619,
      -0.6287709474563599,
      1.2782076597213745,
      0.9836573004722595,
      -0.3679427206516266,
      -0.8924200534820557,
      -0.6511279344558716,
      0.35657501220703125,
      0.4380936920642853,
      0.08818596601486206,
      -0.6797477602958679,
      -1.6636067628860474,
      0.9917441010475159,
      -0.22419250011444092,
      0.1867443323135376,
      0.6467435359954834,
      0.403431236743927,
      1.0637184381484985,
      0.05119440332055092,
      -0.04025823250412941,
      -0.6757571697235107,
      -0.6409060955047607,
      0.07084717601537704,
      -0.09601391106843948,
      0.31397125124931335,
      -0.8162075877189636,
      -0.5575537085533142,
      0.09711067378520966,
      -0.2957802414894104,
      0.11355062574148178,
      0.055171623826026917,
      -0.15525852143764496,
      0.7128797769546509,
      -0.5358861088752747,
      0.40522998571395874,
      0.41571930050849915,
      -0.2032877504825592,
      -0.07775159925222397,
      0.2646632492542267,
      0.33891764283180237,
      -0.08130133152008057,
      -0.23066671192646027,
      0.46429821848869324,
      0.0028969720005989075,
      -1.0627110004425049,
      -0.2596031725406647,
      -0.5760303735733032,
      -0.5337491631507874,
      1.2025177478790283,
      -0.37973400950431824,
      -0.4562098979949951,
      0.049475476145744324,
      0.2310565859079361,
      0.7152150273323059,
      -0.34447818994522095,
      0.33683326840400696,
      0.1401171088218689,
      -0.020084580406546593,
      -1.0049010515213013,
      0.19918973743915558,
      0.43049314618110657,
      0.7359925508499146,
      0.9567344188690186,
      0.06327119469642639,
      0.48746684193611145,
      -0.6881677508354187,
      -0.08056618273258209,
      0.6931134462356567,
      -0.5291686654090881,
      1.0563137531280518,
      -0.9500765204429626,
      0.3479745388031006,
      -0.0291697196662426,
      0.04247276112437248,
      -0.240030437707901,
      -0.6730923056602478,
      0.20150019228458405,
      0.1549764722585678,
      -0.8378812074661255,
      0.1802622526884079,
      -0.11462850868701935,
      -0.819379448890686,
      -0.26029109954833984,
      -0.4680071175098419,
      -0.21367716789245605,
      -0.34681299328804016,
      -0.6150979399681091,
      -0.6082589626312256,
      0.33516430854797363,
      0.10769496858119965,
      -1.446228265762329,
      -0.034949179738759995,
      0.08151059597730637,
      -0.39297884702682495,
      -0.08296308666467667,
      -0.45255544781684875,
      0.4935036897659302,
      0.7473478317260742,
      -0.1539536863565445,
      -0.8719472885131836,
      1.2326544523239136,
      0.668459415435791,
      0.4182323217391968,
      0.35833004117012024,
      1.1878588199615479,
      -0.4441896975040436,
      -0.19044700264930725,
      -0.5662689208984375,
      0.11789380013942719,
      0.8421590328216553,
      0.8054469227790833,
      0.6252951622009277,
      -1.4292417764663696,
      -0.20195302367210388,
      -1.5040452480316162,
      0.7618937492370605,
      -1.4077938795089722,
      0.33383050560951233,
      -0.6518455147743225,
      -0.9505341053009033,
      -0.828229546546936,
      -0.5163243412971497,
      -0.2123616635799408,
      -0.9344565868377686,
      -0.365793377161026,
      1.3781319856643677,
      -0.513139545917511,
      0.05202864855527878,
      -0.8247684836387634,
      -0.4378824830055237,
      0.2853606343269348,
      0.12886206805706024,
      0.7221145629882812,
      -0.464370995759964,
      -1.5315568447113037,
      -0.08042570948600769,
      0.18994255363941193,
      -0.007056588772684336,
      0.2043108493089676,
      0.39656510949134827,
      0.3202402591705322,
      -0.8255950808525085,
      -0.26708200573921204,
      0.8922986388206482,
      -1.0779660940170288,
      -0.22186383605003357,
      -0.5524753332138062,
      0.2140258401632309,
      0.5535839796066284,
      0.1680949479341507,
      -0.7332726716995239,
      0.12148214876651764,
      -0.4501643180847168,
      -0.30289578437805176,
      -0.6936633586883545,
      0.9084858298301697,
      -0.05145074054598808,
      0.4548715651035309,
      -0.694478452205658,
      -0.18780405819416046,
      1.2251429557800293,
      -0.1992533951997757,
      -1.595880389213562,
      0.1732056885957718,
      0.7981885075569153,
      1.5146243572235107,
      -1.0801247358322144,
      0.11271864920854568,
      1.5588326454162598,
      -0.7371805310249329,
      0.42754998803138733,
      -0.49970555305480957,
      0.5201366543769836,
      0.4935528635978699,
      -0.2330062985420227,
      -0.16140399873256683,
      -0.08208724856376648,
      -0.05953808128833771,
      -0.8327010273933411,
      0.6489171385765076,
      -0.1902732104063034,
      0.8010411262512207,
      -0.5462032556533813,
      -0.17119340598583221,
      -0.8580527901649475,
      0.7230402231216431,
      -0.5896814465522766,
      0.23804569244384766,
      -0.5843302011489868,
      -0.5751196146011353,
      -0.21134737133979797,
      -0.14419348537921906,
      0.6979619860649109,
      -0.9059873223304749,
      0.5303928256034851,
      -1.5385249853134155,
      0.23150278627872467,
      -0.8792228102684021,
      1.2145451307296753,
      -0.4616830348968506,
      0.30965566635131836,
      0.3303621709346771,
      1.3711568117141724,
      0.0991121158003807,
      0.11374794691801071,
      0.5937801599502563,
      0.9384448528289795,
      0.26257872581481934,
      -0.8654417991638184,
      0.8976262211799622,
      0.009773356840014458,
      -1.102425456047058,
      0.05176997929811478,
      0.7110872268676758,
      1.1997915506362915,
      -0.12345460802316666,
      0.4687662124633789,
      0.7320956587791443,
      -0.17240817844867706,
      0.15724967420101166,
      -0.6065590977668762,
      -1.0415326356887817,
      0.03212716057896614,
      -0.03784773126244545,
      -0.32995671033859253,
      -1.016937255859375,
      0.030391067266464233,
      0.13341651856899261,
      0.15775080025196075,
      0.3009299635887146,
      0.10789754241704941,
      -0.4005637764930725,
      -0.8902981877326965,
      0.58320152759552,
      0.6416375637054443,
      -0.26255789399147034,
      0.4064604938030243,
      0.3052149713039398,
      -0.30261558294296265,
      1.0669504404067993,
      0.6876139044761658,
      0.1912747472524643,
      -0.05703607201576233,
      0.6558839082717896,
      1.0434447526931763,
      1.0354174375534058,
      -0.17474423348903656,
      -0.34192416071891785,
      -1.0490418672561646,
      0.3778358995914459,
      -1.3343231678009033,
      -0.3713913857936859,
      -0.7633574604988098,
      0.7057086825370789,
      0.18452014029026031,
      0.2099921554327011,
      -0.1939447522163391,
      -0.46740221977233887,
      0.47638511657714844,
      0.27155205607414246,
      -1.1200023889541626,
      0.06318344920873642,
      0.6474494934082031,
      0.21760623157024384,
      -0.48847779631614685,
      0.027932211756706238,
      0.48586657643318176,
      0.5685052871704102,
      0.7028251886367798,
      -0.0196831077337265,
      0.06762843579053879,
      -0.6289910078048706,
      -0.3962710499763489,
      -0.28365615010261536,
      -0.010093375109136105,
      -0.3602886199951172,
      0.9391099214553833,
      -0.6958411931991577,
      0.8001360297203064,
      -0.06210527569055557,
      -0.8366712331771851,
      -0.3798907399177551,
      -0.07432426512241364,
      -0.33050212264060974,
      -0.5927955508232117,
      -1.4451186656951904,
      -0.09048963338136673,
      -0.9308571815490723,
      -0.12990958988666534,
      0.18799521028995514,
      -0.5988074541091919,
      -0.7603238821029663,
      0.3337962329387665,
      -1.0038731098175049,
      -0.09986160695552826,
      -1.146274209022522,
      1.5297393798828125,
      -0.710578203201294,
      -0.3292139172554016,
      -0.9119013547897339,
      -0.8504481911659241,
      -0.4731690585613251,
      -0.4339882433414459,
      -0.8436504602432251,
      0.05448015034198761,
      0.1297159045934677,
      -0.21056486666202545,
      -0.7598903179168701,
      -0.19004277884960175,
      -0.7146245837211609,
      1.4787122011184692,
      0.15804259479045868,
      -0.2609874904155731,
      -0.21975353360176086,
      -0.22359465062618256,
      -0.2567264437675476,
      -0.34201279282569885,
      -0.22180938720703125,
      -0.11586324125528336,
      -0.13927242159843445,
      1.573700189590454,
      1.0293689966201782,
      0.4867302179336548,
      0.7471914887428284,
      -0.49147921800613403,
      0.286848247051239,
      -0.01933557726442814,
      0.07552814483642578,
      -0.5785070061683655,
      -0.1892920732498169,
      -0.7676835656166077
    ],
    "label": {
      "level1": "AMO",
      "level2": "F",
      "level3": "F",
      "leafContractCategory": "F",
      "rootCause": "Missing Required State-specific Method Order",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/51421885",
    "title": "",
    "question": "\"I am getting the following error while calling the model.predict function when running a text classification model in keras. I searched the everywhere but it isn't working for me.\n\nValueError: Error when checking input: expected dense_1_input to have shape (100,) but got array with shape (1,)\n\nMy data has 5 classes and has a total of 15 examples only. Below is the dataset\n\n             query        tags\n0               hi       intro\n1      how are you       wellb\n2            hello       intro\n3        what's up       wellb\n4       how's life       wellb\n5              bye          gb\n6    see you later          gb\n7         good bye          gb\n8           thanks   gratitude\n9        thank you   gratitude\n10  that's helpful   gratitude\n11      I am great  revertfine\n12            fine  revertfine\n13       I am fine  revertfine\n14            good  revertfine\n\nThis is the code of my model\n\nfrom keras.preprocessing.text import Tokenizer\nfrom sklearn.preprocessing import LabelBinarizer\nfrom keras.models import Sequential\nimport pandas as pd\nfrom keras.layers import Dense, Activation\n\ndata = pd.read_csv('text_class.csv')\ntrain_text = data['query']\ntrain_labels = data['tags']\n\ntokenize = Tokenizer(num_words=100)\ntokenize.fit_on_texts(train_text)\n\nx_data = tokenize.texts_to_matrix(train_text)\n\nencoder = LabelBinarizer()\nencoder.fit(train_labels)\ny_data = encoder.transform(train_labels)\n\nmodel = Sequential()\nmodel.add(Dense(512, input_shape=(100,)))\nmodel.add(Activation('relu'))\nmodel.add(Dense(5))\nmodel.add(Activation('softmax'))\n\nmodel.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['acc'])\nmodel.fit(x_data, y_data, batch_size=8, epochs=10)\n\npredictions = model.predict(x_data[0])\ntag_labels = encoder.classes_\npredicted_tags = tag_labels[np.argmax(predictions)]\nprint (predicted_tags)\n\nI am not able to figure out where the problem lies and how to fix it.\"",
    "answer": "\"x_data is 2-dimensional array with shape (15, 100)\n\n  print(x_data.shape) \n\nbut x_data[0] is 1-dimensional array with shape (100, )\n\n  print(x_data[0].shape) \n\nand it makes problem.\n\nUse slicing x_data[0:1] to get it as 2-dimensional array with shape (1, 100) \n\n print(x_data[0:1].shape) \n\nand it will work\n\n predictions = model.predict(x_data[0:1])\"",
    "mlApiName": "keras.models.predict",
    "embedding": [
      -0.194346621632576,
      0.48691028356552124,
      -2.334599494934082,
      -1.2111778259277344,
      1.2313414812088013,
      -0.11842700839042664,
      -0.14892272651195526,
      0.707282304763794,
      -0.4876530170440674,
      -1.1939997673034668,
      0.3355758488178253,
      0.9012075066566467,
      2.1286492347717285,
      0.018775470554828644,
      -0.8101587891578674,
      -0.36290451884269714,
      0.46319204568862915,
      0.18462589383125305,
      -0.47964853048324585,
      1.0272388458251953,
      -0.3857240080833435,
      0.0011326766107231379,
      -0.32112613320350647,
      -0.467014342546463,
      1.026819109916687,
      0.6128329634666443,
      -0.824785053730011,
      0.6200006008148193,
      -0.3395620584487915,
      0.5718888640403748,
      0.6888706684112549,
      -0.2505066394805908,
      -0.4696320593357086,
      -0.9884679913520813,
      -1.249114990234375,
      -0.6002776026725769,
      0.9824646711349487,
      0.13583585619926453,
      0.012884342111647129,
      -0.19879022240638733,
      1.3276054859161377,
      0.16282029449939728,
      -0.019713247194886208,
      0.8771660327911377,
      0.07194285094738007,
      -0.35693755745887756,
      1.803960919380188,
      0.5041469931602478,
      0.5000046491622925,
      -0.5919552445411682,
      0.7329055070877075,
      0.05785621330142021,
      0.10338465869426727,
      0.01354882214218378,
      1.0506809949874878,
      1.3950181007385254,
      -0.10838692635297775,
      -0.20218174159526825,
      1.0660053491592407,
      -1.1542503833770752,
      0.5401214957237244,
      0.4000873565673828,
      -1.9817800521850586,
      0.8669447302818298,
      0.18186114728450775,
      -0.4170389175415039,
      -1.1154801845550537,
      0.7925217151641846,
      -0.5275695323944092,
      -0.627581000328064,
      1.0470229387283325,
      0.5758296847343445,
      -0.09988956153392792,
      0.7667459845542908,
      -0.6560263633728027,
      -0.04600464552640915,
      -0.5660930871963501,
      -0.4567333161830902,
      -0.526522696018219,
      0.6033164858818054,
      0.07355660945177078,
      1.0797449350357056,
      1.2715305089950562,
      0.024917365983128548,
      -0.1963503658771515,
      0.17518679797649384,
      -1.3235448598861694,
      -0.24767880141735077,
      -0.5256312489509583,
      1.333085536956787,
      -0.19805261492729187,
      -0.02360818162560463,
      0.3134329915046692,
      0.8622631430625916,
      -0.5376273393630981,
      -0.6470844149589539,
      -0.23600280284881592,
      -0.21321141719818115,
      -0.8791853785514832,
      -0.5738925337791443,
      -0.38641685247421265,
      0.8992601633071899,
      -0.2300824075937271,
      -1.0961735248565674,
      -0.14037112891674042,
      1.410548448562622,
      -0.05036879703402519,
      -0.1356886625289917,
      -0.4153013825416565,
      -0.7824872136116028,
      0.044276002794504166,
      0.41812390089035034,
      -0.6437580585479736,
      -0.5276864767074585,
      -0.6138216257095337,
      0.2069716900587082,
      0.7979908585548401,
      -0.6917993426322937,
      0.4734346568584442,
      -0.08786236494779587,
      0.04159091040492058,
      -0.5481897592544556,
      0.79668790102005,
      0.38961318135261536,
      -0.20594966411590576,
      1.1652249097824097,
      -0.7905391454696655,
      0.4735913574695587,
      -0.396738737821579,
      -0.5264964699745178,
      -0.22096261382102966,
      -0.19498345255851746,
      -0.47303307056427,
      0.5781407356262207,
      0.9947203993797302,
      1.3696142435073853,
      -1.0500540733337402,
      -0.40983882546424866,
      0.7439735531806946,
      0.3463544249534607,
      0.7904428839683533,
      0.4681229293346405,
      -0.09775351732969284,
      -0.8446458578109741,
      -0.061079636216163635,
      -0.9723952412605286,
      0.4078742265701294,
      -0.7848463654518127,
      -0.3371967673301697,
      -0.05558303743600845,
      0.02087816782295704,
      0.7384269833564758,
      -1.3041224479675293,
      0.15812675654888153,
      0.4988308846950531,
      0.17355746030807495,
      0.6483523845672607,
      0.5454338192939758,
      0.3698025345802307,
      -0.4403883218765259,
      1.6963714361190796,
      0.33249008655548096,
      -0.4214746654033661,
      0.7276454567909241,
      -0.37350037693977356,
      -1.252629280090332,
      0.07384888827800751,
      0.377569317817688,
      -0.6256008744239807,
      0.5824454426765442,
      -0.5399745106697083,
      -0.711091160774231,
      0.2995198667049408,
      -0.07064686715602875,
      0.3033166825771332,
      1.169937252998352,
      1.2590019702911377,
      -0.45995602011680603,
      0.6640005707740784,
      -0.09879546612501144,
      0.9949756264686584,
      0.08576235175132751,
      1.3183119297027588,
      -0.48319074511528015,
      -0.478987455368042,
      -0.17135010659694672,
      0.17058628797531128,
      0.4627598226070404,
      0.17276346683502197,
      -0.9842351078987122,
      0.44933533668518066,
      -0.4345928728580475,
      -0.5635805726051331,
      -0.5793876051902771,
      0.2907921075820923,
      -0.19194890558719635,
      0.7665015459060669,
      -0.6353043913841248,
      0.5364446043968201,
      0.23764720559120178,
      0.44263318181037903,
      0.8363908529281616,
      -1.1592427492141724,
      0.4111652970314026,
      -0.49122154712677,
      1.298981785774231,
      0.12200267612934113,
      0.2664102017879486,
      -0.24680489301681519,
      0.8023208975791931,
      0.2752029001712799,
      -0.26522132754325867,
      -0.22400221228599548,
      0.8822367787361145,
      0.34945955872535706,
      0.10522986203432083,
      0.6442842483520508,
      0.0419500432908535,
      -0.2882470190525055,
      0.3187383711338043,
      0.338805228471756,
      -0.6977071166038513,
      -0.16780097782611847,
      0.6651521921157837,
      0.15837326645851135,
      -0.5870020985603333,
      0.5504067540168762,
      0.028838442638516426,
      -0.441172331571579,
      -0.7998998761177063,
      -0.463175892829895,
      -0.7060457468032837,
      0.509680986404419,
      0.27052024006843567,
      0.059326738119125366,
      0.34593209624290466,
      0.47716301679611206,
      0.6810650825500488,
      -0.8413232564926147,
      -0.7604255080223083,
      -0.17724516987800598,
      0.6202908158302307,
      0.7218850255012512,
      0.1444471776485443,
      -0.7065778374671936,
      -0.004196653608232737,
      0.43480443954467773,
      -0.8889542818069458,
      0.4043003022670746,
      1.1953505277633667,
      0.07655639201402664,
      1.0591952800750732,
      0.8423285484313965,
      0.23507936298847198,
      1.2551264762878418,
      -0.9111273884773254,
      -0.32837817072868347,
      -0.08835193514823914,
      1.159083366394043,
      -0.3229753375053406,
      0.7406776547431946,
      0.27047199010849,
      0.019116658717393875,
      -0.48891353607177734,
      -0.3754456341266632,
      -1.3266301155090332,
      0.5398929119110107,
      0.1852836161851883,
      0.048778779804706573,
      -0.5072155594825745,
      0.38021159172058105,
      0.4491788446903229,
      0.8706027865409851,
      0.42780211567878723,
      1.0498027801513672,
      0.5785213112831116,
      -0.35519492626190186,
      -0.0678187906742096,
      0.3917427957057953,
      -0.18725340068340302,
      -0.4565499722957611,
      -0.780290961265564,
      0.3181729316711426,
      -0.07957218587398529,
      -0.1495024561882019,
      0.057072561234235764,
      -0.563430666923523,
      0.6882157325744629,
      0.6963179707527161,
      0.5038730502128601,
      -0.36999839544296265,
      0.1616939753293991,
      0.19535313546657562,
      0.2910782992839813,
      0.05766616389155388,
      0.8318125605583191,
      0.9638250470161438,
      0.3001720607280731,
      0.4784878194332123,
      -1.150970458984375,
      -0.11346254497766495,
      0.8333343863487244,
      0.7511489391326904,
      0.37856224179267883,
      0.24234230816364288,
      0.18058615922927856,
      0.38466429710388184,
      -0.07623326033353806,
      0.26125282049179077,
      -0.7072795629501343,
      -0.8212450742721558,
      -0.49393230676651,
      -0.5596224665641785,
      0.831051230430603,
      -0.7943466305732727,
      0.04708397760987282,
      -0.13934284448623657,
      0.4615267813205719,
      0.022457007318735123,
      -0.25421980023384094,
      0.45913463830947876,
      -0.17698197066783905,
      0.12359704822301865,
      0.06360901892185211,
      -0.8689533472061157,
      0.8098667860031128,
      -0.33949652314186096,
      -0.1567794233560562,
      0.9789574146270752,
      0.31038135290145874,
      0.2569892406463623,
      0.094581238925457,
      0.0008094484801404178,
      -1.2990155220031738,
      -0.9465467929840088,
      -0.32122570276260376,
      0.18494431674480438,
      0.40785953402519226,
      -0.4595547616481781,
      0.7539404630661011,
      -0.14118365943431854,
      0.10068251192569733,
      0.897703230381012,
      -0.8286994695663452,
      -0.1064344272017479,
      0.26587387919425964,
      -1.1920077800750732,
      -1.0205634832382202,
      0.705930233001709,
      0.4104611277580261,
      -0.26893350481987,
      0.4357186555862427,
      -0.05229945853352547,
      -0.09657620638608932,
      -0.1698453277349472,
      -0.08102641999721527,
      0.7372050881385803,
      -0.007627399638295174,
      -0.12107495963573456,
      0.2619028091430664,
      1.065588355064392,
      -0.1015816181898117,
      -0.1497666835784912,
      -0.6852208971977234,
      0.16356778144836426,
      0.07171201705932617,
      1.0567728281021118,
      0.0658167153596878,
      1.3094489574432373,
      -0.39953333139419556,
      0.1992911845445633,
      -1.2236167192459106,
      -0.1971408873796463,
      -0.17578639090061188,
      0.6334176063537598,
      0.15928871929645538,
      -0.7341172695159912,
      0.11769770830869675,
      -0.31976914405822754,
      0.1309112012386322,
      0.6413980722427368,
      -0.23757758736610413,
      0.09813480824232101,
      -0.19928233325481415,
      0.27489614486694336,
      0.5217333436012268,
      0.36919036507606506,
      -0.4925609529018402,
      -0.494434654712677,
      0.08165069669485092,
      0.3217136859893799,
      -0.41429397463798523,
      -0.6266856789588928,
      -0.2075687050819397,
      0.15361855924129486,
      -1.3777599334716797,
      0.9125176072120667,
      0.6382277011871338,
      -0.4043092429637909,
      0.34631016850471497,
      -1.5124859809875488,
      -0.7744037508964539,
      -0.16706891357898712,
      -0.41816678643226624,
      0.015361746773123741,
      -0.599672794342041,
      0.07718581706285477,
      -0.1359805166721344,
      -0.08034709095954895,
      0.1554209142923355,
      0.5621029138565063,
      0.8235152363777161,
      -0.33429238200187683,
      -1.4458119869232178,
      0.5749884247779846,
      0.029632411897182465,
      -0.04375123977661133,
      0.5990286469459534,
      -1.1418373584747314,
      -0.5344551205635071,
      -0.4547058343887329,
      0.8301894068717957,
      0.19618786871433258,
      0.3235783278942108,
      1.591644287109375,
      0.025408761575818062,
      0.00047519567306153476,
      0.9721134901046753,
      0.3181164562702179,
      -1.4152051210403442,
      0.3256797790527344,
      0.8128488659858704,
      0.3831162750720978,
      -0.02674025110900402,
      -0.5012492537498474,
      0.1326345056295395,
      0.11556009203195572,
      0.8349869847297668,
      -0.17163297533988953,
      0.29559507966041565,
      0.0017374827293679118,
      -0.2527651786804199,
      -1.1614820957183838,
      -0.41980597376823425,
      0.34120675921440125,
      0.17274819314479828,
      0.8031817078590393,
      -0.03399518132209778,
      -1.3659603595733643,
      1.3039754629135132,
      -0.17832334339618683,
      -0.6573729515075684,
      0.03991489112377167,
      0.2604927122592926,
      1.738281011581421,
      -0.2967560291290283,
      -0.28337016701698303,
      0.06978536397218704,
      -0.16675345599651337,
      0.6847919225692749,
      -0.12972047924995422,
      0.3327953517436981,
      -0.9748495817184448,
      0.4745211601257324,
      -0.35239580273628235,
      -1.345766305923462,
      0.059980228543281555,
      -0.7006314396858215,
      0.48903170228004456,
      0.7063225507736206,
      -1.5454150438308716,
      -0.01629580184817314,
      0.12131127715110779,
      -0.5485629439353943,
      0.16594892740249634,
      0.8981509208679199,
      -0.74355149269104,
      0.0489407517015934,
      0.16492348909378052,
      1.136710524559021,
      0.43036067485809326,
      -1.7031060457229614,
      -0.1283324509859085,
      -0.6936081647872925,
      -0.15421165525913239,
      1.4688979387283325,
      1.1547213792800903,
      -0.23814481496810913,
      0.741600751876831,
      0.20939339697360992,
      0.49975085258483887,
      -0.41040974855422974,
      -0.013412288390100002,
      -0.31939396262168884,
      -0.3994521200656891,
      -0.0767836645245552,
      -0.7602433562278748,
      0.525381326675415,
      0.0804014578461647,
      0.9000083208084106,
      -0.12069950252771378,
      -0.3354035019874573,
      -0.06465932726860046,
      -0.389762282371521,
      0.5634554624557495,
      0.18286371231079102,
      0.21575148403644562,
      -1.2750271558761597,
      0.22007136046886444,
      -0.1654871553182602,
      0.20384946465492249,
      0.6111419796943665,
      0.2592143416404724,
      0.18504999577999115,
      -0.023820701986551285,
      -1.1869208812713623,
      -0.014045744203031063,
      0.5463913083076477,
      -0.6666398048400879,
      -0.12013363838195801,
      0.49951857328414917,
      -0.44845184683799744,
      -0.28970375657081604,
      0.16128599643707275,
      -0.21795885264873505,
      0.39773133397102356,
      0.7456034421920776,
      -1.7437547445297241,
      0.1563137173652649,
      -0.517858624458313,
      0.7334722280502319,
      -0.031324099749326706,
      -1.7202229499816895,
      -0.32062891125679016,
      0.7371813654899597,
      -0.13264816999435425,
      -0.4080924391746521,
      1.3527045249938965,
      0.8412741422653198,
      -0.43285202980041504,
      0.4849792420864105,
      1.580541968345642,
      -0.13502216339111328,
      -1.3443201780319214,
      -0.22014163434505463,
      0.16188868880271912,
      -0.15011505782604218,
      0.8642544150352478,
      0.7793101072311401,
      -1.0569853782653809,
      0.4220485985279083,
      -0.6047823429107666,
      0.29482340812683105,
      -0.9891176223754883,
      0.21648482978343964,
      -0.9030668139457703,
      -0.32506459951400757,
      -0.8282755017280579,
      -0.9631142020225525,
      -0.683682918548584,
      -1.3637819290161133,
      0.3724413812160492,
      1.763564109802246,
      0.152604877948761,
      -0.1837698519229889,
      -0.2574113607406616,
      -0.6738337874412537,
      0.06903515756130219,
      0.7854762077331543,
      0.1363566666841507,
      0.001332676038146019,
      -1.4886252880096436,
      0.8597788214683533,
      0.594909131526947,
      -0.8553064465522766,
      -0.3249407708644867,
      0.9864820837974548,
      0.12933030724525452,
      -0.6441323161125183,
      -0.5481533408164978,
      0.5028367042541504,
      -1.6280980110168457,
      0.2728114128112793,
      0.27940019965171814,
      -0.2203253209590912,
      0.4392050802707672,
      0.0635957419872284,
      -0.544903576374054,
      0.08949851989746094,
      0.06003723666071892,
      -1.413644790649414,
      -0.30458736419677734,
      1.3650177717208862,
      -0.14575061202049255,
      0.14224974811077118,
      -0.3059319853782654,
      -0.447403222322464,
      0.3083883821964264,
      -0.6570756435394287,
      -1.5074011087417603,
      -0.36567026376724243,
      0.7483277320861816,
      1.4371012449264526,
      -1.279266357421875,
      0.5275330543518066,
      0.8242160677909851,
      -0.7039305567741394,
      0.19573000073432922,
      -0.23163311183452606,
      0.5834118127822876,
      0.28484874963760376,
      0.030635207891464233,
      -0.2665039300918579,
      0.40394333004951477,
      0.3832584023475647,
      -1.1087822914123535,
      1.0670331716537476,
      0.34748929738998413,
      -0.46674972772598267,
      -0.6784315705299377,
      -0.4443421959877014,
      -0.712776780128479,
      0.7726994156837463,
      -1.5905624628067017,
      0.06745303422212601,
      -0.5463629364967346,
      -0.5398707389831543,
      -0.12898030877113342,
      0.6032283306121826,
      0.39028775691986084,
      -1.6631380319595337,
      -0.14412713050842285,
      -1.3975849151611328,
      0.2089589685201645,
      -0.9061151146888733,
      0.8697007298469543,
      -0.7875770926475525,
      1.326613187789917,
      0.9314284920692444,
      1.1004116535186768,
      0.050837185233831406,
      -0.06252331286668777,
      -0.5307326912879944,
      0.414846271276474,
      -0.5274794697761536,
      -0.5785647034645081,
      0.7850806713104248,
      1.0205564498901367,
      -0.2261054366827011,
      -0.2737276256084442,
      1.3421473503112793,
      0.46947312355041504,
      -0.12604257464408875,
      -0.5504441857337952,
      0.8756797909736633,
      -0.43727371096611023,
      0.4077948331832886,
      -0.9433888792991638,
      -0.8220030665397644,
      0.1363516002893448,
      0.2737691402435303,
      -0.5339106917381287,
      -0.6617856621742249,
      -0.2548253834247589,
      0.43475866317749023,
      -0.2129608392715454,
      -0.523747444152832,
      -0.13797825574874878,
      -0.4795747697353363,
      -1.5847669839859009,
      -0.019482210278511047,
      0.6826692223548889,
      0.5106903314590454,
      0.5950925946235657,
      0.7805795073509216,
      -0.07902154326438904,
      1.0199989080429077,
      0.4559769332408905,
      0.779105544090271,
      -0.25879424810409546,
      0.4279073178768158,
      0.2535403370857239,
      0.7880406975746155,
      0.5934766530990601,
      0.4269702732563019,
      -0.9270468950271606,
      0.2883370518684387,
      -0.660230815410614,
      -0.14685703814029694,
      -0.297176331281662,
      -0.1608303040266037,
      -0.44838234782218933,
      0.23351532220840454,
      0.01097853109240532,
      -0.3992989957332611,
      -0.02602425403892994,
      -0.7300925850868225,
      -0.4840850234031677,
      0.36736512184143066,
      0.5515519976615906,
      -0.312221884727478,
      0.40726521611213684,
      -0.05162835866212845,
      0.6280562877655029,
      -0.4383156895637512,
      -0.15747693181037903,
      0.35904011130332947,
      -0.4844418168067932,
      -0.02888640947639942,
      -0.8214653134346008,
      -0.09178562462329865,
      0.17063139379024506,
      -0.3028993308544159,
      1.3218183517456055,
      -0.4192729592323303,
      0.6361619830131531,
      -0.056754667311906815,
      -0.751296877861023,
      -0.2902173399925232,
      -0.6616814732551575,
      -0.30337604880332947,
      -0.6236479878425598,
      -0.5584127306938171,
      0.6260772943496704,
      -0.61110520362854,
      -1.126957893371582,
      0.2702041566371918,
      -0.2227790504693985,
      -0.48297151923179626,
      -0.09641822427511215,
      -1.3181260824203491,
      0.08058112114667892,
      -1.4573167562484741,
      0.9665898680686951,
      -0.06613577157258987,
      0.48615899682044983,
      -0.40212729573249817,
      -0.9783506393432617,
      -0.7349250316619873,
      -0.2711080014705658,
      -0.7631080150604248,
      1.332260012626648,
      0.5175231695175171,
      0.28072696924209595,
      -0.6858371496200562,
      -1.290598750114441,
      -0.8189755082130432,
      1.3730219602584839,
      0.05824565887451172,
      -0.182819664478302,
      0.14164060354232788,
      -1.1944448947906494,
      -0.4092983305454254,
      0.2260514199733734,
      -0.6011174321174622,
      0.24928604066371918,
      -0.08086680620908737,
      0.9747505187988281,
      0.6113282442092896,
      -0.005346798337996006,
      -0.13851860165596008,
      -0.589433491230011,
      0.31123948097229004,
      0.5779374837875366,
      0.0783081129193306,
      -0.11354546993970871,
      -0.44293320178985596,
      -0.46975675225257874
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Prediction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/43178668",
    "title": "",
    "question": "\"I want to compare the computation time between different models.\nDuring the fit the computation time per epoch is printed to the console.\n\nEpoch 5/5\n160000/160000 [==============================] - **10s** ......\n\nI'm looking for a way to store these times in a similar way to the model metrics that are saved in each epoch and avaliable through the history object.\"",
    "answer": "\"Try the following callback:\n\nclass TimeHistory(keras.callbacks.Callback):\n    def on_train_begin(self, logs={}):\n        self.times = []\n\n    def on_epoch_begin(self, batch, logs={}):\n        self.epoch_time_start = time.time()\n\n    def on_epoch_end(self, batch, logs={}):\n        self.times.append(time.time() - self.epoch_time_start)\n\nThen:\n\ntime_callback = TimeHistory()\nmodel.fit(..., callbacks=[..., time_callback],...)\ntimes = time_callback.times\n\nIn this case times should store the epoch computation times.\"",
    "mlApiName": "keras.models.fit",
    "embedding": [
      0.15107157826423645,
      0.32851994037628174,
      -3.798250675201416,
      -2.5730655193328857,
      0.904318630695343,
      -0.41810542345046997,
      0.045687735080718994,
      -0.7696179747581482,
      -1.0087441205978394,
      -0.5420859456062317,
      -0.3520854413509369,
      0.10231529921293259,
      2.3945186138153076,
      1.248642086982727,
      -0.5599501729011536,
      -0.966521680355072,
      0.5039590001106262,
      0.5951471328735352,
      -0.6305602788925171,
      1.2548542022705078,
      1.501320719718933,
      -0.47697192430496216,
      -0.5567988753318787,
      -0.042077627032995224,
      0.9706987142562866,
      0.584662914276123,
      -0.3064259886741638,
      0.8608877658843994,
      -0.5607964992523193,
      0.4459570348262787,
      1.055765151977539,
      -0.05077141150832176,
      0.6155906319618225,
      -0.8246452808380127,
      -1.1008427143096924,
      -1.7136892080307007,
      0.18382185697555542,
      -0.5449562072753906,
      0.9780738353729248,
      0.2218061089515686,
      2.051098108291626,
      -0.1920071542263031,
      0.7888948917388916,
      0.7764666676521301,
      1.3067295551300049,
      -0.05357082560658455,
      1.0769460201263428,
      -0.2498907446861267,
      0.7654873728752136,
      -0.38285914063453674,
      -0.077689528465271,
      0.15518853068351746,
      0.009192255325615406,
      -0.030023884028196335,
      0.899263858795166,
      0.5348242521286011,
      1.0123674869537354,
      0.9015652537345886,
      0.46772095561027527,
      -0.814742386341095,
      0.9050832986831665,
      -0.11198912560939789,
      -0.971788227558136,
      1.2944915294647217,
      0.3977126181125641,
      -0.2146451622247696,
      -0.4437079131603241,
      0.618675947189331,
      -0.40588873624801636,
      -0.5516815781593323,
      0.4938580393791199,
      1.2558778524398804,
      -0.4145268201828003,
      -0.11893928050994873,
      -0.18131789565086365,
      0.9828501343727112,
      -0.5872594714164734,
      -0.30055639147758484,
      -0.1570664346218109,
      0.6671438217163086,
      -0.23880283534526825,
      0.9621096253395081,
      1.3659417629241943,
      -0.7534909844398499,
      0.712257981300354,
      -0.2548390030860901,
      -0.7336745262145996,
      0.09454932063817978,
      -0.171689972281456,
      0.7826370000839233,
      -1.4103596210479736,
      -0.6888787150382996,
      1.15911066532135,
      0.9105120301246643,
      -0.8489142656326294,
      -0.02056005969643593,
      -0.09182851016521454,
      0.6938676834106445,
      -1.2868863344192505,
      0.14835909008979797,
      -0.3882559835910797,
      -0.17167969048023224,
      -0.16414698958396912,
      -1.0258033275604248,
      0.33052271604537964,
      0.4014151096343994,
      -0.21096302568912506,
      -0.4620669186115265,
      0.05874615162611008,
      -1.0991458892822266,
      -0.25232964754104614,
      0.4114115834236145,
      -0.386756956577301,
      0.4468385875225067,
      -0.13419118523597717,
      -0.17966417968273163,
      0.3296860456466675,
      -0.6606672406196594,
      -0.003223834792152047,
      -0.1194818988442421,
      0.0005802139639854431,
      -0.38643789291381836,
      -0.2448342740535736,
      0.2116106003522873,
      -0.6028205156326294,
      0.9204090237617493,
      -1.0115163326263428,
      0.39631396532058716,
      -0.228023961186409,
      -1.3465381860733032,
      0.2022521197795868,
      -0.27654239535331726,
      -0.41944003105163574,
      0.24883997440338135,
      -0.17295975983142853,
      1.2681653499603271,
      -1.0895545482635498,
      -0.532037079334259,
      -0.4076244831085205,
      0.7375354170799255,
      0.6493281126022339,
      -0.6133508086204529,
      -0.2375340610742569,
      -0.5080574750900269,
      0.243905171751976,
      0.14674103260040283,
      -0.2200709879398346,
      -1.3828141689300537,
      -0.545874834060669,
      0.23053766787052155,
      0.054523080587387085,
      0.7508577108383179,
      -1.409816026687622,
      0.40199437737464905,
      0.7466882467269897,
      -0.5731627941131592,
      -0.4134913980960846,
      0.5489165782928467,
      0.2172190397977829,
      0.703439474105835,
      0.5300801992416382,
      -0.03315013647079468,
      -0.4354127049446106,
      0.8164728283882141,
      -0.585728645324707,
      -0.012981817126274109,
      -0.15487651526927948,
      0.8700769543647766,
      0.098170705139637,
      -0.6092888116836548,
      -1.0187568664550781,
      -0.5097082853317261,
      -0.16852940618991852,
      0.13121657073497772,
      0.3840726613998413,
      0.17096668481826782,
      1.0433619022369385,
      -0.9252851605415344,
      0.17177215218544006,
      -0.644691526889801,
      1.0398404598236084,
      -0.40980443358421326,
      0.9358916282653809,
      0.0006317054503597319,
      -0.8302830457687378,
      -0.6748787760734558,
      0.6168298125267029,
      0.27436646819114685,
      0.15941080451011658,
      -0.46892422437667847,
      0.5409629344940186,
      -0.5289586782455444,
      -0.128996342420578,
      -0.3493529260158539,
      -0.2032736837863922,
      -0.6832730770111084,
      0.34124046564102173,
      -0.3525519371032715,
      0.2665947377681732,
      0.23686794936656952,
      0.3862358331680298,
      0.13887399435043335,
      -0.6596562266349792,
      0.03287447616457939,
      -0.04277438670396805,
      0.7392007112503052,
      0.8943235278129578,
      0.9366911053657532,
      -0.8318898677825928,
      0.8028454184532166,
      1.1386207342147827,
      0.98881995677948,
      0.20915362238883972,
      0.4524874687194824,
      0.40310022234916687,
      -0.4430941045284271,
      0.37469905614852905,
      0.18155542016029358,
      -0.12505970895290375,
      0.6358214020729065,
      0.032208267599344254,
      -0.6686288714408875,
      1.510261058807373,
      -0.3802106976509094,
      0.8934077620506287,
      -1.130974531173706,
      -0.12394442409276962,
      0.36364832520484924,
      -0.7530953884124756,
      -0.22173920273780823,
      -0.9652053117752075,
      -0.9185802340507507,
      -0.2897304594516754,
      0.42636093497276306,
      0.04435637220740318,
      0.8536621928215027,
      0.6648174524307251,
      1.2176027297973633,
      0.052510131150484085,
      0.26726847887039185,
      0.4106135368347168,
      0.6392035484313965,
      0.259760320186615,
      -0.24671804904937744,
      -1.1219829320907593,
      0.4216036796569824,
      0.32103148102760315,
      0.031000884249806404,
      0.18178941309452057,
      1.1162210702896118,
      -0.23994116485118866,
      0.48772838711738586,
      0.21718403697013855,
      -0.13425599038600922,
      1.6692575216293335,
      -1.4745310544967651,
      0.22256243228912354,
      -0.36441200971603394,
      -0.6598082780838013,
      -0.3496933579444885,
      0.7318856120109558,
      0.02504689060151577,
      0.4210268557071686,
      -0.08564283698797226,
      0.043263379484415054,
      -1.679758071899414,
      0.2855404317378998,
      -0.7464417219161987,
      -0.1993638277053833,
      -0.16963522136211395,
      0.10028076171875,
      -0.06314395368099213,
      1.0297828912734985,
      1.0544532537460327,
      0.4487994909286499,
      -0.05299386382102966,
      0.09852679073810577,
      -0.3903169631958008,
      -0.10701167583465576,
      -0.4772716164588928,
      -0.7763166427612305,
      -1.742754578590393,
      -0.8556802272796631,
      0.07361950725317001,
      -0.5027972459793091,
      -0.5106551051139832,
      -0.5498159527778625,
      0.9236035943031311,
      0.5532830357551575,
      -0.16681891679763794,
      -0.11598104983568192,
      0.5933924317359924,
      -0.06075364723801613,
      0.47220999002456665,
      -0.4386597275733948,
      0.5949937701225281,
      0.9019556641578674,
      -0.11294077336788177,
      0.6135099530220032,
      -0.8210669755935669,
      0.7315372824668884,
      0.5771942734718323,
      0.6613883972167969,
      0.7819417715072632,
      0.4192690849304199,
      -0.5110045671463013,
      -0.15212959051132202,
      -0.19719097018241882,
      0.39865806698799133,
      -0.7221463322639465,
      -0.15831565856933594,
      0.16531464457511902,
      -0.8769471645355225,
      0.6851438283920288,
      -0.9174314141273499,
      -0.23870235681533813,
      0.139288991689682,
      -0.15841229259967804,
      -0.05114581808447838,
      -0.5467881560325623,
      0.5582992434501648,
      -1.0251356363296509,
      0.4735865294933319,
      -0.4554916024208069,
      -0.7618860006332397,
      0.6614571809768677,
      -0.7539137601852417,
      0.287723183631897,
      -0.3495119512081146,
      0.4250037372112274,
      0.5747048854827881,
      -0.024962812662124634,
      0.6268212199211121,
      -0.9510496258735657,
      -0.15770135819911957,
      0.20658405125141144,
      0.1296662539243698,
      -0.41109225153923035,
      -0.36024489998817444,
      0.6120352745056152,
      -0.5485096573829651,
      0.6832611560821533,
      0.2743719816207886,
      -0.2852829396724701,
      0.3963930606842041,
      -0.37500062584877014,
      -0.6476521492004395,
      -0.21791532635688782,
      0.7918246388435364,
      0.5785017013549805,
      -0.34885358810424805,
      -0.32065296173095703,
      -0.26849597692489624,
      -0.5847290754318237,
      0.9141641855239868,
      -0.0830436497926712,
      0.7017359137535095,
      0.4444064199924469,
      0.856689989566803,
      0.7951573133468628,
      1.149203896522522,
      0.6885762810707092,
      0.09074995666742325,
      -0.015038421377539635,
      0.07148417085409164,
      0.06974469870328903,
      0.611047625541687,
      0.79840487241745,
      1.3239294290542603,
      -0.2232474535703659,
      -0.05241667479276657,
      0.28890708088874817,
      -0.04877515882253647,
      0.7679120898246765,
      0.25936976075172424,
      0.04267483204603195,
      -0.8141448497772217,
      0.49628937244415283,
      -0.6536646485328674,
      0.6795141100883484,
      0.7190252542495728,
      -1.0210949182510376,
      0.27046999335289,
      0.3539133071899414,
      0.8113104104995728,
      -0.11027860641479492,
      0.4697195887565613,
      -0.23742201924324036,
      -0.47764885425567627,
      0.6326009631156921,
      0.44172200560569763,
      -0.7343606948852539,
      -1.0539039373397827,
      -0.6830160021781921,
      0.6441825032234192,
      -0.7921761870384216,
      0.6542988419532776,
      0.07654827833175659,
      0.09131249785423279,
      -0.12102240324020386,
      -0.44382065534591675,
      0.276632159948349,
      0.03826974704861641,
      0.04978574439883232,
      -0.8229531049728394,
      0.13188882172107697,
      -0.3095659017562866,
      -0.5689309239387512,
      0.27492883801460266,
      0.2245081067085266,
      0.16750654578208923,
      0.16322341561317444,
      -0.23661628365516663,
      -1.3068279027938843,
      -0.1617235243320465,
      0.1390158236026764,
      1.2318705320358276,
      0.7623119354248047,
      -0.272036612033844,
      -0.6937252879142761,
      0.13340136408805847,
      0.4563470780849457,
      -0.41610854864120483,
      -0.09220505505800247,
      0.4682799279689789,
      0.5070333480834961,
      -0.058025237172842026,
      1.05409574508667,
      -0.18973736464977264,
      -2.1049320697784424,
      0.33150991797447205,
      0.17179390788078308,
      1.2676281929016113,
      0.31474965810775757,
      0.0064942436292767525,
      0.1184263601899147,
      0.19346538186073303,
      0.23423653841018677,
      -0.11020191013813019,
      0.5285442471504211,
      -0.05072290450334549,
      -0.432214617729187,
      -0.48994091153144836,
      -0.364857017993927,
      -0.4482264518737793,
      0.8449314832687378,
      0.8475366830825806,
      -1.0282069444656372,
      -1.2496167421340942,
      0.8336939215660095,
      -0.1001344546675682,
      -0.19883428514003754,
      0.015059908851981163,
      1.29348623752594,
      1.1680021286010742,
      -0.3082572817802429,
      0.6929577589035034,
      0.08099222928285599,
      0.3951800763607025,
      0.6816341280937195,
      -0.6834872364997864,
      0.6984156966209412,
      -0.3380206227302551,
      0.35399162769317627,
      -0.0760672315955162,
      -1.8339914083480835,
      0.08039252460002899,
      -0.8489273190498352,
      0.2760111093521118,
      0.9651520252227783,
      -0.2411077916622162,
      -0.49583250284194946,
      0.10513418912887573,
      -0.9854254722595215,
      0.40770843625068665,
      0.7842262387275696,
      -0.15523101389408112,
      -0.46568116545677185,
      0.9617882966995239,
      1.014897108078003,
      0.5135291814804077,
      -1.475763201713562,
      -0.6795099377632141,
      0.0784120187163353,
      -0.3697860538959503,
      1.4823246002197266,
      0.8041437268257141,
      -0.3690091669559479,
      0.24427275359630585,
      -0.18008847534656525,
      0.3301004469394684,
      -0.18031096458435059,
      0.784678041934967,
      0.21291780471801758,
      0.043523456901311874,
      -0.23964761197566986,
      0.2583301067352295,
      0.5621368288993835,
      0.2774673402309418,
      -0.7855817079544067,
      0.6262238621711731,
      0.6239153742790222,
      -0.02633405290544033,
      0.27510929107666016,
      0.918323814868927,
      -0.2104945182800293,
      0.37150830030441284,
      0.14739727973937988,
      -0.779624879360199,
      0.03564424812793732,
      0.5452785491943359,
      0.6074269413948059,
      0.09492506831884384,
      0.7750661373138428,
      1.132736325263977,
      -1.301600694656372,
      0.5836607217788696,
      -0.09808231145143509,
      -0.20250150561332703,
      -0.47545844316482544,
      0.222456693649292,
      0.15442150831222534,
      -0.17716620862483978,
      0.26539769768714905,
      -0.8399673700332642,
      -0.049356263130903244,
      0.24776048958301544,
      -2.2226614952087402,
      0.71132892370224,
      -1.050649642944336,
      0.9199255108833313,
      -0.9443911910057068,
      -1.7695637941360474,
      -0.2265312373638153,
      -0.10669805854558945,
      0.18197226524353027,
      -0.8249634504318237,
      0.44230565428733826,
      0.7298617959022522,
      -0.22939802706241608,
      -0.6875792145729065,
      0.9093312621116638,
      0.012763097882270813,
      -1.0800457000732422,
      -0.32157790660858154,
      -0.142930805683136,
      -0.49826642870903015,
      0.9096031188964844,
      0.8445719480514526,
      -0.7993329167366028,
      -0.08484593033790588,
      -0.7290104627609253,
      0.7780653238296509,
      -1.4709962606430054,
      -0.16196881234645844,
      -0.5672335028648376,
      0.5109695792198181,
      -0.9143949151039124,
      -1.320155382156372,
      -0.165494903922081,
      -1.0433361530303955,
      0.6060190200805664,
      2.0147147178649902,
      0.3500095307826996,
      -0.6323003172874451,
      -0.7672308087348938,
      -0.5260542631149292,
      0.21482336521148682,
      1.144081711769104,
      0.10737340897321701,
      0.796545147895813,
      -1.7621575593948364,
      0.9201622009277344,
      0.19443829357624054,
      -0.8427422642707825,
      -0.5465165972709656,
      0.9516860246658325,
      0.2908722758293152,
      -0.9650781750679016,
      -0.8302037715911865,
      -0.4134460389614105,
      -1.4589693546295166,
      0.019321417436003685,
      0.8284156322479248,
      -0.2891792356967926,
      0.5516427755355835,
      0.42516905069351196,
      -0.46847787499427795,
      -0.04062577337026596,
      0.3405395448207855,
      -0.36183711886405945,
      -0.46776100993156433,
      0.9637319445610046,
      -0.4183370769023895,
      0.3620586097240448,
      0.6636970639228821,
      -0.6072046160697937,
      0.46549421548843384,
      -0.5135279893875122,
      -1.136497139930725,
      -0.3990750312805176,
      0.27161136269569397,
      1.5462076663970947,
      -1.6060436964035034,
      0.7413220405578613,
      1.4223425388336182,
      -1.0622851848602295,
      0.3107394576072693,
      0.4129110872745514,
      -0.5254451036453247,
      0.7169334292411804,
      -0.10493171215057373,
      0.21467594802379608,
      0.8830776810646057,
      -0.2866688668727875,
      -1.0943819284439087,
      0.9550797939300537,
      -0.09062056988477707,
      -1.0586611032485962,
      -0.17674271762371063,
      -0.027770699933171272,
      -0.05352836847305298,
      1.0372546911239624,
      -1.214198112487793,
      0.4475606381893158,
      -0.38698136806488037,
      -0.8589689135551453,
      -0.3746119737625122,
      0.33203962445259094,
      0.20401597023010254,
      -1.3593299388885498,
      0.08426458388566971,
      -1.3083539009094238,
      -0.3898507058620453,
      -0.4240635931491852,
      1.3095210790634155,
      -0.27820953726768494,
      0.7563121914863586,
      -0.4696638882160187,
      1.1428598165512085,
      0.5526065826416016,
      -0.36678698658943176,
      -0.5729441046714783,
      0.7348974347114563,
      -0.22240634262561798,
      -0.8327919244766235,
      0.7152361273765564,
      1.1844562292099,
      0.9822794795036316,
      -0.8218039870262146,
      1.2882740497589111,
      0.6572446227073669,
      0.4231938123703003,
      -0.08225133270025253,
      0.45445606112480164,
      -0.4270878732204437,
      0.4350391626358032,
      -0.91206955909729,
      -0.4087144136428833,
      -0.6517366170883179,
      0.6549608707427979,
      -0.8971830606460571,
      -0.9393889904022217,
      -0.2505163848400116,
      0.4073916971683502,
      0.2497197538614273,
      -0.9649405479431152,
      -0.5198407173156738,
      -0.515216588973999,
      -1.2366353273391724,
      0.35271599888801575,
      0.7818110585212708,
      -0.08708229660987854,
      -0.31577834486961365,
      0.11092741787433624,
      0.12137243151664734,
      0.7021673321723938,
      1.0663918256759644,
      0.5666224956512451,
      -0.07807739824056625,
      0.6785454750061035,
      -0.40475156903266907,
      0.6294324398040771,
      0.05121548846364021,
      0.6519190073013306,
      -0.917234480381012,
      -0.05907774716615677,
      -0.6305872201919556,
      -0.025401081889867783,
      -0.37287378311157227,
      -0.3974839448928833,
      0.5175277590751648,
      -0.3344360589981079,
      -0.27240437269210815,
      -0.15012027323246002,
      0.36959123611450195,
      0.08069636672735214,
      -1.4901005029678345,
      -0.26642781496047974,
      0.4263460338115692,
      0.4607551693916321,
      0.3816230893135071,
      1.01863694190979,
      0.7362621426582336,
      -0.08440978825092316,
      -0.8317928910255432,
      -0.3770240545272827,
      -0.06463906913995743,
      -0.45639723539352417,
      -0.006108625326305628,
      -0.32678061723709106,
      0.1105392575263977,
      -0.32136112451553345,
      0.4803818464279175,
      0.4183710217475891,
      0.0629727840423584,
      -0.23082993924617767,
      -0.6406970620155334,
      -0.32176411151885986,
      -0.6788297891616821,
      0.07019471377134323,
      -0.9592552185058594,
      -0.8261755108833313,
      -0.6998485922813416,
      0.015423002652823925,
      -0.08331357687711716,
      0.056573234498500824,
      -0.4934370219707489,
      -0.48028260469436646,
      0.06269591301679611,
      -0.0586855486035347,
      -0.08473794162273407,
      -0.8724591135978699,
      2.0785446166992188,
      0.36811959743499756,
      0.4691566824913025,
      -1.5426809787750244,
      0.06861203163862228,
      -1.5510706901550293,
      0.07177113741636276,
      -1.5911602973937988,
      0.1850437968969345,
      -0.21129240095615387,
      0.518633246421814,
      -0.42691555619239807,
      -1.0061695575714111,
      -0.8914330005645752,
      0.91999351978302,
      0.43575048446655273,
      -0.5007410049438477,
      0.844088613986969,
      -0.703857421875,
      -1.2819347381591797,
      -0.4787465035915375,
      -0.3700829744338989,
      0.4270707964897156,
      1.2037440538406372,
      0.8536892533302307,
      0.978877604007721,
      0.4941886067390442,
      0.05444691702723503,
      -0.08163304626941681,
      -0.1194644346833229,
      0.1747751086950302,
      0.24157418310642242,
      -0.40239250659942627,
      0.3017556071281433,
      -0.7633272409439087
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Unknown",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Train",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/49195189",
    "title": "",
    "question": "\"I have trained a keras sequential model in a linux 64 machine and saved to a .h5 file.\n\nIt this PC I can load the model and do predictions without problems.\n\nNow I'm implementing the prediction in a Raspberry Pi 3 that have installed keras, tensorflow, h5py and python3.\n\nwhen I load the model\n\nfrom keras.models import load_model\nmodel = load_model('model-0.6358.h5')\n\n, I'm getting: \n\nusr/lib/python3.4/importlib/_bootstrap.py:321: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.\nreturn f(*args, **kwds)\n\n/usr/local/lib/python3.4/dist-packages/keras/models.py:291: UserWarning: Error in loading the saved optimizer state. As a result, your model is starting with a freshly initialized optimizer.\nwarnings.warn('Error in loading the saved optimizer '\n\nBut... it looks like it predicts right.\n\nHow can I avoid that warning message?\"",
    "answer": "\"load_model first builds the saved model architecture with its saved weights and then tries to build the saved optimizer with its saved weights. \n\nHowever, you get an error message because there is a mismatch between the shape of the saved optimizer weights and the shape of the weights that the optimizer is expecting based on the architecture of the loaded model. \n\nI ran into this issue using Keras 2.1.4 when I tried to save and re-load a model that had inner submodels that were set to trainable=False. This information seems not to be preserved when you save the model, so after re-instatiating the inner submodel is set to trainable=True and the optimizer would expect more saved weights than were actually saved. If this might be the problem in your case, I described a workaround in this bug-report:\n\nSet the trainability of all the inner model layers explicitly\nRight before saving, the trainability flags of all the layers have to be set to the state that they had at model compile time\n\nIf you want to get rid of the warning and you do not need the optimizer after saving anyway, you can also save your model without the optimizer: use model.save(filename, include_optimizer=False)\"",
    "mlApiName": "keras.models.add,keras.models.save",
    "embedding": [
      0.28245803713798523,
      0.9723838567733765,
      -2.783275842666626,
      -1.0404026508331299,
      1.4881417751312256,
      0.18253163993358612,
      -0.29245904088020325,
      0.597959578037262,
      -0.9931596517562866,
      -0.8253400325775146,
      -0.786992609500885,
      0.4736510217189789,
      1.6229782104492188,
      -0.2457219660282135,
      -0.5742334127426147,
      0.011561712250113487,
      0.706820011138916,
      -0.12439236789941788,
      0.18628239631652832,
      0.8440754413604736,
      -0.19375640153884888,
      -0.47120216488838196,
      -0.3714086711406708,
      0.031153174117207527,
      0.7873948812484741,
      0.7837947010993958,
      -0.09276268631219864,
      0.410537987947464,
      -0.6324583888053894,
      0.33917129039764404,
      1.0844271183013916,
      -0.7841138243675232,
      -0.5072640776634216,
      -0.9240070581436157,
      -1.4663112163543701,
      -0.9587117433547974,
      0.9370693564414978,
      0.03675084933638573,
      -0.014146018773317337,
      -0.11201149970293045,
      0.6865613460540771,
      0.48991453647613525,
      0.12526285648345947,
      0.5304281115531921,
      -0.2101418673992157,
      -0.009381426498293877,
      1.2351975440979004,
      -0.07554177939891815,
      0.41922613978385925,
      -0.24668332934379578,
      1.121480941772461,
      0.22287783026695251,
      -0.3583938479423523,
      -0.12698780000209808,
      1.961980938911438,
      0.7715719938278198,
      0.4809877574443817,
      0.2674807608127594,
      0.5571627020835876,
      -0.8276724815368652,
      0.3300633728504181,
      0.8263663649559021,
      -0.999163806438446,
      0.9811154007911682,
      -0.3258017599582672,
      0.008360084146261215,
      -0.8484944701194763,
      1.3448941707611084,
      -0.2001473307609558,
      0.09094502031803131,
      0.9447794556617737,
      0.7614617347717285,
      -0.1481054723262787,
      0.22607429325580597,
      -0.29630568623542786,
      1.0673279762268066,
      -0.6615887880325317,
      -0.3831522762775421,
      -0.037987977266311646,
      0.45472225546836853,
      0.08364656567573547,
      1.2469830513000488,
      0.7297424077987671,
      -0.5771327614784241,
      0.047401063144207,
      0.7671207785606384,
      -1.0053726434707642,
      -0.1770591288805008,
      -0.6526063680648804,
      0.7172940969467163,
      -0.5176517963409424,
      -0.498968243598938,
      0.6417038440704346,
      0.6555624008178711,
      -1.062139630317688,
      -0.34320327639579773,
      -0.5058298110961914,
      0.3733055889606476,
      -1.038581371307373,
      -0.49214085936546326,
      0.036977123469114304,
      0.3496416509151459,
      -0.18762986361980438,
      -1.123213768005371,
      -0.0872046947479248,
      1.8346062898635864,
      0.21151410043239594,
      -0.07776247709989548,
      0.1231691762804985,
      -0.8332303762435913,
      -0.5634548664093018,
      0.4399013817310333,
      -0.1114395260810852,
      -0.2135085165500641,
      -0.7092623114585876,
      0.03340725228190422,
      0.46596598625183105,
      -0.2393592745065689,
      0.6143555045127869,
      0.14982452988624573,
      -0.1679404079914093,
      -0.6800262928009033,
      0.6331198215484619,
      0.10607455670833588,
      0.12610359489917755,
      0.5548787713050842,
      -0.9111003875732422,
      0.08444811403751373,
      0.13909350335597992,
      -0.9967202544212341,
      0.328610897064209,
      -0.6139104962348938,
      -0.9740951657295227,
      0.5840656161308289,
      1.0600812435150146,
      1.3765205144882202,
      -0.13862276077270508,
      -0.6785814762115479,
      0.8340516090393066,
      0.3436254858970642,
      0.6500397324562073,
      0.6213440299034119,
      0.3644924461841583,
      -0.23978127539157867,
      0.7563320994377136,
      -1.0658516883850098,
      0.7110599875450134,
      -0.4280233085155487,
      -0.7641814947128296,
      0.40223798155784607,
      -0.25036919116973877,
      0.8623733520507812,
      -1.180087685585022,
      0.6254217028617859,
      0.48093900084495544,
      -0.9037761688232422,
      0.1890491247177124,
      0.37405842542648315,
      0.5922888517379761,
      -0.09048154205083847,
      1.4774469137191772,
      0.32169535756111145,
      -0.23937463760375977,
      1.1097757816314697,
      -0.2855628728866577,
      -0.5321238040924072,
      -0.05230029672384262,
      -0.12993521988391876,
      -0.6514096260070801,
      0.5897527933120728,
      -0.6463062763214111,
      -0.8903638124465942,
      0.20936469733715057,
      -0.06682401150465012,
      0.6345570683479309,
      0.6626946330070496,
      1.1273614168167114,
      -0.6700937747955322,
      0.4235687851905823,
      -0.2721709609031677,
      0.5794601440429688,
      -0.48712071776390076,
      0.7179474234580994,
      0.2799025774002075,
      -1.3893015384674072,
      0.3222895860671997,
      -0.03349379450082779,
      0.4431828558444977,
      0.10469374805688858,
      -0.23936955630779266,
      0.5955525636672974,
      0.7025052905082703,
      -0.698202908039093,
      -0.8613589406013489,
      -0.11228657513856888,
      -0.33022767305374146,
      0.465891569852829,
      -0.7998802661895752,
      0.7902864813804626,
      0.5657194256782532,
      0.2530103027820587,
      0.08530955761671066,
      -1.1658426523208618,
      0.09055877476930618,
      -0.9322484135627747,
      0.6378251910209656,
      -0.16818660497665405,
      0.5223917961120605,
      -0.17560525238513947,
      0.6449715495109558,
      0.23389562964439392,
      0.17156851291656494,
      0.045502372086048126,
      0.48833510279655457,
      0.8616940975189209,
      -0.3643883466720581,
      0.4735182821750641,
      0.17449818551540375,
      -0.48989349603652954,
      0.09438382834196091,
      0.15693983435630798,
      0.07947614789009094,
      0.9264635443687439,
      0.2775336802005768,
      0.3820302188396454,
      -1.0069284439086914,
      -0.09005559980869293,
      -0.6338396668434143,
      -0.5538716912269592,
      -0.5510237216949463,
      -0.14443287253379822,
      -0.9559376239776611,
      0.32296261191368103,
      0.7911666631698608,
      -0.1785152107477188,
      0.8859723806381226,
      0.5297017693519592,
      0.4651050269603729,
      -0.48458775877952576,
      0.1777152419090271,
      0.11270837485790253,
      1.0468292236328125,
      -0.19303520023822784,
      0.34934958815574646,
      -0.840010404586792,
      0.5025286078453064,
      0.38886141777038574,
      -0.6449611783027649,
      0.5752526521682739,
      0.7546409964561462,
      -0.10700222849845886,
      0.8000586628913879,
      1.1200754642486572,
      0.07577668130397797,
      1.3249655961990356,
      -0.22473759949207306,
      -0.981536328792572,
      -0.4089386761188507,
      0.20487309992313385,
      -0.5559856295585632,
      0.5313990712165833,
      -0.45671284198760986,
      -0.2824303209781647,
      -0.4940428137779236,
      -0.21738138794898987,
      -0.3624314069747925,
      -0.12158994376659393,
      -0.013572975061833858,
      0.23981179296970367,
      -0.15572068095207214,
      -0.3254755139350891,
      0.365658700466156,
      0.6949006915092468,
      0.470707505941391,
      0.24894875288009644,
      0.4424755573272705,
      -0.26816460490226746,
      -0.00943891704082489,
      -0.1814766526222229,
      0.13907325267791748,
      -0.9685623049736023,
      -1.3422932624816895,
      -0.6992844343185425,
      -0.1264990121126175,
      -0.11421443521976471,
      -0.21099762618541718,
      -0.36339670419692993,
      0.50902259349823,
      0.17661911249160767,
      -0.05998104065656662,
      -0.29245007038116455,
      0.23226182162761688,
      -0.7700546979904175,
      0.0834510400891304,
      0.43196529150009155,
      0.6630232334136963,
      0.2947984039783478,
      -0.06367328763008118,
      -0.15057463943958282,
      -0.6161139011383057,
      0.7523602843284607,
      0.37206465005874634,
      0.81822270154953,
      0.561174750328064,
      0.11244191229343414,
      -0.020567094907164574,
      -0.3136206567287445,
      0.14561758935451508,
      0.5353565812110901,
      -0.3623528778553009,
      -0.36578091979026794,
      -0.32747000455856323,
      -0.6184900403022766,
      1.262906551361084,
      -0.7978059649467468,
      0.42705562710762024,
      0.8308550119400024,
      0.1275637298822403,
      0.11373879760503769,
      -0.9160332083702087,
      -0.26464712619781494,
      0.1182858794927597,
      0.09912696480751038,
      0.16159678995609283,
      -0.14640258252620697,
      1.2025327682495117,
      -0.3594370186328888,
      1.1357722282409668,
      0.2755172848701477,
      -0.1985304206609726,
      0.8527318835258484,
      -0.19143640995025635,
      -0.1067674309015274,
      -1.2805160284042358,
      -1.4568005800247192,
      -0.240629181265831,
      -0.41676148772239685,
      0.5026971101760864,
      0.054764412343502045,
      0.40075740218162537,
      1.0710811614990234,
      0.18334928154945374,
      0.5190473198890686,
      -0.8698861598968506,
      -0.7404906749725342,
      -0.42018452286720276,
      -0.8904795050621033,
      -1.2009811401367188,
      0.9644613862037659,
      0.4897202253341675,
      -0.5412082672119141,
      0.6211689710617065,
      0.2193305492401123,
      -0.395524263381958,
      0.1400739848613739,
      -0.2798979878425598,
      0.6593186259269714,
      0.23363396525382996,
      0.18297676742076874,
      0.43445727229118347,
      0.6894890069961548,
      -0.08919651806354523,
      0.42200395464897156,
      -0.5436057448387146,
      0.1396731287240982,
      0.10690246522426605,
      0.41267716884613037,
      -0.528468668460846,
      0.689666748046875,
      -0.3152765929698944,
      -0.251401424407959,
      -0.2457214891910553,
      -0.31788063049316406,
      0.14664556086063385,
      0.15831169486045837,
      -0.06676241755485535,
      -0.6572067141532898,
      -0.2737480700016022,
      -0.5164830684661865,
      0.401213675737381,
      0.7479358315467834,
      -0.6616160273551941,
      -0.07882020622491837,
      -0.25292912125587463,
      0.5552884340286255,
      0.6456336975097656,
      0.6425579190254211,
      -0.9762566685676575,
      -0.13148321211338043,
      0.8801361322402954,
      0.7147156000137329,
      -0.36634549498558044,
      -0.25269636511802673,
      -0.1988845020532608,
      0.4965642988681793,
      -0.00871460884809494,
      1.145980715751648,
      0.33699506521224976,
      -0.4148710072040558,
      -0.15644608438014984,
      -1.3165420293807983,
      -0.9595783352851868,
      0.029888909310102463,
      0.0009615582530386746,
      -0.5985262393951416,
      -0.3040880560874939,
      -0.06205887347459793,
      -0.30631744861602783,
      -0.02924952656030655,
      0.29881566762924194,
      0.6612207293510437,
      0.8021284937858582,
      0.17368315160274506,
      -0.8413606882095337,
      0.4839640259742737,
      0.19099973142147064,
      0.23073460161685944,
      0.9617824554443359,
      -0.7054564952850342,
      -0.5708854794502258,
      -0.29404017329216003,
      0.3756369650363922,
      -0.4812503159046173,
      0.10348255187273026,
      1.0326237678527832,
      -0.253169983625412,
      0.8861792683601379,
      0.8307703137397766,
      -0.11770850419998169,
      -1.9777767658233643,
      0.3406105041503906,
      0.3472868502140045,
      0.3937884271144867,
      -0.12010487169027328,
      0.12476126849651337,
      -0.18773159384727478,
      0.07054044306278229,
      0.9427932500839233,
      -0.7955010533332825,
      0.6552537083625793,
      1.0007511377334595,
      0.2978774905204773,
      -1.2221168279647827,
      -0.2238268256187439,
      -0.11329758167266846,
      0.2803325057029724,
      1.0779634714126587,
      -0.7363781332969666,
      -0.5561153888702393,
      0.825607180595398,
      -0.1262197494506836,
      -0.3811744153499603,
      0.7951357364654541,
      0.4063009023666382,
      1.7031347751617432,
      -0.29791876673698425,
      -0.022123903036117554,
      0.23456375300884247,
      -0.36196354031562805,
      0.44638288021087646,
      0.15433309972286224,
      0.7847338318824768,
      -0.6254292130470276,
      0.1563357561826706,
      -0.4486593008041382,
      -0.8122016191482544,
      -0.05704263970255852,
      -0.4528287649154663,
      0.2500871419906616,
      0.8573275208473206,
      -0.7910811901092529,
      -0.4267613887786865,
      0.014036777429282665,
      -0.30940285325050354,
      0.303164005279541,
      0.08280794322490692,
      0.030091028660535812,
      0.2327340692281723,
      0.3565259873867035,
      0.9845778942108154,
      0.4674909710884094,
      -1.2184348106384277,
      -0.5665724277496338,
      -0.46026939153671265,
      -0.007170579396188259,
      1.2759994268417358,
      0.10898085683584213,
      -0.6225975751876831,
      -0.07075903564691544,
      -0.19671405851840973,
      0.676223874092102,
      0.4613286554813385,
      0.12159013003110886,
      0.3744281232357025,
      -0.06081918254494667,
      -0.18879590928554535,
      -0.07648098468780518,
      1.1072720289230347,
      0.22457866370677948,
      0.25525766611099243,
      0.14552414417266846,
      0.21655882894992828,
      0.075691357254982,
      -0.0698365643620491,
      0.892933189868927,
      0.09363876283168793,
      1.156051516532898,
      -0.4348365068435669,
      0.12913107872009277,
      -0.29678988456726074,
      0.3316594362258911,
      0.1359620988368988,
      -0.29937848448753357,
      0.16725286841392517,
      0.9540347456932068,
      -1.000472903251648,
      0.48490288853645325,
      0.06798318028450012,
      -0.48525509238243103,
      -0.441987544298172,
      -0.007058094255626202,
      -0.43018069863319397,
      -0.27402424812316895,
      -0.5194141268730164,
      -0.7543801069259644,
      0.3722594678401947,
      0.7641798257827759,
      -1.7526520490646362,
      -0.13191163539886475,
      -0.08097772300243378,
      0.5953282117843628,
      -0.0005265272338874638,
      -0.9053433537483215,
      0.5446606278419495,
      0.3859234154224396,
      -0.4645354747772217,
      -0.7538666725158691,
      0.8457919955253601,
      0.7500540018081665,
      0.3055984377861023,
      -0.339498370885849,
      0.9166247844696045,
      -0.10525976121425629,
      0.2945386469364166,
      -0.08983553200960159,
      0.3162797689437866,
      0.012563548050820827,
      0.9349257349967957,
      -0.12335796654224396,
      -1.2997983694076538,
      0.5011930465698242,
      -1.0532915592193604,
      0.6105180382728577,
      -0.9032508134841919,
      0.35385456681251526,
      -0.9413833618164062,
      -0.5017480254173279,
      -0.8024386167526245,
      -1.2795814275741577,
      -0.6430014967918396,
      -1.3725981712341309,
      0.26296553015708923,
      1.7136088609695435,
      0.4123344123363495,
      -0.03811752051115036,
      0.18527676165103912,
      -0.5040324330329895,
      0.49965375661849976,
      0.8375425934791565,
      0.10799461603164673,
      -0.03310995548963547,
      -0.9934740662574768,
      0.0690188929438591,
      0.5729721784591675,
      -0.27482616901397705,
      -0.37111350893974304,
      0.6081706881523132,
      0.49234601855278015,
      -0.5709152221679688,
      -0.4456407427787781,
      -0.21475541591644287,
      -1.7090175151824951,
      0.8780425786972046,
      0.34505948424339294,
      -0.5696341395378113,
      0.4177519679069519,
      0.24845468997955322,
      -0.783926248550415,
      0.2841198146343231,
      0.06743534654378891,
      -0.2421325445175171,
      -0.7646046876907349,
      1.028262972831726,
      -0.2588508725166321,
      0.5682165026664734,
      0.24380412697792053,
      -0.620747447013855,
      -0.09678009897470474,
      -0.3828495740890503,
      -1.06178617477417,
      -0.2599125802516937,
      0.6605154275894165,
      1.4703395366668701,
      -1.382272720336914,
      -0.0847252756357193,
      1.0151500701904297,
      -0.7146387100219727,
      0.7944122552871704,
      -0.4741895794868469,
      0.25539684295654297,
      0.17695006728172302,
      -0.619569718837738,
      0.09063674509525299,
      0.049850281327962875,
      0.0925234779715538,
      -1.8091756105422974,
      0.7694379091262817,
      0.20157822966575623,
      -1.045007586479187,
      0.1380881518125534,
      -0.14774897694587708,
      -0.5784198641777039,
      1.165602207183838,
      -1.559142827987671,
      0.39420610666275024,
      -0.6805791854858398,
      -0.24580854177474976,
      -0.07994233816862106,
      0.4093047082424164,
      0.6514219045639038,
      -1.4252015352249146,
      0.01158910896629095,
      -2.2715744972229004,
      0.25128379464149475,
      -0.4634834825992584,
      1.494534969329834,
      -0.2963586449623108,
      0.40411993861198425,
      0.15074200928211212,
      0.3166068494319916,
      0.35697346925735474,
      0.10310006886720657,
      -0.05832674726843834,
      0.2914167642593384,
      -0.9628974795341492,
      -0.2951611578464508,
      1.0273363590240479,
      0.38806095719337463,
      -0.011077906005084515,
      -0.42693766951560974,
      0.886613667011261,
      0.33254632353782654,
      0.10876185446977615,
      -0.533287763595581,
      0.6534914374351501,
      0.03060961328446865,
      0.30260199308395386,
      -0.40231287479400635,
      -0.6788095235824585,
      -0.10572560131549835,
      0.49845999479293823,
      -0.9157570004463196,
      -0.6029863357543945,
      -0.4543328583240509,
      0.7984464764595032,
      -0.04221246764063835,
      -0.4162830114364624,
      -0.41803836822509766,
      -0.5861434936523438,
      -0.9581233263015747,
      -0.12579312920570374,
      0.5251290202140808,
      -0.8023130893707275,
      0.36784690618515015,
      0.4729960262775421,
      -0.13881011307239532,
      1.1955446004867554,
      0.7852754592895508,
      0.5436729192733765,
      -0.20891880989074707,
      0.512711763381958,
      0.25273969769477844,
      0.1083453968167305,
      0.3294062614440918,
      -0.04838627949357033,
      -1.1709624528884888,
      0.2252252697944641,
      -1.3008484840393066,
      -0.265819787979126,
      -0.13035838305950165,
      -0.3616267442703247,
      -0.004051759839057922,
      0.44511690735816956,
      0.23328883945941925,
      -1.0587942600250244,
      0.2860349416732788,
      -0.3079947829246521,
      -0.7017554044723511,
      0.3583463728427887,
      0.16802935302257538,
      0.005760819651186466,
      -0.08539582043886185,
      -0.136762335896492,
      0.35975030064582825,
      -0.24426384270191193,
      0.10248307138681412,
      0.4047599732875824,
      -0.2626936733722687,
      -0.04716678336262703,
      -0.35490405559539795,
      0.0601777546107769,
      -0.27568042278289795,
      -0.12018121033906937,
      0.9377467036247253,
      0.23194879293441772,
      -0.2548481523990631,
      0.2920861542224884,
      -1.0691559314727783,
      -0.06464164704084396,
      -0.4703097641468048,
      0.42739585041999817,
      -0.9290449023246765,
      -1.3100425004959106,
      0.3694976270198822,
      -0.10895011574029922,
      -0.5245373845100403,
      -0.0077715772204101086,
      -0.620653510093689,
      -0.7172870635986328,
      -0.12950339913368225,
      -1.076420545578003,
      -0.245555117726326,
      -1.644897222518921,
      1.3560093641281128,
      -0.6400731801986694,
      0.37998589873313904,
      -0.8132104277610779,
      -0.6987903714179993,
      -1.0657655000686646,
      -0.520658016204834,
      -1.3782868385314941,
      0.30924737453460693,
      0.5916513800621033,
      0.11630800366401672,
      -0.49139174818992615,
      -0.3543454706668854,
      -0.9173202514648438,
      0.6712470054626465,
      0.22332759201526642,
      -0.12131235003471375,
      0.5413647890090942,
      -0.38355565071105957,
      -0.5517215728759766,
      0.46779292821884155,
      -0.6286664605140686,
      -0.06525370478630066,
      -0.28488680720329285,
      0.9428064227104187,
      0.8943319320678711,
      0.427030473947525,
      0.21565088629722595,
      -1.0814138650894165,
      0.39820268750190735,
      0.4569382071495056,
      0.013289911672472954,
      -0.4973059892654419,
      0.3857344388961792,
      -0.40192821621894836
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SAI",
      "level3": "F,IC-1",
      "leafContractCategory": "SAM (Level 3) ? AMO(Level 2)",
      "rootCause": "Missing Input value-Method order Dependency",
      "effect": "IF",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Load",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/43855162",
    "title": "",
    "question": "\"I try to participate in my first Kaggle competition where RMSLE is given as the required loss function. For I have found nothing how to implement this loss function I tried to settle for RMSE. I know this was part of Keras in the past, is there any way to use it in the latest version, maybe with a customized function via backend?\n\nThis is the NN I designed:\n\nfrom keras.models import Sequential\nfrom keras.layers.core import Dense , Dropout\nfrom keras import regularizers\n\nmodel = Sequential()\nmodel.add(Dense(units = 128, kernel_initializer = \"\"uniform\"\", activation = \"\"relu\"\", input_dim = 28,activity_regularizer = regularizers.l2(0.01)))\nmodel.add(Dropout(rate = 0.2))\nmodel.add(Dense(units = 128, kernel_initializer = \"\"uniform\"\", activation = \"\"relu\"\"))\nmodel.add(Dropout(rate = 0.2))\nmodel.add(Dense(units = 1, kernel_initializer = \"\"uniform\"\", activation = \"\"relu\"\"))\nmodel.compile(optimizer = \"\"rmsprop\"\", loss = \"\"root_mean_squared_error\"\")#, metrics =[\"\"accuracy\"\"])\n\nmodel.fit(train_set, label_log, batch_size = 32, epochs = 50, validation_split = 0.15)\n\nI tried a customized root_mean_squared_error function I found on GitHub but for all I know the syntax is not what is required. I think the y_true and the y_pred would have to be defined before passed to the return but I have no idea how exactly, I just started with programming in python and I am really not that good in math...\n\nfrom keras import backend as K\n\ndef root_mean_squared_error(y_true, y_pred):\n        return K.sqrt(K.mean(K.square(y_pred - y_true), axis=-1)) \n\nI receive the following error with this function: \n\nValueError: ('Unknown loss function', ':root_mean_squared_error')\n\nThanks for your ideas, I appreciate every help!\"",
    "answer": "\"When you use a custom loss, you need to put it without quotes, as you pass the function object, not a string:\n\ndef root_mean_squared_error(y_true, y_pred):\n        return K.sqrt(K.mean(K.square(y_pred - y_true))) \n\nmodel.compile(optimizer = \"\"rmsprop\"\", loss = root_mean_squared_error, \n              metrics =[\"\"accuracy\"\"])\"",
    "mlApiName": "keras.models.compile",
    "embedding": [
      0.1921093612909317,
      -0.3588573932647705,
      -2.193316698074341,
      -1.3885666131973267,
      1.486997127532959,
      -0.5307607650756836,
      0.21386300027370453,
      0.47516903281211853,
      -0.3603825569152832,
      -0.9897643327713013,
      -0.6523308157920837,
      0.8963291645050049,
      2.349088191986084,
      -0.08480439335107803,
      -0.48023390769958496,
      -0.24260880053043365,
      0.529774010181427,
      0.1571856290102005,
      -0.40318164229393005,
      1.607442855834961,
      0.19722923636436462,
      -0.5587911009788513,
      -0.4581158459186554,
      -0.06985274702310562,
      1.4159760475158691,
      -0.036732081323862076,
      -0.3286017179489136,
      0.4393308460712433,
      -0.5850526094436646,
      1.0539606809616089,
      0.2675437331199646,
      -0.8285588026046753,
      0.5079237818717957,
      -0.9685710668563843,
      -1.4001593589782715,
      -0.7437771558761597,
      0.898834228515625,
      -0.0018929344369098544,
      0.16629084944725037,
      -0.3112460672855377,
      0.730863094329834,
      0.2026374191045761,
      0.23062241077423096,
      1.135103702545166,
      0.5957037806510925,
      -0.5430444478988647,
      1.5130778551101685,
      -0.22862716019153595,
      0.25622493028640747,
      -0.42171159386634827,
      0.8507674932479858,
      -0.01264613401144743,
      0.024225512519478798,
      -0.14373528957366943,
      0.9084029197692871,
      0.3051532506942749,
      -0.10749965906143188,
      0.6399378776550293,
      0.7246735095977783,
      -0.8387773633003235,
      0.5790534019470215,
      0.8751689791679382,
      -1.597617268562317,
      0.14776453375816345,
      0.6773755550384521,
      -0.09940186887979507,
      -0.6310871839523315,
      1.1210285425186157,
      -0.8104649186134338,
      0.3918006718158722,
      0.5999767184257507,
      1.01261305809021,
      0.21469613909721375,
      -0.1051873192191124,
      -0.49792519211769104,
      0.329597532749176,
      -0.5727112293243408,
      -0.4701724350452423,
      0.03988808020949364,
      0.5461022853851318,
      -0.534480631351471,
      1.4154695272445679,
      1.1450423002243042,
      0.018261291086673737,
      -0.30567997694015503,
      0.21028095483779907,
      -0.6262234449386597,
      0.05446954444050789,
      -0.5811808705329895,
      0.9461134672164917,
      -0.3342934250831604,
      -0.6804778575897217,
      0.8547530770301819,
      0.9080117344856262,
      -0.7188568711280823,
      -0.6832225918769836,
      -1.0184595584869385,
      -0.11102128028869629,
      -0.10341852903366089,
      0.18097355961799622,
      0.3404110074043274,
      0.008943917229771614,
      -0.7776234149932861,
      -1.2810497283935547,
      -0.5315678119659424,
      0.7198553681373596,
      0.525364875793457,
      0.539564847946167,
      0.45818817615509033,
      -0.5304862260818481,
      -0.26974961161613464,
      0.5587829351425171,
      -0.4359686076641083,
      -0.5908777117729187,
      0.05624516308307648,
      -0.29465362429618835,
      0.529331624507904,
      -1.0495214462280273,
      0.29756972193717957,
      0.9156023263931274,
      -0.32450631260871887,
      -0.26715385913848877,
      0.9838865995407104,
      0.4137333929538727,
      -0.2870240807533264,
      1.292144536972046,
      -0.2374529093503952,
      0.21906141936779022,
      -0.021450622007250786,
      -0.8987981677055359,
      -0.2566474974155426,
      -0.9361051321029663,
      -0.48623496294021606,
      0.5130464434623718,
      0.732381284236908,
      1.209855079650879,
      -0.7331435084342957,
      -0.14846281707286835,
      0.1679185926914215,
      0.20075617730617523,
      0.44737303256988525,
      0.2563572824001312,
      -0.235701322555542,
      -1.0577232837677002,
      -0.1502833515405655,
      -0.4470111131668091,
      1.313174843788147,
      -0.9646206498146057,
      -0.8409082293510437,
      -0.0370476059615612,
      0.49064934253692627,
      0.31178396940231323,
      -0.9170122742652893,
      0.25734108686447144,
      1.0557160377502441,
      -0.9404141902923584,
      0.2537649869918823,
      0.6612695455551147,
      0.13950753211975098,
      -0.6019460558891296,
      0.7057266235351562,
      0.48595917224884033,
      -0.5876713991165161,
      1.0174753665924072,
      -0.6025663018226624,
      -0.8077139258384705,
      0.5553069114685059,
      -0.08372054249048233,
      -0.33859044313430786,
      -0.19862854480743408,
      0.23816393315792084,
      -0.8024529814720154,
      0.36107388138771057,
      0.1210424154996872,
      -0.16162273287773132,
      0.6195096373558044,
      0.9478873014450073,
      0.20395919680595398,
      0.24290524423122406,
      -0.6493918299674988,
      0.7543243765830994,
      -0.30348172783851624,
      1.071743369102478,
      -0.1238994300365448,
      -0.8584420084953308,
      0.2168317288160324,
      0.6518819332122803,
      0.062091030180454254,
      0.14411835372447968,
      -0.5346267223358154,
      0.16828368604183197,
      0.32757362723350525,
      -0.15459975600242615,
      -0.8060721755027771,
      -0.3411151170730591,
      0.41225144267082214,
      0.6284886002540588,
      -0.7488495707511902,
      1.0614956617355347,
      0.6672890186309814,
      0.47457072138786316,
      0.8798757791519165,
      -0.8589877486228943,
      0.43100258708000183,
      -0.25220194458961487,
      0.3365694582462311,
      -0.2648272216320038,
      0.2806764245033264,
      -0.5712277889251709,
      0.06399188190698624,
      0.5725317597389221,
      -0.21724770963191986,
      0.18453466892242432,
      0.6218528151512146,
      0.29653200507164,
      -0.4547327756881714,
      0.24433580040931702,
      -0.04850606247782707,
      -0.12878280878067017,
      0.0892382487654686,
      -0.035605791956186295,
      -0.6904288530349731,
      0.7928541302680969,
      0.13412615656852722,
      0.4750458300113678,
      -0.3036450147628784,
      -0.33178144693374634,
      0.07678912580013275,
      -1.2797092199325562,
      -0.2852340042591095,
      -0.5315633416175842,
      -0.9130563139915466,
      0.1175539568066597,
      -0.05329248309135437,
      0.18983644247055054,
      0.9837118983268738,
      0.7814627289772034,
      1.1800668239593506,
      0.26095664501190186,
      0.5372198820114136,
      0.16202782094478607,
      0.9297414422035217,
      0.47548434138298035,
      0.8703955411911011,
      -0.9802609086036682,
      0.08260078728199005,
      -0.6979299783706665,
      -0.46544450521469116,
      -0.3212241232395172,
      0.6319992542266846,
      -0.09366030991077423,
      0.855210542678833,
      0.8493893146514893,
      -0.34021052718162537,
      1.2204948663711548,
      -0.5613290667533875,
      -0.3656960129737854,
      -0.6616826057434082,
      0.9719769954681396,
      -0.4626597464084625,
      0.5549483895301819,
      0.3462739586830139,
      -0.31757286190986633,
      0.0124359130859375,
      -0.6993065476417542,
      -0.8521162271499634,
      -0.3047396242618561,
      -0.3555229902267456,
      -0.04466698691248894,
      0.004582039080560207,
      0.08164788037538528,
      0.2715129554271698,
      0.777019202709198,
      0.9546149969100952,
      1.4565764665603638,
      -0.025546254590153694,
      0.0974586009979248,
      0.07396108657121658,
      0.08009310066699982,
      -0.23782843351364136,
      0.10424833744764328,
      -0.9111811518669128,
      -0.4954755902290344,
      0.10356336086988449,
      -0.8089903593063354,
      -0.5545890927314758,
      0.20501431822776794,
      1.012792706489563,
      -0.11304765194654465,
      0.09441253542900085,
      -0.1651930958032608,
      -0.024623865261673927,
      -0.31871259212493896,
      -0.21705329418182373,
      0.12878598272800446,
      0.5641573667526245,
      0.7681919932365417,
      -0.33486008644104004,
      0.30128994584083557,
      -0.5965589284896851,
      0.020518450066447258,
      0.443459153175354,
      0.00009165877418126911,
      0.16386717557907104,
      -0.285394549369812,
      -0.4273848831653595,
      0.28720223903656006,
      0.14622366428375244,
      0.6393435597419739,
      -0.12094035744667053,
      0.2368554025888443,
      -0.12270832061767578,
      -0.5416073799133301,
      0.9907023906707764,
      -0.6276782751083374,
      0.2679775655269623,
      0.43772292137145996,
      0.4455120265483856,
      -0.014413074590265751,
      -0.2943684160709381,
      -0.0031949880067259073,
      -1.1805567741394043,
      0.11805311590433121,
      0.25692835450172424,
      -0.45211324095726013,
      0.942918598651886,
      -0.8366610407829285,
      -0.26038768887519836,
      0.5927610397338867,
      -0.5007064938545227,
      0.3314778506755829,
      0.8767014741897583,
      0.31288936734199524,
      -1.4347056150436401,
      -1.6654820442199707,
      0.07147703319787979,
      0.3265344798564911,
      -0.10501094907522202,
      -0.5343223214149475,
      0.9746004343032837,
      0.47093701362609863,
      -0.0770459920167923,
      0.7815315127372742,
      -0.7460819482803345,
      -0.317877858877182,
      -0.3809046745300293,
      -0.991956353187561,
      -0.10000546276569366,
      1.0145188570022583,
      -0.3551298975944519,
      -0.35487666726112366,
      -0.0335792601108551,
      0.3939019739627838,
      -0.14315277338027954,
      -0.2993091642856598,
      0.6609898805618286,
      0.9561278223991394,
      -0.43006205558776855,
      0.13645286858081818,
      0.4908776879310608,
      1.5087517499923706,
      -0.1939181238412857,
      0.2464837282896042,
      -0.05577896535396576,
      0.3649232089519501,
      -0.21104630827903748,
      1.0267767906188965,
      0.06500428915023804,
      0.813683807849884,
      -0.25348594784736633,
      0.11477551609277725,
      0.3165740966796875,
      0.0006845390889793634,
      0.2805430293083191,
      -0.5141394138336182,
      -0.4838011562824249,
      -0.6101757884025574,
      0.47543466091156006,
      -1.0214145183563232,
      0.7395926713943481,
      0.26068997383117676,
      -0.2944246530532837,
      0.1487397700548172,
      0.19997495412826538,
      0.7768176794052124,
      0.18552950024604797,
      0.30368518829345703,
      -0.62501060962677,
      0.40737682580947876,
      1.0349496603012085,
      0.19576628506183624,
      -0.8121297955513,
      -0.5394354462623596,
      -0.27812790870666504,
      0.5402609705924988,
      -0.8650245666503906,
      0.4335455298423767,
      0.06446231156587601,
      -0.21415749192237854,
      0.384818434715271,
      -1.982282042503357,
      -0.006747312843799591,
      0.5685625672340393,
      -0.1254919171333313,
      0.03162321448326111,
      -1.2593731880187988,
      0.08135277777910233,
      -0.029792925342917442,
      -0.1360916644334793,
      0.053984347730875015,
      0.13645462691783905,
      -0.10142377763986588,
      -0.2292899489402771,
      -0.9689407348632812,
      0.8991603851318359,
      0.49649715423583984,
      0.6328943371772766,
      0.6776547431945801,
      -0.1707669198513031,
      -1.6096805334091187,
      -0.5467236042022705,
      0.22304539382457733,
      -0.348051518201828,
      0.7836877703666687,
      0.686389684677124,
      0.02977266162633896,
      0.6484965682029724,
      1.1386127471923828,
      0.9043779969215393,
      -2.196981191635132,
      0.11673435568809509,
      0.7986513376235962,
      0.5318154692649841,
      -0.0994487777352333,
      -0.23161262273788452,
      -0.4808887839317322,
      -0.08804165571928024,
      0.07384445518255234,
      -0.7221426963806152,
      0.7021772265434265,
      0.0985933318734169,
      -0.5952751636505127,
      -0.7922877073287964,
      -0.3260229825973511,
      0.41079550981521606,
      0.13284455239772797,
      1.3346481323242188,
      -0.5371146202087402,
      -0.9943899512290955,
      1.3403034210205078,
      -0.3888625502586365,
      0.022887611761689186,
      0.33993205428123474,
      0.5642197132110596,
      1.221055030822754,
      -0.2846486270427704,
      -0.12549087405204773,
      -0.06372346729040146,
      -0.03497735410928726,
      0.32039690017700195,
      -0.6114516258239746,
      0.526811420917511,
      -1.1265391111373901,
      0.019391195848584175,
      0.0776166319847107,
      -1.0084418058395386,
      0.42259278893470764,
      -0.3462661802768707,
      1.101114273071289,
      0.709175169467926,
      -0.7004900574684143,
      -0.49525076150894165,
      0.40573740005493164,
      -0.40494927763938904,
      0.05103391781449318,
      0.7660489678382874,
      -0.3863697350025177,
      -0.20352168381214142,
      1.073516607284546,
      1.009094476699829,
      0.07418649643659592,
      -1.7684983015060425,
      -0.8571159243583679,
      -0.5991506576538086,
      -0.8239563703536987,
      1.5632075071334839,
      0.7961417436599731,
      -0.35889676213264465,
      0.12445081770420074,
      -0.10885414481163025,
      0.41893520951271057,
      -0.10653962194919586,
      -0.1568932980298996,
      -0.1318638175725937,
      0.16787375509738922,
      0.053721603006124496,
      -0.32588475942611694,
      0.9225046634674072,
      0.3339534401893616,
      0.26875612139701843,
      0.04098643735051155,
      0.22659404575824738,
      -0.7363313436508179,
      0.4617806673049927,
      0.7706555128097534,
      -0.39974406361579895,
      0.6417728662490845,
      -0.25328826904296875,
      -0.695244550704956,
      -0.6666678786277771,
      0.6404238939285278,
      -0.2831495404243469,
      0.36731287837028503,
      0.04867502301931381,
      -0.17269307374954224,
      -0.6674904823303223,
      0.44701963663101196,
      0.6266785860061646,
      -0.7965293526649475,
      -0.008816840127110481,
      0.462195485830307,
      -0.33294105529785156,
      -0.14308340847492218,
      -0.9139536619186401,
      -0.6656795144081116,
      0.1393970400094986,
      0.6009034514427185,
      -1.0026012659072876,
      0.12073167413473129,
      -0.8328118324279785,
      -0.013437633402645588,
      -0.44019296765327454,
      -1.8885152339935303,
      -0.00391562981531024,
      0.032815419137477875,
      -0.6947954297065735,
      -0.6733654141426086,
      0.9057072997093201,
      -0.12575578689575195,
      -0.8639808893203735,
      0.34003832936286926,
      1.6879993677139282,
      -0.21369946002960205,
      -0.11041802167892456,
      -0.024925554171204567,
      -0.04098546504974365,
      0.10201430320739746,
      0.29263168573379517,
      0.6595192551612854,
      -1.519526481628418,
      0.2583235204219818,
      -0.2564167380332947,
      0.3178142309188843,
      -1.305940866470337,
      -0.11525791883468628,
      -0.7120571732521057,
      -0.963692843914032,
      -1.188533067703247,
      -0.45077967643737793,
      -0.41623347997665405,
      -1.174343228340149,
      0.04715079069137573,
      1.3720682859420776,
      -0.03799838945269585,
      -0.18850155174732208,
      -0.6358012557029724,
      -0.3544040024280548,
      0.23246777057647705,
      0.43288910388946533,
      0.8512558341026306,
      -0.6548627614974976,
      -1.1636364459991455,
      -0.18364910781383514,
      0.08458533883094788,
      -0.3938731253147125,
      0.7859936356544495,
      0.40093016624450684,
      -0.8068385124206543,
      -0.2419695109128952,
      -0.6531611084938049,
      0.41464078426361084,
      -1.0997611284255981,
      -0.1053130179643631,
      0.1506887972354889,
      -0.4834906756877899,
      0.19884535670280457,
      0.8232046365737915,
      -0.9881654381752014,
      0.11099479347467422,
      0.5056608319282532,
      -0.8730982542037964,
      -0.32197943329811096,
      0.9663676023483276,
      -0.2553838789463043,
      0.2663674056529999,
      0.4135051965713501,
      -0.8463405966758728,
      0.24996115267276764,
      0.17478768527507782,
      -1.180040717124939,
      -0.40843507647514343,
      0.572502613067627,
      1.208259105682373,
      -1.775490641593933,
      0.2792387306690216,
      1.2506450414657593,
      -0.22543556988239288,
      0.3906875550746918,
      -0.22361521422863007,
      0.14249968528747559,
      0.6732540726661682,
      0.11145096272230148,
      -0.44500136375427246,
      0.08352652192115784,
      0.2985542118549347,
      -1.1664139032363892,
      0.8171173930168152,
      0.37497881054878235,
      -0.8174118399620056,
      -0.25312432646751404,
      -0.3987736105918884,
      -0.9210991859436035,
      0.8455082178115845,
      -0.8227880597114563,
      0.48350057005882263,
      0.018224027007818222,
      -1.1121410131454468,
      0.1541995257139206,
      0.21452763676643372,
      0.05729614198207855,
      -1.416425108909607,
      0.08730341494083405,
      -1.373344898223877,
      -0.24445681273937225,
      -0.7098518013954163,
      2.0559439659118652,
      -0.43550723791122437,
      0.898501455783844,
      0.6523738503456116,
      0.6095790266990662,
      -0.025294966995716095,
      0.37093502283096313,
      -0.33198243379592896,
      0.40251773595809937,
      -1.0326461791992188,
      -0.41524726152420044,
      1.1596099138259888,
      0.5252208113670349,
      0.32247093319892883,
      -0.43893519043922424,
      1.0986390113830566,
      0.7705217003822327,
      0.2505177855491638,
      -0.24969570338726044,
      0.9585961103439331,
      -0.5115598440170288,
      0.67485111951828,
      -0.39374080300331116,
      -0.8118624687194824,
      -0.013135282322764397,
      0.36312973499298096,
      -0.7277397513389587,
      -0.8855316042900085,
      -0.32772597670555115,
      1.2381972074508667,
      0.3885476589202881,
      -0.7009966373443604,
      0.21116086840629578,
      -0.27413854002952576,
      -0.7396590709686279,
      0.9053488969802856,
      0.7853578925132751,
      -0.1938580572605133,
      0.8154430985450745,
      0.4083971679210663,
      -0.24519287049770355,
      1.2390766143798828,
      1.3462165594100952,
      -0.2505857050418854,
      -0.17676809430122375,
      0.8898215889930725,
      -0.2466365396976471,
      0.36977419257164,
      0.32612043619155884,
      0.3773256242275238,
      -1.375857949256897,
      0.5453409552574158,
      -0.7620640993118286,
      -0.12919266521930695,
      0.3228175640106201,
      -0.8518484830856323,
      0.2636687457561493,
      0.2823067605495453,
      -0.5214635133743286,
      0.057171184569597244,
      0.22209379076957703,
      0.04675893485546112,
      -1.008164882659912,
      0.32532060146331787,
      0.7079305648803711,
      0.483360230922699,
      0.31534749269485474,
      0.21196788549423218,
      0.13651031255722046,
      0.48972809314727783,
      0.10897194594144821,
      0.5250177383422852,
      -0.46998342871665955,
      -0.5963342189788818,
      -0.16458509862422943,
      -0.06508263200521469,
      -0.3446544408798218,
      -0.7439740300178528,
      0.8585048317909241,
      -0.3675726652145386,
      0.8700163960456848,
      0.24326926469802856,
      -0.3670584559440613,
      -0.5452953577041626,
      -1.08790922164917,
      -0.06949503719806671,
      -0.20086315274238586,
      -0.8984990119934082,
      0.43687063455581665,
      -0.4506075978279114,
      -0.46379756927490234,
      0.056867484003305435,
      -0.18923883140087128,
      -0.686728835105896,
      -0.4208303391933441,
      -1.0871809720993042,
      0.3046400249004364,
      -1.3326336145401,
      1.329559087753296,
      -0.37646642327308655,
      -0.04058961942791939,
      -0.7586559653282166,
      -0.2616465091705322,
      -0.9470008015632629,
      0.7009130120277405,
      -1.1302846670150757,
      0.05281160771846771,
      -0.010481083765625954,
      0.243928000330925,
      -0.28574973344802856,
      -0.5277912020683289,
      -0.5978315472602844,
      0.9576359391212463,
      -0.10897558927536011,
      -0.20348989963531494,
      0.35171744227409363,
      0.031895652413368225,
      -0.40474769473075867,
      0.6674559712409973,
      -0.35591667890548706,
      -0.01569863222539425,
      -0.08405958116054535,
      1.2000337839126587,
      0.6120960712432861,
      0.2611808180809021,
      -0.09481164813041687,
      -0.5088159441947937,
      -0.22675472497940063,
      0.3223790228366852,
      -0.05074683576822281,
      -0.9979907274246216,
      0.27858203649520874,
      -0.1390194445848465
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/53153790",
    "title": "",
    "question": "\"I am fine-tuning a MobileNet with 14 new classes. When I add new layers by:\n\nx=mobile.layers[-6].output\nx=Flatten(x)\npredictions = Dense(14, activation='softmax')(x)\nmodel = Model(inputs=mobile.input, outputs=predictions)\n\nI get the error:\n\n'Tensor' object has no attribute 'lower'\n\nAlso using:\n\nmodel.compile(Adam(lr=.0001), loss='categorical_crossentropy', metrics=['accuracy'])\nmodel.fit_generator(train_batches, steps_per_epoch=18,\n                validation_data=valid_batches, validation_steps=3, epochs=60, verbose=2)\n\nI get the error:\n\nError when checking target: expected dense_1 to have 4 dimensions, but got array with shape (10, 14)\n\nWhat does lower mean? I saw other fine-tuning scripts and there were no other arguments other than the name of the model which is x in this case.\"",
    "answer": "\"The tensor must be passed to the layer when you are calling it, and not as an argument. Therefore it must be like this:\n\nx = Flatten()(x)  # first the layer is constructed and then it is called on x\n\nTo make it more clear, it is equivalent to this:\n\nflatten_layer = Flatten()  # instantiate the layer\nx = flatten_layer(x)       # call it on the given tensor\"",
    "mlApiName": "keras.layers.Flatten",
    "embedding": [
      0.7016458511352539,
      0.5333941578865051,
      -2.5694456100463867,
      -0.9753490090370178,
      1.2412583827972412,
      0.5288069248199463,
      0.44578972458839417,
      0.2234354019165039,
      -0.9492796063423157,
      -1.276679515838623,
      -0.2285122126340866,
      0.6261703968048096,
      2.1592984199523926,
      0.04459699988365173,
      -0.2712364196777344,
      -0.31311947107315063,
      0.3140779137611389,
      0.22485628724098206,
      0.4793633818626404,
      0.38999760150909424,
      0.3662721812725067,
      0.30337584018707275,
      0.13656193017959595,
      -0.1991194486618042,
      1.3479063510894775,
      0.5802916288375854,
      -0.5164468884468079,
      0.4715718626976013,
      -0.42882612347602844,
      0.17806415259838104,
      1.1594258546829224,
      -0.5336812138557434,
      -0.21012920141220093,
      -0.7246509194374084,
      -0.8570511937141418,
      -0.788887619972229,
      0.9666347503662109,
      0.4677838683128357,
      -0.26919907331466675,
      0.11310844868421555,
      1.558670997619629,
      0.07517874985933304,
      0.05983975529670715,
      0.4161727726459503,
      0.2826690077781677,
      -0.0659279003739357,
      1.2844620943069458,
      0.7261227369308472,
      0.6211860775947571,
      -1.2121340036392212,
      0.1947689950466156,
      0.20529727637767792,
      0.3548254370689392,
      -0.4762866497039795,
      1.4683932065963745,
      0.3461366593837738,
      -0.48711511492729187,
      0.5130860805511475,
      0.6821529269218445,
      -0.7777241468429565,
      -0.12438439577817917,
      1.189850926399231,
      -1.1087350845336914,
      1.4483530521392822,
      0.9601731896400452,
      -0.005206759553402662,
      -1.3615078926086426,
      0.1173354983329773,
      -0.7748933434486389,
      -0.8452240228652954,
      0.7390132546424866,
      -0.19962620735168457,
      -0.5284606218338013,
      0.23280958831310272,
      -1.057826042175293,
      0.155694380402565,
      -0.6361523270606995,
      -0.7015915513038635,
      0.38632097840309143,
      -0.1284947693347931,
      -0.057357970625162125,
      1.1749011278152466,
      1.3013691902160645,
      0.09354640543460846,
      0.16906774044036865,
      0.6079515218734741,
      -1.096705675125122,
      0.5843027830123901,
      -0.6753963828086853,
      2.015772819519043,
      -0.5511042475700378,
      -0.3598119616508484,
      0.4211433529853821,
      0.566667377948761,
      -0.9308873414993286,
      -0.35596784949302673,
      -0.008299511857330799,
      0.4981793165206909,
      -0.8157329559326172,
      -0.6758038401603699,
      -0.7943108677864075,
      1.0049489736557007,
      -0.1461801677942276,
      -1.103298544883728,
      -0.5786401033401489,
      1.884663462638855,
      -0.31719696521759033,
      -0.30161014199256897,
      -0.1676035225391388,
      -0.14222103357315063,
      0.22960059344768524,
      0.03652387112379074,
      -0.5438586473464966,
      -0.8681434988975525,
      0.044478219002485275,
      -0.719295859336853,
      0.718978762626648,
      -0.3876914381980896,
      0.31498655676841736,
      0.19250155985355377,
      -0.41135963797569275,
      -0.46829459071159363,
      0.6808728575706482,
      0.8844228386878967,
      -0.27037718892097473,
      0.6137597560882568,
      -0.6073797941207886,
      0.30741748213768005,
      -0.5859031081199646,
      -0.8840590119361877,
      0.12488172203302383,
      -0.12265840172767639,
      -0.7102644443511963,
      -0.21970051527023315,
      0.1696901023387909,
      1.1409488916397095,
      -1.2403887510299683,
      -0.9772637486457825,
      0.5548828840255737,
      0.34178128838539124,
      0.5778303742408752,
      0.8060866594314575,
      0.04735184088349342,
      -0.9632911682128906,
      0.9617864489555359,
      -0.812042236328125,
      0.3102322518825531,
      -0.4531153440475464,
      -0.5797736644744873,
      0.28580442070961,
      -0.028339872136712074,
      0.48648330569267273,
      -0.7163832187652588,
      -0.3914318084716797,
      0.4041193723678589,
      -0.3874850571155548,
      0.5803451538085938,
      0.552531361579895,
      0.5856448411941528,
      0.08018148690462112,
      1.0762981176376343,
      0.32905665040016174,
      -0.41787096858024597,
      0.9188277721405029,
      -0.2870567739009857,
      -0.40934935212135315,
      -0.04083416610956192,
      0.7231420874595642,
      -0.2164101004600525,
      0.30165037512779236,
      -0.6278229355812073,
      -0.422224223613739,
      0.42428743839263916,
      -0.22885839641094208,
      0.08552543818950653,
      1.1180068254470825,
      0.9429059028625488,
      -0.9972146153450012,
      0.4286034107208252,
      -0.03443949297070503,
      0.42676469683647156,
      -0.10842220485210419,
      0.6829875111579895,
      0.011492320336401463,
      -0.4608323872089386,
      -0.21003839373588562,
      -0.13716144859790802,
      -0.62312251329422,
      0.04801643639802933,
      -0.6527603268623352,
      0.4050850570201874,
      -0.15276722609996796,
      -0.5665097832679749,
      -0.20002621412277222,
      0.1905423104763031,
      -0.044511329382658005,
      0.8124105334281921,
      -0.8996171355247498,
      0.6355545520782471,
      0.5057941675186157,
      0.10025791823863983,
      0.38981637358665466,
      -0.035443779081106186,
      0.5746639966964722,
      -0.5671084523200989,
      0.5444851517677307,
      -0.4157831370830536,
      0.3932894170284271,
      -0.4140258729457855,
      0.08401036262512207,
      0.35487428307533264,
      -0.4125553369522095,
      0.4525775909423828,
      0.009399080649018288,
      -0.07260491698980331,
      -0.0150057477876544,
      0.855962336063385,
      -0.5887490510940552,
      -0.8790002465248108,
      -0.11564166843891144,
      0.10111735016107559,
      -0.3945592939853668,
      0.6743829846382141,
      -0.16446644067764282,
      0.8439812064170837,
      -0.9154783487319946,
      0.3888057768344879,
      0.3623541593551636,
      -0.725506067276001,
      -0.9070978164672852,
      -0.3675805330276489,
      -0.828798770904541,
      0.5022128224372864,
      -0.010911568067967892,
      -0.5663601756095886,
      0.31439462304115295,
      0.8880050182342529,
      -0.19270579516887665,
      -0.2758159637451172,
      0.03579825907945633,
      0.0008708190289326012,
      0.8930360674858093,
      0.3881767690181732,
      -0.04486609250307083,
      -0.917915940284729,
      0.3733815550804138,
      -0.1115134060382843,
      -0.46578288078308105,
      0.1241125613451004,
      0.886490523815155,
      0.1735038012266159,
      0.4081726670265198,
      0.6740772128105164,
      0.04991183057427406,
      1.2815569639205933,
      -0.3900229036808014,
      -1.0901259183883667,
      -0.24665643274784088,
      0.860381543636322,
      -0.17753738164901733,
      0.8524941802024841,
      0.2348901778459549,
      0.3920219838619232,
      -0.9596769213676453,
      -0.8243599534034729,
      -0.8209116458892822,
      -0.544755756855011,
      -0.09153544902801514,
      0.3482006788253784,
      -0.30938416719436646,
      0.04925091192126274,
      0.6265725493431091,
      0.585542619228363,
      0.5669004917144775,
      0.22569648921489716,
      0.7432010173797607,
      -0.6242309212684631,
      0.38774988055229187,
      0.3394737243652344,
      0.43208467960357666,
      -0.5443019866943359,
      -0.2403523176908493,
      -0.1189160943031311,
      -0.24272234737873077,
      -0.021004950627684593,
      0.49178358912467957,
      -0.25334399938583374,
      -0.1909429430961609,
      0.41366127133369446,
      0.3978155255317688,
      0.05733403563499451,
      -0.31205058097839355,
      -0.37543144822120667,
      0.3757896423339844,
      -0.06407628208398819,
      0.5150637030601501,
      0.932929277420044,
      -0.37370747327804565,
      0.17398764193058014,
      -0.9145359992980957,
      0.5969650745391846,
      1.0305256843566895,
      0.9667537808418274,
      0.09745161980390549,
      -0.13817410171031952,
      -0.12472480535507202,
      0.6962830424308777,
      -0.10791222006082535,
      -0.05209873244166374,
      -0.5450530648231506,
      -0.7589151859283447,
      0.46750542521476746,
      0.06425207853317261,
      0.594002366065979,
      -0.48721450567245483,
      -0.23736144602298737,
      -0.0400020107626915,
      0.5558346509933472,
      -0.07067618519067764,
      -0.802243173122406,
      -0.1543874442577362,
      0.07713348418474197,
      -0.3546484708786011,
      0.008180799894034863,
      -0.30294957756996155,
      1.004672884941101,
      -0.6737593412399292,
      0.2524654269218445,
      0.6962583661079407,
      0.011089039966464043,
      0.7649684548377991,
      0.06853867322206497,
      0.23119500279426575,
      -0.7935508489608765,
      -1.1838561296463013,
      -0.48639941215515137,
      -0.36342212557792664,
      -0.16405422985553741,
      0.6703833937644958,
      0.19216465950012207,
      -0.5773965120315552,
      0.2339610606431961,
      0.7636245489120483,
      -0.11962364614009857,
      0.07698903232812881,
      0.7193782329559326,
      -1.542435884475708,
      -0.4980832636356354,
      0.671843409538269,
      0.784633994102478,
      -0.16370104253292084,
      0.3154333531856537,
      -0.05345209687948227,
      -0.4780007302761078,
      0.33854159712791443,
      0.12318629026412964,
      0.9389634728431702,
      0.165143683552742,
      0.08148786425590515,
      0.7121307253837585,
      0.8524489402770996,
      -0.04257914423942566,
      -0.0031744102016091347,
      -0.05431126803159714,
      -0.1384637951850891,
      0.7874945402145386,
      0.5042223334312439,
      0.2895919978618622,
      1.1474448442459106,
      0.5646874904632568,
      0.0032497248612344265,
      -0.3389647305011749,
      -0.7871705293655396,
      0.8958474397659302,
      -0.19710113108158112,
      -0.0505514070391655,
      -0.6793484091758728,
      0.07763875275850296,
      -1.0636072158813477,
      -0.10659285634756088,
      0.6370319128036499,
      -0.25590237975120544,
      0.3461248278617859,
      -0.3180709481239319,
      0.6630728840827942,
      0.23659315705299377,
      0.22789786756038666,
      -0.5395431518554688,
      -0.004840213805437088,
      0.7321628928184509,
      0.2525292634963989,
      -0.24694207310676575,
      -1.009878158569336,
      -0.16687269508838654,
      0.37450316548347473,
      -0.4174633324146271,
      0.8834496140480042,
      0.44255340099334717,
      -0.18627506494522095,
      0.21358929574489594,
      -1.4346094131469727,
      -0.5006523728370667,
      0.2436264306306839,
      -0.09775730967521667,
      -0.35934698581695557,
      -0.4101705551147461,
      0.03647825866937637,
      0.11490868031978607,
      0.5306074619293213,
      0.31444603204727173,
      0.8336598873138428,
      0.07573991268873215,
      -0.42493540048599243,
      -1.6125494241714478,
      0.6122238636016846,
      -0.25191038846969604,
      0.40933194756507874,
      0.30577921867370605,
      -1.0304230451583862,
      -0.5220745205879211,
      0.24644111096858978,
      0.5851500034332275,
      -0.14583228528499603,
      -0.13425223529338837,
      1.2226365804672241,
      0.5094809532165527,
      0.20042484998703003,
      0.8309627771377563,
      0.35423511266708374,
      -1.5784529447555542,
      0.10171069204807281,
      0.5521421432495117,
      0.2929723560810089,
      -0.3452795147895813,
      -0.11180625110864639,
      0.2716900408267975,
      -0.025047743692994118,
      0.7714271545410156,
      -0.5108936429023743,
      0.7045438885688782,
      0.8843980431556702,
      -0.43630197644233704,
      -0.7662681341171265,
      -0.5458400249481201,
      0.22042691707611084,
      0.69073086977005,
      1.1748040914535522,
      -0.6891553401947021,
      -1.470392107963562,
      0.9247229695320129,
      0.17368517816066742,
      -0.31019192934036255,
      0.651406466960907,
      0.01329104881733656,
      1.6827017068862915,
      -0.20839476585388184,
      0.05569584295153618,
      -0.14794093370437622,
      -0.3532285690307617,
      -0.09509328007698059,
      0.11135219782590866,
      0.2351401299238205,
      -1.5799429416656494,
      -0.03028065711259842,
      -0.33117061853408813,
      -0.8367166519165039,
      -0.5602761507034302,
      -0.38406234979629517,
      0.10029145330190659,
      1.0364351272583008,
      -0.8199940323829651,
      -0.030426425859332085,
      0.26552191376686096,
      -0.5557546019554138,
      0.4867793321609497,
      0.48344215750694275,
      0.1138092577457428,
      -0.14503300189971924,
      -0.023830831050872803,
      0.6852663159370422,
      0.38880249857902527,
      -1.0095113515853882,
      -0.5516259074211121,
      -1.2807589769363403,
      -0.5675782561302185,
      1.6895196437835693,
      0.17628082633018494,
      0.10174627602100372,
      0.7099127173423767,
      0.0027196810115128756,
      0.9709925651550293,
      -0.5476677417755127,
      -0.0025398582220077515,
      0.20851868391036987,
      -0.5327593684196472,
      -0.04216529056429863,
      -0.04526224732398987,
      0.3743375241756439,
      0.5850224494934082,
      0.5542680621147156,
      -0.38199716806411743,
      0.10553586483001709,
      -0.060137227177619934,
      0.29973432421684265,
      0.5844661593437195,
      -0.6471671462059021,
      1.3610833883285522,
      -1.179869294166565,
      0.04114825651049614,
      -0.2556806802749634,
      0.16896918416023254,
      0.7216613292694092,
      0.8528454899787903,
      0.26945099234580994,
      0.33052733540534973,
      -1.860213279724121,
      0.2655302882194519,
      0.4022853672504425,
      -1.2428195476531982,
      0.39911800622940063,
      0.4093019366264343,
      -0.9891207218170166,
      -0.34378674626350403,
      -0.97917240858078,
      -0.30229079723358154,
      0.42825233936309814,
      0.3309045135974884,
      -1.4288413524627686,
      0.22774803638458252,
      -0.6142403483390808,
      0.29697394371032715,
      -0.1505427360534668,
      -0.9187768697738647,
      -0.20851868391036987,
      1.1009106636047363,
      -0.02105329930782318,
      -0.4274129867553711,
      0.894928514957428,
      0.5088274478912354,
      -0.2811169922351837,
      0.020969416946172714,
      0.8757096529006958,
      -0.5868685841560364,
      -1.0609766244888306,
      -0.28390267491340637,
      -0.5315026640892029,
      -0.3664364218711853,
      0.830402135848999,
      0.965419590473175,
      -0.8483123183250427,
      0.08014741539955139,
      -0.9970470070838928,
      0.16462135314941406,
      -0.6135814785957336,
      -0.09280658513307571,
      -0.558129072189331,
      -0.566254734992981,
      -0.9852400422096252,
      0.12132732570171356,
      -0.27550646662712097,
      -0.6476503014564514,
      -0.3806319832801819,
      1.5007613897323608,
      0.13970299065113068,
      -0.19485348463058472,
      -0.9998528957366943,
      -0.6939302086830139,
      0.16226698458194733,
      0.720313549041748,
      0.2795102596282959,
      -0.5311152935028076,
      -0.9763991832733154,
      -0.04606311768293381,
      0.32157662510871887,
      -0.6471769213676453,
      -0.03189108520746231,
      0.43567636609077454,
      0.04621047526597977,
      -0.7101110219955444,
      -0.12524189054965973,
      -0.08498867601156235,
      -1.227023959159851,
      -0.14420601725578308,
      -0.14055323600769043,
      -0.1977211833000183,
      0.31707102060317993,
      -0.6612634658813477,
      -1.3451313972473145,
      0.22289815545082092,
      -0.10689328610897064,
      -0.7909595370292664,
      -0.032260432839393616,
      1.0128602981567383,
      0.2191615104675293,
      -0.26524338126182556,
      -0.19150853157043457,
      -0.7612276673316956,
      0.27355924248695374,
      -1.2310950756072998,
      -0.8969084620475769,
      0.09819117188453674,
      0.6080297231674194,
      1.3029954433441162,
      -0.568115770816803,
      0.627816379070282,
      1.331343412399292,
      -0.7115945816040039,
      0.4042375683784485,
      -0.4904341995716095,
      0.5755129456520081,
      0.47938862442970276,
      0.8565436005592346,
      -0.11326739192008972,
      0.17638303339481354,
      0.12113630026578903,
      -0.31779077649116516,
      0.826125979423523,
      -0.28033870458602905,
      -0.6175681352615356,
      -0.7559676170349121,
      -0.5268217921257019,
      -0.5171496272087097,
      0.8737617135047913,
      -1.0514347553253174,
      0.3336856961250305,
      -0.898744523525238,
      -0.12705102562904358,
      -0.12848971784114838,
      0.012816487811505795,
      0.7314007878303528,
      -1.735360860824585,
      0.14641329646110535,
      -1.6472665071487427,
      0.14237524569034576,
      -0.9276896715164185,
      1.248237133026123,
      -0.43725886940956116,
      0.8350170254707336,
      1.1682184934616089,
      0.9570837020874023,
      0.20959976315498352,
      0.05618123337626457,
      -1.039995551109314,
      0.8693454265594482,
      -0.04592285677790642,
      -1.4656466245651245,
      0.2663365602493286,
      0.6758583188056946,
      -0.02227780595421791,
      0.0486859567463398,
      1.457740306854248,
      1.6165989637374878,
      -0.2009424865245819,
      -0.26383495330810547,
      0.32030683755874634,
      -0.700728714466095,
      0.4178549349308014,
      -0.3038415312767029,
      -1.0026823282241821,
      0.06410752236843109,
      0.07997366786003113,
      -0.4082593321800232,
      -0.1506812870502472,
      0.2833716571331024,
      -0.3970559537410736,
      -0.4237872362136841,
      -0.5173014402389526,
      0.08397050946950912,
      -0.42166566848754883,
      -1.1614243984222412,
      0.11501900106668472,
      0.3013434112071991,
      0.03668982908129692,
      0.28590741753578186,
      0.9581171274185181,
      -0.08797785639762878,
      0.9817343354225159,
      0.7502363920211792,
      0.5421534776687622,
      0.17808689177036285,
      0.39265596866607666,
      0.4590584337711334,
      1.2173073291778564,
      0.00010270289203617722,
      -0.20477080345153809,
      -1.1044001579284668,
      0.17319753766059875,
      -0.8668777942657471,
      -0.03575393185019493,
      -0.30230921506881714,
      -0.007587093394249678,
      -0.4603041410446167,
      0.25280454754829407,
      -0.2527303099632263,
      -0.553619384765625,
      0.31585797667503357,
      -0.5026313662528992,
      -0.5998474955558777,
      0.19163133203983307,
      0.01990177482366562,
      0.12729379534721375,
      0.3265669643878937,
      0.0830458402633667,
      0.8506268262863159,
      -0.06985245645046234,
      0.5202902555465698,
      -0.1459846794605255,
      0.5166561007499695,
      -0.6756285429000854,
      -0.7930243015289307,
      -0.19567647576332092,
      0.22103911638259888,
      0.1148575022816658,
      1.096880316734314,
      -0.3430638611316681,
      1.2749770879745483,
      0.3178263306617737,
      -1.197152018547058,
      -0.5937467217445374,
      -0.8815668225288391,
      0.31302377581596375,
      -0.29892098903656006,
      -1.01555335521698,
      0.08998090028762817,
      -0.35551267862319946,
      -0.3510397672653198,
      -0.16116364300251007,
      -0.4064226746559143,
      -0.26550182700157166,
      -0.05222960561513901,
      -0.978015661239624,
      0.47117772698402405,
      -0.8111439943313599,
      1.1349127292633057,
      -0.4028770327568054,
      0.22480489313602448,
      -0.949133038520813,
      -0.04084092378616333,
      -0.5124508738517761,
      -0.16914814710617065,
      -0.6962224245071411,
      0.5126923322677612,
      0.001909784972667694,
      0.3972456157207489,
      -0.8789212107658386,
      -0.3052349388599396,
      -0.4287275969982147,
      1.5588592290878296,
      -0.09463721513748169,
      -0.14284010231494904,
      0.00925152376294136,
      -0.29532501101493835,
      -0.692424476146698,
      0.16358281672000885,
      -0.43696242570877075,
      0.06443380564451218,
      0.07460518181324005,
      0.571285605430603,
      1.4437190294265747,
      -0.08389850705862045,
      0.1320493519306183,
      -0.9641733765602112,
      1.2348856925964355,
      0.3007895052433014,
      -0.28897446393966675,
      -0.7296063899993896,
      -0.4159402847290039,
      -0.5291063189506531
    ],
    "label": {
      "level1": "SAM",
      "level2": "DT",
      "level3": "MT",
      "leafContractCategory": "MT",
      "rootCause": "Unacceptable Input Type",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/42264649",
    "title": "",
    "question": "\"I'm following this tutorial (section 6: Tying it All Together), with my own dataset. I can get the example in the tutorial working, no problem, with the sample dataset provided.\nI'm getting a binary cross-entropy error that is negative, and no improvements as epochs progress. I'm pretty sure binary cross-entropy should always be positive, and I should see some improvement in the loss. I've truncated the sample output (and code call) below to 5 epochs. Others seem to run into similar problems sometimes when training CNNs, but I didn't see a clear solution in my case. Does anyone know why this is happening?\nSample output:\nCreating TensorFlow device (/gpu:2) -> (device: 2, name: GeForce GTX TITAN Black, pci bus id: 0000:84:00.0)\n10240/10240 [==============================] - 2s - loss: -5.5378 - acc: 0.5000 - val_loss: -7.9712 - val_acc: 0.5000\nEpoch 2/5\n10240/10240 [==============================] - 0s - loss: -7.9712 - acc: 0.5000 - val_loss: -7.9712 - val_acc: 0.5000\nEpoch 3/5\n10240/10240 [==============================] - 0s - loss: -7.9712 - acc: 0.5000 - val_loss: -7.9712 - val_acc: 0.5000\nEpoch 4/5\n10240/10240 [==============================] - 0s - loss: -7.9712 - acc: 0.5000 - val_loss: -7.9712 - val_acc: 0.5000\nEpoch 5/5\n10240/10240 [==============================] - 0s - loss: -7.9712 - acc: 0.5000 - val_loss: -7.9712 - val_acc: 0.5000\n\nMy code:\nimport numpy as np\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense\n\ndataset = np.loadtxt('train_rows.csv', delimiter=\"\",\"\")\ntestset = np.loadtxt('test_rows.csv', delimiter=\"\",\"\")\n\n# split into input (X) and output (Y) variables\nX = dataset[:, :62]\nY = dataset[:, 62]\n\nX_test = testset[:, :62]\nY_test = testset[:, 62]\n\n### create model\nmodel = Sequential()\nmodel.add(Dense(100, input_dim=(62,), activation='relu'))\nmodel.add(Dense(50, activation='relu'))\nmodel.add(Dense(1, activation='sigmoid'))\n\nmodel.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])\n## Fit the model\nmodel.fit(X, Y, validation_data=(X_test, Y_test), epochs=5, batch_size=128)\"",
    "answer": "I should have printed out my response variable. The categories were labelled as 1 and 2 instead of 0 and 1, which confused the classifier.",
    "mlApiName": "keras.models.fit",
    "embedding": [
      0.38958534598350525,
      -0.229908287525177,
      -2.495786666870117,
      -1.025113821029663,
      1.7230108976364136,
      0.9165827035903931,
      0.37362954020500183,
      0.5426971912384033,
      -1.0058170557022095,
      -0.8284232020378113,
      0.397760272026062,
      0.8395108580589294,
      1.7961323261260986,
      -0.32527264952659607,
      -0.08613733947277069,
      0.025191791355609894,
      0.39233800768852234,
      0.8246533274650574,
      -0.12829989194869995,
      1.3343249559402466,
      -0.16829326748847961,
      -0.0518224872648716,
      -0.005978441331535578,
      -0.7759668231010437,
      1.358260989189148,
      0.8676624298095703,
      -0.5302032232284546,
      1.2650225162506104,
      -0.6835525035858154,
      0.8199217915534973,
      1.7769020795822144,
      0.166093647480011,
      -0.5099482536315918,
      -1.208457112312317,
      -2.572371482849121,
      -0.3337883949279785,
      0.8344998955726624,
      -0.05539880692958832,
      0.6610270142555237,
      0.4608605206012726,
      1.5403401851654053,
      -0.33631566166877747,
      0.6075797080993652,
      0.614143967628479,
      -0.008582360111176968,
      0.13976259529590607,
      1.7877297401428223,
      0.04938628152012825,
      1.206018090248108,
      -0.9229589700698853,
      0.7544464468955994,
      0.5049944519996643,
      0.7332565188407898,
      0.33778926730155945,
      1.7544970512390137,
      0.7277786135673523,
      -0.16027423739433289,
      0.3467106521129608,
      0.6209138631820679,
      -0.8147696852684021,
      0.07247477024793625,
      0.6841360926628113,
      -1.0976084470748901,
      1.2736763954162598,
      -0.09172844141721725,
      -0.40616244077682495,
      -0.4511450529098511,
      0.613348662853241,
      -0.23694589734077454,
      -0.536226212978363,
      0.33794769644737244,
      0.6175112128257751,
      0.5252076983451843,
      0.4168703854084015,
      -0.4667569398880005,
      0.060632701963186264,
      -0.7529990077018738,
      -0.2858242690563202,
      0.014728442765772343,
      0.4415983557701111,
      -0.27596086263656616,
      0.5235210061073303,
      1.0746773481369019,
      0.5262051224708557,
      0.3722677230834961,
      -0.003206787630915642,
      -0.7256181836128235,
      -0.3693658113479614,
      -1.3690736293792725,
      1.0591994524002075,
      -0.3154574930667877,
      -0.029969176277518272,
      0.5989023447036743,
      0.2533740997314453,
      -0.5941454768180847,
      -0.028498301282525063,
      -0.30323609709739685,
      0.38609206676483154,
      -0.9652405977249146,
      0.35452914237976074,
      0.07289575785398483,
      -0.33574771881103516,
      -0.25146546959877014,
      -0.41633209586143494,
      -0.75702303647995,
      1.064383625984192,
      -0.16240552067756653,
      -0.30619874596595764,
      -0.40322619676589966,
      -0.12818165123462677,
      -1.0349761247634888,
      0.5961450934410095,
      -0.5101080536842346,
      -0.7492261528968811,
      0.5616810321807861,
      0.2867390513420105,
      0.5588296055793762,
      0.05899200960993767,
      -0.08740188181400299,
      -0.00109036301728338,
      0.05167422443628311,
      -0.45702725648880005,
      -0.24231179058551788,
      0.33245161175727844,
      -0.6971131563186646,
      0.9128421545028687,
      -1.0026144981384277,
      0.3093138635158539,
      0.19978412985801697,
      -0.8923450708389282,
      -0.1055690348148346,
      -0.28811559081077576,
      -0.4852482080459595,
      0.262620210647583,
      0.6312338709831238,
      0.8658159375190735,
      -0.7394562363624573,
      -0.33455541729927063,
      0.7512774467468262,
      0.6584630012512207,
      0.3045264780521393,
      0.39624664187431335,
      0.3872530460357666,
      -0.6684626936912537,
      0.7673195600509644,
      -1.0862423181533813,
      -0.217166930437088,
      -0.7229108810424805,
      -0.9476335048675537,
      -0.3207497298717499,
      -0.2843739986419678,
      0.43805167078971863,
      -0.3827061951160431,
      0.335805207490921,
      -0.3326321840286255,
      -0.57593834400177,
      -0.24199610948562622,
      -0.1155494973063469,
      0.19879180192947388,
      0.16670382022857666,
      0.9817622900009155,
      0.31429323554039,
      -0.8955121636390686,
      0.7937731146812439,
      0.007630267646163702,
      -0.2883128523826599,
      -0.07026948779821396,
      0.020807946100831032,
      0.289974182844162,
      0.2383306473493576,
      -0.9445461630821228,
      -0.8443568348884583,
      0.5265946388244629,
      -0.7308725714683533,
      0.21254600584506989,
      1.4612278938293457,
      1.223371148109436,
      -0.10662661492824554,
      0.8735949993133545,
      -0.651262640953064,
      0.12037836015224457,
      0.19429244101047516,
      1.4732153415679932,
      0.11494915932416916,
      0.03682694211602211,
      -1.048712134361267,
      0.001281358185224235,
      1.133607029914856,
      -0.8479809165000916,
      -0.8680444955825806,
      1.5737358331680298,
      0.018753517419099808,
      -1.258707880973816,
      -0.490199476480484,
      0.3992001414299011,
      -0.864854097366333,
      0.6851587295532227,
      -0.6797958612442017,
      0.9996330142021179,
      0.27665287256240845,
      -0.32668980956077576,
      0.3323676884174347,
      -0.6458433270454407,
      0.056110043078660965,
      -0.8936718106269836,
      0.46431857347488403,
      -0.30222317576408386,
      0.056263670325279236,
      -0.4186547100543976,
      0.7495338320732117,
      -0.5837668776512146,
      -0.04739249125123024,
      0.06876793503761292,
      0.559689998626709,
      -0.30991217494010925,
      -0.8552278280258179,
      0.5029644966125488,
      -0.21516436338424683,
      -0.6363940834999084,
      0.09261296689510345,
      -0.23218019306659698,
      -0.4969465434551239,
      0.5866376161575317,
      -0.38132041692733765,
      0.977331817150116,
      -0.6238884329795837,
      -0.2757962942123413,
      -0.39560049772262573,
      -0.7066503167152405,
      -0.6170516610145569,
      -0.2652239203453064,
      -0.08758189529180527,
      0.720693826675415,
      0.20509637892246246,
      -0.5621392130851746,
      0.46104106307029724,
      1.1257498264312744,
      1.2804361581802368,
      -0.4208792746067047,
      -0.20723867416381836,
      -0.12114473432302475,
      0.35476154088974,
      -0.5712010264396667,
      0.675842821598053,
      -0.568751335144043,
      0.28140532970428467,
      -0.41720274090766907,
      -0.6312402486801147,
      -0.2513902485370636,
      0.20829227566719055,
      0.21882349252700806,
      0.9791550040245056,
      0.5400101542472839,
      -0.2044007033109665,
      0.9893733263015747,
      -0.3500816524028778,
      -0.5400774478912354,
      -0.48178985714912415,
      0.2663026452064514,
      0.06100282445549965,
      0.3763887882232666,
      -0.2376890480518341,
      0.4459265172481537,
      -0.16704240441322327,
      -0.07317964732646942,
      -0.9732163548469543,
      -0.23849767446517944,
      -0.12425225973129272,
      0.08154821395874023,
      -0.379313200712204,
      -0.03877727687358856,
      0.548745334148407,
      0.808681309223175,
      0.8163336515426636,
      1.0189038515090942,
      0.3764136731624603,
      0.014532883651554585,
      0.20078246295452118,
      -0.44055765867233276,
      0.19735345244407654,
      -0.980950653553009,
      -0.8047360181808472,
      -0.3012142479419708,
      -0.026669982820749283,
      -0.3925457000732422,
      -0.1201743558049202,
      -0.0023158772382885218,
      0.4815962612628937,
      0.5302426815032959,
      0.8304561972618103,
      -0.11318571865558624,
      -0.11175792664289474,
      -0.00948567409068346,
      0.36115947365760803,
      0.30907514691352844,
      0.4141104221343994,
      0.8150122761726379,
      -0.32175636291503906,
      0.0663827434182167,
      -0.900108814239502,
      0.20349884033203125,
      0.9955819845199585,
      0.4967711269855499,
      0.1944403499364853,
      -0.03619210422039032,
      -0.25669699907302856,
      -0.5729950666427612,
      -0.22014349699020386,
      0.5539765954017639,
      -0.6267629265785217,
      -0.9710882902145386,
      -0.35548973083496094,
      -0.19351185858249664,
      0.10616905987262726,
      -0.057387541979551315,
      -0.07147501409053802,
      0.08461061120033264,
      0.5632572770118713,
      -0.055291105061769485,
      0.4554486870765686,
      0.6545239090919495,
      -0.3575687110424042,
      0.17378459870815277,
      -0.005829952657222748,
      -0.30329275131225586,
      0.7431291937828064,
      0.07289250195026398,
      0.5639551281929016,
      0.7239605784416199,
      0.5595447421073914,
      0.6910310983657837,
      -0.41347312927246094,
      1.1006728410720825,
      -1.0319173336029053,
      -0.5638765096664429,
      -0.0036208657547831535,
      0.03987935185432434,
      0.11075436323881149,
      -0.3283086121082306,
      1.4108185768127441,
      0.10017748177051544,
      0.23882216215133667,
      0.2989290952682495,
      -0.5850942134857178,
      -0.04828215390443802,
      -0.11371331661939621,
      -0.9670605659484863,
      -0.3838315010070801,
      0.5400927066802979,
      0.8179064989089966,
      0.12549035251140594,
      -0.07809325307607651,
      -0.08362238854169846,
      -0.21930935978889465,
      -0.44305935502052307,
      -0.10358379036188126,
      0.028754010796546936,
      -0.6086102724075317,
      -0.13255521655082703,
      0.7398137450218201,
      0.5166901350021362,
      0.16344167292118073,
      -0.33453306555747986,
      0.49915242195129395,
      -0.3975251615047455,
      0.7635326981544495,
      0.8280592560768127,
      0.22725822031497955,
      1.141674518585205,
      -0.38993412256240845,
      -0.9122409224510193,
      -0.21081848442554474,
      -0.8997657895088196,
      0.35995081067085266,
      -0.290420800447464,
      -0.45878472924232483,
      -0.6567640900611877,
      0.2916805148124695,
      -0.6791682839393616,
      0.8006545901298523,
      0.8387238383293152,
      -0.6066293120384216,
      -0.6006415486335754,
      0.449858158826828,
      0.8221079111099243,
      -0.49019894003868103,
      0.16102434694766998,
      -0.9215087890625,
      -0.25247377157211304,
      0.435676634311676,
      0.4292418360710144,
      -0.04283806309103966,
      -0.8359270691871643,
      0.1619938164949417,
      0.36664414405822754,
      -0.7993513941764832,
      1.1168643236160278,
      0.3682982623577118,
      -0.510073184967041,
      0.359463632106781,
      -1.1868716478347778,
      -0.47799769043922424,
      0.6444122791290283,
      -0.09839726239442825,
      -0.10246368497610092,
      -0.9363278150558472,
      -0.7213890552520752,
      0.3137950301170349,
      -0.5577212572097778,
      0.8347694873809814,
      0.4427987337112427,
      0.4883041977882385,
      -0.5627312064170837,
      -1.7232282161712646,
      0.7675994038581848,
      0.3884814977645874,
      0.6403394341468811,
      0.7523369193077087,
      -0.09971641004085541,
      -0.86521315574646,
      0.4581587016582489,
      0.8423802256584167,
      -0.23564524948596954,
      0.4499150812625885,
      1.0696837902069092,
      0.4930005669593811,
      0.2292885035276413,
      0.8051302433013916,
      0.26028600335121155,
      -1.418044090270996,
      0.0981471911072731,
      0.8504058122634888,
      0.09682943671941757,
      0.5900379419326782,
      0.14593100547790527,
      0.819844126701355,
      -0.10004521161317825,
      0.27398088574409485,
      -0.2826763391494751,
      1.1831835508346558,
      0.5416144132614136,
      -0.31579551100730896,
      -1.1142386198043823,
      -1.0979231595993042,
      0.07431919127702713,
      0.7020614147186279,
      2.017751455307007,
      -1.6020299196243286,
      -1.232209324836731,
      0.9231078028678894,
      0.16084833443164825,
      -0.5520092844963074,
      1.0632972717285156,
      0.34378761053085327,
      1.306047797203064,
      -0.317612886428833,
      -0.08555730432271957,
      0.26734814047813416,
      -0.14770357310771942,
      0.5212221741676331,
      0.15508680045604706,
      0.0676748976111412,
      -1.1062672138214111,
      0.4280085563659668,
      -0.09769710153341293,
      -0.905475378036499,
      -0.12532946467399597,
      -0.47356492280960083,
      0.40103456377983093,
      0.2934132218360901,
      -1.1607699394226074,
      0.21895010769367218,
      0.0018712893361225724,
      -0.4845767617225647,
      -0.45734596252441406,
      1.0924376249313354,
      -0.6585432887077332,
      0.0758747011423111,
      0.17146578431129456,
      1.0670995712280273,
      0.37526631355285645,
      -1.8252631425857544,
      0.25167012214660645,
      -0.4635264277458191,
      -0.34967437386512756,
      1.5056034326553345,
      0.5124357342720032,
      0.3571593463420868,
      0.7274986505508423,
      -0.3141324818134308,
      0.6130586862564087,
      0.2823464870452881,
      0.4288056492805481,
      -0.3673292100429535,
      -0.6158138513565063,
      -0.044891033321619034,
      0.28043538331985474,
      0.34393152594566345,
      0.493754118680954,
      0.44574907422065735,
      -0.7389017343521118,
      0.2791079878807068,
      -0.1595885008573532,
      0.5538771152496338,
      0.4721645712852478,
      0.011293493211269379,
      0.6585293412208557,
      -1.3171610832214355,
      -0.45411446690559387,
      0.11341984570026398,
      0.05282323807477951,
      0.14202404022216797,
      1.1675721406936646,
      0.26411864161491394,
      0.27469268441200256,
      -1.249079942703247,
      0.46932581067085266,
      -0.0804343968629837,
      -0.5679376125335693,
      -0.7114626169204712,
      0.7126715779304504,
      -0.6282875537872314,
      -0.08885971456766129,
      -0.6703598499298096,
      -0.486299991607666,
      0.16860342025756836,
      0.4966970384120941,
      -1.4964467287063599,
      -0.39115405082702637,
      -0.1786893904209137,
      0.5645498633384705,
      0.18938884139060974,
      -1.2417386770248413,
      0.3450259268283844,
      0.16801334917545319,
      0.12883765995502472,
      -0.5412525534629822,
      1.0472962856292725,
      0.6009463667869568,
      -0.10959544032812119,
      0.07177719473838806,
      0.8945638537406921,
      -0.6882525086402893,
      -0.6977571249008179,
      -0.7807297110557556,
      -0.19251258671283722,
      0.23269842565059662,
      0.39558807015419006,
      0.17635244131088257,
      -1.551639199256897,
      0.5966330766677856,
      -0.9227263331413269,
      0.23797547817230225,
      -0.8740472793579102,
      0.5327296853065491,
      -0.8342317938804626,
      -0.44553980231285095,
      -0.863882839679718,
      -1.0967049598693848,
      -0.7291530966758728,
      -1.14493727684021,
      -0.07321043312549591,
      1.5093775987625122,
      0.6751396059989929,
      0.5123640894889832,
      -0.4934210479259491,
      -0.6301642060279846,
      0.22712647914886475,
      0.28082549571990967,
      0.7091055512428284,
      0.43779832124710083,
      -0.890440046787262,
      0.5706920623779297,
      -0.11803962290287018,
      -0.5720500349998474,
      -0.2550082504749298,
      0.16479836404323578,
      -0.4836370050907135,
      -0.687218189239502,
      -0.9879216551780701,
      -0.08557111024856567,
      -1.505813479423523,
      0.33863791823387146,
      0.5120735168457031,
      -0.48281776905059814,
      1.0547480583190918,
      -0.529327392578125,
      -0.24452155828475952,
      0.2662738561630249,
      0.15601268410682678,
      -0.85258549451828,
      -0.16416515409946442,
      1.1315582990646362,
      -0.7532292604446411,
      -0.33662739396095276,
      -0.6329730749130249,
      -1.312752604484558,
      -0.2240431308746338,
      -1.0091460943222046,
      -1.6517308950424194,
      -0.8323318362236023,
      0.6333667039871216,
      1.370816946029663,
      -1.0578346252441406,
      0.30764368176460266,
      1.1641939878463745,
      -0.6414183378219604,
      0.31745636463165283,
      -0.09505204111337662,
      0.5243427753448486,
      0.5573908686637878,
      -0.062294479459524155,
      -0.0016795068513602018,
      -0.2898664176464081,
      0.2072545289993286,
      -0.8839818835258484,
      1.0210391283035278,
      0.19259628653526306,
      -0.8722957372665405,
      -0.2498810589313507,
      -0.4376671612262726,
      -0.7626969814300537,
      0.4562692642211914,
      -1.501442551612854,
      -0.054112277925014496,
      0.1113726794719696,
      -0.18936623632907867,
      -0.20138396322727203,
      0.5349695682525635,
      0.4598335027694702,
      -1.8235536813735962,
      0.5138780474662781,
      -1.0356167554855347,
      -0.03361765295267105,
      -1.426754117012024,
      1.178870677947998,
      -0.6938529014587402,
      0.7819684147834778,
      0.9511117935180664,
      0.8224982023239136,
      0.228131964802742,
      0.0925598070025444,
      -0.749891459941864,
      -0.5560255646705627,
      0.22845201194286346,
      0.20191690325737,
      0.4660964608192444,
      0.9576805233955383,
      -0.09858749061822891,
      -0.6103789210319519,
      1.0264095067977905,
      0.8631960153579712,
      0.3282916843891144,
      -0.039480060338974,
      0.45754915475845337,
      0.0861644297838211,
      0.30612364411354065,
      -0.09598042070865631,
      0.14459027349948883,
      -0.11908929795026779,
      0.40689411759376526,
      -0.5372792482376099,
      -0.8607214093208313,
      0.8339918255805969,
      0.5391353368759155,
      0.0853278785943985,
      -0.011806296184659004,
      -0.3890123963356018,
      -0.21993593871593475,
      -1.671245813369751,
      0.47604671120643616,
      0.6185067892074585,
      -0.39057332277297974,
      -0.04409686103463173,
      0.4157026708126068,
      -0.47194430232048035,
      0.8799733519554138,
      1.031695008277893,
      0.39102211594581604,
      -0.17319069802761078,
      0.9102490544319153,
      -0.8043684959411621,
      0.4695606231689453,
      0.22013257443904877,
      -0.23862704634666443,
      -0.7516642212867737,
      -0.46557796001434326,
      -0.03601323440670967,
      0.21207328140735626,
      -0.12645643949508667,
      -0.4817347228527069,
      -0.13670127093791962,
      -0.11260566115379333,
      -0.04706297069787979,
      -0.6259623169898987,
      0.9742682576179504,
      -0.45184561610221863,
      -0.3582891821861267,
      0.16073939204216003,
      0.12853632867336273,
      0.3002370297908783,
      0.39938658475875854,
      -0.2527073621749878,
      0.3420267701148987,
      0.18874573707580566,
      0.21432872116565704,
      0.05263179913163185,
      -0.10051684081554413,
      0.008897321298718452,
      -0.18500791490077972,
      -0.12316286563873291,
      -0.06501353532075882,
      -0.4122267961502075,
      0.36603742837905884,
      -0.5932683944702148,
      -0.0782170370221138,
      0.2926701307296753,
      -1.3613053560256958,
      -0.40852436423301697,
      0.4382992684841156,
      0.10947656631469727,
      -0.4255569577217102,
      -1.0235708951950073,
      0.5129401683807373,
      -0.06108149141073227,
      -0.8206803202629089,
      -0.5144019722938538,
      -0.23096933960914612,
      0.03257245197892189,
      -0.048649806529283524,
      -0.9446074962615967,
      -0.10169078409671783,
      -0.9340882301330566,
      1.2100236415863037,
      -0.4072763919830322,
      0.7356612086296082,
      -0.19007086753845215,
      -0.3498210906982422,
      -0.9932697415351868,
      -0.06778491288423538,
      -1.4397974014282227,
      0.3670358657836914,
      0.4236849844455719,
      0.07968500256538391,
      -0.9102543592453003,
      -1.3068121671676636,
      -0.7360451817512512,
      1.3186050653457642,
      0.5531865358352661,
      -0.3763522207736969,
      0.3378497362136841,
      -1.2611578702926636,
      -0.29128900170326233,
      0.6545513272285461,
      -0.4459657371044159,
      -0.27506837248802185,
      0.4975959062576294,
      0.47123488783836365,
      0.9895232319831848,
      0.36264804005622864,
      -0.020762642845511436,
      -1.107115626335144,
      0.06748274713754654,
      0.40799981355667114,
      -0.3383791744709015,
      -0.21027769148349762,
      0.09082535654306412,
      -0.2586045265197754
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "IF",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Train",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/47183159",
    "title": "",
    "question": "\"I am having trouble with the Keras backend functions for setting values.  I am trying to convert a model from PyTorch to Keras and am trying to set the weights of the Keras model, but the weights do not appear to be getting set.  Note: I am not actually setting with np.ones just using that for an example.\n\nI have tried...\n\nLoading an existing model\n\nimport keras\nfrom keras.models import load_model, Model\nmodel = load_model(model_dir+file_name)\nkeras_layer = [layer for layer in model.layers if layer.name=='conv2d_1'][0]\n\nCreating a simple model\n\nimg_input = keras.layers.Input(shape=(3,3,3))\nx = keras.layers.Conv2D(1, kernel_size=1, strides=1, padding=\"\"valid\"\", \nuse_bias=False, name='conv1')(img_input)\nmodel = Model(img_input, x)\nkeras_layer = [layer for layer in model.layers if layer.name=='conv1'][0]\n\nThen using set_weights or set_value\n\nkeras_layer.set_weights([np.ones((1, 1, 3, 1))])\n\nor...\n\nK.batch_set_value([(weight,np.ones((1, 1, 3, 1))) for weight in keras_layer.weights])\n\nafterwards I call either one of the following:\n\nK.batch_get_value([weight for weight in keras_layer.weights])\nkeras_layer.get_weights()\n\nAnd None of the weights appear to have been set.  The same values as before are returned.\n\n[array([[[[  1.61547325e-06],\n      [  2.97779252e-06],\n      [  1.50160542e-06]]]], dtype=float32)]\n\nHow do I set the weights of a layer in Keras with a numpy array of values?\"",
    "answer": "\"What is keras_layer in your code?\n\nYou can set weights these ways:\n\nmodel.layers[i].set_weights(listOfNumpyArrays)    \nmodel.get_layer(layerName).set_weights(...)\nmodel.set_weights(listOfNumpyArrays)\n\nWhere model is an instance of an existing model. \nYou can see the expected length of the list and its array shapes using the method get_weights() from the same instances above.\"",
    "mlApiName": "keras.models,keras.models.layers,keras.models.load_model",
    "embedding": [
      0.11615796387195587,
      1.2543377876281738,
      -2.439831018447876,
      -1.4846932888031006,
      1.3907551765441895,
      -0.16205932199954987,
      -0.36115193367004395,
      -0.043905287981033325,
      -1.183308720588684,
      -0.578072190284729,
      -0.5152912735939026,
      0.643593966960907,
      1.905835747718811,
      0.3268646001815796,
      -0.44575706124305725,
      -0.49554499983787537,
      0.10229285061359406,
      0.3081619143486023,
      0.34290456771850586,
      0.6153506636619568,
      0.2010165899991989,
      -0.6007684469223022,
      0.21801944077014923,
      -0.6592350006103516,
      1.8367011547088623,
      0.2692566514015198,
      -0.3914686441421509,
      1.0809524059295654,
      -0.3447204828262329,
      0.5871496796607971,
      0.6130603551864624,
      -0.9795029163360596,
      0.08656685054302216,
      -0.9947178959846497,
      -1.2662715911865234,
      -0.5282102227210999,
      1.4871019124984741,
      0.1892709881067276,
      0.2327684909105301,
      -0.28081777691841125,
      0.7836345434188843,
      -0.03715023398399353,
      -0.15504123270511627,
      0.8580952882766724,
      -0.14689132571220398,
      -0.3334919214248657,
      1.6930688619613647,
      0.32767453789711,
      0.3139703571796417,
      -0.8202296495437622,
      0.3202846944332123,
      0.2462807297706604,
      -0.2191808521747589,
      -0.5048840045928955,
      1.2457844018936157,
      0.6155515313148499,
      0.11385331302881241,
      1.1680830717086792,
      0.49930793046951294,
      -0.4230637550354004,
      0.47956594824790955,
      1.2595412731170654,
      -1.4795297384262085,
      1.253575325012207,
      0.427280068397522,
      0.22805820405483246,
      -0.6747235059738159,
      0.4968714118003845,
      -0.6183820366859436,
      -0.47980478405952454,
      0.6435545086860657,
      0.6058651804924011,
      -0.9805779457092285,
      -0.05554566904902458,
      -0.4381124973297119,
      -0.4579719007015228,
      -0.5916345715522766,
      -0.6866191029548645,
      -0.49740469455718994,
      0.035282202064991,
      0.27447599172592163,
      1.2741867303848267,
      1.4753775596618652,
      -0.4874367415904999,
      0.14769987761974335,
      0.4406983256340027,
      -0.6500018835067749,
      -0.43479007482528687,
      -1.0351630449295044,
      1.3581575155258179,
      -0.4386955797672272,
      -0.32368677854537964,
      0.2264128178358078,
      1.056500792503357,
      -0.6855899095535278,
      -0.8108620643615723,
      -0.07133317738771439,
      0.7325237989425659,
      -0.7775499820709229,
      -0.06668715178966522,
      -0.4083609879016876,
      1.1735758781433105,
      -0.2986309826374054,
      -1.6342623233795166,
      -0.7436760663986206,
      1.5052306652069092,
      0.15845546126365662,
      0.44058316946029663,
      0.03610696271061897,
      -0.3323921263217926,
      -0.7193007469177246,
      0.14552250504493713,
      0.5562385320663452,
      -0.05428706482052803,
      -0.15083974599838257,
      -0.37635648250579834,
      0.2800467908382416,
      -0.2279740869998932,
      0.40319105982780457,
      0.10203917324542999,
      -0.441083699464798,
      -0.7761581540107727,
      0.7561224102973938,
      -0.04792574793100357,
      0.2793344259262085,
      0.1500464826822281,
      -0.716783881187439,
      0.3901604115962982,
      -0.0749659463763237,
      -1.0646519660949707,
      0.6074309945106506,
      -0.7243667244911194,
      -1.0463148355484009,
      0.2913917601108551,
      0.6472187638282776,
      1.0489838123321533,
      -0.9515403509140015,
      -0.9548808932304382,
      0.5135658979415894,
      0.005324764177203178,
      0.6779327988624573,
      0.28485697507858276,
      -0.6581170558929443,
      -0.9730731844902039,
      0.4701949954032898,
      -0.2832656502723694,
      0.7410097122192383,
      -0.5109503269195557,
      -0.4052674174308777,
      0.44816702604293823,
      0.43320053815841675,
      0.9846099019050598,
      -1.5231636762619019,
      0.06300850212574005,
      0.4355478882789612,
      -0.7667133212089539,
      0.9137313365936279,
      0.9224569797515869,
      0.09286434948444366,
      -0.32240986824035645,
      1.5019807815551758,
      0.7849229574203491,
      -0.1513051837682724,
      0.5190811157226562,
      0.11769664287567139,
      -0.5850575566291809,
      -0.053789835423231125,
      0.6502127051353455,
      -0.34543174505233765,
      0.5797403454780579,
      -0.9325827956199646,
      -0.6765394806861877,
      -0.25188422203063965,
      -0.274686723947525,
      0.36368367075920105,
      1.2109326124191284,
      1.1520150899887085,
      -0.16312429308891296,
      1.0166573524475098,
      -0.4718812108039856,
      0.8914642333984375,
      -0.19470593333244324,
      1.0710475444793701,
      -0.00524982251226902,
      -1.0153288841247559,
      0.2921575605869293,
      0.023826057091355324,
      -0.41920673847198486,
      0.13890518248081207,
      -0.5537563562393188,
      0.26659467816352844,
      -0.038179945200681686,
      -0.11422207951545715,
      -0.5796006321907043,
      0.03220943361520767,
      -0.15210221707820892,
      0.583505392074585,
      -1.0907710790634155,
      1.226976990699768,
      -0.03277360647916794,
      0.44684866070747375,
      0.47445735335350037,
      -0.6307366490364075,
      0.793768048286438,
      -0.7860910892486572,
      1.4760335683822632,
      0.12506388127803802,
      0.22483420372009277,
      -0.3027656674385071,
      0.4185679256916046,
      -0.05572856217622757,
      0.06257139891386032,
      0.3400747776031494,
      0.29963091015815735,
      0.3984386920928955,
      -0.30184870958328247,
      0.886972963809967,
      -0.5831250548362732,
      0.0856848955154419,
      -0.004655014723539352,
      0.37488260865211487,
      -0.10160866379737854,
      0.72769695520401,
      0.25792762637138367,
      0.6112958788871765,
      -0.7383412718772888,
      0.502201497554779,
      -0.27010780572891235,
      -0.3233097791671753,
      -0.19376914203166962,
      -0.8034000396728516,
      -0.6477862596511841,
      0.08237262070178986,
      0.8762690424919128,
      -0.14886946976184845,
      0.8960580825805664,
      0.8769683837890625,
      0.6366025805473328,
      -0.5396551489830017,
      0.2891313433647156,
      0.37859678268432617,
      0.37312841415405273,
      0.45058247447013855,
      0.16414637863636017,
      -1.0572893619537354,
      0.7004373073577881,
      -0.24934442341327667,
      -0.5783584117889404,
      0.03789204731583595,
      0.7209665179252625,
      0.07638408988714218,
      -0.006091564428061247,
      0.8080506920814514,
      0.508368968963623,
      1.0760095119476318,
      -1.138684868812561,
      -0.4439871907234192,
      -0.4786631762981415,
      0.7805339097976685,
      -0.39015477895736694,
      1.004699468612671,
      -0.22150100767612457,
      -0.22756953537464142,
      0.19943125545978546,
      -0.39188137650489807,
      -1.466376543045044,
      -0.3387945890426636,
      -0.18131424486637115,
      -0.030970986932516098,
      0.20840561389923096,
      0.35823535919189453,
      0.48275449872016907,
      1.1854840517044067,
      0.8389416933059692,
      0.9438363313674927,
      0.2528379559516907,
      0.5220569372177124,
      0.03125344589352608,
      0.28502318263053894,
      -0.23930761218070984,
      -0.43625470995903015,
      -1.1279233694076538,
      -0.514276385307312,
      -0.6524393558502197,
      0.09234418720006943,
      0.01602182351052761,
      -0.10047689825296402,
      0.17995701730251312,
      0.6795958876609802,
      0.22117003798484802,
      -0.025619525462388992,
      0.03969975560903549,
      -0.19446976482868195,
      -0.27443939447402954,
      0.2908233404159546,
      1.053892970085144,
      0.8868988156318665,
      -0.45339128375053406,
      0.15275263786315918,
      -0.8372812867164612,
      0.2716469168663025,
      0.8108090162277222,
      0.4820321798324585,
      0.5592702627182007,
      -0.11575258523225784,
      0.4482724368572235,
      0.8234104514122009,
      0.4656265079975128,
      0.30717214941978455,
      -0.22015799582004547,
      -0.6900873184204102,
      0.09118063747882843,
      -0.3143917918205261,
      1.2744288444519043,
      -0.44304051995277405,
      -0.22609184682369232,
      -0.11919891834259033,
      -0.16344419121742249,
      0.1954224854707718,
      -1.1089046001434326,
      -0.660141110420227,
      -0.2112359255552292,
      0.3848704993724823,
      0.35468047857284546,
      -0.5468823313713074,
      1.1263264417648315,
      -0.643860936164856,
      0.1556682288646698,
      0.7906429767608643,
      -0.004975790157914162,
      1.1895869970321655,
      0.3486379086971283,
      0.044239792972803116,
      -1.325398325920105,
      -0.9178170561790466,
      -0.4688437879085541,
      0.37058359384536743,
      0.07810501754283905,
      0.15829463303089142,
      1.4781861305236816,
      -0.18185856938362122,
      0.13764676451683044,
      0.381197065114975,
      -0.31378382444381714,
      -0.5083761811256409,
      0.3501482903957367,
      -1.0883480310440063,
      -1.3119572401046753,
      0.5552696585655212,
      0.3558381199836731,
      -0.4432441294193268,
      0.7776982188224792,
      -0.16400426626205444,
      -0.010322780348360538,
      -0.04664350301027298,
      -0.29631465673446655,
      0.661647379398346,
      -0.09971783310174942,
      -0.1874079555273056,
      0.5575600862503052,
      0.9606677889823914,
      -0.1198846772313118,
      0.25269392132759094,
      -0.4951317310333252,
      0.1319257766008377,
      -0.24734754860401154,
      0.8696649670600891,
      -0.09209058433771133,
      0.8671465516090393,
      -0.2649046778678894,
      0.25872549414634705,
      -0.6874547600746155,
      -0.024917498230934143,
      0.48684462904930115,
      -0.3629409670829773,
      0.304313063621521,
      -0.6183304190635681,
      0.2860274016857147,
      -0.12340196222066879,
      -0.0595194473862648,
      -0.07780531048774719,
      -1.0792800188064575,
      0.19985607266426086,
      0.16711191833019257,
      0.22007928788661957,
      0.8275379538536072,
      0.2963199317455292,
      -0.7474930882453918,
      -0.0026828066911548376,
      0.5459815263748169,
      0.5534660220146179,
      -0.5217164158821106,
      -1.128853678703308,
      -0.23855915665626526,
      0.8753722310066223,
      -0.2098589390516281,
      1.0692381858825684,
      -0.1088382676243782,
      -0.3554159998893738,
      0.3381412625312805,
      -1.1664022207260132,
      -1.01100754737854,
      -0.9839099049568176,
      -0.8556510210037231,
      -0.38343459367752075,
      -0.022005192935466766,
      0.2638019025325775,
      -0.26365432143211365,
      -0.07110744714736938,
      0.4658675789833069,
      0.08112645149230957,
      0.31110888719558716,
      0.598482072353363,
      -1.7113317251205444,
      0.7177154421806335,
      0.08777758479118347,
      0.23091736435890198,
      1.3227849006652832,
      -0.6931251883506775,
      -1.1953951120376587,
      -0.18046773970127106,
      0.366532564163208,
      -0.7522439956665039,
      -0.7063301205635071,
      0.661686360836029,
      0.7869940996170044,
      0.1678263247013092,
      1.441209077835083,
      1.0628695487976074,
      -1.998197078704834,
      0.09561470150947571,
      0.9524269700050354,
      0.8148767948150635,
      -0.02548578940331936,
      -0.27364248037338257,
      0.2182823270559311,
      0.33911439776420593,
      0.7909408807754517,
      -0.7076885104179382,
      0.35827019810676575,
      1.0249385833740234,
      0.2867680788040161,
      -1.8484539985656738,
      -0.3117658793926239,
      0.4208638668060303,
      0.13502362370491028,
      0.8459388017654419,
      -0.7147517204284668,
      -0.9377241730690002,
      0.8690445423126221,
      -0.5201894044876099,
      -0.3509461581707001,
      0.3182624578475952,
      0.30723804235458374,
      1.7834745645523071,
      0.047527313232421875,
      -0.15201081335544586,
      0.04943042993545532,
      -0.3216991126537323,
      -0.03994254022836685,
      0.29430514574050903,
      0.22216664254665375,
      -0.832564115524292,
      -0.1894276738166809,
      -1.0135672092437744,
      -1.2903674840927124,
      -0.1067475974559784,
      -0.004987232852727175,
      0.791138231754303,
      0.8506242632865906,
      -0.5790731906890869,
      -0.6465058922767639,
      0.5068404674530029,
      -0.41862115263938904,
      -0.09166518598794937,
      -0.25121238827705383,
      0.0018653912702575326,
      0.05125316232442856,
      0.25632086396217346,
      0.8551110029220581,
      0.35797303915023804,
      -1.2059012651443481,
      -0.5629450082778931,
      -0.6257972121238708,
      -0.41364648938179016,
      1.6832685470581055,
      -0.055657487362623215,
      0.03459296375513077,
      0.5375738739967346,
      0.20232053101062775,
      0.4197688102722168,
      0.22001075744628906,
      0.14885525405406952,
      -0.06972260773181915,
      0.1470106840133667,
      -0.38180986046791077,
      -0.20336826145648956,
      1.192571997642517,
      0.6261334419250488,
      0.4738405644893646,
      -0.0011668438091874123,
      0.6536555290222168,
      -0.2432110607624054,
      0.41046851873397827,
      0.44843927025794983,
      -0.2925207316875458,
      0.7346595525741577,
      -0.9881855845451355,
      -0.16511154174804688,
      -0.6282843351364136,
      0.606059193611145,
      0.11520791053771973,
      0.07470733672380447,
      0.2217981219291687,
      0.01619330421090126,
      -1.5403730869293213,
      0.16909246146678925,
      0.11921238154172897,
      -0.9975014925003052,
      0.17608433961868286,
      0.07079604268074036,
      -0.9577480554580688,
      -0.05036433786153793,
      -1.0669111013412476,
      -0.6732093095779419,
      0.12286742031574249,
      0.10676358640193939,
      -1.6307438611984253,
      0.00959322415292263,
      -0.4387640655040741,
      0.06367860734462738,
      -0.4801623821258545,
      -1.088592529296875,
      -0.37584036588668823,
      0.8609583973884583,
      -0.5131056308746338,
      -0.4400818943977356,
      1.403770089149475,
      0.24586570262908936,
      -0.21357403695583344,
      0.8628347516059875,
      1.1373976469039917,
      0.2956232726573944,
      -0.6251955628395081,
      -0.7625095248222351,
      0.025395235046744347,
      -0.18364614248275757,
      0.7190449833869934,
      0.785912811756134,
      -0.932372510433197,
      -0.08812405914068222,
      -0.8125132322311401,
      0.42452627420425415,
      -0.5348799228668213,
      -0.060008060187101364,
      -0.49690550565719604,
      -0.9488874673843384,
      -0.8818345069885254,
      -0.4197099804878235,
      -0.45646509528160095,
      -1.0036888122558594,
      0.5832124352455139,
      1.8134852647781372,
      -0.5138922929763794,
      0.1751457005739212,
      -0.5756735801696777,
      -1.1221345663070679,
      0.3932481110095978,
      0.478529155254364,
      0.5325589179992676,
      -0.4455054700374603,
      -1.2843867540359497,
      0.5879042744636536,
      0.40791308879852295,
      -0.40624022483825684,
      0.5265647172927856,
      0.07867874950170517,
      -0.0818839967250824,
      -0.7471826672554016,
      -0.18577797710895538,
      0.281538188457489,
      -1.5967594385147095,
      -0.19360314309597015,
      0.25451362133026123,
      -0.02235584706068039,
      0.12081097811460495,
      -0.025083007290959358,
      -0.8606207370758057,
      0.4192851781845093,
      0.021938079968094826,
      -1.1970033645629883,
      -0.8659388422966003,
      0.9723443388938904,
      -0.11233223229646683,
      0.5278596878051758,
      -0.06983860582113266,
      -0.39625248312950134,
      0.5100093483924866,
      -0.11566787213087082,
      -1.5658069849014282,
      -0.3136642575263977,
      0.7901338338851929,
      1.2513132095336914,
      -1.707632064819336,
      0.3716374635696411,
      1.7279396057128906,
      -0.7096320986747742,
      0.4804973900318146,
      -0.34022602438926697,
      0.7095518112182617,
      0.6585367918014526,
      0.16647739708423615,
      -0.3608749508857727,
      0.35577061772346497,
      0.10624571889638901,
      -1.1578195095062256,
      1.024968147277832,
      0.029462499544024467,
      -0.43596795201301575,
      -0.43753957748413086,
      -1.0883276462554932,
      -1.1581127643585205,
      1.5871820449829102,
      -1.6104716062545776,
      1.1323610544204712,
      -0.5377911329269409,
      -0.9006898999214172,
      0.359515905380249,
      0.3488098382949829,
      0.8327468037605286,
      -1.2548497915267944,
      -0.1715073138475418,
      -1.3887965679168701,
      0.13487783074378967,
      -1.0908126831054688,
      1.337205410003662,
      0.2547701895236969,
      1.1471318006515503,
      0.5363480448722839,
      0.5776483416557312,
      -0.14404049515724182,
      -0.05248548835515976,
      -0.48292794823646545,
      0.5523118376731873,
      -0.2137267291545868,
      -1.2795979976654053,
      0.3871482014656067,
      0.7141945958137512,
      -0.19990594685077667,
      0.1004057303071022,
      1.1526027917861938,
      0.8742526173591614,
      0.01956709660589695,
      -0.1959604024887085,
      0.6092144250869751,
      -0.40085557103157043,
      -0.1980447769165039,
      -0.30763673782348633,
      -1.3702027797698975,
      -0.10143256187438965,
      -0.012750018388032913,
      -0.2720727324485779,
      -1.009664535522461,
      0.29468148946762085,
      0.7694793939590454,
      0.036832891404628754,
      -0.5274973511695862,
      0.012066811323165894,
      -0.43425431847572327,
      -0.5494122505187988,
      0.016490085050463676,
      0.20258675515651703,
      -0.20288895070552826,
      0.6567458510398865,
      0.7250807285308838,
      -0.08505267649888992,
      1.1646637916564941,
      0.9076824188232422,
      0.35383087396621704,
      -0.12855109572410583,
      1.6097391843795776,
      0.3911929428577423,
      0.8148393034934998,
      0.29480406641960144,
      0.3624419867992401,
      -1.2302547693252563,
      0.33178946375846863,
      -1.2144649028778076,
      -0.04612419381737709,
      -0.5617362856864929,
      0.42566055059432983,
      0.1442762166261673,
      0.18676665425300598,
      -0.13592015206813812,
      -1.3485922813415527,
      0.16402144730091095,
      -0.15920352935791016,
      -0.8052451014518738,
      1.0122807025909424,
      0.4616345167160034,
      0.9694525599479675,
      -0.36899518966674805,
      0.369636207818985,
      0.6780775785446167,
      -0.11220145970582962,
      -0.4522939622402191,
      0.21757566928863525,
      -0.23832371830940247,
      -0.5011928677558899,
      -0.4449407756328583,
      -1.2002003192901611,
      -0.03773470222949982,
      -0.3830457627773285,
      1.3188862800598145,
      0.2734462320804596,
      0.6296084523200989,
      0.230488583445549,
      -0.5111358761787415,
      -0.8632426261901855,
      -0.29099008440971375,
      0.23371988534927368,
      -0.471161812543869,
      -1.1538007259368896,
      0.5660083889961243,
      -0.5974494814872742,
      -0.6325041651725769,
      -0.2245846837759018,
      -0.7962695360183716,
      -0.5215426683425903,
      0.5276584029197693,
      -1.1149190664291382,
      -0.37981611490249634,
      -1.5952682495117188,
      1.1060802936553955,
      -0.332493394613266,
      0.2101636379957199,
      -1.0218713283538818,
      -1.0153425931930542,
      -0.7669565677642822,
      -0.4408228397369385,
      -0.8895337581634521,
      0.5793114304542542,
      0.5486856698989868,
      0.4685482382774353,
      -0.7725974321365356,
      -0.28199055790901184,
      -1.1317752599716187,
      1.6646391153335571,
      0.12368054687976837,
      -0.31747129559516907,
      0.33289578557014465,
      -0.20051626861095428,
      -0.49345535039901733,
      0.01501084677875042,
      -1.0788424015045166,
      0.36771464347839355,
      -0.7369058132171631,
      0.48026517033576965,
      0.6748149394989014,
      0.14159585535526276,
      -0.1543515920639038,
      -0.6947165131568909,
      0.36124372482299805,
      0.8030975461006165,
      -0.061205629259347916,
      -0.5430077314376831,
      -0.0638907179236412,
      -0.1703047901391983
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SL",
      "level3": "F",
      "leafContractCategory": "AMO(Level-2)",
      "rootCause": "Missing Options",
      "effect": "IF",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Load",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/43196636",
    "title": "",
    "question": "\"I have an example of a neural network with two layers. The first layer takes two arguments and has one output. The second should take one argument as result of the first layer and one additional argument. It should looks like this:\n\nx1  x2  x3\n \\  /   /\n  y1   /\n   \\  /\n    y2\n\nSo, I'd created a model with two layers and tried to merge them but it returns an error: The first layer in a Sequential model must get an \"\"input_shape\"\" or \"\"batch_input_shape\"\" argument. on the line result.add(merged).\n\nModel:\n\nfirst = Sequential()\nfirst.add(Dense(1, input_shape=(2,), activation='sigmoid'))\n\nsecond = Sequential()\nsecond.add(Dense(1, input_shape=(1,), activation='sigmoid'))\n\nresult = Sequential()\nmerged = Concatenate([first, second])\nada_grad = Adagrad(lr=0.1, epsilon=1e-08, decay=0.0)\nresult.add(merged)\nresult.compile(optimizer=ada_grad, loss=_loss_tensor, metrics=['accuracy'])\"",
    "answer": "\"You're getting the error because result defined as Sequential() is just a container for the model and you have not defined an input for it.\n\nGiven what you're trying to build set result to take the third input x3.\nfirst = Sequential()\nfirst.add(Dense(1, input_shape=(2,), activation='sigmoid'))\n\nsecond = Sequential()\nsecond.add(Dense(1, input_shape=(1,), activation='sigmoid'))\n\nthird = Sequential()\n# of course you must provide the input to result which will be your x3\nthird.add(Dense(1, input_shape=(1,), activation='sigmoid'))\n\n# lets say you add a few more layers to first and second.\n# concatenate them\nmerged = Concatenate([first, second])\n\n# then concatenate the two outputs\n\nresult = Concatenate([merged,  third])\n\nada_grad = Adagrad(lr=0.1, epsilon=1e-08, decay=0.0)\n\nresult.compile(optimizer=ada_grad, loss='binary_crossentropy',\n               metrics=['accuracy'])\n\nHowever, my preferred way of building a model that has this type of input structure would be to use the functional api.\nHere is an implementation of your requirements to get you started:\nfrom keras.models import Model\nfrom keras.layers import Concatenate, Dense, LSTM, Input, concatenate\nfrom keras.optimizers import Adagrad\n\nfirst_input = Input(shape=(2, ))\nfirst_dense = Dense(1, )(first_input)\n\nsecond_input = Input(shape=(2, ))\nsecond_dense = Dense(1, )(second_input)\n\nmerge_one = concatenate([first_dense, second_dense])\n\nthird_input = Input(shape=(1, ))\nmerge_two = concatenate([merge_one, third_input])\n\nmodel = Model(inputs=[first_input, second_input, third_input], outputs=merge_two)\nada_grad = Adagrad(lr=0.1, epsilon=1e-08, decay=0.0)\nmodel.compile(optimizer=ada_grad, loss='binary_crossentropy',\n               metrics=['accuracy'])\n\nTo answer the question in the comments:\n\nHow are result and merged connected? Assuming you mean how are they concatenated.\n\nConcatenation works like this:\n  a        b         c\na b c   g h i    a b c g h i\nd e f   j k l    d e f j k l\n\ni.e rows are just joined.\n\nNow, x1 is input to first, x2 is input into second and x3 input into third.\"",
    "mlApiName": "keras.layers.Concatenate,keras.models.Model",
    "embedding": [
      0.15827356278896332,
      0.7514711022377014,
      -1.84902024269104,
      -1.1450626850128174,
      1.3597676753997803,
      -0.2821630537509918,
      0.180437371134758,
      0.1947551816701889,
      -1.1932939291000366,
      -0.5089974999427795,
      -0.6392271518707275,
      0.42345890402793884,
      2.3808834552764893,
      0.2741663455963135,
      -0.5572735071182251,
      -0.7834574580192566,
      0.3711554706096649,
      0.5900837182998657,
      -0.11182787269353867,
      0.8762706518173218,
      -0.7200396656990051,
      -0.0037522928323596716,
      0.29813146591186523,
      -0.4237515330314636,
      1.5048158168792725,
      0.15218974649906158,
      -0.7014584541320801,
      0.4542554020881653,
      -0.9327532052993774,
      0.24312308430671692,
      1.436294436454773,
      -0.8933907151222229,
      0.24931122362613678,
      -0.7235342860221863,
      -2.023082971572876,
      -0.9654488563537598,
      0.802681565284729,
      -0.28269195556640625,
      -0.09238501638174057,
      0.007907687686383724,
      1.2471262216567993,
      0.4378772974014282,
      -0.11904051154851913,
      -0.2585439085960388,
      -0.1533031165599823,
      0.04427759721875191,
      1.5368865728378296,
      -0.3054349720478058,
      1.0429327487945557,
      -1.2990913391113281,
      0.5265471935272217,
      0.8873448967933655,
      -0.29007548093795776,
      -0.01686418242752552,
      1.3210490942001343,
      0.8227362632751465,
      0.5529858469963074,
      0.6279529333114624,
      1.4422478675842285,
      -0.5729924440383911,
      0.027421867474913597,
      0.8209040760993958,
      -1.1560242176055908,
      1.7282463312149048,
      0.5128265023231506,
      -0.31456923484802246,
      -0.39941665530204773,
      0.9817445278167725,
      -0.40959542989730835,
      -0.0929286926984787,
      0.3894427418708801,
      0.17382478713989258,
      0.9548538327217102,
      -0.20409159362316132,
      -0.07517580687999725,
      0.2295411080121994,
      -0.44358521699905396,
      -0.6736975312232971,
      -0.17753693461418152,
      0.9473865032196045,
      0.17625692486763,
      0.35790368914604187,
      0.9311382174491882,
      -0.42348426580429077,
      0.26350608468055725,
      0.6013146638870239,
      -1.1114423274993896,
      -0.5407441258430481,
      -0.9445451498031616,
      1.74565589427948,
      -0.23934927582740784,
      0.15864670276641846,
      0.45276111364364624,
      0.6755045056343079,
      -0.6447680592536926,
      -0.5199155807495117,
      -0.19084760546684265,
      0.3955024182796478,
      -0.43449074029922485,
      -0.2095450609922409,
      -0.6352828741073608,
      0.31154248118400574,
      0.20077021420001984,
      -1.4751038551330566,
      0.17028464376926422,
      1.1577836275100708,
      0.42918652296066284,
      -0.4914427101612091,
      -0.0534183531999588,
      -0.555754542350769,
      -1.3579761981964111,
      -0.2673141062259674,
      -0.03109685331583023,
      -0.25624436140060425,
      0.14543955028057098,
      -0.5091434121131897,
      -0.36126047372817993,
      0.27633750438690186,
      0.5315790772438049,
      -0.11573269963264465,
      0.38410812616348267,
      -0.6638699173927307,
      0.54538494348526,
      -0.086868055164814,
      -0.047474607825279236,
      1.1023736000061035,
      -0.5338953733444214,
      0.007164753042161465,
      0.1325271725654602,
      -1.17827570438385,
      0.3260582983493805,
      -0.24974459409713745,
      0.0833757147192955,
      0.40077483654022217,
      0.3032670021057129,
      1.0283066034317017,
      -0.9076681733131409,
      -1.0867109298706055,
      0.7448136210441589,
      0.19969023764133453,
      0.3580360412597656,
      -0.03950925171375275,
      -0.350299596786499,
      -0.9333366751670837,
      0.5754923224449158,
      -1.0690667629241943,
      0.6296860575675964,
      -0.373970091342926,
      -0.9145748615264893,
      0.2507243752479553,
      -0.1747003197669983,
      0.590169370174408,
      -1.009284257888794,
      0.5093845725059509,
      0.24124543368816376,
      -0.5807949900627136,
      0.4953843057155609,
      0.12954726815223694,
      0.516305685043335,
      -0.18832054734230042,
      1.1811656951904297,
      -0.1439274698495865,
      -0.5387495756149292,
      0.4810282289981842,
      -0.2536487877368927,
      -0.6314730644226074,
      0.536213755607605,
      -0.4717082679271698,
      0.1548212617635727,
      0.3401181399822235,
      -0.47613829374313354,
      -0.22970907390117645,
      -0.17591655254364014,
      0.4749726951122284,
      0.513674259185791,
      1.119675874710083,
      1.4028078317642212,
      -0.6198024749755859,
      0.487443745136261,
      0.040420323610305786,
      0.7417801022529602,
      0.5452372431755066,
      0.5099745988845825,
      -0.08968721330165863,
      -0.15287111699581146,
      0.04585818201303482,
      0.1730555146932602,
      0.0602266751229763,
      -0.06296467036008835,
      -0.43411657214164734,
      0.4487997889518738,
      0.20980983972549438,
      -0.18493542075157166,
      -0.33456769585609436,
      -0.22388215363025665,
      0.19846022129058838,
      1.1379538774490356,
      -1.0345858335494995,
      1.3720159530639648,
      0.33948689699172974,
      -0.0986257791519165,
      0.35923266410827637,
      -0.7789022326469421,
      0.8394345045089722,
      -0.7812625169754028,
      1.129281997680664,
      -0.5348571538925171,
      0.7026249766349792,
      -0.5881665945053101,
      0.41787293553352356,
      -0.02358401007950306,
      0.02572457492351532,
      0.26527854800224304,
      0.2289591282606125,
      -0.20619860291481018,
      -0.827692449092865,
      0.6113932132720947,
      -0.2659764885902405,
      -0.5374701023101807,
      0.08733213692903519,
      0.049119994044303894,
      -0.5694865584373474,
      1.0943809747695923,
      -0.24648043513298035,
      0.5339982509613037,
      -1.1677809953689575,
      -0.00888427346944809,
      0.08824708312749863,
      -1.2063976526260376,
      -0.41673487424850464,
      -0.28465548157691956,
      -0.9559959769248962,
      0.4844924509525299,
      -0.5420244932174683,
      0.4510510563850403,
      0.7618295550346375,
      0.9341278076171875,
      0.8208659291267395,
      -0.6314669847488403,
      0.5797514915466309,
      0.32522374391555786,
      0.6696776747703552,
      -0.20705007016658783,
      -0.3843297064304352,
      -1.1799805164337158,
      0.3548358082771301,
      -0.049343135207891464,
      -0.2579576373100281,
      -0.11201006174087524,
      0.8679370284080505,
      -0.34091025590896606,
      0.7006980180740356,
      0.18535102903842926,
      0.2629558742046356,
      1.4518057107925415,
      -0.4877331852912903,
      -0.3715519905090332,
      0.022789573296904564,
      0.599288821220398,
      -0.6011682152748108,
      0.7867107391357422,
      0.05484601855278015,
      -0.6613214015960693,
      -0.3424583077430725,
      -0.811698853969574,
      -1.0623949766159058,
      -0.2261296957731247,
      -0.5124451518058777,
      0.45066797733306885,
      -0.171404168009758,
      -0.631908118724823,
      -0.06872903555631638,
      1.006609320640564,
      0.5917468667030334,
      0.7854771018028259,
      0.6929302215576172,
      -0.18496209383010864,
      -0.4615629315376282,
      0.09275771677494049,
      -0.26317939162254333,
      -0.7493060231208801,
      -0.9740386009216309,
      -0.6323637962341309,
      -0.17953063547611237,
      -0.563565194606781,
      -0.018281329423189163,
      -0.27864763140678406,
      0.8107451796531677,
      0.38565465807914734,
      1.1117790937423706,
      -0.37997087836265564,
      0.39983975887298584,
      -0.06801756471395493,
      -0.14262977242469788,
      0.11970584094524384,
      0.7905934453010559,
      1.312134861946106,
      -0.40287134051322937,
      -0.05185220390558243,
      -0.8840510249137878,
      0.12207546085119247,
      0.6343668699264526,
      1.0096330642700195,
      -0.02844596840441227,
      0.21757009625434875,
      -0.07631015032529831,
      -0.2673882246017456,
      0.2868750989437103,
      0.24662858247756958,
      -0.433998703956604,
      -0.4261597692966461,
      -0.2928743064403534,
      0.43320927023887634,
      0.56810462474823,
      0.14930829405784607,
      0.03667083755135536,
      0.6914294958114624,
      0.4498586058616638,
      0.6537886261940002,
      -0.013029566034674644,
      -0.5967469215393066,
      -0.5055357217788696,
      -0.14236095547676086,
      -0.10040713101625443,
      -0.5314784646034241,
      0.6999040842056274,
      -0.3592110574245453,
      0.23134943842887878,
      0.3583622872829437,
      -0.39074471592903137,
      0.513318657875061,
      0.1657884418964386,
      0.4755382239818573,
      -0.944852888584137,
      -0.938128650188446,
      -0.2659575939178467,
      0.025308631360530853,
      0.1464398354291916,
      0.09355621784925461,
      1.3098130226135254,
      -0.3357696533203125,
      0.09167946875095367,
      0.777243435382843,
      -0.4362896978855133,
      -0.1693318486213684,
      0.1633460521697998,
      -0.5714056491851807,
      -0.7022141814231873,
      0.34532231092453003,
      0.29494938254356384,
      -0.2927757799625397,
      0.21526582539081573,
      -0.02511545643210411,
      -0.3104870617389679,
      -0.06465832889080048,
      -0.38545775413513184,
      0.739963173866272,
      -0.30314669013023376,
      -0.11688637733459473,
      0.5352975726127625,
      0.8855035305023193,
      0.0600268580019474,
      -0.230994313955307,
      -0.22555769979953766,
      -0.29658499360084534,
      0.152957946062088,
      0.9470605850219727,
      -0.11992281675338745,
      0.7229673862457275,
      0.06956516951322556,
      -0.3424123227596283,
      -0.2634267210960388,
      -0.7638610005378723,
      0.4142170250415802,
      -0.39924487471580505,
      -0.18053942918777466,
      -1.124387264251709,
      0.0406888909637928,
      -0.40605929493904114,
      0.322335809469223,
      0.4444010555744171,
      -0.6751698851585388,
      -0.13119861483573914,
      0.23173892498016357,
      0.7859498262405396,
      0.24327760934829712,
      0.5218267440795898,
      -0.5420286655426025,
      0.044615019112825394,
      0.8411802649497986,
      0.16059273481369019,
      -0.160821795463562,
      -0.7084563970565796,
      -0.6068429946899414,
      0.44663622975349426,
      -0.5468258261680603,
      0.46722742915153503,
      0.137320414185524,
      -0.6422971487045288,
      0.5134325623512268,
      -1.2115278244018555,
      -0.5211538076400757,
      -0.0022203668486326933,
      -0.6823468208312988,
      -0.08231768012046814,
      -0.4798714518547058,
      0.3529869616031647,
      -0.3497444689273834,
      -0.3164476454257965,
      0.5608603954315186,
      0.6527100205421448,
      0.47325801849365234,
      0.10569281131029129,
      -1.2096703052520752,
      0.474741131067276,
      -0.32996082305908203,
      0.7757813334465027,
      0.6795808672904968,
      -1.0124428272247314,
      -0.720989465713501,
      -0.5607293844223022,
      1.3528536558151245,
      -0.3197398781776428,
      0.13425524532794952,
      0.769073486328125,
      0.49212509393692017,
      0.8231367468833923,
      1.5220320224761963,
      -0.1366010457277298,
      -1.578627586364746,
      0.6927089691162109,
      0.5190839171409607,
      0.7336840629577637,
      -0.10762358456850052,
      -0.3174768388271332,
      0.1143481433391571,
      -0.6500344276428223,
      0.827441930770874,
      -0.28390994668006897,
      0.8977468013763428,
      0.9765218496322632,
      -0.5206133127212524,
      -0.8612281084060669,
      -0.6246773600578308,
      0.6174433827400208,
      0.6419729590415955,
      0.82560133934021,
      -1.2469671964645386,
      -1.6075944900512695,
      1.200812578201294,
      -0.036066554486751556,
      0.19232359528541565,
      0.19172784686088562,
      0.6084794402122498,
      1.5505348443984985,
      0.3437492549419403,
      0.06677619367837906,
      0.3201352655887604,
      -0.21984611451625824,
      0.19758941233158112,
      0.41518494486808777,
      0.1989842802286148,
      -1.0650954246520996,
      -0.18397478759288788,
      0.17806726694107056,
      -1.3916057348251343,
      0.26694363355636597,
      -0.5259774327278137,
      0.5958916544914246,
      0.6309094429016113,
      -0.585313081741333,
      -0.18980425596237183,
      0.5332818627357483,
      0.09796328842639923,
      0.04232512041926384,
      0.24924114346504211,
      0.1084338128566742,
      -0.312551349401474,
      0.2831043601036072,
      0.8119680881500244,
      0.09888752549886703,
      -1.8119057416915894,
      -0.37952011823654175,
      -0.7858946323394775,
      -0.4015817940235138,
      1.517255425453186,
      0.11448253691196442,
      0.2799663841724396,
      0.5337151885032654,
      0.18773961067199707,
      0.48008376359939575,
      0.08096538484096527,
      -0.11458045244216919,
      -0.28715091943740845,
      -0.4488372206687927,
      -0.2727847099304199,
      -0.26250219345092773,
      1.0453544855117798,
      0.3056390881538391,
      0.7867966294288635,
      -0.14217118918895721,
      0.25350314378738403,
      -0.4898698627948761,
      0.060826193541288376,
      0.24480994045734406,
      -0.6755024194717407,
      0.7537074089050293,
      -0.8095088601112366,
      -0.1042657420039177,
      -0.18085210025310516,
      0.1442336142063141,
      -0.6466978788375854,
      -0.23358556628227234,
      0.2683611512184143,
      -0.08434461802244186,
      -1.0526944398880005,
      0.04815828427672386,
      0.013088821433484554,
      -0.8929343223571777,
      -0.12336497753858566,
      0.594618022441864,
      -0.25446268916130066,
      -0.5348079800605774,
      -0.6608623266220093,
      -0.8839478492736816,
      0.6714438199996948,
      0.25261005759239197,
      -1.4229919910430908,
      0.1668369024991989,
      -0.3778115212917328,
      -0.0421200767159462,
      0.22402532398700714,
      -1.1265473365783691,
      0.740675151348114,
      0.7300156950950623,
      -0.6258648037910461,
      -0.42871472239494324,
      0.8560488820075989,
      0.6953929662704468,
      -0.33459407091140747,
      0.376127690076828,
      1.0571832656860352,
      -0.42379724979400635,
      0.027434321120381355,
      -0.38851988315582275,
      0.8808485269546509,
      0.5272731781005859,
      0.4020324647426605,
      0.39242443442344666,
      -0.9717476963996887,
      -0.24589665234088898,
      -1.85666024684906,
      0.41129690408706665,
      -0.9797141551971436,
      0.37015461921691895,
      -0.9297434687614441,
      -0.6597272753715515,
      -0.9642281532287598,
      -0.09509502351284027,
      0.15821197628974915,
      -0.9684780836105347,
      -0.17157022655010223,
      1.7536967992782593,
      0.19201171398162842,
      -0.5007116198539734,
      -0.702262282371521,
      -0.9471555948257446,
      0.8115928173065186,
      0.26098954677581787,
      0.32333219051361084,
      0.05786413699388504,
      -1.559070110321045,
      0.06406429409980774,
      0.33422917127609253,
      -0.3026689291000366,
      0.317192405462265,
      0.5623108744621277,
      0.054176412522792816,
      -0.4928986430168152,
      -0.7628698348999023,
      0.5652011632919312,
      -1.5083680152893066,
      -0.49609625339508057,
      -0.11903995275497437,
      -0.048094555735588074,
      0.5706713795661926,
      -0.2506692707538605,
      -0.01067852508276701,
      -0.15691155195236206,
      0.13167352974414825,
      -0.9198417067527771,
      -0.6757350564002991,
      0.6360858082771301,
      -0.4439132511615753,
      0.42233210802078247,
      -0.2648332417011261,
      -0.24841146171092987,
      0.6289229393005371,
      -0.4077123701572418,
      -1.3562685251235962,
      -0.29626190662384033,
      0.8858861327171326,
      1.6011102199554443,
      -1.0491567850112915,
      -0.05632374808192253,
      1.608949065208435,
      -0.577316403388977,
      0.2382224202156067,
      -0.6074166297912598,
      0.47229132056236267,
      0.25097131729125977,
      -0.3261415362358093,
      -0.1320725679397583,
      -0.07903625071048737,
      0.7054087519645691,
      -1.1450977325439453,
      0.705578088760376,
      -0.5457647442817688,
      0.022332219406962395,
      -0.2781866192817688,
      -0.04790470749139786,
      -0.9924595355987549,
      1.1051291227340698,
      -0.9032301306724548,
      -0.015002395957708359,
      -0.5768101215362549,
      -0.852114737033844,
      -0.24786865711212158,
      0.3782033622264862,
      0.8336225748062134,
      -1.128256916999817,
      0.0035010401625186205,
      -1.0086870193481445,
      -0.3251006305217743,
      -1.105788230895996,
      1.3722714185714722,
      -0.16710734367370605,
      0.9784013032913208,
      0.22221167385578156,
      1.36181640625,
      0.07682781666517258,
      0.4693247377872467,
      -0.14100508391857147,
      1.2808988094329834,
      0.5804452896118164,
      -0.7093567848205566,
      0.7626341581344604,
      0.5535924434661865,
      -0.24421703815460205,
      0.03478751704096794,
      0.7586002945899963,
      0.806323230266571,
      -0.3714699447154999,
      -0.280051052570343,
      0.568784236907959,
      -0.31870609521865845,
      -0.17971856892108917,
      -0.07872218638658524,
      -0.47174200415611267,
      0.16099205613136292,
      -0.057959817349910736,
      -0.5481442213058472,
      -1.1428313255310059,
      0.03032582253217697,
      0.32828643918037415,
      -0.18641644716262817,
      -0.13936440646648407,
      0.3142809271812439,
      0.041874323040246964,
      -1.0425584316253662,
      0.5216322541236877,
      0.32762637734413147,
      0.10356207937002182,
      0.7186333537101746,
      0.285686731338501,
      -0.23027561604976654,
      0.8969696164131165,
      0.8261823654174805,
      0.5565491914749146,
      -0.42895182967185974,
      0.7633328437805176,
      0.010955259203910828,
      0.7602907419204712,
      0.03838874027132988,
      0.35342031717300415,
      -0.9854776263237,
      0.3599690794944763,
      -0.7901508212089539,
      -0.3144969344139099,
      -0.06759483367204666,
      0.3526875972747803,
      0.123882956802845,
      0.350373238325119,
      0.13086622953414917,
      -0.805718183517456,
      0.9228668212890625,
      0.09149438142776489,
      -0.6202973127365112,
      0.6590799689292908,
      0.8354458212852478,
      0.5739385485649109,
      -0.3016660511493683,
      -0.3362601399421692,
      0.7287660837173462,
      -0.4003797769546509,
      0.1057971715927124,
      0.13166870176792145,
      0.3826545774936676,
      -0.07020313292741776,
      -0.10054047405719757,
      -0.5409994721412659,
      0.18166178464889526,
      -0.09733418375253677,
      1.1640419960021973,
      -0.4511374831199646,
      0.39510780572891235,
      -0.14457669854164124,
      -0.17717322707176208,
      -0.7267274260520935,
      0.4380708634853363,
      -0.30341359972953796,
      -0.3646022379398346,
      -1.0745878219604492,
      0.6539631485939026,
      -1.0166711807250977,
      -0.5232641696929932,
      0.11518305540084839,
      -0.6028110980987549,
      -0.7348460555076599,
      0.4501921534538269,
      -0.7665047645568848,
      -0.4579341411590576,
      -1.3697935342788696,
      1.1397641897201538,
      -0.5946482419967651,
      -0.26590609550476074,
      -0.9691722989082336,
      -0.5472391247749329,
      -0.813920795917511,
      -0.2226521521806717,
      -1.3672778606414795,
      -0.24247993528842926,
      0.04514000564813614,
      -0.4672123193740845,
      -0.6109601855278015,
      -0.6767739653587341,
      -1.216783881187439,
      1.756974697113037,
      0.5036665797233582,
      -0.6242995262145996,
      -0.09385260939598083,
      -0.23350316286087036,
      -0.42737099528312683,
      0.1744610220193863,
      0.3958438038825989,
      0.38418763875961304,
      -0.4745972156524658,
      1.3779009580612183,
      1.0638560056686401,
      0.24134884774684906,
      -0.2616047263145447,
      -1.0271342992782593,
      -0.011475407518446445,
      0.11604643613100052,
      -0.07302442193031311,
      -0.1513342708349228,
      -0.17372292280197144,
      -0.2175879031419754
    ],
    "label": {
      "level1": "AMO",
      "level2": "F",
      "level3": "F",
      "leafContractCategory": "F",
      "rootCause": "Missing Required State-specific Method Order",
      "effect": "Unknown",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/42606207",
    "title": "",
    "question": "\"I'm doing a binary classification using Keras (with Tensorflow backend) and I've got about 76% precision and 70% recall. Now I want to try to play with decision threshold. As far as I know Keras uses decision threshold 0.5. Is there a way in Keras to use custom threshold for decision precision and recall?\n\nThank you for your time!\"",
    "answer": "\"create custom metrics like this :\n\nEdited thanks to @Marcin : Create functions that returns the desired metrics with threshold_value as argument\n\ndef precision_threshold(threshold=0.5):\n    def precision(y_true, y_pred):\n        \"\"\"\"\"\"Precision metric.\n        Computes the precision over the whole batch using threshold_value.\n        \"\"\"\"\"\"\n        threshold_value = threshold\n        # Adaptation of the \"\"round()\"\" used before to get the predictions. Clipping to make sure that the predicted raw values are between 0 and 1.\n        y_pred = K.cast(K.greater(K.clip(y_pred, 0, 1), threshold_value), K.floatx())\n        # Compute the number of true positives. Rounding in prevention to make sure we have an integer.\n        true_positives = K.round(K.sum(K.clip(y_true * y_pred, 0, 1)))\n        # count the predicted positives\n        predicted_positives = K.sum(y_pred)\n        # Get the precision ratio\n        precision_ratio = true_positives / (predicted_positives + K.epsilon())\n        return precision_ratio\n    return precision\n\ndef recall_threshold(threshold = 0.5):\n    def recall(y_true, y_pred):\n        \"\"\"\"\"\"Recall metric.\n        Computes the recall over the whole batch using threshold_value.\n        \"\"\"\"\"\"\n        threshold_value = threshold\n        # Adaptation of the \"\"round()\"\" used before to get the predictions. Clipping to make sure that the predicted raw values are between 0 and 1.\n        y_pred = K.cast(K.greater(K.clip(y_pred, 0, 1), threshold_value), K.floatx())\n        # Compute the number of true positives. Rounding in prevention to make sure we have an integer.\n        true_positives = K.round(K.sum(K.clip(y_true * y_pred, 0, 1)))\n        # Compute the number of positive targets.\n        possible_positives = K.sum(K.clip(y_true, 0, 1))\n        recall_ratio = true_positives / (possible_positives + K.epsilon())\n        return recall_ratio\n    return recall\n\nnow you can use them in\n\nmodel.compile(..., metrics = [precision_threshold(0.1), precision_threshold(0.2),precision_threshold(0.8), recall_threshold(0.2,...)])\n\nI hope this helps :)\"",
    "mlApiName": "keras.models.compile",
    "embedding": [
      0.5629875659942627,
      0.48737025260925293,
      -3.083949089050293,
      -0.783648669719696,
      1.4720265865325928,
      -0.5374917984008789,
      0.5913790464401245,
      0.6981595754623413,
      -0.5670339465141296,
      -0.2566777467727661,
      -0.20725437998771667,
      0.9154896140098572,
      2.641498565673828,
      0.49496912956237793,
      -0.5226725935935974,
      -1.011021614074707,
      0.3169828951358795,
      -0.8827478289604187,
      0.4430895745754242,
      0.9407626986503601,
      0.2378585785627365,
      -0.43563833832740784,
      -1.1476610898971558,
      -1.089079737663269,
      0.5783626437187195,
      0.5995393395423889,
      -0.20811742544174194,
      0.8931623697280884,
      -0.8978667259216309,
      1.0556879043579102,
      0.7611730694770813,
      -0.6990571618080139,
      -0.3485035300254822,
      -0.9211241006851196,
      -1.273903727531433,
      -0.9492697715759277,
      0.8234435319900513,
      -0.23940780758857727,
      0.3065429925918579,
      -1.0455938577651978,
      0.8721425533294678,
      0.5912255644798279,
      0.4531265199184418,
      -0.09910110384225845,
      0.3789685070514679,
      0.29235076904296875,
      1.8983324766159058,
      0.24383285641670227,
      0.6488549113273621,
      -0.9696903228759766,
      0.5538030862808228,
      -0.07671677321195602,
      0.15010716021060944,
      0.11170125007629395,
      1.5749987363815308,
      1.2327057123184204,
      -0.321872740983963,
      0.7773526310920715,
      0.813173234462738,
      -1.2128442525863647,
      0.7759373784065247,
      0.6653363704681396,
      -1.506230354309082,
      0.7639362812042236,
      0.4437377452850342,
      0.27207666635513306,
      -0.7417920231819153,
      0.4637398421764374,
      -0.08594018965959549,
      -0.6044772267341614,
      0.5592664480209351,
      0.02254534140229225,
      -0.8963741660118103,
      0.216581329703331,
      -0.8653345108032227,
      1.2236963510513306,
      -0.7893116474151611,
      0.08026997745037079,
      0.24321265518665314,
      0.986070454120636,
      -0.3873443305492401,
      -0.4423326551914215,
      1.4526206254959106,
      -0.06150016933679581,
      -0.07719101011753082,
      -0.07061376422643661,
      -0.6163008213043213,
      -0.32485389709472656,
      -0.21216410398483276,
      1.567983865737915,
      0.11533863097429276,
      -0.08323687314987183,
      0.46813610196113586,
      0.629629909992218,
      -0.6409121155738831,
      0.014530535787343979,
      -0.20110483467578888,
      0.10781598091125488,
      0.17911331355571747,
      -0.04452402889728546,
      -0.042456649243831635,
      0.004107999615371227,
      -0.022448407486081123,
      -1.3525363206863403,
      -0.33973246812820435,
      1.0355842113494873,
      0.012803531251847744,
      -0.0902806743979454,
      0.5233374238014221,
      -0.485733300447464,
      -0.07688231021165848,
      0.3005762994289398,
      -0.37017321586608887,
      -0.3610950708389282,
      -0.06208045780658722,
      0.1315804123878479,
      0.3172426223754883,
      -0.8403182625770569,
      -0.4581884741783142,
      0.20625053346157074,
      0.4120085835456848,
      -0.8087042570114136,
      0.5450552701950073,
      -0.34974128007888794,
      -0.6236363649368286,
      0.8998250365257263,
      -1.2738301753997803,
      -0.45457467436790466,
      -0.4823576509952545,
      -1.2365398406982422,
      0.46046942472457886,
      -0.23546399176120758,
      -0.8000301718711853,
      0.34180784225463867,
      0.12251214683055878,
      2.0516393184661865,
      0.35128483176231384,
      -0.601578414440155,
      0.13118648529052734,
      0.402837336063385,
      0.3637435734272003,
      0.43103113770484924,
      -0.21681371331214905,
      -0.7365742325782776,
      -0.3065532445907593,
      -0.7462064027786255,
      0.20919694006443024,
      -0.09299016743898392,
      -1.071655035018921,
      -0.10002487897872925,
      0.301612913608551,
      0.9002528190612793,
      -0.9182120561599731,
      0.7619304060935974,
      0.19343368709087372,
      -1.1436922550201416,
      0.2602229118347168,
      0.2369309663772583,
      0.18666502833366394,
      0.3115837275981903,
      1.2539173364639282,
      0.7417614459991455,
      -0.5575988292694092,
      1.0171509981155396,
      -0.6574476957321167,
      -0.7548514604568481,
      0.2635633051395416,
      -0.025162499397993088,
      -0.08124378323554993,
      0.6867919564247131,
      -1.2766045331954956,
      -0.48253893852233887,
      0.3877132534980774,
      -0.2664571702480316,
      0.5993258953094482,
      0.9886791110038757,
      1.4340746402740479,
      0.012416255660355091,
      0.3874342143535614,
      -0.422621488571167,
      0.9032503366470337,
      -0.05066079646348953,
      1.1952978372573853,
      -0.2522643208503723,
      -1.092844009399414,
      -0.11473523080348969,
      1.5838563442230225,
      -0.05840572714805603,
      0.14347490668296814,
      -0.19433937966823578,
      0.49475711584091187,
      0.016586055979132652,
      -0.8949267864227295,
      -0.8584014177322388,
      -0.6168091297149658,
      -0.5131964683532715,
      1.1707581281661987,
      -1.3548346757888794,
      0.8949635624885559,
      -0.5000585317611694,
      0.028705131262540817,
      0.29641950130462646,
      -1.187294363975525,
      0.684262752532959,
      -0.8367674946784973,
      1.4810625314712524,
      0.22270801663398743,
      0.9123868942260742,
      -0.5788701176643372,
      0.7484878301620483,
      0.01858561672270298,
      0.13049714267253876,
      0.3792106807231903,
      0.7658117413520813,
      0.1884583681821823,
      -0.3277122676372528,
      0.29033082723617554,
      -0.5549871921539307,
      -0.14347606897354126,
      0.154140904545784,
      0.48798874020576477,
      -0.49333634972572327,
      0.43039217591285706,
      0.6963499188423157,
      0.1846887767314911,
      -0.4323696792125702,
      -0.5028984546661377,
      0.6893595457077026,
      0.17041908204555511,
      0.07016053050756454,
      -0.3248862028121948,
      -0.775702178478241,
      0.44165486097335815,
      0.26833316683769226,
      -0.21896260976791382,
      0.9759659171104431,
      0.6127207279205322,
      0.7137455940246582,
      -0.007820595055818558,
      0.26937153935432434,
      0.40599220991134644,
      0.41593480110168457,
      0.04134354367852211,
      0.5155853629112244,
      -1.6811190843582153,
      0.11623543500900269,
      -0.3823910057544708,
      -0.6634858250617981,
      0.02572103776037693,
      0.678507924079895,
      -0.6499343514442444,
      0.7095931172370911,
      0.5033774375915527,
      0.18001295626163483,
      0.9425100684165955,
      0.060296643525362015,
      -0.34487786889076233,
      0.045817792415618896,
      0.03944285213947296,
      0.493301659822464,
      0.20433124899864197,
      -0.038052983582019806,
      0.5513683557510376,
      -0.5258141160011292,
      -0.14307112991809845,
      -1.0971156358718872,
      -0.6959612369537354,
      -0.4181690216064453,
      0.1991836577653885,
      0.0523720309138298,
      0.6340246200561523,
      0.03583309426903725,
      1.07424795627594,
      1.0609021186828613,
      0.7784055471420288,
      0.297397255897522,
      0.7147757411003113,
      0.05139883607625961,
      0.9765931367874146,
      -0.39876851439476013,
      -0.777665913105011,
      -0.8396445512771606,
      -0.744243323802948,
      -0.4898877739906311,
      -0.2109062820672989,
      -0.024615466594696045,
      0.14187267422676086,
      0.776493489742279,
      0.43428996205329895,
      0.8387048840522766,
      -0.2670910656452179,
      0.0699305385351181,
      -0.5161657333374023,
      0.2027892768383026,
      0.13157068192958832,
      0.7890586256980896,
      0.4812447726726532,
      0.017859242856502533,
      -0.016728751361370087,
      -0.5644545555114746,
      0.11110234260559082,
      0.5506116151809692,
      0.5747439861297607,
      0.6581828594207764,
      -0.2606915831565857,
      -0.5500031113624573,
      -0.11401449143886566,
      0.26268818974494934,
      -0.03878983110189438,
      -0.6652253866195679,
      -0.5089598894119263,
      0.005393561441451311,
      -0.9254668951034546,
      0.3781704604625702,
      -0.6492003798484802,
      0.09104938060045242,
      0.959559977054596,
      1.2217133045196533,
      0.4224979281425476,
      -0.3169010579586029,
      0.8638667464256287,
      -0.5960416197776794,
      -0.0038371942937374115,
      -0.19527505338191986,
      -0.08908981829881668,
      0.740218997001648,
      -0.8057082891464233,
      -0.09998061507940292,
      0.26226720213890076,
      0.2763049006462097,
      1.4035745859146118,
      0.7287863492965698,
      0.22400066256523132,
      -0.8487040400505066,
      -0.9571337103843689,
      -1.0715351104736328,
      -0.04484962299466133,
      0.01019325852394104,
      -0.15280285477638245,
      1.1723589897155762,
      0.07793117314577103,
      0.48756662011146545,
      0.38917240500450134,
      -0.7333913445472717,
      -0.45550915598869324,
      0.9124524593353271,
      -0.2229733020067215,
      -0.7151126861572266,
      0.5979633927345276,
      0.2119714915752411,
      -0.14205074310302734,
      -0.1021103486418724,
      -0.47014838457107544,
      -0.7792462110519409,
      0.5120822787284851,
      0.17764246463775635,
      1.182350993156433,
      0.19094303250312805,
      -0.051911961287260056,
      0.06660302728414536,
      1.165233850479126,
      0.8991926908493042,
      -0.17697228491306305,
      -0.5985803008079529,
      -0.11196823418140411,
      -0.16286803781986237,
      0.849833071231842,
      -0.23721274733543396,
      0.3317579925060272,
      -0.13819727301597595,
      -0.7206072807312012,
      -0.3638913631439209,
      -0.29936787486076355,
      0.6811454892158508,
      -0.3931223452091217,
      -0.13588057458400726,
      -1.0221898555755615,
      0.5723327398300171,
      -0.2418719232082367,
      0.360598087310791,
      0.24371634423732758,
      -0.5456796288490295,
      0.6414694786071777,
      -0.3755936920642853,
      0.4266712963581085,
      -0.20888495445251465,
      0.4572829306125641,
      -1.5117095708847046,
      0.07813535630702972,
      0.4205528497695923,
      -0.050036557018756866,
      -0.7008803486824036,
      -0.585342526435852,
      -0.3478536307811737,
      0.6714197397232056,
      -0.6630542874336243,
      0.6328188180923462,
      0.09800839424133301,
      -0.20245595276355743,
      0.6865265369415283,
      -1.3015844821929932,
      -0.6128047704696655,
      0.3764374852180481,
      0.05278754234313965,
      -0.8051356673240662,
      -0.1942359060049057,
      -0.5032142996788025,
      -0.13179856538772583,
      0.11736289411783218,
      0.6664578318595886,
      0.4622051417827606,
      0.4746282994747162,
      -0.7530186176300049,
      -1.6451141834259033,
      0.1371520757675171,
      0.643241822719574,
      0.7100059986114502,
      1.034363031387329,
      -0.15800581872463226,
      -0.5435424447059631,
      -0.2937380373477936,
      1.069535732269287,
      0.45710477232933044,
      -0.09730223566293716,
      1.3823717832565308,
      0.46427682042121887,
      0.27316340804100037,
      1.5589183568954468,
      0.4919741451740265,
      -2.212756872177124,
      1.1630539894104004,
      0.7567228674888611,
      0.6998376250267029,
      0.012175967916846275,
      0.047892287373542786,
      0.172149196267128,
      -0.16067321598529816,
      -0.0005825803964398801,
      -0.5199967622756958,
      0.4804342985153198,
      0.30194079875946045,
      -0.29994815587997437,
      -1.426059365272522,
      -0.5500411987304688,
      0.02696605771780014,
      0.5413649678230286,
      0.7792893648147583,
      -0.764962375164032,
      -1.2102954387664795,
      1.0054450035095215,
      -0.5190923810005188,
      0.18733835220336914,
      0.045215096324682236,
      0.25308626890182495,
      1.6014387607574463,
      -1.0780222415924072,
      0.10704667866230011,
      0.3381968140602112,
      0.43116694688796997,
      0.8854694962501526,
      0.15259741246700287,
      0.5882902145385742,
      -0.778057873249054,
      0.17532098293304443,
      0.1480506807565689,
      -0.492258757352829,
      0.2935745120048523,
      -0.39432936906814575,
      1.2531527280807495,
      0.8875207901000977,
      -0.9301702380180359,
      -0.5285012722015381,
      0.16504834592342377,
      -0.17065787315368652,
      -0.5582932233810425,
      0.4137830436229706,
      -0.3130396604537964,
      0.19639889895915985,
      0.5978901386260986,
      0.9717987775802612,
      -0.4827266335487366,
      -0.906899631023407,
      -0.24361881613731384,
      -0.5040655136108398,
      -0.4539027214050293,
      1.8222955465316772,
      0.8587158918380737,
      -0.8719959855079651,
      0.09968408197164536,
      -0.3082846701145172,
      0.7653606534004211,
      0.8123862743377686,
      0.4331544041633606,
      -0.1181006208062172,
      -0.44708308577537537,
      -0.3570738136768341,
      0.20021526515483856,
      1.049722671508789,
      0.24087846279144287,
      0.5234648585319519,
      -0.187554731965065,
      0.11600475013256073,
      -0.1376579850912094,
      -0.16863836348056793,
      0.2022523432970047,
      -0.6898840069770813,
      0.4798383414745331,
      -1.2428703308105469,
      -0.31501126289367676,
      0.21907448768615723,
      -0.1165156289935112,
      0.45905622839927673,
      0.5956928730010986,
      0.39548683166503906,
      0.15787570178508759,
      -1.0696159601211548,
      0.7423505187034607,
      0.3372326195240021,
      -0.8993149399757385,
      -0.4107472598552704,
      0.9384874105453491,
      -0.8822960257530212,
      -0.38367703557014465,
      -0.6850292086601257,
      -1.1902648210525513,
      -0.08627219498157501,
      -0.3007832467556,
      -2.0080270767211914,
      0.3237571120262146,
      -0.7483919858932495,
      0.6784296631813049,
      -0.5130632519721985,
      -1.0768263339996338,
      0.1506366729736328,
      0.8502060174942017,
      -0.16240938007831573,
      -0.6969956159591675,
      0.7600179314613342,
      0.5132175087928772,
      0.042800094932317734,
      0.00855990219861269,
      1.8471742868423462,
      0.2645625174045563,
      -0.5621119141578674,
      0.37868306040763855,
      -0.47604966163635254,
      0.2544938921928406,
      0.8525617122650146,
      0.2841728925704956,
      -1.7841918468475342,
      0.28693968057632446,
      -0.6193817257881165,
      0.4075607359409332,
      -1.865512490272522,
      0.19616276025772095,
      0.40093398094177246,
      -0.6376667618751526,
      -0.926842451095581,
      -0.7523995637893677,
      -0.0628388524055481,
      -0.6454660296440125,
      0.1119985431432724,
      1.4399054050445557,
      0.4933149516582489,
      -0.2019619345664978,
      -1.4137496948242188,
      -0.828437864780426,
      -0.056565843522548676,
      0.6890952587127686,
      0.4949903190135956,
      0.005969081539660692,
      -1.0735855102539062,
      0.38355788588523865,
      0.05447997897863388,
      -0.523179292678833,
      0.5854890942573547,
      0.45126453042030334,
      0.7945756316184998,
      -0.4753524363040924,
      -1.3502498865127563,
      0.7368564009666443,
      -0.3433837294578552,
      0.47831106185913086,
      0.06340278685092926,
      -0.17907334864139557,
      0.7154690027236938,
      -0.5632902383804321,
      -0.5793245434761047,
      -0.2501891553401947,
      -0.39085447788238525,
      -0.6606335043907166,
      -0.46222493052482605,
      0.7134577631950378,
      -0.8236188292503357,
      0.5298270583152771,
      -0.04627686366438866,
      -0.17468661069869995,
      -0.7499530911445618,
      -1.1714578866958618,
      -1.530245065689087,
      -0.3024889826774597,
      0.5821259617805481,
      1.0362001657485962,
      -2.057234525680542,
      0.14710664749145508,
      1.3392328023910522,
      -1.2438716888427734,
      -0.1578856110572815,
      -0.12277425080537796,
      0.5586391687393188,
      0.40984854102134705,
      0.04294545575976372,
      0.7549610733985901,
      -0.5837156176567078,
      0.2744634747505188,
      -1.1986494064331055,
      1.263810634613037,
      0.2511748671531677,
      -0.9418884515762329,
      0.0041475314646959305,
      -0.5290921926498413,
      -0.7344842553138733,
      1.4243024587631226,
      -1.2909032106399536,
      0.34125596284866333,
      -0.15171906352043152,
      -0.03778005391359329,
      -0.39468762278556824,
      0.2513987123966217,
      0.3959985077381134,
      -1.742021918296814,
      0.09107565134763718,
      -0.8435710668563843,
      0.6466419100761414,
      -0.8953481912612915,
      1.084272861480713,
      -0.413140207529068,
      0.3028838336467743,
      0.4592095911502838,
      0.2222716063261032,
      0.7429884672164917,
      -0.44891467690467834,
      -0.8407924771308899,
      0.65028977394104,
      0.3561284840106964,
      -0.9090598225593567,
      0.9463794827461243,
      1.1441212892532349,
      0.5621410012245178,
      -0.21397437155246735,
      0.9300068020820618,
      0.6801143884658813,
      0.6674354672431946,
      -0.27397283911705017,
      0.06510657072067261,
      -0.10705648362636566,
      0.28445905447006226,
      -0.3784101605415344,
      -0.3635861575603485,
      -0.527245283126831,
      0.7191218137741089,
      -0.7814239263534546,
      -1.0424931049346924,
      -0.21177129447460175,
      0.790152907371521,
      -0.37461790442466736,
      -1.1726793050765991,
      0.6398388743400574,
      -0.44795697927474976,
      -1.7060878276824951,
      1.0337615013122559,
      -0.22913020849227905,
      -0.34694114327430725,
      0.5536577701568604,
      0.6466960906982422,
      -0.12697726488113403,
      0.6918741464614868,
      0.8399865627288818,
      0.018085895106196404,
      -0.36948296427726746,
      0.3565376102924347,
      0.10929112136363983,
      0.6183196306228638,
      -0.8843393325805664,
      -0.231427863240242,
      -0.6349405646324158,
      0.14551210403442383,
      -0.4128043055534363,
      0.011133920401334763,
      -0.7138065099716187,
      -0.768973708152771,
      -0.3351581394672394,
      0.5891565084457397,
      -0.22941772639751434,
      -0.2609286606311798,
      0.2058560848236084,
      0.5679463744163513,
      -0.5771309733390808,
      0.6222073435783386,
      0.7690851092338562,
      -0.18970468640327454,
      0.2246076613664627,
      0.15585772693157196,
      0.5359810590744019,
      -0.1021527349948883,
      0.3534887433052063,
      0.0526445172727108,
      -0.04749177396297455,
      -0.10660021007061005,
      0.12106190621852875,
      -0.4042186439037323,
      -0.11704635620117188,
      -0.5961102843284607,
      0.7467511892318726,
      -0.4717903435230255,
      0.2592729330062866,
      -0.29286661744117737,
      -0.8687063455581665,
      -0.350685179233551,
      0.12302327901124954,
      0.07808858901262283,
      -0.6835415959358215,
      -1.2958264350891113,
      0.6187270879745483,
      -0.08348514884710312,
      -0.5627543926239014,
      -0.2925044000148773,
      -0.2737291157245636,
      -0.24717532098293304,
      -0.9042853116989136,
      -0.7882365584373474,
      -0.893240749835968,
      -1.6545000076293945,
      0.9249606728553772,
      -0.6845284104347229,
      0.9288522601127625,
      -1.263825535774231,
      0.08349191397428513,
      -1.5462406873703003,
      0.23398061096668243,
      -1.4500850439071655,
      0.8676832914352417,
      0.3617023527622223,
      0.24572943150997162,
      0.02866332232952118,
      -1.1741951704025269,
      -0.5806760191917419,
      1.467880129814148,
      0.5791345238685608,
      -0.7941060662269592,
      0.3226146697998047,
      -0.17728391289710999,
      -0.9430369138717651,
      0.049709971994161606,
      -0.3026551604270935,
      0.06509086489677429,
      0.3880235552787781,
      0.8072762489318848,
      1.51497483253479,
      -0.16448961198329926,
      -0.2488723248243332,
      -0.7553437352180481,
      0.2683717608451843,
      0.5282024145126343,
      -0.29197958111763,
      -0.23000797629356384,
      -0.4451809823513031,
      0.08183515816926956
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Unknown",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/45979848",
    "title": "",
    "question": "\"I a trying to merge 2 sequential models in keras. Here is the code:\n\nmodel1 = Sequential(layers=[\n    # input layers and convolutional layers\n    Conv1D(128, kernel_size=12, strides=4, padding='valid', activation='relu', input_shape=input_shape),\n    MaxPooling1D(pool_size=6),\n    Conv1D(256, kernel_size=12, strides=4, padding='valid', activation='relu'),\n    MaxPooling1D(pool_size=6),\n    Dropout(.5),\n\n])\n\nmodel2 = Sequential(layers=[\n    # input layers and convolutional layers\n    Conv1D(128, kernel_size=20, strides=5, padding='valid', activation='relu', input_shape=input_shape),\n    MaxPooling1D(pool_size=5),\n    Conv1D(256, kernel_size=20, strides=5, padding='valid', activation='relu'),\n    MaxPooling1D(pool_size=5),\n    Dropout(.5),\n\n])\n\nmodel = merge([model1, model2], mode = 'sum')\nFlatten(),\nDense(256, activation='relu'),\nDropout(.5),\nDense(128, activation='relu'),\nDropout(.35),\n# output layer\nDense(5, activation='softmax')\nreturn model\n\nHere is the error log:\n\n  File\n  \"\"/nics/d/home/dsawant/anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py\"\",\n  line 392, in is_keras_tensor\n      raise ValueError('Unexpectedly found an instance of type ' + str(type(x)) + '. ' ValueError: Unexpectedly found an instance of\n  type . Expected a symbolic tensor\n  instance.\n\nSome more log:\n\n  ValueError: Layer merge_1 was called with an input that isn't a\n  symbolic tensor. Received type: class 'keras.models.Sequential'.\n  Full input: [keras.models.Sequential object at 0x2b32d518a780,\n  keras.models.Sequential object at 0x2b32d521ee80]. All inputs to the\n  layer should be tensors.\n\nHow can I merge these 2 Sequential models that use different window sizes and apply functions like 'max', 'sum' etc to them?\"",
    "answer": "\"Using the functional API brings you all possibilities. \n\nWhen using the functional API, you need to keep track of inputs and outputs, instead of just defining layers. \n\nYou define a layer, then you call the layer with an input tensor to get the output tensor. Models and layers can be called exactly the same way.\n\nFor the merge layer, I prefer using other merge layers that are more intuitive, such as Add(), Multiply() and Concatenate() for instance. \n\nfrom keras.layers import *\n\nmergedOut = Add()([model1.output,model2.output])\n    #Add() -> creates a merge layer that sums the inputs\n    #The second parentheses \"\"calls\"\" the layer with the output tensors of the two models\n    #it will demand that both model1 and model2 have the same output shape\n\nThis same idea apply to all the following layers. We keep updating the output tensor giving it to each layer and getting a new output (if we were interested in creating branches, we would use a different var for each output of interest to keep track of them):\n\nmergedOut = Flatten()(mergedOut)    \nmergedOut = Dense(256, activation='relu')(mergedOut)\nmergedOut = Dropout(.5)(mergedOut)\nmergedOut = Dense(128, activation='relu')(mergedOut)\nmergedOut = Dropout(.35)(mergedOut)\n\n# output layer\nmergedOut = Dense(5, activation='softmax')(mergedOut)\n\nNow that we created the \"\"path\"\", it's time to create the Model. Creating the model is just like telling at which input tensors it starts and where it ends:\n\nfrom keras.models import Model\n\nnewModel = Model([model1.input,model2.input], mergedOut)\n    #use lists if you want more than one input or output    \n\nNotice that since this model has two inputs, you have to train it with two different X_training vars in a list:\n\nnewModel.fit([X_train_1, X_train_2], Y_train, ....)    \n\nNow, suppose you wanted only one input, and both model1 and model2 would take the same input. \n\nThe functional API allows that quite easily by creating an input tensor and feeding it to the models (we call the models as if they were layers):   \n\ncommonInput = Input(input_shape)\n\nout1 = model1(commonInput)    \nout2 = model2(commonInput)    \n\nmergedOut = Add()([out1,out2])\n\nIn this case, the Model would consider this input:\n\noneInputModel = Model(commonInput,mergedOut)\"",
    "mlApiName": "keras.models.Model,keras.models.add",
    "embedding": [
      -0.36538657546043396,
      1.4280024766921997,
      -2.2949204444885254,
      -1.1240625381469727,
      1.1849441528320312,
      -0.6487099528312683,
      -0.10701662302017212,
      0.6486712694168091,
      -0.5964723825454712,
      -0.5994393229484558,
      -0.5683460831642151,
      0.21946744620800018,
      1.8777486085891724,
      0.41749805212020874,
      -0.4534152150154114,
      -0.6153799891471863,
      0.5800833702087402,
      0.4279394745826721,
      -0.2634916603565216,
      1.0754295587539673,
      -0.9753962755203247,
      0.001240444602444768,
      0.31437334418296814,
      -0.7473112940788269,
      1.769715428352356,
      0.10499858111143112,
      -0.24572986364364624,
      0.6369318962097168,
      -0.2605028748512268,
      -0.10353236645460129,
      1.2573986053466797,
      -0.8499134182929993,
      0.25486066937446594,
      -0.9491490125656128,
      -1.219075322151184,
      -1.0225781202316284,
      1.0349607467651367,
      -0.6139649152755737,
      -0.16353221237659454,
      -0.5546408295631409,
      0.6790759563446045,
      0.663286566734314,
      0.16414529085159302,
      0.1378018856048584,
      0.03870582953095436,
      -0.7300506234169006,
      1.8963936567306519,
      -0.15406616032123566,
      0.9037478566169739,
      -1.2806282043457031,
      0.5293585658073425,
      0.6649794578552246,
      -0.0032504559494554996,
      0.019376613199710846,
      1.306915044784546,
      0.6932641863822937,
      0.6180257201194763,
      0.09309189021587372,
      1.3279352188110352,
      -0.5656958222389221,
      -0.2904045283794403,
      0.9506985545158386,
      -0.8665826320648193,
      1.1578500270843506,
      0.35686948895454407,
      0.34597015380859375,
      -0.4909105896949768,
      0.9325510263442993,
      -0.18543371558189392,
      -0.6244208812713623,
      0.36969196796417236,
      0.2692188322544098,
      0.7886532545089722,
      -0.010860098525881767,
      -0.010148067027330399,
      0.5205094814300537,
      -0.293952077627182,
      -0.6618687510490417,
      0.46316948533058167,
      0.725044310092926,
      0.1359032690525055,
      1.042144775390625,
      1.2294788360595703,
      -0.2267693430185318,
      -0.12747178971767426,
      0.8219208121299744,
      -0.9730744957923889,
      -0.33012303709983826,
      -0.842400074005127,
      1.0316771268844604,
      -0.35422584414482117,
      -0.12553434073925018,
      0.46680861711502075,
      1.0209206342697144,
      -1.0327303409576416,
      -1.131261944770813,
      -0.049037039279937744,
      0.26324737071990967,
      -0.8594164848327637,
      -0.1808134913444519,
      -0.5234037041664124,
      0.3943869471549988,
      0.1910448521375656,
      -1.4441347122192383,
      0.5876131057739258,
      1.0956541299819946,
      -0.08900447189807892,
      0.198513001203537,
      0.09788566082715988,
      -0.2986457645893097,
      -0.7470499277114868,
      0.009928151033818722,
      -0.4246273338794708,
      -0.4540555775165558,
      0.24551749229431152,
      -0.09663920104503632,
      -0.011760927736759186,
      0.17085903882980347,
      0.26799276471138,
      0.19724036753177643,
      0.2523839473724365,
      -1.11875581741333,
      0.3817284107208252,
      0.03942171856760979,
      0.15585291385650635,
      0.06512855738401413,
      -0.3267039358615875,
      0.07661935687065125,
      0.480581134557724,
      -1.2107089757919312,
      0.3981468379497528,
      -0.6000048518180847,
      0.02987479977309704,
      0.5332211852073669,
      0.5171731114387512,
      1.3250585794448853,
      -0.6908263564109802,
      -1.0255296230316162,
      0.4334475100040436,
      0.11487576365470886,
      0.5352780222892761,
      -0.15383698046207428,
      -0.4029550850391388,
      -0.5379801988601685,
      0.6555180549621582,
      -0.9834772348403931,
      0.5001000761985779,
      -0.41562557220458984,
      -1.3333263397216797,
      -0.07362593710422516,
      0.011718754656612873,
      0.3970763683319092,
      -1.3798391819000244,
      0.346213698387146,
      0.45853567123413086,
      -0.6664320826530457,
      0.6571436524391174,
      0.5963501930236816,
      0.612464189529419,
      -0.45835885405540466,
      0.9247297644615173,
      0.24496357142925262,
      -0.09015107154846191,
      0.8060255646705627,
      -0.34836122393608093,
      -0.501766562461853,
      0.31539270281791687,
      -0.443339079618454,
      -0.14303728938102722,
      0.4035058617591858,
      -0.6853823065757751,
      -0.6993873715400696,
      -0.1282469779253006,
      0.19144470989704132,
      0.2995002269744873,
      1.1724932193756104,
      1.4495068788528442,
      -0.5091226696968079,
      0.46833565831184387,
      0.32208847999572754,
      0.8677139282226562,
      -0.19884000718593597,
      0.6745283007621765,
      0.07795961946249008,
      -0.7681791186332703,
      0.17707613110542297,
      0.23282480239868164,
      0.13957363367080688,
      -0.2772009074687958,
      -0.3610164225101471,
      0.6285438537597656,
      0.1674157977104187,
      0.048618465662002563,
      -0.6551005244255066,
      0.20444822311401367,
      0.48442158102989197,
      0.8789094686508179,
      -0.9887713193893433,
      1.1392872333526611,
      0.09619829803705215,
      -0.19286265969276428,
      0.3174877166748047,
      -0.726026177406311,
      0.34901246428489685,
      -0.5528790354728699,
      1.1309994459152222,
      -0.7889554500579834,
      0.7430619597434998,
      -0.33394646644592285,
      0.18403704464435577,
      0.49829739332199097,
      -0.006777878385037184,
      0.23939800262451172,
      0.24300433695316315,
      0.20652146637439728,
      -0.6246328949928284,
      0.6217940449714661,
      -0.6763628125190735,
      -0.8244733214378357,
      -0.2685382664203644,
      0.6851239204406738,
      0.000654795381706208,
      0.833743155002594,
      0.4576427936553955,
      0.4101746082305908,
      -0.8689555525779724,
      0.03578157722949982,
      0.04945515841245651,
      -0.990685224533081,
      -0.37449002265930176,
      -0.6289567947387695,
      -0.2770689129829407,
      0.5774485468864441,
      -0.039340995252132416,
      -0.26025334000587463,
      0.6844304203987122,
      0.9753881692886353,
      1.0767136812210083,
      -0.8447386026382446,
      0.1149345338344574,
      0.09384612739086151,
      0.9027378559112549,
      0.2656078636646271,
      -0.02545989491045475,
      -1.3605568408966064,
      0.3027748167514801,
      -0.4769139885902405,
      -0.4240703284740448,
      0.1325436234474182,
      0.9180478453636169,
      -0.18696774542331696,
      0.09705810248851776,
      0.6513093709945679,
      0.09426676481962204,
      1.4466575384140015,
      -0.4670565724372864,
      -0.3712734878063202,
      0.3052743673324585,
      0.862477719783783,
      -0.3997114896774292,
      0.7458816766738892,
      0.6499159336090088,
      -0.2140749990940094,
      -0.20132122933864594,
      -0.6857549548149109,
      -0.3345777094364166,
      -0.3493111729621887,
      -0.4217885732650757,
      0.19133968651294708,
      -0.30736860632896423,
      -0.4898372292518616,
      0.397820383310318,
      1.044033408164978,
      0.5446580052375793,
      0.27068933844566345,
      0.4833967685699463,
      0.11266978830099106,
      -0.3837631344795227,
      0.10306823253631592,
      -0.03657427057623863,
      -0.8133231401443481,
      -0.9216518998146057,
      -0.5597286224365234,
      0.3295375108718872,
      -0.28817009925842285,
      -0.16179515421390533,
      0.032276321202516556,
      0.6217067837715149,
      -0.07185817509889603,
      0.8416863679885864,
      -0.05190083384513855,
      0.4310702383518219,
      0.2730570137500763,
      -0.14595307409763336,
      0.15655383467674255,
      0.9244787693023682,
      0.9583772420883179,
      -0.7895434498786926,
      -0.000668722961563617,
      -0.2650400996208191,
      0.7837281823158264,
      0.1514730006456375,
      0.8089225888252258,
      0.5188701152801514,
      0.058128722012043,
      -0.09573707729578018,
      -0.11662161350250244,
      0.33977222442626953,
      0.28589898347854614,
      0.045728541910648346,
      -0.26977914571762085,
      -0.14689616858959198,
      -0.5948852300643921,
      1.0187751054763794,
      -0.3988633453845978,
      0.4567887485027313,
      0.8505361080169678,
      0.49828043580055237,
      0.12499170005321503,
      -0.31186577677726746,
      -0.397666335105896,
      -0.5105355381965637,
      0.3060891926288605,
      0.19342198967933655,
      0.21117834746837616,
      0.9701533317565918,
      -0.5482552647590637,
      0.33135586977005005,
      0.06638845056295395,
      -0.5094016194343567,
      0.05838268622756004,
      0.18142135441303253,
      0.49744099378585815,
      -1.6200875043869019,
      -1.3291209936141968,
      -0.19361455738544464,
      -0.4262668192386627,
      -0.329261839389801,
      0.13767167925834656,
      1.0185185670852661,
      0.3930721580982208,
      0.22689500451087952,
      0.27451539039611816,
      -0.4531990885734558,
      -0.436977744102478,
      0.3101649582386017,
      -0.8297669291496277,
      -0.6566556692123413,
      1.0037758350372314,
      0.1385006457567215,
      -0.5151703357696533,
      0.42674699425697327,
      0.4150873124599457,
      -0.5054033994674683,
      0.0025400815065950155,
      -0.7068094611167908,
      0.99680495262146,
      -0.35020944476127625,
      -0.13352079689502716,
      0.34383124113082886,
      1.1275795698165894,
      -0.1422996073961258,
      -0.22082477807998657,
      -0.4388381242752075,
      0.17666520178318024,
      0.161966934800148,
      1.0514142513275146,
      -0.1008373498916626,
      0.619713544845581,
      0.29717642068862915,
      -0.32011643052101135,
      -0.2824542820453644,
      -0.9634478688240051,
      0.34058770537376404,
      0.12093452364206314,
      -0.024019239470362663,
      -1.131508231163025,
      0.1448306441307068,
      0.23649217188358307,
      0.37022823095321655,
      0.699015200138092,
      -0.3961661159992218,
      -0.16699768602848053,
      0.2729087173938751,
      0.4838583171367645,
      0.46926236152648926,
      0.25736677646636963,
      -1.088597297668457,
      0.27356627583503723,
      1.2132153511047363,
      0.8255175948143005,
      0.02519184537231922,
      -0.8170623779296875,
      -0.6442766785621643,
      0.5647447109222412,
      -0.29884767532348633,
      0.6561984419822693,
      -0.09568870812654495,
      -0.6773470640182495,
      0.3518679141998291,
      -0.987596869468689,
      -1.0234707593917847,
      -0.24478808045387268,
      -0.3453895151615143,
      -0.898356020450592,
      -0.4781202971935272,
      0.2708749771118164,
      -0.3185548186302185,
      0.19362831115722656,
      0.40170207619667053,
      0.5490906834602356,
      0.234162837266922,
      0.29926183819770813,
      -1.4502378702163696,
      0.6720033884048462,
      0.2406645268201828,
      0.6596331596374512,
      0.5017274618148804,
      -0.9103660583496094,
      -0.4579555094242096,
      -0.6705172061920166,
      0.8235107660293579,
      -0.26228100061416626,
      -0.016027633100748062,
      1.1338729858398438,
      0.4293406903743744,
      0.7724895477294922,
      1.6807831525802612,
      -0.13823653757572174,
      -2.4101829528808594,
      0.2914247512817383,
      0.3972455859184265,
      0.7317089438438416,
      -0.3560551404953003,
      -0.18183119595050812,
      -0.290425568819046,
      -0.11931288242340088,
      0.8543229699134827,
      -0.38517269492149353,
      1.0938997268676758,
      1.158679485321045,
      -0.13485164940357208,
      -1.0606633424758911,
      0.013263396918773651,
      0.6318249106407166,
      0.2779195308685303,
      0.8497366905212402,
      -0.9092932939529419,
      -1.35849130153656,
      0.7441409826278687,
      -0.02294502779841423,
      0.059219084680080414,
      0.24323710799217224,
      0.5623316168785095,
      1.403361201286316,
      0.3558978736400604,
      -0.40066832304000854,
      0.31949231028556824,
      -0.42567315697669983,
      0.23986683785915375,
      0.2341490387916565,
      0.5862898230552673,
      -0.33964383602142334,
      -0.177038311958313,
      -0.41565167903900146,
      -0.8915231227874756,
      -0.2181745171546936,
      -0.43539169430732727,
      0.2539125084877014,
      0.6243731379508972,
      -0.6329635381698608,
      0.0685659646987915,
      0.11448005586862564,
      -0.1925370842218399,
      -0.04086397960782051,
      -0.3365142047405243,
      0.07964194566011429,
      -0.05870843306183815,
      0.49436378479003906,
      0.43343549966812134,
      0.06770255416631699,
      -1.4301985502243042,
      -0.17595599591732025,
      -0.4835337996482849,
      -0.3610057234764099,
      1.5488003492355347,
      0.3686029613018036,
      -0.1119052991271019,
      0.3747185170650482,
      -0.07447127997875214,
      0.4931754171848297,
      0.15447671711444855,
      0.07621904462575912,
      -0.05694214254617691,
      -0.17474395036697388,
      -0.45113879442214966,
      0.24865677952766418,
      0.9075273871421814,
      0.27706870436668396,
      0.6943715810775757,
      0.5954768061637878,
      0.08855729550123215,
      -0.41815754771232605,
      -0.03052647039294243,
      0.4526112675666809,
      -0.6744850277900696,
      0.8459376096725464,
      -0.880431056022644,
      -0.02932937815785408,
      0.35730376839637756,
      0.45669999718666077,
      -0.32485833764076233,
      -0.014809716492891312,
      0.33783531188964844,
      -0.14911799132823944,
      -1.2672934532165527,
      0.23306341469287872,
      -0.0013088006526231766,
      -0.5211881995201111,
      -1.0205066204071045,
      0.6256609559059143,
      -0.7332661747932434,
      -0.6329039335250854,
      -0.7191503643989563,
      -1.0012168884277344,
      0.7774268388748169,
      0.26297569274902344,
      -1.5403859615325928,
      0.16100139915943146,
      -0.5754827857017517,
      0.23467956483364105,
      -0.1283654421567917,
      -1.3643724918365479,
      0.7603557705879211,
      0.6570554375648499,
      -0.4734501540660858,
      -0.41840460896492004,
      0.889773428440094,
      0.507726788520813,
      -0.21197813749313354,
      0.3834218978881836,
      1.1156255006790161,
      -0.32161521911621094,
      -0.5686833262443542,
      -0.20334003865718842,
      0.14704398810863495,
      0.5543738603591919,
      0.7306488752365112,
      0.47022008895874023,
      -0.8505158424377441,
      -0.2600192129611969,
      -1.802085518836975,
      0.7855023145675659,
      -0.9201680421829224,
      0.32412999868392944,
      -1.6358330249786377,
      -0.8883696794509888,
      -0.911675214767456,
      -0.6154760718345642,
      -0.028278496116399765,
      -0.4927824139595032,
      -0.054810553789138794,
      1.4958759546279907,
      -0.0218979325145483,
      -0.14499184489250183,
      -1.3303630352020264,
      -0.6568185687065125,
      0.47138550877571106,
      0.6424986124038696,
      0.3630945086479187,
      -0.12238575518131256,
      -1.2751022577285767,
      0.0663413554430008,
      0.3293972313404083,
      0.05251261591911316,
      -0.10696316510438919,
      0.8107184171676636,
      0.19205668568611145,
      -0.6424025297164917,
      -0.625122606754303,
      0.30587390065193176,
      -1.2120002508163452,
      0.20524954795837402,
      0.10909587889909744,
      -0.3796253800392151,
      1.132698893547058,
      0.2257510870695114,
      -0.5072264075279236,
      0.021673401817679405,
      -0.26572927832603455,
      -0.47425898909568787,
      -0.4097539484500885,
      0.6378957033157349,
      -0.4975048005580902,
      0.49709638953208923,
      -0.06637272238731384,
      -0.2137519121170044,
      0.7990591526031494,
      -0.3072318434715271,
      -1.1773817539215088,
      -0.6362280249595642,
      0.38990047574043274,
      1.8496425151824951,
      -0.8722541332244873,
      -0.10613563656806946,
      1.527780294418335,
      -1.1810870170593262,
      -0.1974126100540161,
      -0.08879953622817993,
      0.5839288234710693,
      0.535114049911499,
      -0.44527217745780945,
      -0.35304197669029236,
      0.17830683290958405,
      0.46603184938430786,
      -1.3510639667510986,
      0.7824605703353882,
      -0.17833100259304047,
      -0.17648185789585114,
      -0.182907372713089,
      -0.06326866894960403,
      -1.2306506633758545,
      1.0372530221939087,
      -1.3217936754226685,
      0.2677532732486725,
      -0.656460165977478,
      -1.0366060733795166,
      -0.35295388102531433,
      0.4761982858181,
      0.7308533787727356,
      -1.0174702405929565,
      -0.6208590269088745,
      -1.373458743095398,
      0.038731496781110764,
      -0.6834638118743896,
      1.0523852109909058,
      -0.9833598136901855,
      0.43104737997055054,
      0.2437632977962494,
      1.0131210088729858,
      0.16784396767616272,
      0.04962331801652908,
      0.0705421045422554,
      1.0420724153518677,
      0.5318660736083984,
      -0.7903091311454773,
      0.8171157240867615,
      0.6305406093597412,
      -0.41362863779067993,
      -0.21764586865901947,
      0.5677542686462402,
      0.64298415184021,
      -0.496747761964798,
      -0.3781556785106659,
      0.4326947033405304,
      -0.3276437222957611,
      0.0943235531449318,
      -0.514385461807251,
      -0.8415058851242065,
      0.2863629460334778,
      0.2567780911922455,
      -0.0381840243935585,
      -1.1816270351409912,
      -0.23007874190807343,
      0.6472460627555847,
      0.04626740142703056,
      -0.06452861428260803,
      0.35425493121147156,
      -0.0966368243098259,
      -1.160811185836792,
      -0.1828770488500595,
      0.6335945129394531,
      -0.4781337082386017,
      0.4667193591594696,
      0.2564316391944885,
      -0.2854822874069214,
      1.0854113101959229,
      0.7874143719673157,
      0.8199080228805542,
      -0.33121249079704285,
      0.4212322235107422,
      -0.4828161299228668,
      0.5291223526000977,
      0.21768873929977417,
      0.35660842061042786,
      -1.0307393074035645,
      0.6865137219429016,
      -0.8541102409362793,
      -0.39003801345825195,
      -0.5762590169906616,
      0.11607251316308975,
      0.01191649492830038,
      0.1468784064054489,
      0.22856095433235168,
      -0.785430908203125,
      0.9185509085655212,
      -0.23064596951007843,
      -1.1073124408721924,
      0.4565453827381134,
      0.9827291965484619,
      0.30712759494781494,
      -0.19642223417758942,
      -0.2881301939487457,
      0.6895126104354858,
      -0.31318584084510803,
      -0.005772116128355265,
      0.35695895552635193,
      0.5437688827514648,
      0.4222559928894043,
      -0.39204397797584534,
      -0.7543879747390747,
      0.16689136624336243,
      -0.2363184094429016,
      1.3823336362838745,
      -0.05720685049891472,
      -0.02043132670223713,
      -0.45268934965133667,
      -0.3893468379974365,
      -0.13845032453536987,
      -0.17702195048332214,
      0.15112541615962982,
      -0.7483630180358887,
      -1.4334752559661865,
      0.2103629857301712,
      -1.1359729766845703,
      -0.514790952205658,
      0.3755582273006439,
      -0.6993639469146729,
      -0.5596569180488586,
      0.3041253983974457,
      -0.795673131942749,
      -0.4112398624420166,
      -1.7180404663085938,
      1.2825720310211182,
      -0.6632148623466492,
      -0.010234219022095203,
      -1.1278623342514038,
      -0.4805549085140228,
      -1.4616613388061523,
      -0.21683228015899658,
      -1.2586792707443237,
      -0.4365941882133484,
      0.1357448250055313,
      0.3598000407218933,
      -0.733793318271637,
      -0.7064035534858704,
      -1.0663985013961792,
      1.2147533893585205,
      0.3459986746311188,
      -0.4993591606616974,
      0.3432815968990326,
      -0.48905882239341736,
      -0.2098449021577835,
      0.24985264241695404,
      0.23287266492843628,
      0.40578293800354004,
      -0.5413694381713867,
      1.4941755533218384,
      0.7063695192337036,
      0.8826125264167786,
      0.06907837837934494,
      -0.9459956884384155,
      0.12493907660245895,
      0.5839192867279053,
      0.10297907888889313,
      -0.5224976539611816,
      -0.07790840417146683,
      -0.3803105056285858
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SL",
      "level3": "F",
      "leafContractCategory": "AMO(Level-2)",
      "rootCause": "Missing Options",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/47523841",
    "title": "",
    "question": "\"I am trying to use keras to store a model and then load it to retrain. My question is how do I set the learning rate to a new value when loading a model?\n\nHere are my code:  \n\n# Save a model\nmodel = Sequential()\nmodel.add(Dense(64, kernel_initializer='uniform', input_shape=(10,)))\nmodel.add(Activation('tanh'))\nmodel.add(Activation('softmax'))\n# learning rate is 0.001\nsgd = optimizers.SGD(lr=0.001, decay=1e-6, momentum=0.9, nesterov=True)\nmodel.compile(loss='mean_squared_error', optimizer=sgd)\nmodel.fit_generator(...)\nmodel.save()\n\nThen load the model,  \n\nmodel = load_model(model)\n# Change the model's parameters here. Set the learning rate to 0.01.\nmodel.fit_generator(...)\n\nThank you.\"",
    "answer": "\"I think I find the answer:\n\nfrom keras import backend as K\n# To get learning rate\nprint(K.get_value(model.optimizer.lr))\n# To set learning rate\nK.set_value(model.optimizer.lr, 0.001)\nkeras.__version__ # 2.0.2\"",
    "mlApiName": "keras.backend.set_value,keras.models.load_model",
    "embedding": [
      0.030180558562278748,
      0.6065530776977539,
      -2.736957550048828,
      -1.174293041229248,
      1.716004729270935,
      -0.27674639225006104,
      -0.11785820126533508,
      0.12018769234418869,
      -1.0384845733642578,
      -0.5950671434402466,
      -0.6334949135780334,
      0.9624308943748474,
      2.2204558849334717,
      0.5496810078620911,
      -0.44160279631614685,
      0.04284825176000595,
      0.3698553740978241,
      -0.03607238829135895,
      -0.23271708190441132,
      0.7173592448234558,
      0.12317294627428055,
      -0.8872517943382263,
      -0.19289307296276093,
      -0.8353585004806519,
      1.3691532611846924,
      -0.0817343071103096,
      -0.8094934821128845,
      0.7917928695678711,
      0.09048915654420853,
      0.9998407363891602,
      0.7061014175415039,
      -1.1564487218856812,
      -0.008189216256141663,
      -0.6904832124710083,
      -1.5074454545974731,
      -0.9271657466888428,
      1.1409839391708374,
      0.2618713974952698,
      -0.4709767997264862,
      -0.4938717782497406,
      0.586518406867981,
      -0.7355419993400574,
      0.4003714323043823,
      0.7983317971229553,
      0.3382165729999542,
      0.3162569999694824,
      1.365017294883728,
      -0.060663893818855286,
      1.028851866722107,
      -0.24420250952243805,
      0.8626640439033508,
      -0.007103512994945049,
      -0.20014315843582153,
      -0.5254859328269958,
      1.7169413566589355,
      1.117820143699646,
      -0.3533562421798706,
      1.1677004098892212,
      0.6084539890289307,
      -1.0691665410995483,
      0.7529504895210266,
      0.8035244941711426,
      -1.4469362497329712,
      0.9703654050827026,
      0.18839183449745178,
      0.07549740374088287,
      -0.23200027644634247,
      1.3624342679977417,
      -1.1249600648880005,
      0.06686101108789444,
      0.19951389729976654,
      0.9370559453964233,
      -1.3668500185012817,
      -0.32303598523139954,
      -0.43631047010421753,
      -0.2905765771865845,
      -0.6284093856811523,
      -0.68700110912323,
      -0.15752439200878143,
      0.34563717246055603,
      -0.0880245640873909,
      1.136691927909851,
      1.2494137287139893,
      -0.40829306840896606,
      0.5309937000274658,
      0.49126702547073364,
      -0.7358652949333191,
      -0.1805909126996994,
      -1.47262442111969,
      1.183458924293518,
      -0.15698383748531342,
      -0.19061674177646637,
      0.7556906342506409,
      0.5296525359153748,
      -1.0129120349884033,
      -0.9693006873130798,
      -0.6742581725120544,
      0.41307973861694336,
      -0.7277191877365112,
      -0.1305333971977234,
      -0.4658260941505432,
      0.35668110847473145,
      -0.18932026624679565,
      -1.508249282836914,
      -0.5372384190559387,
      1.2642403841018677,
      0.023816827684640884,
      0.1434401422739029,
      -0.04047582671046257,
      -0.6896589994430542,
      -0.6298136115074158,
      -0.1292124092578888,
      0.50616055727005,
      0.1340789645910263,
      -0.7223860621452332,
      -0.38009098172187805,
      0.47022542357444763,
      0.2171044945716858,
      0.19653961062431335,
      0.04433051496744156,
      -0.5543791055679321,
      0.40468522906303406,
      0.3358626365661621,
      0.1833925098180771,
      0.13180771470069885,
      1.077938437461853,
      -0.6376534104347229,
      0.3266453742980957,
      -0.21974579989910126,
      -0.4901193380355835,
      0.6144027709960938,
      -0.6404206156730652,
      -1.1086944341659546,
      0.5493748784065247,
      0.6531259417533875,
      1.7011905908584595,
      -0.68845534324646,
      -0.4519801735877991,
      0.23527422547340393,
      0.7343840003013611,
      0.24034631252288818,
      -0.27990788221359253,
      0.14606468379497528,
      -0.3709358274936676,
      -0.04677579551935196,
      0.08291265368461609,
      0.4720393419265747,
      -0.6197717785835266,
      -0.23897957801818848,
      0.39333376288414,
      0.5540209412574768,
      0.7556403875350952,
      -1.1858701705932617,
      0.26679351925849915,
      1.0164909362792969,
      -1.0307456254959106,
      0.614656925201416,
      0.5267995595932007,
      0.6501381993293762,
      -0.13654914498329163,
      1.559600591659546,
      0.02129044383764267,
      -0.24728183448314667,
      0.9972350001335144,
      -0.4064038395881653,
      -0.19581064581871033,
      0.23354306817054749,
      0.5318456888198853,
      0.018425682559609413,
      0.11842367798089981,
      -0.7303352355957031,
      -1.1032562255859375,
      0.037469591945409775,
      -0.4301113784313202,
      0.48267287015914917,
      0.603342592716217,
      1.6671562194824219,
      0.006503034383058548,
      0.8152192831039429,
      0.10738729685544968,
      0.8232715725898743,
      -0.3636845350265503,
      1.396253228187561,
      -0.015565908513963223,
      -0.9042891263961792,
      -0.30714529752731323,
      0.3636316955089569,
      0.24278250336647034,
      0.6007034182548523,
      -0.7519820928573608,
      0.680844783782959,
      0.10561615973711014,
      -0.35992467403411865,
      -0.33428335189819336,
      -0.4975563883781433,
      -0.5147876739501953,
      0.6436018347740173,
      -0.6304264068603516,
      0.9988561272621155,
      0.20602650940418243,
      -0.06512288749217987,
      0.5832605361938477,
      -1.1727228164672852,
      0.03933281823992729,
      -0.7559632658958435,
      0.6017910838127136,
      0.08297447115182877,
      0.4800048768520355,
      0.09476200491189957,
      0.617537796497345,
      0.3780394494533539,
      -0.0029617880936712027,
      0.14695005118846893,
      0.8565942645072937,
      0.7228672504425049,
      -0.5385664701461792,
      0.7282165288925171,
      -0.07786653935909271,
      -0.16776053607463837,
      0.03555850684642792,
      0.16591639816761017,
      -0.8954091668128967,
      0.5030115842819214,
      0.15616250038146973,
      0.4012604355812073,
      -0.7395936250686646,
      -0.057742226868867874,
      -0.38463401794433594,
      -0.2130981981754303,
      0.30456915497779846,
      -0.4117398262023926,
      -0.5987817645072937,
      -0.3087517023086548,
      0.8023604154586792,
      0.3163876235485077,
      1.233217716217041,
      0.6180638074874878,
      1.1823526620864868,
      -0.3871356248855591,
      0.34311580657958984,
      0.6398066282272339,
      0.6167472004890442,
      0.5267710089683533,
      0.029973585158586502,
      -1.0152335166931152,
      0.47363781929016113,
      0.9543529152870178,
      -0.9475340843200684,
      -0.2116226851940155,
      0.6470312476158142,
      0.12447264790534973,
      0.525918185710907,
      0.43391546607017517,
      0.03400355204939842,
      0.8696165084838867,
      -1.1568167209625244,
      -1.1454657316207886,
      -0.534770131111145,
      0.46489134430885315,
      -0.7669117450714111,
      0.6389830708503723,
      0.2899070084095001,
      0.013905097730457783,
      0.19386853277683258,
      -0.44076547026634216,
      -0.9600645303726196,
      -0.28699028491973877,
      0.05644712224602699,
      0.12220389395952225,
      0.13517974317073822,
      -0.18366017937660217,
      0.1595868617296219,
      1.1331883668899536,
      1.0622832775115967,
      0.9659932255744934,
      0.1398487389087677,
      0.06819035112857819,
      -0.13720251619815826,
      0.09581337124109268,
      -0.3501291275024414,
      -0.6314816474914551,
      -1.7369472980499268,
      -0.5469928979873657,
      -0.2495189756155014,
      -0.5726236701011658,
      -0.3126668632030487,
      0.0451296865940094,
      0.18488311767578125,
      0.332572877407074,
      -0.037603333592414856,
      -0.4199834167957306,
      -0.10705872625112534,
      -0.633455753326416,
      0.06918586790561676,
      0.7244814038276672,
      0.8256264328956604,
      0.9676951169967651,
      -0.2522749602794647,
      -0.36909347772598267,
      -0.672523558139801,
      0.24266785383224487,
      0.22470146417617798,
      0.4799901843070984,
      0.1576339155435562,
      -0.35921579599380493,
      0.3211064338684082,
      0.10510643571615219,
      0.2375822365283966,
      0.0958578884601593,
      0.2559290826320648,
      -0.34958556294441223,
      -0.3735131621360779,
      -0.7579043507575989,
      0.7868705987930298,
      -0.7132070660591125,
      0.12845966219902039,
      -0.15956005454063416,
      -0.44323673844337463,
      0.48612573742866516,
      -0.7919979095458984,
      0.0006064556655474007,
      -0.1547696739435196,
      0.08803416043519974,
      -0.03410116210579872,
      -0.39648646116256714,
      0.7190301418304443,
      -0.8083762526512146,
      0.04676439240574837,
      0.4062674641609192,
      -0.24585115909576416,
      1.2193549871444702,
      0.9742368459701538,
      -0.3913445770740509,
      -1.3829561471939087,
      -0.5560581088066101,
      0.007016282994300127,
      -0.20667614042758942,
      0.367964506149292,
      0.20808279514312744,
      1.0132644176483154,
      -0.0965835303068161,
      0.36555126309394836,
      0.3944748342037201,
      -0.05980854108929634,
      -0.9073107242584229,
      -0.2690461277961731,
      -0.9737641215324402,
      -1.5077043771743774,
      0.5917631387710571,
      0.1931474804878235,
      -1.0835506916046143,
      0.44853925704956055,
      -0.23169070482254028,
      0.013950269669294357,
      -0.09407011419534683,
      -0.33458736538887024,
      0.5335841774940491,
      -0.22458645701408386,
      0.11656245589256287,
      0.5050761103630066,
      1.2321523427963257,
      -0.339861124753952,
      0.05264320969581604,
      -0.19223323464393616,
      -0.02478710003197193,
      -0.5411900877952576,
      0.7744842171669006,
      -0.30910468101501465,
      1.3021063804626465,
      -0.2983088195323944,
      -0.11233425885438919,
      -0.38803619146347046,
      -0.30862683057785034,
      0.44819119572639465,
      -0.11732746660709381,
      0.23318396508693695,
      -0.9193854928016663,
      0.6240360140800476,
      -0.4751253128051758,
      -0.11086661368608475,
      0.2432379573583603,
      -1.0188665390014648,
      -0.3717937469482422,
      -0.20836292207241058,
      0.393138587474823,
      0.673216700553894,
      1.000325322151184,
      -0.9189421534538269,
      0.423135370016098,
      1.155653953552246,
      0.7292234897613525,
      -0.7234950661659241,
      -0.8052200078964233,
      0.2582378387451172,
      0.6729736328125,
      -0.5759537816047668,
      1.1074607372283936,
      -0.11752327531576157,
      0.3272894322872162,
      -0.2963663935661316,
      -1.2123254537582397,
      -0.5970637202262878,
      -0.11571290343999863,
      0.012591267004609108,
      -0.20412592589855194,
      -0.02861480787396431,
      0.4407293200492859,
      -0.41168028116226196,
      -0.06423079967498779,
      0.2122863531112671,
      0.07418812066316605,
      0.06615202873945236,
      -0.09107160568237305,
      -1.5108453035354614,
      0.8990145325660706,
      -0.3038792908191681,
      0.5423018336296082,
      1.1826246976852417,
      -0.9484288096427917,
      -0.6865469813346863,
      -0.1497337371110916,
      0.12310812622308731,
      -0.18217991292476654,
      -0.5846006870269775,
      0.6920435428619385,
      0.3313494622707367,
      0.42050424218177795,
      1.6805888414382935,
      1.0578042268753052,
      -2.468473196029663,
      0.12850560247898102,
      0.5916381478309631,
      0.3749069571495056,
      -0.1401888132095337,
      -0.37956908345222473,
      0.1305122822523117,
      0.6100970506668091,
      0.5534798502922058,
      -0.7062065005302429,
      0.12189198285341263,
      0.26426178216934204,
      0.12680985033512115,
      -1.253257393836975,
      -0.048151645809412,
      -0.12147733569145203,
      0.6117098927497864,
      0.6770721673965454,
      -0.8038114309310913,
      -0.9820926785469055,
      0.5596857666969299,
      -0.31255123019218445,
      -0.0060878354124724865,
      0.19256682693958282,
      0.1565580517053604,
      1.827212929725647,
      0.03697711601853371,
      -0.45860758423805237,
      0.14290770888328552,
      -0.055720213800668716,
      0.45647498965263367,
      -0.4124796688556671,
      0.6858987808227539,
      -0.38727977871894836,
      0.016751926392316818,
      -0.06568631529808044,
      -1.365820288658142,
      0.5087099671363831,
      -0.5610119700431824,
      0.21216385066509247,
      1.4618475437164307,
      -0.30650705099105835,
      -0.5999540090560913,
      0.9037217497825623,
      -0.5000634789466858,
      0.2453964501619339,
      0.19874823093414307,
      -0.21480810642242432,
      0.21992497146129608,
      0.8268535137176514,
      0.7651354670524597,
      -0.0800585076212883,
      -1.6280466318130493,
      -0.7460725903511047,
      -0.793282687664032,
      -0.33356332778930664,
      0.8505903482437134,
      0.062336910516023636,
      0.06728467345237732,
      0.47237464785575867,
      -0.47486400604248047,
      1.2147024869918823,
      0.5881627798080444,
      0.06956029683351517,
      0.17362146079540253,
      0.09526563435792923,
      -0.0033940633293241262,
      -0.12443245202302933,
      0.9840391874313354,
      0.2969702184200287,
      -0.07907162606716156,
      0.09273358434438705,
      0.14255738258361816,
      -0.0690259262919426,
      0.15641045570373535,
      0.6268255114555359,
      -0.5796017050743103,
      0.45051029324531555,
      -1.1388098001480103,
      -0.6517490744590759,
      -0.20782962441444397,
      0.1429559737443924,
      0.9385875463485718,
      0.4043063521385193,
      0.44439497590065,
      0.2633717656135559,
      -1.5740913152694702,
      0.42637836933135986,
      0.2934061288833618,
      -0.42161130905151367,
      0.1525275558233261,
      0.274119108915329,
      -0.5217938423156738,
      -0.8745479583740234,
      -0.19457361102104187,
      -1.259704351425171,
      -0.3070051670074463,
      0.6299030184745789,
      -1.58269464969635,
      0.2728482782840729,
      -0.3350074887275696,
      0.3511667251586914,
      0.24545522034168243,
      -0.9498530626296997,
      0.2252979576587677,
      0.5015066862106323,
      -0.47545576095581055,
      -0.5786948204040527,
      0.8634390234947205,
      0.16831447184085846,
      -0.1453174501657486,
      0.4702620506286621,
      0.7188995480537415,
      0.3819533586502075,
      -0.5891755819320679,
      -0.16106095910072327,
      0.037933070212602615,
      -0.5176160931587219,
      0.8293269276618958,
      0.8632972240447998,
      -1.343602180480957,
      -0.04822731763124466,
      -0.7792489528656006,
      1.0000851154327393,
      -1.028857707977295,
      0.3235641121864319,
      -0.5855205059051514,
      -1.0602256059646606,
      -0.6392881274223328,
      -0.66253262758255,
      -0.6985852122306824,
      -0.5093507170677185,
      0.3623966574668884,
      1.9474724531173706,
      -0.24268697202205658,
      -0.2765025496482849,
      -0.8607286214828491,
      -0.7489393949508667,
      0.15845796465873718,
      1.0267785787582397,
      0.44159120321273804,
      -0.17744819819927216,
      -1.4166913032531738,
      0.46195530891418457,
      0.4805772304534912,
      -0.7205271124839783,
      0.07168790698051453,
      0.4276896119117737,
      0.2255813181400299,
      -0.7334587574005127,
      -0.25996163487434387,
      0.17529162764549255,
      -1.6709744930267334,
      0.6396456360816956,
      0.0023684315383434296,
      -0.210670605301857,
      0.9075061082839966,
      -0.008570230565965176,
      -0.28818631172180176,
      0.20805035531520844,
      0.35549500584602356,
      -0.6275574564933777,
      -0.43808552622795105,
      0.6177859902381897,
      -0.0065570417791605,
      0.01905159279704094,
      0.36738404631614685,
      -0.7450727224349976,
      0.45811018347740173,
      -0.16657646000385284,
      -1.4528241157531738,
      -0.5569227933883667,
      0.8832525014877319,
      1.284878134727478,
      -1.441833734512329,
      0.43960797786712646,
      1.3554034233093262,
      -1.0168514251708984,
      0.46560418605804443,
      -0.03360193222761154,
      0.7537083625793457,
      -0.19069519639015198,
      -0.5446507334709167,
      -0.3012863099575043,
      0.5931602120399475,
      0.6491864323616028,
      -0.8426991701126099,
      1.348112940788269,
      0.08181320875883102,
      -0.5858092308044434,
      0.070003442466259,
      -0.983087420463562,
      -0.7658254504203796,
      1.4889037609100342,
      -1.5402053594589233,
      1.0890934467315674,
      -0.9613052606582642,
      -1.1273088455200195,
      -0.41421666741371155,
      0.9691662192344666,
      0.5561321973800659,
      -1.3047384023666382,
      -0.13830921053886414,
      -2.1600053310394287,
      0.041455596685409546,
      -0.5178168416023254,
      1.3681389093399048,
      -0.18478627502918243,
      0.8152363896369934,
      -0.05146839842200279,
      0.7770347595214844,
      0.3241945505142212,
      0.16339631378650665,
      -0.16031473875045776,
      -0.2215433269739151,
      -0.6632378697395325,
      -0.6850057244300842,
      0.46415141224861145,
      0.1758754849433899,
      0.28881314396858215,
      -0.47320792078971863,
      0.9076566100120544,
      0.6415227055549622,
      0.3277716338634491,
      -0.3277890980243683,
      0.8354232311248779,
      -0.24114705622196198,
      -0.19593185186386108,
      -0.07828254997730255,
      -0.3775213658809662,
      -0.11781994253396988,
      0.23266305029392242,
      -0.5423943996429443,
      -0.7959727048873901,
      -0.31554096937179565,
      1.106679081916809,
      0.2103736847639084,
      -0.5375290513038635,
      -0.2509717047214508,
      -0.20303407311439514,
      -1.1173580884933472,
      0.15081728994846344,
      0.6314451098442078,
      -0.26594892144203186,
      0.4667852818965912,
      0.5579320788383484,
      0.26233434677124023,
      1.0060831308364868,
      1.1673517227172852,
      -0.02974039502441883,
      -0.07776986807584763,
      0.7214556336402893,
      0.0853700041770935,
      0.8448402285575867,
      0.7500756978988647,
      0.2586883008480072,
      -1.118618130683899,
      0.2944065034389496,
      -1.0450507402420044,
      0.20341520011425018,
      -0.575930655002594,
      0.2652963399887085,
      0.4043123722076416,
      0.3992726504802704,
      0.5507768392562866,
      -1.4159752130508423,
      0.19358408451080322,
      -0.3580438494682312,
      -0.8346344232559204,
      1.0003565549850464,
      0.5413469672203064,
      0.5875938534736633,
      -0.3460836708545685,
      -0.11357381194829941,
      0.810005247592926,
      0.4422570466995239,
      -0.06036735698580742,
      0.7601140141487122,
      -0.22943170368671417,
      -0.7618165612220764,
      -0.4860733151435852,
      -1.2548145055770874,
      -0.6059806942939758,
      -0.32924649119377136,
      1.0635627508163452,
      0.09365064650774002,
      0.012852689251303673,
      0.42632216215133667,
      -0.4408183693885803,
      -0.7695760726928711,
      -0.4103076457977295,
      0.16524887084960938,
      -0.5379592180252075,
      -0.5628975629806519,
      0.6127640604972839,
      -0.322171688079834,
      -0.42304128408432007,
      -0.3562327027320862,
      -0.6225912570953369,
      -0.5274543762207031,
      0.40056368708610535,
      -1.2256715297698975,
      -0.4877070188522339,
      -1.5776537656784058,
      1.766080379486084,
      -0.1931857019662857,
      0.583828866481781,
      -0.7527832984924316,
      -0.4072839021682739,
      -1.333453893661499,
      0.2881896495819092,
      -0.7721135020256042,
      0.22815516591072083,
      0.5144830942153931,
      0.9427367448806763,
      -0.7798038125038147,
      -0.3109933137893677,
      -0.9304608106613159,
      1.7757099866867065,
      0.43458759784698486,
      -0.19390910863876343,
      0.5479390621185303,
      -0.5342550277709961,
      -0.7149203419685364,
      0.26453250646591187,
      -0.9277217984199524,
      -0.09691116213798523,
      -0.5391547679901123,
      0.7948125004768372,
      0.7152373194694519,
      0.1921093463897705,
      -0.22945734858512878,
      -0.8794624209403992,
      0.08444765955209732,
      -0.042182739824056625,
      0.5015983581542969,
      -0.717632532119751,
      0.3439815044403076,
      -0.4151281714439392
    ],
    "label": {
      "level1": "AMO",
      "level2": "F",
      "level3": "F",
      "leafContractCategory": "F",
      "rootCause": "Missing Required State-specific Method Order",
      "effect": "Unknown",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Load",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/42284873",
    "title": "",
    "question": "\"I'm using the ImageDataGenerator inside Keras to read a directory of images. I'd like to save the result inside a numpy array, so I can do further manipulations and save it to disk in one file.\n\nflow_from_directory() returns an iterator, which is why I tried the following\n\nitr = gen.flow_from_directory('data/train/', batch_size=1, target_size=(32,32))\nimgs = np.concatenate([itr.next() for i in range(itr.nb_sample)])\n\nbut that produced\n\nValueError: could not broadcast input array from shape (32,32,3) into shape (1)\n\nI think I'm misusing the concatenate() function, but I can't figure out where I fail.\"",
    "answer": "\"I had the same problem and solved it the following way:\nitr.next returns the next batch of images as two numpy.ndarray objects: batch_x, batch_y. (Source: keras/preprocessing/image.py)\nSo what you can do is set the batch_size for flow_from_directory to the size of your whole train dataset.\nExample, my whole training set consists of 1481 images:\ntrain_datagen = ImageDataGenerator(rescale=1. / 255)\nitr = train_datagen.flow_from_directory(\ntrain_data_dir,\ntarget_size=(img_width, img_height),\nbatch_size=1481,\nclass_mode='categorical')\n\nX, y = itr.next()\"",
    "mlApiName": "keras.preprocessing.image.ImageDataGenerator.flow_from_directory",
    "embedding": [
      -0.1652904748916626,
      0.42517751455307007,
      -2.483778953552246,
      -1.439988613128662,
      0.18677550554275513,
      -1.0654826164245605,
      0.014279826544225216,
      0.39197981357574463,
      -1.1201168298721313,
      -1.646018624305725,
      -0.039672087877988815,
      0.6948217153549194,
      2.2542126178741455,
      0.44043177366256714,
      -0.16828064620494843,
      -0.5930377840995789,
      -0.026415474712848663,
      -0.630245566368103,
      0.08711035549640656,
      0.9922565817832947,
      -0.3424997627735138,
      -0.03613211587071419,
      0.309187114238739,
      0.15531404316425323,
      1.2258386611938477,
      -0.31926095485687256,
      0.08198539912700653,
      -0.2447919398546219,
      -1.4221171140670776,
      0.38955727219581604,
      1.0711450576782227,
      0.4709708094596863,
      0.1370496302843094,
      -1.3273085355758667,
      -0.9234097003936768,
      -0.22130589187145233,
      0.5986267328262329,
      -0.9060326814651489,
      0.6286562085151672,
      0.213182732462883,
      0.7461442351341248,
      -0.19221250712871552,
      -0.3623112440109253,
      -0.3035615384578705,
      0.30129745602607727,
      -0.6155418157577515,
      1.2204111814498901,
      0.6799150109291077,
      -0.1602979600429535,
      -0.341940701007843,
      0.2018168419599533,
      0.5120670795440674,
      -1.1862225532531738,
      0.11407391726970673,
      0.9341533184051514,
      1.0368406772613525,
      -0.1698620766401291,
      0.047525011003017426,
      0.6894062161445618,
      -0.8178436756134033,
      0.3532714545726776,
      0.42500394582748413,
      -1.1667554378509521,
      0.835456371307373,
      1.0103894472122192,
      -0.7692177891731262,
      -1.36270010471344,
      0.7613649964332581,
      -0.18817734718322754,
      0.09821634739637375,
      0.7018982172012329,
      0.2148837298154831,
      0.48711535334587097,
      0.5518507957458496,
      -0.09590360522270203,
      0.16283880174160004,
      -0.4974479675292969,
      -0.7004119157791138,
      -0.3278769254684448,
      0.4766794741153717,
      0.026540329679846764,
      -0.10197199136018753,
      0.7900922894477844,
      -0.21832142770290375,
      0.6087467670440674,
      0.4007469415664673,
      -0.20015479624271393,
      -0.4574192762374878,
      -0.42035168409347534,
      1.0972363948822021,
      -0.031102946028113365,
      -0.025737473741173744,
      0.1720753312110901,
      1.2008391618728638,
      -0.05924154818058014,
      -0.3015689253807068,
      0.4736033082008362,
      0.6592361927032471,
      -0.34631454944610596,
      -0.3379388153553009,
      -0.0006183325895108283,
      0.24937976896762848,
      -0.04086596891283989,
      -0.627616286277771,
      0.3645319938659668,
      1.0705304145812988,
      0.8178134560585022,
      -0.18289393186569214,
      0.2231174111366272,
      -0.2811688482761383,
      -0.5816317796707153,
      -0.7123607993125916,
      -0.5905064344406128,
      0.05499115213751793,
      0.045016005635261536,
      0.4260035753250122,
      -0.11289510130882263,
      -0.9021492004394531,
      0.16190563142299652,
      -0.043252285569906235,
      -0.1550317257642746,
      -0.7180673480033875,
      0.3228199779987335,
      -0.25796371698379517,
      -0.16591528058052063,
      0.4171055555343628,
      -0.7209630608558655,
      -0.06871280074119568,
      0.2700427174568176,
      -0.6862937211990356,
      -0.45549941062927246,
      -0.9656450748443604,
      0.11278466135263443,
      0.3001483380794525,
      0.5216944217681885,
      0.7254867553710938,
      -0.700949490070343,
      -1.5479611158370972,
      0.5043593645095825,
      0.09735817462205887,
      0.15096339583396912,
      0.08796926587820053,
      -0.8476057052612305,
      -0.1549077332019806,
      0.8671387434005737,
      -0.3948279023170471,
      0.17255567014217377,
      -0.3074105381965637,
      -0.1320931613445282,
      0.07709334790706635,
      -0.042115468531847,
      0.7040908336639404,
      -0.6933887600898743,
      -0.01406792737543583,
      1.076167106628418,
      -0.5316272377967834,
      0.5454027056694031,
      0.9473565220832825,
      1.0397143363952637,
      -0.3616233170032501,
      0.6936292052268982,
      0.3292602300643921,
      -0.6684706807136536,
      0.33877885341644287,
      -0.4517674446105957,
      -1.4463876485824585,
      0.35754698514938354,
      -0.017789175733923912,
      -0.05859999358654022,
      -0.44967421889305115,
      -1.2456657886505127,
      -0.8987427353858948,
      -0.3637520670890808,
      -0.48971158266067505,
      -0.08153606951236725,
      0.6284982562065125,
      1.251433253288269,
      -0.8508703708648682,
      0.7290590405464172,
      -0.5208826661109924,
      0.5155656337738037,
      -0.528978168964386,
      0.45331522822380066,
      0.06923031061887741,
      0.4174719452857971,
      -0.036269716918468475,
      0.047942306846380234,
      0.6215954422950745,
      0.04211830347776413,
      -0.11183944344520569,
      0.5207352638244629,
      0.1481669396162033,
      -0.5350934863090515,
      -0.27907395362854004,
      -0.5870696306228638,
      -0.14859846234321594,
      0.3471887409687042,
      -0.9272505640983582,
      0.5703670978546143,
      0.2040720134973526,
      0.34063464403152466,
      0.18627925217151642,
      -0.4310652017593384,
      0.9109911322593689,
      -0.045357462018728256,
      1.4634082317352295,
      -0.772529125213623,
      1.0841618776321411,
      -0.4584009051322937,
      0.8225529789924622,
      0.6660196185112,
      -0.5628854632377625,
      0.1079382672905922,
      0.06391419470310211,
      -0.2472096085548401,
      -0.5623345971107483,
      1.1015598773956299,
      -0.8543661832809448,
      -0.6598955392837524,
      0.731448233127594,
      0.12138385325670242,
      0.22027702629566193,
      1.1067382097244263,
      -0.30405113101005554,
      -0.008792038075625896,
      -0.19554798305034637,
      0.5100802183151245,
      -0.6171454191207886,
      -0.6714040637016296,
      -0.34911465644836426,
      -1.2248271703720093,
      -0.6782310009002686,
      0.43570560216903687,
      0.5898152589797974,
      0.07498137652873993,
      0.7260082960128784,
      0.07684408873319626,
      1.1633920669555664,
      -1.014762282371521,
      0.01511384081095457,
      0.25946053862571716,
      0.31170132756233215,
      0.3594665229320526,
      -0.3203350007534027,
      -0.9328205585479736,
      0.04186297208070755,
      -0.11937368661165237,
      -0.87400221824646,
      0.24101610481739044,
      0.5296036005020142,
      0.29514461755752563,
      0.033556338399648666,
      0.8205046057701111,
      0.12031609565019608,
      0.6327725052833557,
      -0.5745814442634583,
      -0.8093759417533875,
      0.05818251147866249,
      0.2712877690792084,
      -0.12290319055318832,
      0.23972460627555847,
      0.2829810380935669,
      0.475263386964798,
      -0.2447938621044159,
      -0.44536662101745605,
      -0.9552428722381592,
      0.6385363340377808,
      0.8453649878501892,
      0.5635073184967041,
      -0.3486897051334381,
      0.1216515526175499,
      0.20354633033275604,
      0.5473220348358154,
      -0.8322937488555908,
      0.33961841464042664,
      0.6125004291534424,
      0.10562862455844879,
      0.050262849777936935,
      -0.34317824244499207,
      0.19205129146575928,
      -0.41405797004699707,
      -0.314578652381897,
      -0.6695833206176758,
      0.6064976453781128,
      -0.13064754009246826,
      0.17053832113742828,
      -0.01930723339319229,
      0.8673201203346252,
      0.973362147808075,
      0.6052519083023071,
      0.1775648146867752,
      0.1326577216386795,
      -0.23567655682563782,
      0.5483007431030273,
      0.048822071403265,
      0.10849729180335999,
      1.1309561729431152,
      0.419387549161911,
      0.16767607629299164,
      -0.7138332724571228,
      0.1663988083600998,
      0.47351396083831787,
      1.52592134475708,
      0.5667774081230164,
      -0.05546955764293671,
      0.343828022480011,
      -0.05982102453708649,
      -0.4306515157222748,
      0.02731173485517502,
      -0.46245357394218445,
      -0.41274842619895935,
      -0.20439311861991882,
      -0.4687984883785248,
      1.0352026224136353,
      -0.05784493684768677,
      -0.8185868263244629,
      0.08499535173177719,
      0.2272833287715912,
      0.9810373187065125,
      -0.4196833372116089,
      -0.16559533774852753,
      -0.06668831408023834,
      -0.18158692121505737,
      -0.17282292246818542,
      -0.7561787962913513,
      0.3458397388458252,
      -0.28457656502723694,
      0.5032600164413452,
      1.3956624269485474,
      -0.3053570091724396,
      -0.0808270201086998,
      1.0176455974578857,
      -0.05666494742035866,
      -0.5529611110687256,
      -0.48300912976264954,
      -0.1557384580373764,
      0.42791441082954407,
      0.3419502377510071,
      0.4179573953151703,
      0.9569091200828552,
      0.600850522518158,
      0.33771461248397827,
      0.5447164177894592,
      -1.0432891845703125,
      0.6209278106689453,
      0.8719677925109863,
      -0.5380622148513794,
      -0.05977616459131241,
      0.03427346423268318,
      0.1803489774465561,
      0.6197590827941895,
      -0.548442542552948,
      -0.04314250126481056,
      -1.1292099952697754,
      0.5582528114318848,
      0.774816632270813,
      -0.026191536337137222,
      -0.367662638425827,
      0.6192675232887268,
      0.11575661599636078,
      0.4749661684036255,
      -0.1285545825958252,
      -0.059944942593574524,
      -0.35044363141059875,
      -0.03462754189968109,
      -0.17109014093875885,
      0.8267182111740112,
      -0.3287261426448822,
      0.9050966501235962,
      -0.4592054486274719,
      -0.3482701778411865,
      -1.5080089569091797,
      0.013905651867389679,
      0.5986329317092896,
      -0.5628618597984314,
      0.16713236272335052,
      -0.5526395440101624,
      0.5145377516746521,
      -0.5272542238235474,
      0.061682987958192825,
      0.5668058395385742,
      -0.3188263177871704,
      0.17138849198818207,
      -0.36392664909362793,
      -0.3394230008125305,
      0.4656374156475067,
      0.7177351713180542,
      -0.5671661496162415,
      -0.6947556138038635,
      0.5945670008659363,
      -0.23165513575077057,
      -1.1096166372299194,
      -1.068516731262207,
      -0.9987122416496277,
      0.23662984371185303,
      0.3377632200717926,
      0.05295399948954582,
      0.4919891059398651,
      -0.8549838662147522,
      0.45471301674842834,
      -0.9385684132575989,
      -0.22053366899490356,
      0.11333993822336197,
      -0.318704217672348,
      -0.7872105240821838,
      -0.4476124346256256,
      0.26438799500465393,
      -0.011503768153488636,
      0.4509943425655365,
      0.1720150262117386,
      0.2788773477077484,
      -0.220024973154068,
      -0.5305786728858948,
      -1.5293561220169067,
      0.8361188173294067,
      -0.32518962025642395,
      1.0479700565338135,
      0.6548670530319214,
      -0.7554867267608643,
      -0.0350487157702446,
      -0.21622855961322784,
      0.41267696022987366,
      -0.06519056111574173,
      0.1286182552576065,
      0.4241970479488373,
      1.01285982131958,
      0.1583966761827469,
      1.1241382360458374,
      0.3337142765522003,
      -1.0028464794158936,
      -0.16789591312408447,
      0.711476743221283,
      0.7731414437294006,
      -0.028074560686945915,
      -0.4219475984573364,
      0.29770427942276,
      0.3283548951148987,
      1.4899080991744995,
      -0.35516443848609924,
      0.3711080551147461,
      0.7366172671318054,
      -0.5060367584228516,
      -0.1494167596101761,
      0.376118540763855,
      0.9704118967056274,
      0.7373437285423279,
      1.0059031248092651,
      -0.2960337698459625,
      -1.5869511365890503,
      1.566383719444275,
      -0.4060036540031433,
      0.10270017385482788,
      0.17838019132614136,
      0.17536476254463196,
      1.2310242652893066,
      0.1752479076385498,
      -0.5717096924781799,
      -0.7939326763153076,
      0.4622926115989685,
      0.10437872260808945,
      -0.23723441362380981,
      0.7902936935424805,
      -0.9648351669311523,
      0.3592207431793213,
      -0.08634036779403687,
      -0.5085954070091248,
      0.0604240819811821,
      -0.8472574949264526,
      0.26071345806121826,
      0.7835330367088318,
      -0.4341101348400116,
      -0.2926771938800812,
      0.7688691020011902,
      0.05066974088549614,
      -0.105366550385952,
      0.9793608784675598,
      0.004013150930404663,
      -0.59763103723526,
      1.0402863025665283,
      0.7050080895423889,
      -0.15267179906368256,
      -1.6389541625976562,
      -0.507185697555542,
      -0.6037138104438782,
      0.03179173544049263,
      1.4051997661590576,
      -0.3069419860839844,
      0.10469155013561249,
      0.8469069004058838,
      -0.19785290956497192,
      0.6378096342086792,
      -0.017958989366889,
      0.1593620777130127,
      0.5759835839271545,
      -0.18203191459178925,
      -1.0603166818618774,
      -0.16492046415805817,
      0.18362705409526825,
      0.05167070031166077,
      -0.06547793000936508,
      -0.11128348857164383,
      -0.20124085247516632,
      -1.4201887845993042,
      0.3213464319705963,
      0.6156054735183716,
      -0.03130927309393883,
      0.03258712962269783,
      -0.004555690102279186,
      -0.8894193768501282,
      0.23680022358894348,
      0.8672980070114136,
      0.1101282387971878,
      0.09836773574352264,
      0.4125610291957855,
      0.2591368854045868,
      -1.1386924982070923,
      0.20931684970855713,
      -0.4308694005012512,
      -0.62126624584198,
      0.450503945350647,
      0.7538271546363831,
      -0.6024530529975891,
      -0.2241552323102951,
      -0.2848075032234192,
      -0.5033751130104065,
      0.3187144696712494,
      0.153316468000412,
      -0.5023314952850342,
      0.40472668409347534,
      -0.2151392251253128,
      0.46925631165504456,
      -0.600073516368866,
      -1.0758371353149414,
      -0.009007275104522705,
      -0.05009942501783371,
      -0.188617542386055,
      -0.8628495931625366,
      1.0484073162078857,
      0.453477680683136,
      0.0946473628282547,
      0.5514327883720398,
      1.1017662286758423,
      -0.41820791363716125,
      -0.12606002390384674,
      -0.5131826996803284,
      -0.20754088461399078,
      0.3323873281478882,
      0.1908576786518097,
      0.05090967193245888,
      -0.4472225606441498,
      0.5068245530128479,
      -0.2698103189468384,
      0.1327703595161438,
      -1.4194761514663696,
      -0.09363390505313873,
      -0.262299120426178,
      -0.536230742931366,
      -0.9203886389732361,
      -0.7163788676261902,
      -0.24922853708267212,
      -0.735908031463623,
      0.3754326105117798,
      1.482188105583191,
      0.11746349930763245,
      0.4212382733821869,
      0.46977585554122925,
      -0.16071879863739014,
      0.7237719297409058,
      0.004507958889007568,
      0.3868008852005005,
      -0.42545369267463684,
      -1.8777289390563965,
      0.7043530344963074,
      0.1643427312374115,
      0.34216490387916565,
      -0.002281090011820197,
      1.0595440864562988,
      1.0054347515106201,
      -0.6362869143486023,
      -0.23437166213989258,
      0.3216066360473633,
      -1.1435954570770264,
      0.5232493281364441,
      -0.32783618569374084,
      -0.5238234400749207,
      0.6355205774307251,
      -0.1169981062412262,
      -0.4156755208969116,
      0.019605226814746857,
      -0.1778499186038971,
      -0.9405286312103271,
      -0.8271286487579346,
      0.41184401512145996,
      0.11636494845151901,
      0.4501679837703705,
      -0.23811714351177216,
      0.3017843961715698,
      0.7851060032844543,
      -0.6769334077835083,
      -0.9255368709564209,
      -0.33500900864601135,
      0.8563397526741028,
      1.3783774375915527,
      -0.558455765247345,
      -1.7240478992462158,
      1.0057035684585571,
      -0.43338292837142944,
      0.28761690855026245,
      -0.6767704486846924,
      -0.020553503185510635,
      0.4293074905872345,
      -0.48091748356819153,
      0.05393531918525696,
      -0.1393723338842392,
      -0.02128956839442253,
      -0.3721362054347992,
      0.9023599028587341,
      0.23944224417209625,
      0.7468442320823669,
      -0.5075039863586426,
      -0.6918302774429321,
      -0.9743049144744873,
      1.1808732748031616,
      -0.8093997240066528,
      0.5029662251472473,
      -0.32227322459220886,
      -0.5207962393760681,
      -0.333330899477005,
      0.6779581904411316,
      1.3702012300491333,
      -0.5876388549804688,
      -0.32870760560035706,
      -1.6348053216934204,
      0.13630323112010956,
      -0.9511685371398926,
      0.7773600816726685,
      0.169535830616951,
      1.0061529874801636,
      0.38196825981140137,
      1.5224703550338745,
      -0.31227511167526245,
      -0.5819867253303528,
      -0.520545244216919,
      0.5945387482643127,
      -0.25210875272750854,
      -0.6200093626976013,
      0.8968204855918884,
      1.5447876453399658,
      -0.12099338322877884,
      -0.7510569095611572,
      0.9061181545257568,
      1.165191650390625,
      0.09109511226415634,
      -0.15710392594337463,
      0.33579114079475403,
      0.28209128975868225,
      -0.09315560013055801,
      -1.3773608207702637,
      -0.9962081909179688,
      -1.1291717290878296,
      0.6835860013961792,
      -0.7372793555259705,
      -0.6331619620323181,
      0.376722127199173,
      0.47944962978363037,
      0.07034078240394592,
      -0.7254925966262817,
      0.09475922584533691,
      -0.48385384678840637,
      -1.3648484945297241,
      0.44170552492141724,
      0.42933186888694763,
      -0.3210929036140442,
      0.10952384024858475,
      0.47133201360702515,
      -0.21582704782485962,
      1.1776113510131836,
      0.6541070342063904,
      0.23994822800159454,
      0.3379424214363098,
      0.5046952962875366,
      -0.39240097999572754,
      0.37040048837661743,
      0.04515806958079338,
      0.3475399613380432,
      -0.3864377737045288,
      -0.5778049826622009,
      -1.2322384119033813,
      -0.16009221971035004,
      -1.6300415992736816,
      -0.3576275706291199,
      -0.1302807480096817,
      0.36401399970054626,
      0.06357113271951675,
      -0.3620666265487671,
      0.3064461350440979,
      0.5075328946113586,
      -1.0160579681396484,
      0.4726056158542633,
      1.059388279914856,
      0.611237108707428,
      -0.019257133826613426,
      0.6699000597000122,
      0.44066882133483887,
      -0.049823734909296036,
      0.07297248393297195,
      0.7917846441268921,
      -0.0016311564249917865,
      -0.010821632109582424,
      -0.6455618143081665,
      -0.18214593827724457,
      -0.24313318729400635,
      -0.8895837664604187,
      1.2043246030807495,
      -0.25378113985061646,
      0.5896614193916321,
      -0.07450461387634277,
      -1.033728837966919,
      -0.3424532413482666,
      0.2017916887998581,
      -0.27221834659576416,
      -0.050857268273830414,
      -0.7162014245986938,
      -0.0860653966665268,
      -0.9329326152801514,
      -1.0952383279800415,
      -0.1514354795217514,
      -0.4460029602050781,
      -0.5156108736991882,
      -0.7618710994720459,
      -1.0308723449707031,
      -0.5791639089584351,
      -1.012041687965393,
      1.2116371393203735,
      0.09176430851221085,
      -0.1268424242734909,
      -1.4109302759170532,
      -0.8435656428337097,
      -0.3269970118999481,
      -0.3129369020462036,
      -0.42288053035736084,
      1.5110546350479126,
      0.0024146572686731815,
      -0.36416861414909363,
      -0.41960078477859497,
      -0.40364012122154236,
      -0.8456740379333496,
      1.1931132078170776,
      0.26295214891433716,
      -0.040803782641887665,
      -0.1385088711977005,
      -0.24908603727817535,
      0.01566840521991253,
      0.4066891074180603,
      0.41447681188583374,
      -0.23587672412395477,
      -0.022091621533036232,
      1.736681580543518,
      1.3120760917663574,
      -0.007443796377629042,
      0.1717744916677475,
      -0.2430470734834671,
      0.04055556282401085,
      0.01218133419752121,
      0.0507999062538147,
      -0.5037007331848145,
      -0.8766207695007324,
      -0.8261274695396423
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Load",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/47843265",
    "title": "",
    "question": "\"I have saved a keras model as a h5py file and now want to load it from disk.\nWhen training the model I use:\nfrom keras.models import Sequential\n\nmodel = Sequential()\nH = model.fit(....)\n\nWhen the model is trained, I want to load it from disk with\nmodel = load_model()\n\nHow can I get H from the model variable? It unfortunately does not have a history parameter that I can just call. Is it because the save_model function doesn't save history?\"",
    "answer": "\"Unfortunately it seems that Keras hasn't implemented the possibility of loading the history directly from a loaded model. Instead you have to set it up in advance. This is how I solved it using CSVLogger (it's actually very convenient storing the entire training history in a separate file. This way you can always come back later and plot whatever history you want instead of being dependent on a variable you can easily lose stored in the RAM):\nFirst we have to set up the logger before initiating the training.\nfrom keras.callbacks import CSVLogger\n\ncsv_logger = CSVLogger('training.log', separator=',', append=False)\nmodel.fit(X_train, Y_train, callbacks=[csv_logger])\n\nThe entire log history will now be stored in the file 'training.log' (the same information you would get, by in your case, calling H.history). When the training is finished, the next step would simply be to load the data stored in this file. You can do that with pandas read_csv:\nimport pandas as pd\nlog_data = pd.read_csv('training.log', sep=',', engine='python')\n\nFrom here on you can treat the data stored in log_data just as you would by loading it from K.history.\nMore information in Keras callbacks docs.\"",
    "mlApiName": "keras.callbacks.CSVLogger,keras.models.fit",
    "embedding": [
      0.09962240606546402,
      0.8575100898742676,
      -3.0591728687286377,
      -1.8074754476547241,
      0.8786414861679077,
      -0.04855262115597725,
      -0.20613501965999603,
      0.5280432105064392,
      -0.908884584903717,
      -1.4158334732055664,
      -1.0947941541671753,
      -0.03901465982198715,
      2.2078866958618164,
      -0.3440802991390228,
      -0.2539632320404053,
      -1.064706563949585,
      0.2731131613254547,
      -0.11022244393825531,
      -0.29974597692489624,
      0.7864904403686523,
      0.2426769882440567,
      -0.6795375943183899,
      -0.038890499621629715,
      -0.06866354495286942,
      0.929850697517395,
      0.02512235753238201,
      -0.3441869914531708,
      0.4476875364780426,
      -0.413000226020813,
      0.08079288899898529,
      1.09856116771698,
      -0.9408575296401978,
      0.4357657730579376,
      -0.6399337649345398,
      -0.9430079460144043,
      -0.720300018787384,
      0.04924826696515083,
      -0.3510592579841614,
      0.2387744039297104,
      0.5885787010192871,
      0.8185164928436279,
      0.7519901394844055,
      0.8058509826660156,
      0.6328823566436768,
      0.5279943943023682,
      -0.21277141571044922,
      0.8433557748794556,
      -0.12553182244300842,
      0.2865564227104187,
      0.24268794059753418,
      0.8919431567192078,
      -0.14314931631088257,
      -0.8080847263336182,
      -0.14330732822418213,
      1.5657614469528198,
      0.7915130257606506,
      1.4279959201812744,
      -0.055463775992393494,
      0.6866534352302551,
      -1.629651665687561,
      1.0890355110168457,
      0.5386749505996704,
      -1.0284605026245117,
      1.2226612567901611,
      0.045584458857774734,
      -0.5990671515464783,
      -0.6999155282974243,
      1.3725427389144897,
      -1.072696566581726,
      -0.09025408327579498,
      0.9270856976509094,
      0.8251407146453857,
      -0.2730155289173126,
      -0.3749687373638153,
      -0.13656800985336304,
      0.7586625218391418,
      -0.4876689016819,
      -1.2302058935165405,
      -0.12377958744764328,
      0.1906650960445404,
      0.10893842577934265,
      0.7728568911552429,
      0.9202107787132263,
      -0.6155825257301331,
      0.5349250435829163,
      0.009651511907577515,
      -0.8285763263702393,
      0.4064418077468872,
      -0.44228091835975647,
      1.2452363967895508,
      -0.8948076963424683,
      0.024923956021666527,
      0.7912970185279846,
      0.5272950530052185,
      -0.3176865577697754,
      -0.3946278393268585,
      -0.15646353363990784,
      -0.0009867462795227766,
      -0.8736366629600525,
      -0.09875442087650299,
      -0.16493593156337738,
      -0.24883291125297546,
      0.38327640295028687,
      -0.8231830596923828,
      0.4643556773662567,
      1.4281338453292847,
      0.1366962492465973,
      -0.17639029026031494,
      0.1503865122795105,
      -1.0451384782791138,
      -0.3636164963245392,
      0.8040485382080078,
      0.3287559151649475,
      0.4947352707386017,
      -0.058521121740341187,
      -0.2574654817581177,
      0.6923036575317383,
      -0.39380910992622375,
      -0.32251545786857605,
      0.5340748429298401,
      -0.9937848448753357,
      0.048163969069719315,
      0.31076979637145996,
      -0.19615985453128815,
      -0.09655474871397018,
      0.9496525526046753,
      -0.5928183197975159,
      0.4027253985404968,
      -0.10668079555034637,
      -1.0326052904129028,
      -0.04315171763300896,
      -0.779924213886261,
      -1.2054656744003296,
      0.7652172446250916,
      1.4025315046310425,
      0.8145691156387329,
      -0.9068852066993713,
      -0.9175828695297241,
      0.36448073387145996,
      0.41707760095596313,
      0.8635713458061218,
      -0.20189805328845978,
      -0.38434597849845886,
      -0.3461485207080841,
      0.6300233602523804,
      0.27963727712631226,
      0.4069177508354187,
      -0.8462848663330078,
      -0.1056688129901886,
      0.5485931038856506,
      -0.05543487146496773,
      0.8426309823989868,
      -1.3129689693450928,
      0.7368322014808655,
      0.9860706925392151,
      -0.9971475601196289,
      0.22488029301166534,
      0.51494300365448,
      1.2529958486557007,
      0.3982330560684204,
      0.8281364440917969,
      0.45133069157600403,
      -0.04923486337065697,
      1.0082350969314575,
      -0.1521720290184021,
      -0.30218368768692017,
      0.138825461268425,
      0.14581942558288574,
      -0.027529312297701836,
      0.25855788588523865,
      -0.4742720425128937,
      -1.3125789165496826,
      -0.14229393005371094,
      -0.3174246847629547,
      0.034379929304122925,
      0.27432000637054443,
      1.2009896039962769,
      -1.0075651407241821,
      0.5672522187232971,
      -0.10407290607690811,
      1.0941674709320068,
      -1.0207334756851196,
      1.0402464866638184,
      -0.4525415897369385,
      -1.4120304584503174,
      0.16688039898872375,
      -0.28966039419174194,
      0.4562995433807373,
      0.3301587700843811,
      -0.7644057869911194,
      0.47488048672676086,
      0.00357999955303967,
      -0.5750865936279297,
      -0.9640865325927734,
      -0.14833630621433258,
      -0.9971257448196411,
      0.49790218472480774,
      -0.5253254771232605,
      0.8487153649330139,
      0.5593012571334839,
      0.43500643968582153,
      0.785514235496521,
      -0.8090002536773682,
      0.31059151887893677,
      -0.719770610332489,
      0.5552729368209839,
      -0.00807596929371357,
      0.2983328104019165,
      -0.7484045028686523,
      0.266441285610199,
      0.7410474419593811,
      0.6095588803291321,
      0.009743156842887402,
      0.740987241268158,
      0.06726488471031189,
      -0.11086799949407578,
      0.19265545904636383,
      -0.08255453407764435,
      -0.44134917855262756,
      -0.2204015851020813,
      0.29981881380081177,
      0.18236567080020905,
      0.8231932520866394,
      0.059247102588415146,
      0.2516547441482544,
      -0.6385170221328735,
      0.04182429984211922,
      -0.11718405783176422,
      -0.7735927104949951,
      -0.3408033847808838,
      -1.38068425655365,
      -1.38532292842865,
      0.497459352016449,
      0.685985267162323,
      0.18424297869205475,
      0.9300459027290344,
      0.13072240352630615,
      1.1954290866851807,
      -0.7177456617355347,
      0.4289584755897522,
      0.013493715785443783,
      0.024465857073664665,
      0.23369917273521423,
      0.024832459166646004,
      -0.7276415824890137,
      0.5633698105812073,
      -0.005867739673703909,
      -0.599387526512146,
      0.5492041707038879,
      0.477516770362854,
      0.14655277132987976,
      0.7722695469856262,
      1.4127566814422607,
      -0.44553038477897644,
      1.2332706451416016,
      -0.7026944756507874,
      0.2029086798429489,
      -0.5645205974578857,
      -0.0580567792057991,
      -0.6821686029434204,
      0.6430892944335938,
      -0.30260607600212097,
      -0.1488489955663681,
      0.21652163565158844,
      0.07487843930721283,
      -0.6332150101661682,
      0.06769372522830963,
      -0.005493317265063524,
      0.10895538330078125,
      -0.4300450086593628,
      0.06671301275491714,
      0.14898891746997833,
      1.0639511346817017,
      0.4818733036518097,
      0.17289799451828003,
      0.2269735485315323,
      -0.18362411856651306,
      0.1642005741596222,
      -0.04929646477103233,
      -1.004473328590393,
      -0.33873921632766724,
      -2.0545268058776855,
      -0.9624324440956116,
      -0.45160526037216187,
      -0.7786639928817749,
      -0.05331701785326004,
      0.05651891231536865,
      0.7026713490486145,
      0.6083622574806213,
      -0.40080147981643677,
      0.14662277698516846,
      0.4445157051086426,
      -0.9098515510559082,
      0.24059632420539856,
      -0.10126873850822449,
      0.8073469400405884,
      0.7412285208702087,
      0.3471967577934265,
      -0.2544798254966736,
      -0.526980996131897,
      0.9616190195083618,
      -0.06913850456476212,
      0.78128981590271,
      0.32850611209869385,
      -0.1349712610244751,
      -0.8613100647926331,
      -0.434557169675827,
      0.4339917302131653,
      0.22448651492595673,
      -0.026337677612900734,
      -0.550015926361084,
      -0.6020278334617615,
      -0.8035986423492432,
      1.6057484149932861,
      -0.818515419960022,
      0.036913372576236725,
      0.5012592673301697,
      -0.1728179007768631,
      0.44267186522483826,
      -0.35212498903274536,
      0.345442533493042,
      -0.35940274596214294,
      -0.04473000392317772,
      0.6260550022125244,
      -0.5097169280052185,
      -0.027568863704800606,
      -0.5414760708808899,
      0.5088844895362854,
      -0.10844650864601135,
      -0.7130159735679626,
      1.040198564529419,
      0.5503735542297363,
      0.18246795237064362,
      -1.5456074476242065,
      -0.7586557865142822,
      0.1791931539773941,
      0.024269865825772285,
      0.17662347853183746,
      -0.4890560805797577,
      1.2600399255752563,
      0.2987857162952423,
      0.24683378636837006,
      0.32579782605171204,
      -0.2940196692943573,
      -0.6326517462730408,
      -0.5840444564819336,
      -0.4460963308811188,
      -0.5569931864738464,
      0.9543712735176086,
      0.5594158172607422,
      -0.34202495217323303,
      0.8947110176086426,
      -0.2664600610733032,
      -0.6204217672348022,
      0.18607769906520844,
      -0.09408821910619736,
      0.46002665162086487,
      0.1901240348815918,
      0.5903508067131042,
      0.3115819990634918,
      1.1921682357788086,
      0.24894118309020996,
      0.7203400135040283,
      -0.43409866094589233,
      0.7213996052742004,
      0.014589839614927769,
      0.5224069952964783,
      0.3485998213291168,
      1.1000014543533325,
      0.005346404854208231,
      0.07967860996723175,
      -0.4219914674758911,
      0.03180566057562828,
      0.18612369894981384,
      -0.16093938052654266,
      0.25045162439346313,
      -0.6451892256736755,
      0.1724136620759964,
      -0.894603431224823,
      0.6440798044204712,
      0.486978679895401,
      -1.1601948738098145,
      -0.05025378242135048,
      0.5624420642852783,
      0.4694627821445465,
      0.41900429129600525,
      0.7503265142440796,
      0.3487895429134369,
      -0.13652364909648895,
      1.3734183311462402,
      0.6149823665618896,
      -0.541843593120575,
      -0.40923944115638733,
      -0.5351707339286804,
      0.8810285329818726,
      -0.3416423499584198,
      0.9501562714576721,
      0.03489849343895912,
      -0.25653740763664246,
      -0.272347092628479,
      -1.2988189458847046,
      -0.0331791453063488,
      0.2714768052101135,
      0.14014506340026855,
      -1.0163624286651611,
      1.0567851066589355,
      -0.4068850874900818,
      -0.7311615347862244,
      0.6543342471122742,
      0.0368555523455143,
      0.6444830894470215,
      -0.22189727425575256,
      0.0326932817697525,
      -1.0270549058914185,
      0.17240871489048004,
      -0.25686508417129517,
      0.6613028049468994,
      0.9734196662902832,
      -0.8927963972091675,
      -0.7476317286491394,
      0.16061271727085114,
      -0.5271120071411133,
      0.009022152051329613,
      -0.04399620741605759,
      1.1237722635269165,
      0.8104678392410278,
      0.31397101283073425,
      1.2430857419967651,
      0.20077982544898987,
      -2.6110122203826904,
      0.4651065170764923,
      0.5634061694145203,
      1.076827049255371,
      0.3388272523880005,
      0.18129312992095947,
      0.24326123297214508,
      0.5373366475105286,
      0.46540218591690063,
      -0.24786041676998138,
      0.6975608468055725,
      1.2642183303833008,
      -0.2648303210735321,
      -0.871616542339325,
      -0.47020313143730164,
      -0.6763504147529602,
      0.35944995284080505,
      1.5279881954193115,
      -0.26156580448150635,
      -0.767112135887146,
      0.4604008197784424,
      -0.3991694748401642,
      -0.5378646850585938,
      0.20573699474334717,
      0.48531538248062134,
      1.9326061010360718,
      -0.0957881510257721,
      -0.4129859507083893,
      -0.4680539071559906,
      -0.22430522739887238,
      0.7784123420715332,
      -0.03529873490333557,
      0.396943062543869,
      -0.04085766151547432,
      0.1900617927312851,
      -0.010649205185472965,
      -2.201387643814087,
      0.07440468668937683,
      -0.638405978679657,
      0.14664441347122192,
      1.9597504138946533,
      -0.2688203454017639,
      -0.1600075513124466,
      0.6959478259086609,
      -0.4216434955596924,
      -0.09693415462970734,
      -0.039401065558195114,
      -0.3551916778087616,
      -0.29583829641342163,
      0.6292577385902405,
      0.24508684873580933,
      0.9305173754692078,
      -0.9851099252700806,
      -0.8758982419967651,
      -0.39332881569862366,
      -0.5553002953529358,
      1.0811724662780762,
      0.08127925544977188,
      -0.018209991976618767,
      0.14419685304164886,
      0.16950169205665588,
      0.4670032858848572,
      0.6043331027030945,
      0.5357648134231567,
      0.3098911941051483,
      0.23279960453510284,
      -0.6783050298690796,
      -0.3632717728614807,
      0.5951900482177734,
      -0.014614146202802658,
      -0.3987773656845093,
      0.27166324853897095,
      0.6892998814582825,
      -0.2434668093919754,
      -0.11213868856430054,
      0.8708072900772095,
      -0.17407460510730743,
      1.0335285663604736,
      0.33011695742607117,
      -0.8435174822807312,
      -0.28912612795829773,
      0.5338156819343567,
      0.13316988945007324,
      -0.629413366317749,
      0.8096132278442383,
      0.7071672677993774,
      -0.9577018022537231,
      0.5494301915168762,
      0.3018026351928711,
      -0.11466041207313538,
      -0.018597833812236786,
      0.15917576849460602,
      0.04667890444397926,
      0.28946754336357117,
      -0.3551589250564575,
      -1.445881962776184,
      0.10818710923194885,
      0.9628928303718567,
      -1.8817179203033447,
      0.3408583104610443,
      0.261868953704834,
      0.4489467442035675,
      0.05552545562386513,
      -1.063338279724121,
      -0.0975247472524643,
      -0.11109021306037903,
      -0.07254479825496674,
      -1.2684098482131958,
      1.07527494430542,
      -0.2762932777404785,
      0.2103390246629715,
      -0.07176747173070908,
      0.8028354048728943,
      0.2819274365901947,
      -0.4678502678871155,
      -0.5406736731529236,
      0.1473095417022705,
      0.5011149048805237,
      0.6020156741142273,
      0.14949683845043182,
      -0.704055666923523,
      0.20600664615631104,
      -0.9520151019096375,
      0.8687334656715393,
      -0.6476503610610962,
      -0.4381052553653717,
      -1.1117277145385742,
      -0.22539031505584717,
      -0.28479495644569397,
      -1.2437472343444824,
      -1.0313512086868286,
      -1.1225852966308594,
      0.7787005305290222,
      1.710018515586853,
      0.37800922989845276,
      -0.7632946968078613,
      0.3599359691143036,
      -0.4899420738220215,
      0.05326158180832863,
      0.8105247616767883,
      0.20021280646324158,
      0.14779824018478394,
      -1.1536643505096436,
      0.3457344174385071,
      0.2307056486606598,
      -0.4028051495552063,
      -0.32998257875442505,
      1.1882175207138062,
      0.8150386214256287,
      -0.5510740876197815,
      -0.9619026184082031,
      -0.39202016592025757,
      -1.7867259979248047,
      0.2819649875164032,
      0.9486759901046753,
      -0.5646672248840332,
      -0.0837710052728653,
      0.16497045755386353,
      -0.6357955932617188,
      -0.16614428162574768,
      0.18524765968322754,
      -0.5167379975318909,
      -0.5459305047988892,
      0.8416725397109985,
      -0.2545008957386017,
      0.6296292543411255,
      0.2018609344959259,
      -0.3330623209476471,
      -0.14690716564655304,
      -0.21629266440868378,
      -1.5400019884109497,
      0.09935728460550308,
      0.4503360688686371,
      1.2629015445709229,
      -1.3398321866989136,
      0.1326494663953781,
      0.896806538105011,
      -0.7213013172149658,
      0.22450128197669983,
      0.182676300406456,
      -0.4581744968891144,
      -0.2909977436065674,
      -0.7370517253875732,
      -0.3957381546497345,
      0.4455682039260864,
      0.04808109998703003,
      -1.539201259613037,
      0.8816673755645752,
      0.4902302920818329,
      0.023745326325297356,
      0.4256518483161926,
      -0.8689035773277283,
      -0.43011781573295593,
      1.4969688653945923,
      -1.15645170211792,
      0.9538023471832275,
      -0.6233336925506592,
      -1.331304907798767,
      0.4708426594734192,
      0.3256823420524597,
      0.6718262434005737,
      -1.1724765300750732,
      -0.03072897531092167,
      -2.3823184967041016,
      0.3155910074710846,
      -0.7975470423698425,
      1.4608811140060425,
      0.13403210043907166,
      0.6061679124832153,
      -0.02666427008807659,
      -0.24587029218673706,
      0.56471848487854,
      0.003658958477899432,
      -0.34359192848205566,
      0.4947976768016815,
      -0.006889368873089552,
      -0.3838779032230377,
      0.6151230931282043,
      -0.20098371803760529,
      0.4745585024356842,
      -0.6907541155815125,
      1.033395528793335,
      0.622075617313385,
      -0.29867538809776306,
      -0.4504324197769165,
      0.4286034405231476,
      -0.23174774646759033,
      0.28066807985305786,
      -0.6204953789710999,
      -1.1164190769195557,
      -0.38511526584625244,
      0.6696655750274658,
      -0.6888564825057983,
      -1.0049784183502197,
      -0.8065343499183655,
      0.5521039366722107,
      0.699775755405426,
      -0.6434324979782104,
      -0.046999242156744,
      -0.19514189660549164,
      -0.3138212561607361,
      0.26878517866134644,
      0.858588457107544,
      -0.128438338637352,
      0.6067900657653809,
      0.24563530087471008,
      -0.11493933200836182,
      1.0250802040100098,
      1.125320315361023,
      0.14041967689990997,
      -0.08254188299179077,
      0.43262550234794617,
      -0.24167828261852264,
      0.0675516203045845,
      0.29344141483306885,
      0.6318957209587097,
      -0.7323153018951416,
      0.1991424262523651,
      -1.1234550476074219,
      -0.01622062548995018,
      -0.12670466303825378,
      -0.7734906673431396,
      -0.18977321684360504,
      0.4480089545249939,
      0.11021986603736877,
      -0.42922481894493103,
      -0.11600569635629654,
      0.10304774343967438,
      -1.3338017463684082,
      -0.41632238030433655,
      0.29675719141960144,
      0.674117386341095,
      0.0849459320306778,
      -0.12048245966434479,
      0.23245584964752197,
      0.0388871431350708,
      -0.35152119398117065,
      0.11056603491306305,
      0.057890888303518295,
      -0.663651704788208,
      -0.030038747936487198,
      -0.7543830871582031,
      0.1266726553440094,
      -0.6266953349113464,
      1.3058667182922363,
      -0.007308376021683216,
      0.16126516461372375,
      -0.05865035951137543,
      0.07018498331308365,
      -0.10653360933065414,
      -0.9152075052261353,
      -0.08053575456142426,
      -0.6020691394805908,
      -1.0905119180679321,
      0.36995625495910645,
      0.12090685963630676,
      0.0795031487941742,
      -0.44647416472435,
      -0.6984935402870178,
      -0.4338505268096924,
      0.2855985164642334,
      -0.6160333752632141,
      -0.39866164326667786,
      -1.3432166576385498,
      1.0584603548049927,
      0.01265356969088316,
      -0.17523643374443054,
      -1.2934985160827637,
      -0.7726027369499207,
      -1.1478664875030518,
      -0.6895585060119629,
      -1.089503526687622,
      0.5932285189628601,
      0.34619656205177307,
      0.5508217811584473,
      -0.8906577825546265,
      -0.6727102994918823,
      -1.1619853973388672,
      1.104328989982605,
      0.03368406742811203,
      -0.3692246079444885,
      0.7245145440101624,
      -0.5497186779975891,
      -0.5154153108596802,
      0.5830708146095276,
      -0.49753519892692566,
      0.23655909299850464,
      0.10087548196315765,
      1.3880181312561035,
      1.1240050792694092,
      0.40056878328323364,
      0.12888671457767487,
      -0.27899041771888733,
      -0.15798771381378174,
      0.7252470850944519,
      0.07999175786972046,
      -0.7417380213737488,
      0.24814659357070923,
      -0.19133007526397705
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SAI",
      "level3": "F,IC-1",
      "leafContractCategory": "SAM (Level 3) ? AMO(Level 2)",
      "rootCause": "Missing Input value-Method order Dependency",
      "effect": "Unknown",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Load",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/45755022",
    "title": "",
    "question": "\"I have a saved a model using model.save(). I'm trying to reload the model and add a few layers and tune some hyper-parameters, however, it throws the AttributeError.\n\nModel is loaded using load_model().\n\nI guess I'm missing understanding how to add layers to saved layers. If someone can guide me here, it will be great. I'm a novice to deep learning and using keras, so probably my request would be silly.\n\nSnippet:\n\nprev_model = load_model('final_model.h5') # loading the previously saved model.\n\nprev_model.add(Dense(256,activation='relu'))\nprev_model.add(Dropout(0.5))\nprev_model.add(Dense(1,activation='sigmoid'))\n\nmodel = Model(inputs=prev_model.input, outputs=prev_model(prev_model.output))\n\nAnd the error it throws:\n\nTraceback (most recent call last):\n  File \"\"image_classifier_3.py\"\", line 39, in \n    prev_model.add(Dense(256,activation='relu'))\nAttributeError: 'Model' object has no attribute 'add'\n\nI know adding layers works on new Sequential() model, but how do we add to existing saved models?\"",
    "answer": "\"The add method is present only in sequential models (Sequential class), which is a simpler interface to the more powerful but complicated functional model (Model class). load_model will always return a Model instance, which is the most generic class.\n\nYou can look at the example to see how you can compose different models, but the idea is that, in the end, a Model behaves pretty much like any other layer. So you should be able to do:\n\nprev_model = load_model('final_model.h5') # loading the previously saved model.\n\nnew_model = Sequential()\nnew_model.add(prev_model)\nnew_model.add(Dense(256,activation='relu'))\nnew_model.add(Dropout(0.5))\nnew_model.add(Dense(1,activation='sigmoid'))\n\nnew_model.compile(...)\"",
    "mlApiName": "keras.models.add,keras.models.load_model",
    "embedding": [
      -0.450077086687088,
      0.5482091903686523,
      -2.3120570182800293,
      -1.5987478494644165,
      1.6068567037582397,
      -0.259363055229187,
      -0.1686120629310608,
      -0.05713605135679245,
      -0.9143342971801758,
      -0.989585816860199,
      -1.1233896017074585,
      0.47061917185783386,
      2.0071706771850586,
      0.3709821105003357,
      -0.5767645835876465,
      -0.1899372786283493,
      0.18996277451515198,
      0.4057033360004425,
      0.023243041709065437,
      0.65647292137146,
      -0.06851405650377274,
      -0.9128551483154297,
      0.6024059057235718,
      -0.44979068636894226,
      0.7320752739906311,
      0.39588093757629395,
      -0.4122098982334137,
      0.6624524593353271,
      -0.18305927515029907,
      0.3071343004703522,
      1.0594514608383179,
      -1.383345365524292,
      0.1633082926273346,
      -1.00921630859375,
      -0.4965178668498993,
      -0.6561410427093506,
      0.820358395576477,
      0.23568882048130035,
      -0.2583787739276886,
      -0.033568721264600754,
      0.9486188292503357,
      0.8205894827842712,
      0.28845086693763733,
      0.19262102246284485,
      -0.3589170277118683,
      -0.11362193524837494,
      1.2378826141357422,
      0.10485450178384781,
      1.1615746021270752,
      -0.21026146411895752,
      1.1832753419876099,
      0.7732647061347961,
      -0.3106963336467743,
      -0.026730740442872047,
      1.7812358140945435,
      0.8566067814826965,
      0.5137841701507568,
      0.5290919542312622,
      0.9889014959335327,
      -1.1340137720108032,
      -0.16937628388404846,
      1.3666415214538574,
      -0.5663976073265076,
      1.529928207397461,
      0.16153278946876526,
      0.12809514999389648,
      -0.6371649503707886,
      1.1286066770553589,
      -0.5202358961105347,
      -0.5191248655319214,
      0.21705903112888336,
      0.7576832175254822,
      -0.6116937398910522,
      0.15334269404411316,
      -0.3573031723499298,
      0.4460415244102478,
      -0.3349943459033966,
      -0.4758840799331665,
      0.017134051769971848,
      0.007685263641178608,
      0.3589726686477661,
      1.3641341924667358,
      1.7197515964508057,
      -0.5137632489204407,
      -0.04765968397259712,
      0.6510995626449585,
      -1.015390157699585,
      -0.20657789707183838,
      -0.9782198071479797,
      1.3975588083267212,
      -0.2148987501859665,
      -0.6612043976783752,
      0.32342618703842163,
      0.9266464710235596,
      -0.7711086869239807,
      -1.0363643169403076,
      -0.12995198369026184,
      0.02537219412624836,
      -1.6355384588241577,
      -0.42462342977523804,
      -0.32538992166519165,
      0.41341692209243774,
      0.32870689034461975,
      -1.2811753749847412,
      -0.5381183624267578,
      1.6194193363189697,
      -0.34364932775497437,
      0.06388084590435028,
      0.5632610321044922,
      -0.32581114768981934,
      -0.9707294702529907,
      0.1298368275165558,
      0.2319144457578659,
      0.13601429760456085,
      -0.1252201944589615,
      -0.07911906391382217,
      0.11048071831464767,
      -0.41827669739723206,
      0.5245122909545898,
      0.44415608048439026,
      -0.3253556787967682,
      -0.045743562281131744,
      0.4595459997653961,
      -0.12229054421186447,
      -0.3073854446411133,
      0.8376501202583313,
      -0.47504961490631104,
      -0.30835336446762085,
      -0.057139042764902115,
      -1.2778611183166504,
      0.29140162467956543,
      -0.5883020758628845,
      0.0026253466494381428,
      0.39817267656326294,
      0.9104702472686768,
      1.3545206785202026,
      -0.8965359926223755,
      -1.2402758598327637,
      0.3930472135543823,
      0.807820737361908,
      0.42914101481437683,
      0.00652458006516099,
      -0.43512603640556335,
      -0.8726885914802551,
      0.4128367602825165,
      -0.4473218321800232,
      0.8238134384155273,
      -0.5608484148979187,
      -0.6186366081237793,
      0.23537908494472504,
      0.26682165265083313,
      0.8406868577003479,
      -1.3543391227722168,
      -0.10587913542985916,
      0.6293099522590637,
      -0.4544932246208191,
      0.15085427463054657,
      0.48005616664886475,
      0.1598690003156662,
      -0.718228280544281,
      1.1859350204467773,
      0.44188523292541504,
      -0.12191896885633469,
      0.5971745252609253,
      -0.13148139417171478,
      -0.7461351752281189,
      0.14512310922145844,
      -0.7057361602783203,
      -0.3953031003475189,
      1.1051266193389893,
      -0.13498477637767792,
      -0.7616642713546753,
      0.04575151950120926,
      0.3189104199409485,
      0.5732493996620178,
      0.7157915830612183,
      1.7846949100494385,
      -0.7385339736938477,
      0.6334863305091858,
      -0.4440762996673584,
      0.4773414731025696,
      -0.8475133776664734,
      0.7973169684410095,
      0.20211322605609894,
      -1.1685305833816528,
      0.3159981667995453,
      -0.10402588546276093,
      0.5278651118278503,
      0.31107380986213684,
      -0.8391518592834473,
      0.3776746094226837,
      0.4652552604675293,
      0.3281039297580719,
      -0.048217613250017166,
      0.15650606155395508,
      -0.060409821569919586,
      0.521755576133728,
      -0.5604596138000488,
      0.09786835312843323,
      0.08324024081230164,
      0.1169685646891594,
      0.5412847995758057,
      -0.4497201144695282,
      0.2300419956445694,
      -0.7934679388999939,
      1.1577359437942505,
      -0.5473577380180359,
      -0.08883833140134811,
      -0.438972532749176,
      0.24811023473739624,
      0.5629420876502991,
      0.2333878129720688,
      0.39482057094573975,
      0.49361875653266907,
      0.4248723089694977,
      0.1462719440460205,
      0.22217226028442383,
      -0.4341031610965729,
      -0.24035346508026123,
      -0.5027186274528503,
      0.01076817512512207,
      -0.21763402223587036,
      1.3300986289978027,
      -0.06921926885843277,
      0.6437131762504578,
      -0.7814096212387085,
      0.4437260627746582,
      -0.13020223379135132,
      -0.5099430084228516,
      -0.2295314222574234,
      -0.5469991564750671,
      -0.8704319596290588,
      0.4179084002971649,
      0.09547065198421478,
      -0.36399415135383606,
      0.989065408706665,
      0.34504854679107666,
      1.0454062223434448,
      -1.3455307483673096,
      -0.04666497930884361,
      0.2204703539609909,
      0.8259794116020203,
      0.8591355085372925,
      0.0074737342074513435,
      -1.1626378297805786,
      0.11650706082582474,
      0.21533934772014618,
      -0.30155283212661743,
      0.3761608600616455,
      0.9371251463890076,
      0.2771833539009094,
      -0.09953317791223526,
      0.7727769613265991,
      -0.21837417781352997,
      1.8302586078643799,
      -0.7470434308052063,
      -0.4645915627479553,
      0.2975939214229584,
      0.28463098406791687,
      -0.4570440948009491,
      0.7445028424263,
      0.37870967388153076,
      -0.3973674774169922,
      -0.3381745517253876,
      -0.1934887319803238,
      -0.31537947058677673,
      -0.2682774066925049,
      -0.2973470687866211,
      0.26979130506515503,
      -0.16784384846687317,
      -0.2783576250076294,
      0.34219419956207275,
      0.8560106158256531,
      0.41278085112571716,
      0.6077159643173218,
      0.886026918888092,
      -0.3116791248321533,
      0.09394866973161697,
      -0.16895602643489838,
      -0.3706110119819641,
      -0.4336705505847931,
      -1.5979056358337402,
      -0.8374252319335938,
      -0.4810379147529602,
      -0.690938413143158,
      0.1882406771183014,
      0.049281734973192215,
      0.6340076327323914,
      0.029223373159766197,
      -0.10032442212104797,
      -0.6211104989051819,
      -0.14720739424228668,
      -0.6174423098564148,
      0.18122871220111847,
      -0.022234493866562843,
      0.5997132062911987,
      0.9718050360679626,
      -0.05747631937265396,
      -0.40779709815979004,
      0.07882258296012878,
      0.5340531468391418,
      0.3118852972984314,
      1.1084243059158325,
      0.45849189162254333,
      0.1830665022134781,
      -0.08775970339775085,
      0.09046583622694016,
      0.324579656124115,
      0.3277505934238434,
      -0.40964627265930176,
      -0.9433901906013489,
      -0.2643933594226837,
      -0.5053814649581909,
      0.908491849899292,
      -0.4087655544281006,
      0.20262658596038818,
      0.0809595137834549,
      0.1703571230173111,
      0.2760404050350189,
      -0.38179972767829895,
      -0.6721740961074829,
      0.0245475135743618,
      0.30048808455467224,
      0.5789868235588074,
      -0.3531661331653595,
      1.1975963115692139,
      -0.8278958797454834,
      0.47457996010780334,
      0.08958239108324051,
      -0.20975829660892487,
      0.6925814151763916,
      0.21565549075603485,
      0.16935256123542786,
      -1.7231016159057617,
      -0.4130825698375702,
      -0.039912957698106766,
      -0.7942072153091431,
      -0.0005121242138557136,
      0.244506374001503,
      1.2398171424865723,
      0.0037982023786753416,
      0.47791072726249695,
      0.5945351719856262,
      -0.38108935952186584,
      -0.621448814868927,
      0.05030370131134987,
      -0.7651727795600891,
      -0.6312165856361389,
      0.7911113500595093,
      0.4003409147262573,
      -0.8792526125907898,
      0.9342669248580933,
      0.03288737311959267,
      -0.49579057097435,
      0.026064446195960045,
      -0.20009742677211761,
      0.36509886384010315,
      0.1041271910071373,
      0.2667499780654907,
      0.4683384597301483,
      1.2213943004608154,
      -0.21518409252166748,
      0.2293076515197754,
      -0.06951987743377686,
      0.6616134643554688,
      0.12308724969625473,
      0.5826947093009949,
      -0.6508203148841858,
      1.0608854293823242,
      -0.287562757730484,
      0.2308485060930252,
      -0.2730613350868225,
      -0.5846377015113831,
      0.6032252311706543,
      -0.20276696979999542,
      0.6335954666137695,
      -0.8298404812812805,
      0.26342830061912537,
      -0.9416363835334778,
      -0.12469273805618286,
      0.2370510846376419,
      -0.9550164341926575,
      -0.030345100909471512,
      -0.02082304283976555,
      0.44156351685523987,
      0.49546417593955994,
      0.4847709834575653,
      -0.2732182741165161,
      0.19846893846988678,
      1.7990083694458008,
      0.47236233949661255,
      -0.03429931402206421,
      -0.8831751942634583,
      -0.749091625213623,
      0.8802488446235657,
      -0.3463287055492401,
      1.0582188367843628,
      -0.21723909676074982,
      0.056953445076942444,
      -0.2237783521413803,
      -1.158867359161377,
      -0.2005559802055359,
      0.14096125960350037,
      -0.3831987977027893,
      -0.794053316116333,
      -0.1636478304862976,
      0.5534771084785461,
      -0.21214838325977325,
      0.001450155396014452,
      0.14093762636184692,
      0.38835760951042175,
      0.2389710694551468,
      0.2843310832977295,
      -1.4596483707427979,
      0.7900353670120239,
      0.03194616734981537,
      0.7979598641395569,
      0.5869864225387573,
      -1.0974972248077393,
      -0.8659141659736633,
      -0.34322109818458557,
      -0.026311509311199188,
      0.12546870112419128,
      -0.18800315260887146,
      1.0125552415847778,
      0.06611227989196777,
      0.3846617639064789,
      1.3584372997283936,
      0.4657701551914215,
      -2.1795156002044678,
      -0.24107134342193604,
      0.5991154313087463,
      0.48703423142433167,
      -0.6574166417121887,
      -0.340567409992218,
      -0.0018281885422766209,
      0.33328497409820557,
      1.2619768381118774,
      -0.6662104725837708,
      0.18644626438617706,
      1.2180689573287964,
      0.11927761882543564,
      -0.5136709213256836,
      -0.08199967443943024,
      0.3754608929157257,
      0.5736560225486755,
      0.5013427734375,
      -0.9770384430885315,
      -0.9988319873809814,
      1.2349592447280884,
      0.03969183564186096,
      0.08757055550813675,
      0.6992599964141846,
      0.47962698340415955,
      1.740844964981079,
      -0.1930580586194992,
      -0.16050489246845245,
      0.01444073487073183,
      -0.4938356280326843,
      0.44755038619041443,
      -0.11297010630369186,
      0.5591515898704529,
      -0.7196260094642639,
      -0.17022469639778137,
      -0.4399424195289612,
      -1.4574368000030518,
      0.06872246414422989,
      -0.27033424377441406,
      0.3285529613494873,
      0.8711820840835571,
      -0.0430411659181118,
      -0.22291980683803558,
      0.21927660703659058,
      -0.4095552861690521,
      0.670174777507782,
      0.21839769184589386,
      0.4838154911994934,
      -0.3148382604122162,
      0.7315396070480347,
      0.7730261087417603,
      0.46521419286727905,
      -1.5019762516021729,
      -1.0061520338058472,
      -0.3704419732093811,
      -0.008773460984230042,
      1.4668203592300415,
      0.22492167353630066,
      0.5967569351196289,
      0.35836082696914673,
      0.20404605567455292,
      0.86474609375,
      0.3653355538845062,
      -0.7334538698196411,
      0.26009681820869446,
      0.28027579188346863,
      -0.4547950327396393,
      -0.016732819378376007,
      1.4700435400009155,
      -0.09806817024946213,
      -0.08657482266426086,
      0.3599015176296234,
      0.36520910263061523,
      -0.31059321761131287,
      0.0540672242641449,
      0.8722936511039734,
      -0.6956763863563538,
      0.7913283705711365,
      -0.81280916929245,
      -0.17700645327568054,
      -0.8123464584350586,
      0.37168994545936584,
      -0.47124749422073364,
      -0.23233281075954437,
      0.2732332646846771,
      0.5822511911392212,
      -1.295456051826477,
      0.08987288922071457,
      -0.16875885426998138,
      -0.38547056913375854,
      -0.10811493545770645,
      -0.09008461236953735,
      -0.32223719358444214,
      -0.37569063901901245,
      -0.41067129373550415,
      -0.5043520331382751,
      -0.08531425893306732,
      0.7527379393577576,
      -1.8033514022827148,
      0.11809448152780533,
      -0.24765126407146454,
      0.2696287930011749,
      -0.22912797331809998,
      -0.7850819230079651,
      0.2759820222854614,
      0.6542276740074158,
      -0.3769637942314148,
      -1.229683518409729,
      1.1118179559707642,
      0.603254497051239,
      -0.03302678465843201,
      0.5693269371986389,
      1.1713851690292358,
      -0.14932967722415924,
      -0.09924928843975067,
      -0.3181859254837036,
      -0.13591121137142181,
      0.08821405470371246,
      1.2119243144989014,
      0.648177981376648,
      -0.7135598659515381,
      -0.40994712710380554,
      -0.897972583770752,
      0.7025143504142761,
      -0.803558886051178,
      -0.10778210312128067,
      -1.1177634000778198,
      -1.2020235061645508,
      -1.0270304679870605,
      -0.5518993735313416,
      -0.4912363290786743,
      -1.041171669960022,
      0.2117397040128708,
      1.9206236600875854,
      -0.4890550673007965,
      -0.6097543835639954,
      -0.7486740350723267,
      -0.8321300745010376,
      0.6716171503067017,
      0.8901407718658447,
      0.1260041445493698,
      -0.11894602328538895,
      -1.1761749982833862,
      0.142221137881279,
      0.12777036428451538,
      -0.15878352522850037,
      -0.1876157522201538,
      0.9748494625091553,
      0.13195055723190308,
      -0.7375001311302185,
      -0.5026403665542603,
      -0.032007914036512375,
      -1.5118539333343506,
      0.21143148839473724,
      0.3519425392150879,
      -0.1834002137184143,
      0.4438934624195099,
      0.30565544962882996,
      -0.8920180797576904,
      0.2002848982810974,
      0.2061753123998642,
      -0.7864198684692383,
      -0.13827817142009735,
      0.8117169737815857,
      -0.17834964394569397,
      0.8144201040267944,
      0.37624049186706543,
      -0.5477033853530884,
      0.048606205731630325,
      0.07800997793674469,
      -0.9243678450584412,
      -0.10111656785011292,
      0.5797274708747864,
      1.498782992362976,
      -0.9225811958312988,
      0.2760838270187378,
      1.1981889009475708,
      -1.2663873434066772,
      0.5296880602836609,
      0.06559070944786072,
      0.8939546942710876,
      0.2186521291732788,
      -0.4285508692264557,
      -0.43351155519485474,
      0.5096102952957153,
      0.4279525876045227,
      -1.5097113847732544,
      0.782571017742157,
      -0.2517372965812683,
      -0.2047044187784195,
      0.0001206722590723075,
      -0.6775091886520386,
      -0.8170783519744873,
      1.410017967224121,
      -1.3757747411727905,
      0.7460693717002869,
      -1.2019399404525757,
      -1.1727350950241089,
      0.4683695137500763,
      0.32968851923942566,
      0.8187307119369507,
      -1.2331984043121338,
      -0.16750869154930115,
      -2.451559543609619,
      0.3567875921726227,
      -0.37524139881134033,
      1.6618661880493164,
      -0.09820370376110077,
      0.7989968657493591,
      0.08483994007110596,
      0.3955916464328766,
      0.13837656378746033,
      0.4228423535823822,
      -0.17256031930446625,
      0.8042343854904175,
      0.09503702074289322,
      -1.0840766429901123,
      0.3728066682815552,
      0.5054143667221069,
      0.14515577256679535,
      -0.484494149684906,
      0.9633817076683044,
      0.9243690967559814,
      -0.04666169360280037,
      -0.1133965402841568,
      0.2632271945476532,
      -0.6752824187278748,
      0.3962288200855255,
      -0.42994266748428345,
      -1.1934411525726318,
      0.6301711797714233,
      0.4573882520198822,
      -0.5716285109519958,
      -0.90362548828125,
      -0.4985417425632477,
      0.5733484625816345,
      0.27363765239715576,
      0.23144064843654633,
      -0.15947891771793365,
      -0.129209503531456,
      -0.39976370334625244,
      -0.000510417390614748,
      0.8428917527198792,
      -0.0709119662642479,
      0.3612571656703949,
      0.38109835982322693,
      -0.3461708128452301,
      1.2932854890823364,
      1.0673332214355469,
      0.10178928077220917,
      -0.4910617172718048,
      0.3576805293560028,
      0.1920582503080368,
      0.5498127937316895,
      0.18594639003276825,
      0.15105856955051422,
      -1.6231952905654907,
      0.4491058886051178,
      -1.0930801630020142,
      -0.08406200259923935,
      -0.48029831051826477,
      -0.5620429515838623,
      -0.21109959483146667,
      0.3460257649421692,
      0.14935874938964844,
      -0.6968445181846619,
      0.5075239539146423,
      0.09210360795259476,
      -1.2227797508239746,
      0.7138167023658752,
      0.7984445691108704,
      -0.26303571462631226,
      -0.6695574522018433,
      0.013273406773805618,
      0.25020432472229004,
      -0.020764004439115524,
      -0.4791412353515625,
      0.42167773842811584,
      -0.09600687026977539,
      -0.3036450743675232,
      -0.37363651394844055,
      -1.3890389204025269,
      0.17167997360229492,
      -0.036668188869953156,
      1.3424429893493652,
      -0.9495327472686768,
      -0.2214757800102234,
      0.2190837562084198,
      -0.10227757692337036,
      -0.4669889807701111,
      -0.8347342610359192,
      -0.5021501779556274,
      -0.6422134637832642,
      -1.132629156112671,
      0.6881060600280762,
      -0.40099936723709106,
      -0.03271244466304779,
      -0.6760933995246887,
      -0.4611262083053589,
      -0.12388624250888824,
      -0.05622044578194618,
      -1.0856657028198242,
      -0.2120504379272461,
      -1.6092240810394287,
      1.3560714721679688,
      -0.9158855676651001,
      0.010263491421937943,
      -0.8773369789123535,
      -0.692175030708313,
      -0.8005029559135437,
      -0.25605782866477966,
      -1.1159861087799072,
      0.3413774371147156,
      0.585659921169281,
      0.4195024073123932,
      -0.7283987998962402,
      -0.13076046109199524,
      -1.1597497463226318,
      1.409162163734436,
      0.181513711810112,
      0.11487351357936859,
      0.2996889054775238,
      -0.49649664759635925,
      -0.3201793134212494,
      -0.17617933452129364,
      -0.4263654351234436,
      -0.03650367632508278,
      -0.954671323299408,
      0.915202796459198,
      0.8465085029602051,
      0.04077329486608505,
      -0.0014924528077244759,
      -0.5956380367279053,
      0.22780393064022064,
      0.4608105421066284,
      0.5319332480430603,
      -0.8208624720573425,
      0.18765151500701904,
      -0.7206301093101501
    ],
    "label": {
      "level1": "AMO",
      "level2": "G",
      "level3": "G",
      "leafContractCategory": "G",
      "rootCause": "Missing Required Method Order",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Load",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/49785536",
    "title": "",
    "question": "\"I cannot seem to get the value of learning rate. What I get is below. \n\nI've tried the model for 200 epochs and want to see/change the learning rate. Is this not the correct way?\n\n>>> print(ig_cnn_model.optimizer.lr)\n\"",
    "answer": "\"Use eval() from keras.backend:\n\nimport keras.backend as K\nfrom keras.models import Sequential\nfrom keras.layers import Dense\n\nmodel = Sequential()\nmodel.add(Dense(1, input_shape=(1,)))\nmodel.add(Dense(1))\nmodel.compile(loss='mse', optimizer='adam')\n\nprint(K.eval(model.optimizer.lr))\n\nOutput:\n\n0.001\"",
    "mlApiName": "keras.backend",
    "embedding": [
      0.2619810104370117,
      0.5884228348731995,
      -2.8967158794403076,
      -1.3550673723220825,
      1.5907037258148193,
      0.022357355803251266,
      0.3720542788505554,
      0.4942520558834076,
      -0.6187755465507507,
      -0.27303406596183777,
      0.309643417596817,
      1.351363182067871,
      2.54487681388855,
      0.9267679452896118,
      0.007040261756628752,
      -0.664904773235321,
      -0.026383239775896072,
      -0.4256615936756134,
      -0.10202141106128693,
      0.7001627683639526,
      0.4795472323894501,
      -0.7257121801376343,
      -0.14097380638122559,
      0.00907080713659525,
      1.7075709104537964,
      0.23016224801540375,
      -0.6795222163200378,
      0.32165127992630005,
      -0.6375187635421753,
      1.0510756969451904,
      0.7354299426078796,
      -0.7193630933761597,
      0.04460145905613899,
      -0.2319122552871704,
      -1.7049529552459717,
      -0.6650711297988892,
      1.385041356086731,
      0.12070323526859283,
      -0.25577491521835327,
      0.0821886956691742,
      0.951379656791687,
      -0.27505090832710266,
      0.622333288192749,
      1.03691565990448,
      0.45024076104164124,
      0.3945196568965912,
      0.9021037220954895,
      0.4181113839149475,
      0.8376051783561707,
      -0.4936482012271881,
      0.47435230016708374,
      0.816368818283081,
      0.22616830468177795,
      0.3854430615901947,
      1.6198608875274658,
      1.3105273246765137,
      -1.0684231519699097,
      0.673891007900238,
      0.9500265121459961,
      -1.2113995552062988,
      1.238216519355774,
      0.7653181552886963,
      -1.507917881011963,
      0.8561156988143921,
      1.049835443496704,
      -0.3036068379878998,
      -0.7179397344589233,
      0.9521557688713074,
      -0.8536533713340759,
      -0.1769856959581375,
      -0.20318563282489777,
      0.3906114399433136,
      -0.7156922817230225,
      0.2516319155693054,
      -0.8379533290863037,
      -0.4529569149017334,
      -1.0093309879302979,
      -0.8397489786148071,
      -0.30797532200813293,
      0.90406334400177,
      -0.21296659111976624,
      0.5151479244232178,
      1.0013999938964844,
      -0.43988049030303955,
      0.4920698404312134,
      -0.14672645926475525,
      -0.8537560701370239,
      -0.3306560218334198,
      -0.8443004488945007,
      1.6178953647613525,
      -0.18530742824077606,
      -0.17196008563041687,
      1.0473262071609497,
      0.5119075775146484,
      -1.1068828105926514,
      -0.7133268713951111,
      -0.6475085020065308,
      0.24987052381038666,
      -0.7445679306983948,
      -0.3637436330318451,
      -0.5708757638931274,
      0.12749141454696655,
      -0.2753696143627167,
      -1.4957455396652222,
      -0.1511537879705429,
      1.1694966554641724,
      0.617206871509552,
      -0.23750928044319153,
      0.08924365043640137,
      -0.4830324947834015,
      -0.44460099935531616,
      -0.2535323202610016,
      0.12350631505250931,
      0.40862908959388733,
      -0.22241736948490143,
      -0.7553213834762573,
      0.07464867830276489,
      0.1288098245859146,
      -0.026859508827328682,
      0.16824370622634888,
      0.007786247413605452,
      0.23957906663417816,
      0.23792575299739838,
      0.047501806169748306,
      0.061022818088531494,
      1.2230104207992554,
      -1.1180016994476318,
      0.09174087643623352,
      -0.08280988782644272,
      -0.22378943860530853,
      -0.19788795709609985,
      -0.529220700263977,
      -0.41273418068885803,
      0.30886900424957275,
      0.31625133752822876,
      2.091797113418579,
      -1.112878441810608,
      -0.41084811091423035,
      0.3230048716068268,
      0.5115640163421631,
      0.4370846748352051,
      -0.32655036449432373,
      0.4126259982585907,
      -0.37113386392593384,
      -0.08341773599386215,
      -0.00958955753594637,
      0.7272318005561829,
      -0.5557376146316528,
      -0.6470077633857727,
      -0.05616219341754913,
      0.5299686193466187,
      0.7008863091468811,
      -0.6614593863487244,
      0.489798367023468,
      1.3328018188476562,
      -0.8304457068443298,
      0.1536443531513214,
      0.3466256856918335,
      -0.02623428776860237,
      0.002037352416664362,
      1.0170193910598755,
      0.22501298785209656,
      -0.012879310175776482,
      0.7201154828071594,
      -0.8042944073677063,
      -0.5457084774971008,
      0.5415653586387634,
      0.743869423866272,
      0.1555745005607605,
      0.2237529158592224,
      -0.7556619644165039,
      -0.876706063747406,
      0.40468162298202515,
      -0.2648431360721588,
      0.21458083391189575,
      0.49765926599502563,
      1.291413426399231,
      -0.20531800389289856,
      0.5602611899375916,
      0.29608333110809326,
      1.2749921083450317,
      -0.6819400787353516,
      1.4028834104537964,
      -0.09925977140665054,
      -0.5047591924667358,
      -0.40601056814193726,
      0.3176707327365875,
      0.42088574171066284,
      0.655353307723999,
      -0.6514192819595337,
      1.0259698629379272,
      -0.18225373327732086,
      -0.7940305471420288,
      -0.8730042576789856,
      -0.42584556341171265,
      -0.15564273297786713,
      0.8567054271697998,
      -1.121942400932312,
      0.989082396030426,
      0.5247693657875061,
      0.03264028951525688,
      0.5440756678581238,
      -1.2681461572647095,
      0.6540486216545105,
      -1.211600422859192,
      -0.18142572045326233,
      0.17219123244285583,
      0.45502805709838867,
      -0.7113116383552551,
      0.2542036473751068,
      -0.005744046997278929,
      0.18419958651065826,
      0.27704674005508423,
      0.8915256857872009,
      0.649215579032898,
      0.25451329350471497,
      0.5588357448577881,
      0.010601273737847805,
      0.05210579186677933,
      0.46293070912361145,
      0.29073280096054077,
      -0.6026431322097778,
      0.3421879708766937,
      0.29792702198028564,
      0.7775315642356873,
      -0.9942853450775146,
      -0.7840059995651245,
      -0.32808369398117065,
      -0.7174809575080872,
      0.41259878873825073,
      -0.50682133436203,
      -1.1115959882736206,
      -0.033319246023893356,
      0.8880698680877686,
      -0.06632746756076813,
      0.5139145851135254,
      1.0806738138198853,
      0.8603564500808716,
      -0.22715914249420166,
      0.6825456023216248,
      0.433804452419281,
      0.655116856098175,
      -0.008120272308588028,
      0.20266848802566528,
      -0.9885607361793518,
      0.10905681550502777,
      0.5018650889396667,
      -0.43153509497642517,
      -0.14793509244918823,
      0.6497354507446289,
      0.00901604164391756,
      1.1714166402816772,
      0.8305381536483765,
      0.21680520474910736,
      0.9736578464508057,
      -0.8061273097991943,
      -1.0297423601150513,
      -0.5073956251144409,
      0.5440363883972168,
      -0.17710816860198975,
      0.517975389957428,
      -0.26275378465652466,
      0.46699801087379456,
      0.05241873487830162,
      -0.32857847213745117,
      -1.1824488639831543,
      0.3163311779499054,
      -0.43003925681114197,
      0.078310526907444,
      -0.2437489926815033,
      -0.5390855669975281,
      0.3867417573928833,
      0.7042345404624939,
      0.7514064311981201,
      0.7556672096252441,
      0.36139410734176636,
      0.3625127971172333,
      -0.3026176393032074,
      -0.17645715177059174,
      -0.3210321366786957,
      -0.6393126845359802,
      -1.3309824466705322,
      -0.24858978390693665,
      0.2703079581260681,
      -0.21510013937950134,
      -0.40803423523902893,
      0.20112454891204834,
      0.3972950875759125,
      0.41061875224113464,
      0.05091750994324684,
      -0.27471622824668884,
      -0.5254924893379211,
      -0.3462856113910675,
      0.29183465242385864,
      -0.22502639889717102,
      0.01589435711503029,
      1.3557466268539429,
      -0.18551142513751984,
      0.4455703794956207,
      -0.9420982599258423,
      0.3612590730190277,
      0.2996518015861511,
      0.8170297145843506,
      0.6441938281059265,
      0.007115315645933151,
      -0.4425309896469116,
      0.3233272135257721,
      0.07691901922225952,
      0.7208645343780518,
      0.0362311489880085,
      -0.5100104212760925,
      -0.6045566201210022,
      -0.846411943435669,
      0.3055802285671234,
      -0.5536217093467712,
      0.22022384405136108,
      -0.3285411298274994,
      0.25497502088546753,
      0.6731927990913391,
      0.29823482036590576,
      0.0928979441523552,
      -0.37190479040145874,
      -0.20963072776794434,
      -0.04890385642647743,
      -0.7484872341156006,
      0.19531157612800598,
      -0.4839981496334076,
      -0.030572542920708656,
      0.2184077948331833,
      -0.07084552198648453,
      0.9325056672096252,
      0.1747046411037445,
      -0.14398504793643951,
      -1.1337628364562988,
      -0.5187024474143982,
      -0.19148322939872742,
      -0.31788864731788635,
      0.2769929766654968,
      -0.020712334662675858,
      1.094986081123352,
      -0.15523403882980347,
      0.38743287324905396,
      -0.1005687415599823,
      0.11794454604387283,
      -0.4916282296180725,
      -0.7972030639648438,
      -0.8122843503952026,
      -1.2198880910873413,
      0.3908865749835968,
      -0.24037104845046997,
      -1.077605128288269,
      0.4525240957736969,
      -0.2983171343803406,
      -0.009184618480503559,
      0.5346472263336182,
      -0.28258973360061646,
      0.3206195831298828,
      0.3302939832210541,
      0.35553014278411865,
      0.4028693735599518,
      1.0310131311416626,
      -0.3591479957103729,
      -0.005512864328920841,
      -0.15130449831485748,
      -0.7648955583572388,
      -0.22687512636184692,
      0.5070497989654541,
      0.27084633708000183,
      0.9214693307876587,
      -0.19430208206176758,
      -0.04748363047838211,
      -0.032954297959804535,
      0.0683588758111,
      0.5660121440887451,
      -0.448885053396225,
      0.11667431145906448,
      -1.2308017015457153,
      0.6611058115959167,
      -0.175486758351326,
      0.18191644549369812,
      0.41680750250816345,
      -0.4246649444103241,
      0.08652002364397049,
      -0.11921428143978119,
      0.5045972466468811,
      0.6029087901115417,
      0.4498104155063629,
      -1.1843892335891724,
      0.09351930022239685,
      0.8312593102455139,
      0.6499907970428467,
      -0.5091463327407837,
      -0.84035724401474,
      0.19367291033267975,
      0.15804032981395721,
      -0.8803074359893799,
      1.4501726627349854,
      0.46514129638671875,
      0.3881567716598511,
      0.16964513063430786,
      -1.2265790700912476,
      -0.7064597010612488,
      0.3174854516983032,
      0.3101770579814911,
      -0.4525957703590393,
      0.14071616530418396,
      0.25874078273773193,
      -0.3973156213760376,
      0.41860443353652954,
      0.3865661919116974,
      -0.3307771682739258,
      0.049787551164627075,
      -0.1387140452861786,
      -1.6952621936798096,
      0.38118574023246765,
      -0.29900088906288147,
      0.9415715336799622,
      0.32091832160949707,
      -0.8583298325538635,
      -0.6098601222038269,
      0.0483187772333622,
      0.6327505707740784,
      -0.008378829807043076,
      -0.5452108979225159,
      0.5744858384132385,
      0.8498367071151733,
      0.5221282243728638,
      1.383207082748413,
      0.6921465396881104,
      -1.912077784538269,
      0.7304497361183167,
      0.1464652419090271,
      0.2626279294490814,
      -0.2947109639644623,
      -0.9501261711120605,
      0.5922784209251404,
      0.4743993580341339,
      0.8070639371871948,
      -0.2822529673576355,
      0.5481892228126526,
      -0.04592860862612724,
      -0.20348428189754486,
      -0.38913029432296753,
      -0.4587537348270416,
      -0.12200789153575897,
      1.0572929382324219,
      1.46323823928833,
      -0.583105742931366,
      -1.4956063032150269,
      0.8051221966743469,
      -0.2787630558013916,
      -0.5022020936012268,
      -0.34552255272865295,
      0.5394018292427063,
      1.7478944063186646,
      -0.2781505584716797,
      -0.18639661371707916,
      0.11312543600797653,
      0.09079806506633759,
      0.9024103879928589,
      -0.1137242466211319,
      0.6387435793876648,
      -0.8836665153503418,
      0.10920039564371109,
      -0.18205241858959198,
      -0.8396250009536743,
      -0.04507818818092346,
      -0.4176786243915558,
      0.8848733305931091,
      1.210378885269165,
      -1.092322587966919,
      -0.34756597876548767,
      0.9824352860450745,
      -1.0446240901947021,
      -0.08130363374948502,
      0.2582480311393738,
      -0.5539392828941345,
      0.10608435422182083,
      0.659407377243042,
      0.7035683989524841,
      -0.42249786853790283,
      -1.5907871723175049,
      -0.7221903800964355,
      -1.0717476606369019,
      -0.383015513420105,
      1.043147087097168,
      -0.17928466200828552,
      0.02340805158019066,
      -0.1346312016248703,
      -0.46867531538009644,
      0.5295752882957458,
      0.3770599663257599,
      0.09940101206302643,
      -0.6156257390975952,
      -0.1671191304922104,
      -0.30805134773254395,
      -0.29609689116477966,
      0.9943129420280457,
      0.9397254586219788,
      0.6994261741638184,
      -0.23576518893241882,
      0.12636400759220123,
      -0.8733571171760559,
      -0.10224232822656631,
      0.5787383317947388,
      -0.5202348232269287,
      0.9446947574615479,
      -1.231135368347168,
      -0.6068155169487,
      0.2522696852684021,
      -0.11551423370838165,
      0.5042279958724976,
      0.34846580028533936,
      0.10300613939762115,
      0.24333389103412628,
      -1.2002097368240356,
      0.46539899706840515,
      0.2779531478881836,
      -0.5126654505729675,
      0.0862041488289833,
      0.9243346452713013,
      -0.3495791256427765,
      -0.4851051867008209,
      -0.037080295383930206,
      -0.7522076964378357,
      0.1073949784040451,
      0.48582714796066284,
      -1.2460525035858154,
      0.10897370427846909,
      -0.996296226978302,
      0.2978813350200653,
      0.10124842077493668,
      -1.6923644542694092,
      -0.0564742237329483,
      0.11700285226106644,
      0.16168983280658722,
      -0.17430581152439117,
      0.2408723384141922,
      0.8709422945976257,
      -0.5438184142112732,
      0.6091389060020447,
      1.1503257751464844,
      0.31524908542633057,
      -0.9592500925064087,
      0.27275821566581726,
      0.14012522995471954,
      -0.908537745475769,
      0.6905952095985413,
      0.6085163950920105,
      -1.3008699417114258,
      0.32444292306900024,
      -0.7355970144271851,
      1.0676413774490356,
      -0.6869364976882935,
      0.21913179755210876,
      -0.5000060796737671,
      -0.3229859471321106,
      -0.7096261382102966,
      -0.5174001455307007,
      -0.6185491681098938,
      -0.720278263092041,
      -0.060691267251968384,
      2.194937229156494,
      0.22225597500801086,
      -0.3408399820327759,
      -0.7392197251319885,
      -0.7702469825744629,
      0.020600859075784683,
      0.7650581002235413,
      0.968725323677063,
      -0.1029154509305954,
      -1.2718863487243652,
      0.02817135863006115,
      0.7836360931396484,
      -0.3128562569618225,
      0.38815736770629883,
      1.09869384765625,
      0.13480982184410095,
      -0.7126945853233337,
      -0.453691303730011,
      -0.04044613987207413,
      -1.339950442314148,
      0.3216930329799652,
      -0.19268693029880524,
      0.21854452788829803,
      0.5445940494537354,
      -0.21822383999824524,
      -0.08754947036504745,
      -0.15740995109081268,
      0.4853317141532898,
      -0.6408292055130005,
      -0.40195658802986145,
      0.31316089630126953,
      -0.5803768038749695,
      0.01891310140490532,
      -0.2062242180109024,
      -0.9427438974380493,
      0.06343410909175873,
      -0.3715847134590149,
      -1.0141390562057495,
      -0.3573811948299408,
      0.3915151357650757,
      0.7232467532157898,
      -1.5949474573135376,
      0.41739746928215027,
      0.7814921140670776,
      -0.7736939191818237,
      0.8698816299438477,
      0.04461522027850151,
      -0.03775595501065254,
      -0.613789975643158,
      -0.22293490171432495,
      -0.11899600923061371,
      0.19378720223903656,
      0.7040400505065918,
      -0.8971433043479919,
      1.148699164390564,
      -0.16484728455543518,
      -1.2783123254776,
      -0.5308973789215088,
      -0.7399558424949646,
      -0.8133729100227356,
      1.276772141456604,
      -1.4359978437423706,
      1.005011796951294,
      -0.48757079243659973,
      -0.5553063154220581,
      -0.47769641876220703,
      0.3992599546909332,
      0.6979746222496033,
      -1.3220268487930298,
      0.7013527154922485,
      -1.6976109743118286,
      -0.4932185411453247,
      -0.7363128662109375,
      0.7129302024841309,
      -0.6168464422225952,
      0.7373449206352234,
      0.05578227341175079,
      1.0191999673843384,
      0.19889934360980988,
      -0.15607552230358124,
      -0.44678714871406555,
      -0.042299866676330566,
      -0.9180163741111755,
      -0.5588393807411194,
      0.9164389371871948,
      1.1660113334655762,
      0.20659150183200836,
      -0.18033847212791443,
      1.101280927658081,
      0.6141862869262695,
      0.5674611330032349,
      -0.6609697341918945,
      0.813618540763855,
      -0.14373518526554108,
      0.373453289270401,
      -0.1646091341972351,
      0.24787192046642303,
      -0.3191370964050293,
      -0.06858482211828232,
      -0.8525397777557373,
      -0.630181074142456,
      0.24206902086734772,
      0.7816973328590393,
      -0.6539578437805176,
      -0.6696364283561707,
      0.17552126944065094,
      -0.08569056540727615,
      -1.327380895614624,
      0.15350548923015594,
      0.20753520727157593,
      -0.5689032077789307,
      0.5863794088363647,
      0.4619593918323517,
      0.5357818007469177,
      1.1609286069869995,
      0.23111166059970856,
      -0.2916853129863739,
      0.03023272380232811,
      0.4054414927959442,
      0.16954267024993896,
      0.7622135281562805,
      0.5545269846916199,
      0.004684464540332556,
      -1.212534785270691,
      -0.10674013197422028,
      -1.179154872894287,
      -0.304436594247818,
      -0.4565187096595764,
      -0.5330249667167664,
      -0.1916644275188446,
      0.15705884993076324,
      -0.2251143753528595,
      -0.6651048064231873,
      0.6713650822639465,
      -0.5791298747062683,
      -0.6804002523422241,
      0.8212176561355591,
      0.8486462831497192,
      0.7708444595336914,
      -0.14980332553386688,
      -0.008087335154414177,
      0.4122611880302429,
      0.14132677018642426,
      0.14431776106357574,
      0.4161953628063202,
      -0.07847053557634354,
      -0.46903401613235474,
      -0.7028387188911438,
      -0.5864887833595276,
      -0.07356450706720352,
      -0.7310001850128174,
      1.101082444190979,
      0.04788084700703621,
      0.41708388924598694,
      0.5568438768386841,
      -0.6056416034698486,
      -0.6936346888542175,
      0.1086990237236023,
      0.6085673570632935,
      -0.514255702495575,
      -1.180361032485962,
      0.11316980421543121,
      -0.3338085114955902,
      -0.40455326437950134,
      -0.15442563593387604,
      -0.42440810799598694,
      -0.4075954556465149,
      0.24350948631763458,
      -0.7156962156295776,
      0.23707672953605652,
      -1.8353949785232544,
      1.260361909866333,
      -0.261190265417099,
      0.5734951496124268,
      -0.6739696860313416,
      -0.22181551158428192,
      -1.084491491317749,
      0.23826615512371063,
      -0.8885882496833801,
      0.4304054379463196,
      0.3893918991088867,
      0.6313511729240417,
      -0.7205981612205505,
      -0.4138621687889099,
      -0.7585070133209229,
      1.3570455312728882,
      0.4512290060520172,
      -0.22263163328170776,
      0.4675339162349701,
      -0.4048251807689667,
      -0.27996373176574707,
      0.2642146944999695,
      -0.652917742729187,
      0.17935167253017426,
      -0.2373266965150833,
      0.5592926144599915,
      1.1855782270431519,
      0.2269294708967209,
      -0.04847736284136772,
      -1.3811959028244019,
      0.5622498989105225,
      0.046653952449560165,
      0.26262909173965454,
      -0.8139302134513855,
      0.07552117109298706,
      -0.6129835844039917
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "0",
      "mlLibrary": "Keras",
      "contractViolationLocation": "0",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/47266383",
    "title": "",
    "question": "\"Im trying to save and load weights from the model i have trained.\n\nthe code im using to save the model is.\n\nTensorBoard(log_dir='/output')\nmodel.fit_generator(image_a_b_gen(batch_size), steps_per_epoch=1, epochs=1)\nmodel.save_weights('model.hdf5')\nmodel.save_weights('myModel.h5')\n\nLet me know if this an incorrect way to do it,or if there is a better way to do it.\n\nbut when i try to load them,using this,\n\nfrom keras.models import load_model\nmodel = load_model('myModel.h5')\n\nbut i get this error:\n\nValueError                                Traceback (most recent call \nlast)\n in ()\n      1 from keras.models import load_model\n----> 2 model = load_model('myModel.h5')\n\n/home/decentmakeover2/anaconda3/lib/python3.5/site-\npackages/keras/models.py in load_model(filepath, custom_objects, compile)\n    235         model_config = f.attrs.get('model_config')\n    236         if model_config is None:\n--> 237             raise ValueError('No model found in config file.')\n    238         model_config = json.loads(model_config.decode('utf-8'))\n    239         model = model_from_config(model_config, \ncustom_objects=custom_objects)\n\nValueError: No model found in config file.\n\nAny suggestions on what i may be doing wrong?\nThank you in advance.\"",
    "answer": "\"Here is a YouTube video that explains exactly what you're wanting to do: Save and load a Keras model\n\nThere are three different saving methods that Keras makes available. These are described in the video link above (with examples), as well as below. \n\nFirst, the reason you're receiving the error is because you're calling load_model incorrectly.\n\nTo save and load the weights of the model, you would first use \n\nmodel.save_weights('my_model_weights.h5')\n\nto save the weights, as you've displayed. To load the weights, you would first need to build your model, and then call load_weights on the model, as in\n\nmodel.load_weights('my_model_weights.h5')\n\nAnother saving technique is model.save(filepath). This save function saves:\n\nThe architecture of the model, allowing to re-create the model.\nThe weights of the model.\nThe training configuration (loss, optimizer).\nThe state of the optimizer, allowing to resume training exactly where you left off.\n\nTo load this saved model, you would use the following:\n\nfrom keras.models import load_model\nnew_model = load_model(filepath)'\n\nLastly, model.to_json(), saves only the architecture of the model. To load the architecture, you would use \n\nfrom keras.models import model_from_json\nmodel = model_from_json(json_string)\"",
    "mlApiName": "keras.models.load_model,keras.models.save_weights",
    "embedding": [
      -0.25149840116500854,
      0.844734251499176,
      -2.475640058517456,
      -1.502720594406128,
      1.2809399366378784,
      0.1914985477924347,
      -0.3021076023578644,
      0.1502045840024948,
      -0.9003936648368835,
      -0.6416015028953552,
      -0.8426151871681213,
      -0.22980421781539917,
      2.0021378993988037,
      -0.13248150050640106,
      -0.9231630563735962,
      -0.06441596895456314,
      0.7149391770362854,
      -0.0324210561811924,
      0.11660199612379074,
      1.0751858949661255,
      -0.24098220467567444,
      -0.8562512397766113,
      0.22055555880069733,
      -0.22605939209461212,
      1.2497272491455078,
      0.5723774433135986,
      -0.29832565784454346,
      1.1772104501724243,
      -0.6655469536781311,
      0.45461347699165344,
      0.4989698529243469,
      -0.744340181350708,
      0.05553107336163521,
      -1.040722370147705,
      -1.3196277618408203,
      -0.46965596079826355,
      0.8551303744316101,
      -0.16419534385204315,
      0.1451399326324463,
      0.011504237540066242,
      1.04997718334198,
      0.006155828945338726,
      0.4110643267631531,
      0.7548462152481079,
      -0.06837992370128632,
      -0.5048946142196655,
      1.18873929977417,
      -0.07274837046861649,
      0.7637631297111511,
      0.1949680596590042,
      1.0632957220077515,
      0.1689649522304535,
      -0.6873209476470947,
      -0.012643115594983101,
      1.9305001497268677,
      0.5530017614364624,
      0.7776207327842712,
      0.41394680738449097,
      0.6662268042564392,
      -1.1337329149246216,
      0.8883384466171265,
      0.8372287750244141,
      -1.0500510931015015,
      0.7594267129898071,
      -0.34014612436294556,
      -0.45032045245170593,
      -0.5640971064567566,
      1.1517817974090576,
      -0.19911804795265198,
      0.016258353367447853,
      0.7233518958091736,
      0.946844756603241,
      0.2333335131406784,
      -0.23644354939460754,
      -0.513525128364563,
      0.9369202256202698,
      -0.5167486667633057,
      -0.41550666093826294,
      -0.00044312255340628326,
      0.3773673176765442,
      -0.44546329975128174,
      0.9626486301422119,
      0.8834412097930908,
      -0.6450943946838379,
      0.00672161765396595,
      0.4249134063720703,
      -1.1506679058074951,
      -0.11082243919372559,
      -0.5672783255577087,
      1.1176092624664307,
      -0.2466525137424469,
      -0.23145519196987152,
      0.6723974943161011,
      0.7288317680358887,
      -0.7661590576171875,
      -0.4627457857131958,
      -0.24386967718601227,
      0.4654664099216461,
      -0.5404211282730103,
      -0.44796276092529297,
      0.10114899277687073,
      0.43333837389945984,
      -0.26877203583717346,
      -1.031798243522644,
      -0.4010128080844879,
      1.8417396545410156,
      0.400872141122818,
      0.03322363644838333,
      -0.0116713372990489,
      -0.7104121446609497,
      -0.6123538017272949,
      0.387786865234375,
      0.6178218722343445,
      0.19874027371406555,
      -0.6688234210014343,
      -0.17109613120555878,
      0.7183791995048523,
      -0.29808175563812256,
      0.09179645776748657,
      0.40381526947021484,
      -0.40689027309417725,
      -0.6595150232315063,
      0.5615931153297424,
      -0.43773895502090454,
      -0.14872482419013977,
      0.5617064833641052,
      -0.47543397545814514,
      0.2584667205810547,
      -0.048778682947158813,
      -1.0731881856918335,
      0.30787423253059387,
      -0.8991971015930176,
      -0.641353189945221,
      0.30368614196777344,
      1.3280725479125977,
      0.9223452210426331,
      -0.8403105139732361,
      -1.0709428787231445,
      0.5192078351974487,
      0.28759485483169556,
      0.44642138481140137,
      0.1739424765110016,
      -0.19876308739185333,
      -0.6528688073158264,
      0.39873868227005005,
      -0.6446919441223145,
      0.30371466279029846,
      -0.5292603373527527,
      -0.3664633631706238,
      0.34083080291748047,
      0.3152860701084137,
      0.7554152011871338,
      -1.295408844947815,
      0.49186018109321594,
      0.8783527612686157,
      -1.1122610569000244,
      -0.06629931181669235,
      0.8719959259033203,
      0.6624735593795776,
      -0.2787421941757202,
      1.1941481828689575,
      0.5462431311607361,
      -0.24784255027770996,
      0.9163737297058105,
      -0.12324419617652893,
      -0.6459714770317078,
      -0.0020430623553693295,
      -0.4235018491744995,
      -0.35452762246131897,
      0.23043185472488403,
      -0.8044707775115967,
      -0.9758721590042114,
      -0.03377446532249451,
      -0.028880471363663673,
      0.3064439296722412,
      0.18270082771778107,
      1.4324628114700317,
      -0.5628396272659302,
      0.6059364676475525,
      -0.8634536266326904,
      0.9311026334762573,
      -0.748056948184967,
      0.7444939613342285,
      -0.09887354075908661,
      -1.204781174659729,
      0.17575882375240326,
      0.3613123297691345,
      0.5046879649162292,
      0.2313867211341858,
      -0.5046176314353943,
      0.6688283681869507,
      0.36997902393341064,
      -0.009632826782763004,
      -0.7179855704307556,
      -0.2002568393945694,
      -0.63828045129776,
      0.5807352662086487,
      -0.6172047257423401,
      0.40484383702278137,
      0.2752869725227356,
      0.6071645021438599,
      0.4179440140724182,
      -1.0631463527679443,
      0.24823643267154694,
      -1.151817798614502,
      0.3751758337020874,
      -0.1908406913280487,
      0.25911635160446167,
      0.0782109797000885,
      0.07938121259212494,
      0.1368727833032608,
      0.036931030452251434,
      0.33633866906166077,
      0.5363250374794006,
      0.4284226894378662,
      -0.2938399612903595,
      0.22569668292999268,
      0.06497400254011154,
      -0.9245550036430359,
      -0.08643515408039093,
      0.2473238855600357,
      -0.18668928742408752,
      1.2815146446228027,
      0.08350592106580734,
      0.37857314944267273,
      -0.9573494791984558,
      0.1327248066663742,
      -0.23876889050006866,
      -0.3175300657749176,
      -0.6420604586601257,
      -0.7797911763191223,
      -1.0558379888534546,
      0.08462446928024292,
      0.510811448097229,
      0.03571180999279022,
      1.0049412250518799,
      0.67689049243927,
      1.1923067569732666,
      -0.589680016040802,
      0.4970146119594574,
      0.7080399990081787,
      0.273783415555954,
      0.6240824460983276,
      0.08420810103416443,
      -0.9305260181427002,
      0.5252766609191895,
      0.04396776482462883,
      -0.24415995180606842,
      0.43990054726600647,
      0.35719048976898193,
      0.4848456084728241,
      0.6744858622550964,
      0.6006453037261963,
      -0.3430687189102173,
      1.370001196861267,
      -0.6924683451652527,
      -0.3940308094024658,
      -0.4763662815093994,
      0.34386682510375977,
      -0.26900193095207214,
      0.524161696434021,
      -0.3416561782360077,
      -0.2063346654176712,
      0.16837604343891144,
      -0.4227812886238098,
      -0.6946821808815002,
      -0.02851228229701519,
      -0.24320784211158752,
      0.5166906714439392,
      -0.07749367505311966,
      0.09360311925411224,
      0.24927553534507751,
      0.9124040007591248,
      0.45472198724746704,
      0.1901363581418991,
      0.3749460279941559,
      -0.11710558831691742,
      0.2968074381351471,
      -0.023478258401155472,
      -0.4234750270843506,
      -0.17542016506195068,
      -1.7873005867004395,
      -0.5593491196632385,
      -0.38961803913116455,
      0.16728048026561737,
      -0.135090172290802,
      -0.5274525284767151,
      0.5762661695480347,
      0.5151193141937256,
      -0.260735422372818,
      -0.24410510063171387,
      0.7499439120292664,
      -0.6314700245857239,
      0.04393695294857025,
      0.22638718783855438,
      0.8221808671951294,
      0.6911582946777344,
      -0.14418374001979828,
      -0.46227580308914185,
      -0.46874740719795227,
      0.612442135810852,
      0.35578832030296326,
      1.2322502136230469,
      0.820068359375,
      -0.1466120034456253,
      0.09605368226766586,
      -0.10478486120700836,
      0.440282940864563,
      0.5077911019325256,
      -0.14684629440307617,
      -0.7193052172660828,
      -0.16987580060958862,
      -0.3548450469970703,
      1.7524819374084473,
      -0.5181117653846741,
      -0.04184781014919281,
      0.6209808588027954,
      -0.6470513939857483,
      0.19592991471290588,
      -0.7543607950210571,
      -0.5144354701042175,
      -0.06611496210098267,
      0.19572831690311432,
      0.5625996589660645,
      -0.4759247899055481,
      1.0937221050262451,
      -0.609395444393158,
      0.6790388226509094,
      0.5456394553184509,
      -0.6380382180213928,
      0.5183927416801453,
      0.3210425078868866,
      0.05344771966338158,
      -1.5695141553878784,
      -1.1407922506332397,
      -0.19864825904369354,
      -0.3216877579689026,
      0.29182368516921997,
      -0.06211339682340622,
      0.7821828126907349,
      0.38175731897354126,
      0.5828160047531128,
      0.4331972002983093,
      -0.6490464806556702,
      -1.3337637186050415,
      -0.4337611198425293,
      -1.1291918754577637,
      -1.0084792375564575,
      1.0576518774032593,
      0.39499062299728394,
      -0.6480613946914673,
      0.8495268225669861,
      0.04406808689236641,
      -0.30154627561569214,
      -0.306578129529953,
      -0.5128873586654663,
      0.28521984815597534,
      0.30918872356414795,
      -0.12468642741441727,
      0.6093968749046326,
      1.217458724975586,
      0.25681254267692566,
      0.3156162202358246,
      -0.6468734741210938,
      -0.16445986926555634,
      -0.26587170362472534,
      0.5674762725830078,
      -0.22848273813724518,
      0.8033087849617004,
      -0.4260212182998657,
      0.2397390753030777,
      -0.09962821006774902,
      -0.30796030163764954,
      0.2096039205789566,
      0.02731223776936531,
      0.29540103673934937,
      -0.29492321610450745,
      0.0849103108048439,
      -0.9683956503868103,
      0.12929406762123108,
      0.06512042880058289,
      -1.1093124151229858,
      -0.4948588013648987,
      0.1282067596912384,
      0.49800363183021545,
      0.48871147632598877,
      0.6604875326156616,
      -0.14135432243347168,
      -0.19939257204532623,
      1.205614447593689,
      0.4918307363986969,
      -0.6267526745796204,
      -0.5889957547187805,
      -0.6186259388923645,
      1.086112141609192,
      0.08315635472536087,
      0.8993182182312012,
      0.03801359236240387,
      0.046193674206733704,
      -0.052775152027606964,
      -1.2879745960235596,
      -0.39672839641571045,
      0.3148404359817505,
      -0.2786864936351776,
      -0.849240243434906,
      0.25157108902931213,
      -0.08316832035779953,
      -0.3303634524345398,
      -0.03843466937541962,
      0.7629402279853821,
      0.8847292065620422,
      0.28337717056274414,
      0.41078898310661316,
      -1.0517349243164062,
      0.6820241808891296,
      -0.104324571788311,
      0.20229193568229675,
      1.3568198680877686,
      -0.566851794719696,
      -0.769446611404419,
      0.08385054022073746,
      -0.05064694210886955,
      -0.3620176911354065,
      -0.42284777760505676,
      1.200892686843872,
      0.8577278256416321,
      0.5806276798248291,
      1.1021727323532104,
      0.20373256504535675,
      -2.302302360534668,
      0.0072744679637253284,
      0.5360808968544006,
      0.5775677561759949,
      0.007982196286320686,
      -0.2688177824020386,
      0.3414404094219208,
      0.8122449517250061,
      0.8357702493667603,
      -0.08919082581996918,
      0.5576233267784119,
      0.8958304524421692,
      0.3715860843658447,
      -1.5118377208709717,
      -0.14862139523029327,
      0.1040215939283371,
      0.44658640027046204,
      1.1857770681381226,
      -0.7573651075363159,
      -0.3149082362651825,
      0.5939942002296448,
      -0.34479811787605286,
      -0.23267653584480286,
      0.5708684921264648,
      0.06609777361154556,
      1.813797116279602,
      -0.028102146461606026,
      0.022640757262706757,
      0.5294204354286194,
      -0.04589066281914711,
      0.2630566358566284,
      -0.10855276882648468,
      0.7050046324729919,
      -0.3840509057044983,
      0.21312277019023895,
      -0.8988709449768066,
      -1.5256849527359009,
      -0.2260579615831375,
      -0.3615955114364624,
      0.5843023061752319,
      0.6595482230186462,
      -0.4463912546634674,
      -0.3356388509273529,
      0.05597205460071564,
      -0.5180926322937012,
      0.33521249890327454,
      0.11333712190389633,
      0.014396699145436287,
      0.23020409047603607,
      0.713711142539978,
      0.9496211409568787,
      0.6101306676864624,
      -1.7380328178405762,
      -0.8875303268432617,
      -0.4310648739337921,
      -0.056021202355623245,
      1.2115410566329956,
      0.13113349676132202,
      0.0019377341959625483,
      0.4977002441883087,
      0.2531183958053589,
      0.6181856393814087,
      0.2197692096233368,
      -0.39272168278694153,
      -0.031859882175922394,
      0.4306960999965668,
      -0.06726294010877609,
      0.30763763189315796,
      1.2984206676483154,
      0.14572611451148987,
      -0.8263895511627197,
      0.22064562141895294,
      0.04196018725633621,
      -0.4537031650543213,
      -0.3807360827922821,
      0.8727623820304871,
      0.014754682779312134,
      0.9027987718582153,
      -0.05815545469522476,
      -0.206708624958992,
      -0.5643153786659241,
      0.11377045512199402,
      -0.22253601253032684,
      0.13637903332710266,
      0.46318259835243225,
      0.6782357096672058,
      -1.1295181512832642,
      0.8142330646514893,
      0.48600587248802185,
      -0.11584320664405823,
      0.0700434148311615,
      0.16081298887729645,
      -0.6256435513496399,
      0.23584164679050446,
      -0.7746645212173462,
      -1.1972098350524902,
      0.3265206217765808,
      0.8612688183784485,
      -1.7457283735275269,
      0.24300718307495117,
      0.12847758829593658,
      0.36813703179359436,
      -0.2409813106060028,
      -0.8333088755607605,
      -0.1731461137533188,
      -0.01142873615026474,
      -0.34245994687080383,
      -1.2788975238800049,
      0.9755074381828308,
      -0.06546207517385483,
      -0.42301180958747864,
      0.03287598863244057,
      0.9193202257156372,
      0.14212842285633087,
      0.00009416961256647483,
      -0.460450142621994,
      0.048840973526239395,
      0.4824451208114624,
      0.20065303146839142,
      0.49503061175346375,
      -0.6270256638526917,
      0.3039776086807251,
      -0.3875945210456848,
      0.590133786201477,
      -0.8380081653594971,
      0.006092165131121874,
      -0.8195028901100159,
      -0.5108179450035095,
      -0.5470021963119507,
      -1.1647523641586304,
      -0.6354616284370422,
      -1.5820406675338745,
      0.5491519570350647,
      1.3520643711090088,
      -0.16544832289218903,
      -0.32267531752586365,
      0.234273761510849,
      -0.8325625061988831,
      0.4247991442680359,
      0.568118691444397,
      0.3933979570865631,
      0.03984394669532776,
      -0.7139204144477844,
      0.5267545580863953,
      0.6020267605781555,
      -0.3155047595500946,
      0.0829414501786232,
      0.8675127625465393,
      0.12366805970668793,
      -0.6342231035232544,
      -0.7718607783317566,
      0.34590092301368713,
      -1.6969953775405884,
      0.4928186535835266,
      0.14715337753295898,
      -0.5204724669456482,
      0.3381249010562897,
      0.29568952322006226,
      -0.9107126593589783,
      0.2463197559118271,
      0.020694738253951073,
      -0.08170977979898453,
      -0.3840537965297699,
      0.7081616520881653,
      -0.1958480328321457,
      0.8021476864814758,
      -0.1160840392112732,
      -0.4026039242744446,
      -0.050740987062454224,
      -0.25155898928642273,
      -1.255247950553894,
      0.15635456144809723,
      0.5639214515686035,
      1.4132248163223267,
      -1.7387588024139404,
      0.28978902101516724,
      1.1984018087387085,
      -1.2417898178100586,
      0.9092907905578613,
      -0.11828432232141495,
      0.18978922069072723,
      -0.305561900138855,
      -0.40849924087524414,
      -0.3577384948730469,
      0.520261824131012,
      0.34035441279411316,
      -1.8197569847106934,
      0.6286678314208984,
      0.372373104095459,
      -0.3602498769760132,
      0.2183869630098343,
      -0.714239776134491,
      -0.5623410940170288,
      1.3100106716156006,
      -1.5463982820510864,
      0.7882058620452881,
      -0.6343733072280884,
      -0.7894388437271118,
      0.695183277130127,
      0.64419025182724,
      0.31210070848464966,
      -1.3589601516723633,
      -0.005401347763836384,
      -2.284323215484619,
      0.18555817008018494,
      -0.8844693303108215,
      1.9120110273361206,
      -0.08925081789493561,
      0.8139145374298096,
      0.3434188961982727,
      0.5603328347206116,
      0.16260316967964172,
      -0.02821439690887928,
      -0.6319932341575623,
      0.49706557393074036,
      -0.611026406288147,
      -0.8575769662857056,
      0.8080745935440063,
      0.29497000575065613,
      0.2552376091480255,
      -0.646696150302887,
      1.0137485265731812,
      0.47452855110168457,
      0.12119603157043457,
      -0.455239474773407,
      0.652001678943634,
      -0.22126059234142303,
      -0.15790508687496185,
      -0.855086088180542,
      -0.7649529576301575,
      -0.49953120946884155,
      0.7637941837310791,
      -0.5190126895904541,
      -0.281523197889328,
      -0.3026656210422516,
      0.6053892374038696,
      0.20507416129112244,
      -0.7766830921173096,
      -0.3469802141189575,
      -0.40042898058891296,
      -0.6207523345947266,
      -0.13442577421665192,
      0.5918530821800232,
      -0.8571014404296875,
      0.300514280796051,
      0.6955758333206177,
      -0.3079091012477875,
      0.8610388040542603,
      0.5455697774887085,
      -0.015470082871615887,
      -0.1058933362364769,
      0.3459490239620209,
      -0.19199775159358978,
      -0.1480291485786438,
      0.401266872882843,
      0.46355772018432617,
      -1.4571282863616943,
      0.5182802081108093,
      -1.5438988208770752,
      0.2527923285961151,
      -0.3165602684020996,
      -0.576807975769043,
      0.561944842338562,
      0.48083674907684326,
      0.21549922227859497,
      -1.1980818510055542,
      0.48570504784584045,
      0.24948765337467194,
      -1.029462218284607,
      0.9031323790550232,
      0.9003272652626038,
      0.5876158475875854,
      -0.01695462502539158,
      0.0891900286078453,
      0.49449726939201355,
      0.021350644528865814,
      -0.1483965516090393,
      0.16755230724811554,
      -0.30342379212379456,
      -0.13030406832695007,
      -0.41232815384864807,
      -0.5557711720466614,
      0.07547403126955032,
      -0.40553873777389526,
      1.5190390348434448,
      0.126439169049263,
      0.1900026798248291,
      0.3836067318916321,
      -0.34691324830055237,
      -0.4849833846092224,
      -0.8318239450454712,
      0.12063127011060715,
      -0.7767455577850342,
      -0.876883327960968,
      0.3392190933227539,
      -0.529967725276947,
      -0.556169867515564,
      -0.16635391116142273,
      -0.8609064221382141,
      -0.7842961549758911,
      0.38969796895980835,
      -1.2705495357513428,
      -0.4440482258796692,
      -1.8547537326812744,
      1.1116658449172974,
      -0.18601909279823303,
      0.25253286957740784,
      -1.3647456169128418,
      -0.7165967226028442,
      -0.839102029800415,
      -0.3381668031215668,
      -0.7106436491012573,
      0.5916795134544373,
      0.6370294094085693,
      0.4640812873840332,
      -0.3274865448474884,
      -0.3077313303947449,
      -0.8287202715873718,
      0.8201655745506287,
      0.15268613398075104,
      0.37733030319213867,
      0.5160313844680786,
      -0.3389958143234253,
      -0.5148701667785645,
      0.7278593182563782,
      -1.234790563583374,
      -0.1355782151222229,
      -0.43063443899154663,
      1.0523662567138672,
      0.8052833676338196,
      0.3382280468940735,
      -0.23972398042678833,
      -0.7461233735084534,
      -0.19537502527236938,
      0.5455469489097595,
      0.2554175555706024,
      -0.7403302192687988,
      0.4734155237674713,
      -0.5563564896583557
    ],
    "label": {
      "level1": "AMO",
      "level2": "G",
      "level3": "G",
      "leafContractCategory": "G",
      "rootCause": "Missing Required Method Order",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Load",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/51806852",
    "title": "",
    "question": "\"Inspired by tf.keras.Model subclassing I created custom model.\n\nI can train it and get successfull results, but I can't save it.\n\nI use python3.6 with tensorflow v1.10 (or v1.9)  \n\nMinimal complete code example here:\n\nimport tensorflow as tf\nfrom tensorflow.keras.datasets import mnist\n\nclass Classifier(tf.keras.Model):\n    def __init__(self):\n        super().__init__(name=\"\"custom_model\"\")\n\n        self.batch_norm1 = tf.layers.BatchNormalization()\n        self.conv1 = tf.layers.Conv2D(32, (7, 7))\n        self.pool1 = tf.layers.MaxPooling2D((2, 2), (2, 2))\n\n        self.batch_norm2 = tf.layers.BatchNormalization()\n        self.conv2 = tf.layers.Conv2D(64, (5, 5))\n        self.pool2 = tf.layers.MaxPooling2D((2, 2), (2, 2))\n\n    def call(self, inputs, training=None, mask=None):\n        x = self.batch_norm1(inputs)\n        x = self.conv1(x)\n        x = tf.nn.relu(x)\n        x = self.pool1(x)\n\n        x = self.batch_norm2(x)\n        x = self.conv2(x)\n        x = tf.nn.relu(x)\n        x = self.pool2(x)\n\n        return x\n\nif __name__ == '__main__':\n    (x_train, y_train), (x_test, y_test) = mnist.load_data()\n\n    x_train = x_train.reshape(*x_train.shape, 1)[:1000]\n    y_train = y_train.reshape(*y_train.shape, 1)[:1000]\n\n    x_test = x_test.reshape(*x_test.shape, 1)\n    y_test = y_test.reshape(*y_test.shape, 1)\n\n    y_train = tf.keras.utils.to_categorical(y_train)\n    y_test = tf.keras.utils.to_categorical(y_test)\n\n    model = Classifier()\n\n    inputs = tf.keras.Input((28, 28, 1))\n\n    x = model(inputs)\n    x = tf.keras.layers.Flatten()(x)\n    x = tf.keras.layers.Dense(10, activation=\"\"sigmoid\"\")(x)\n\n    model = tf.keras.Model(inputs=inputs, outputs=x)\n    model.compile(optimizer=\"\"adam\"\", loss=\"\"binary_crossentropy\"\", metrics=[\"\"accuracy\"\"])\n    model.fit(x_train, y_train, epochs=1, shuffle=True)\n\n    model.save(\"\"./my_model\"\")\n\nError message:  \n\n1000/1000 [==============================] - 1s 1ms/step - loss: 4.6037 - acc: 0.7025\nTraceback (most recent call last):\n  File \"\"/home/user/Data/test/python/mnist/mnist_run.py\"\", line 62, in \n    model.save(\"\"./my_model\"\")\n  File \"\"/home/user/miniconda3/envs/ml3.6/lib/python3.6/site-packages/tensorflow/python/keras/engine/network.py\"\", line 1278, in save\n    save_model(self, filepath, overwrite, include_optimizer)\n  File \"\"/home/user/miniconda3/envs/ml3.6/lib/python3.6/site-packages/tensorflow/python/keras/engine/saving.py\"\", line 101, in save_model\n    'config': model.get_config()\n  File \"\"/home/user/miniconda3/envs/ml3.6/lib/python3.6/site-packages/tensorflow/python/keras/engine/network.py\"\", line 1049, in get_config\n    layer_config = layer.get_config()\n  File \"\"/home/user/miniconda3/envs/ml3.6/lib/python3.6/site-packages/tensorflow/python/keras/engine/network.py\"\", line 1028, in get_config\n    raise NotImplementedError\nNotImplementedError\n\nProcess finished with exit code 1\n\nI looked into the error line and found out that get_config method checks self._is_graph_network\n\nDo anybody deal with this problem?\n\nThanks!\n\nUpdate 1:\n\nOn the keras 2.2.2 (not tf.keras)\n\nFound comment (for model saving)\n\nfile: keras/engine/network.py\n\nFunction: get_config  \n\n  # Subclassed networks are not serializable\n\n  # (unless serialization is implemented by\n\n  # the author of the subclassed network).  \n\nSo, obviously it won't work...\n\nI wonder, why don't they point it out in the documentation (Like: \"\"Use subclassing without ability to save!\"\")\n\nUpdate 2:\n\nFound in keras documentation:  \n\n  In subclassed models, the model's topology is defined as Python code\n\n  (rather than as a static graph of layers). That means the model's\n\n  topology cannot be inspected or serialized. As a result, the following\n\n  methods and attributes are not available for subclassed models:  \n  \n  model.inputs        and model.outputs.\n\n  model.to_yaml()     and model.to_json()\n\n  model.get_config()  and model.save().  \n\nSo, there is no way to save model by using subclassing.\n\nIt's possible to only use Model.save_weights()\"",
    "answer": "\"TensorFlow 2.2\n\nThanks for @cal for noticing me that the new TensorFlow has supported saving the custom models!\n\n  By using model.save to save the whole model and by using load_model to restore previously stored subclassed model. The following code snippets describe how to implement them.\n\nclass ThreeLayerMLP(keras.Model):\n\n  def __init__(self, name=None):\n    super(ThreeLayerMLP, self).__init__(name=name)\n    self.dense_1 = layers.Dense(64, activation='relu', name='dense_1')\n    self.dense_2 = layers.Dense(64, activation='relu', name='dense_2')\n    self.pred_layer = layers.Dense(10, name='predictions')\n\n  def call(self, inputs):\n    x = self.dense_1(inputs)\n    x = self.dense_2(x)\n    return self.pred_layer(x)\n\ndef get_model():\n  return ThreeLayerMLP(name='3_layer_mlp')\n\nmodel = get_model()\n# Save the model\nmodel.save('path_to_my_model',save_format='tf')\n\n# Recreate the exact same model purely from the file\nnew_model = keras.models.load_model('path_to_my_model')\n\nSee: Save and serialize models with Keras - Part II: Saving and Loading of Subclassed Models\n\nTensorFlow 2.0\n\nTL;DR:\n\ndo not use model.save() for custom subclass keras model;\nuse save_weights() and load_weights() instead.\n\nWith the help of the Tensorflow Team, it turns out the best practice of saving a Custom Sub-Class Keras Model is to save its weights and load it back when needed.\n\nThe reason that we can not simply save a Keras custom subclass model is that it contains custom codes, which can not be serialized safely. However, the weights can be saved/loaded when we have the same model structure and custom codes without any problem.\n\nThere has a great tutorial written by Francois Chollet who is the author of Keras, for how to save/load Sequential/Functional/Keras/Custom Sub-Class Models in Tensorflow 2.0 in Colab at here. In Saving Subclassed Models section, it said that:\n\n  Sequential models and Functional models are datastructures that represent a DAG of layers. As such, they can be safely serialized and deserialized.\n  \n  A subclassed model differs in that it's not a datastructure, it's a\n  piece of code. The architecture of the model is defined via the body\n  of the call method. This means that the architecture of the model\n  cannot be safely serialized. To load a model, you'll need to have\n  access to the code that created it (the code of the model subclass).\n  Alternatively, you could be serializing this code as bytecode (e.g.\n  via pickling), but that's unsafe and generally not portable.\"",
    "mlApiName": "keras.models.save_weights,keras.models.save",
    "embedding": [
      0.1409517079591751,
      0.8764416575431824,
      -2.1776468753814697,
      -0.6559522151947021,
      1.3848117589950562,
      -0.09473901242017746,
      -0.06183812394738197,
      0.645521342754364,
      -0.6156429052352905,
      -0.8190735578536987,
      -0.7056453227996826,
      0.39986953139305115,
      1.739091396331787,
      -0.2740020453929901,
      -0.884377658367157,
      -0.003462257096543908,
      0.7862141132354736,
      0.154469832777977,
      0.1171908751130104,
      0.848182737827301,
      -0.7433569431304932,
      -0.5044724941253662,
      0.8000063896179199,
      -0.28347980976104736,
      1.8642879724502563,
      0.16617479920387268,
      -0.4202922582626343,
      0.3648906350135803,
      -0.5731892585754395,
      0.5615097284317017,
      1.042332410812378,
      -0.5019300580024719,
      -0.054150428622961044,
      -0.7588160634040833,
      -1.2621233463287354,
      -0.7385076880455017,
      0.5826060175895691,
      -0.5092875957489014,
      0.02441432513296604,
      -0.016243603080511093,
      0.6368883848190308,
      0.05147278681397438,
      -0.17617371678352356,
      0.18538537621498108,
      0.35189250111579895,
      -0.4936632513999939,
      1.1587728261947632,
      -0.06286248564720154,
      0.10278479009866714,
      -0.017777718603610992,
      0.7770744562149048,
      0.390000581741333,
      -0.35233840346336365,
      0.31584033370018005,
      1.3699554204940796,
      0.4518532454967499,
      0.5128140449523926,
      -0.09078773856163025,
      1.0228030681610107,
      -1.2364014387130737,
      0.20211577415466309,
      0.9146214723587036,
      -0.3301820456981659,
      0.8735767602920532,
      0.15777437388896942,
      -0.31654590368270874,
      -0.8903107643127441,
      0.8980614542961121,
      0.16620399057865143,
      -0.24839898943901062,
      0.7745558619499207,
      0.8384548425674438,
      0.5237544775009155,
      0.3442120850086212,
      0.053991515189409256,
      0.6844574809074402,
      -0.6070277094841003,
      -0.2955879271030426,
      0.12753967940807343,
      0.7382059097290039,
      -0.31956952810287476,
      1.124268651008606,
      0.6332195997238159,
      0.07933948934078217,
      -0.0630335584282875,
      0.3066544830799103,
      -0.8358534574508667,
      -0.3686671555042267,
      -0.9359819889068604,
      1.1944984197616577,
      -0.28735291957855225,
      -0.20455390214920044,
      0.7887459993362427,
      0.720548152923584,
      -0.21701374650001526,
      -0.21324080228805542,
      -0.01677032746374607,
      -0.06734220683574677,
      -0.8581927418708801,
      -0.5975415706634521,
      -0.18497280776500702,
      -0.0446457676589489,
      -0.568783164024353,
      -1.1142719984054565,
      0.4003937840461731,
      1.3176195621490479,
      0.06230592727661133,
      0.2839687764644623,
      0.05959323048591614,
      -0.2896561324596405,
      -0.004103675484657288,
      0.22028902173042297,
      -0.1202966719865799,
      0.1280841827392578,
      -0.47664836049079895,
      0.4944506585597992,
      0.3556345999240875,
      -0.39872604608535767,
      0.4836583137512207,
      0.1316651701927185,
      -0.9600286483764648,
      -0.6803658604621887,
      0.15538521111011505,
      0.07477835565805435,
      -0.45966458320617676,
      0.998741626739502,
      -0.36481890082359314,
      0.0692816823720932,
      0.07352244108915329,
      -0.8524774312973022,
      0.013621351681649685,
      -0.26870638132095337,
      -0.7716801762580872,
      0.42608094215393066,
      0.16407474875450134,
      0.9770877957344055,
      -1.2093596458435059,
      -0.7342102527618408,
      0.4705842435359955,
      0.05729279667139053,
      0.5322194695472717,
      0.36324846744537354,
      -0.3271726965904236,
      -0.06941483914852142,
      0.4016096591949463,
      -1.1409119367599487,
      0.33378568291664124,
      -0.19713732600212097,
      -0.36916276812553406,
      0.20017442107200623,
      0.6881837844848633,
      0.8477444648742676,
      -0.7995733022689819,
      0.5942084789276123,
      0.6683874726295471,
      -0.8195383548736572,
      0.6957508325576782,
      0.8982700705528259,
      0.650749146938324,
      0.024720557034015656,
      1.2878886461257935,
      0.14657440781593323,
      -0.22298812866210938,
      0.6687172651290894,
      -0.6889322400093079,
      -0.8499378561973572,
      -0.1705663651227951,
      -0.22610951960086823,
      -0.16829615831375122,
      0.09826985001564026,
      -1.1890236139297485,
      -0.23627014458179474,
      0.1378532499074936,
      -0.026779435575008392,
      0.22964085638523102,
      0.41088277101516724,
      0.7387902140617371,
      -0.7367338538169861,
      0.6959494948387146,
      -0.5677860379219055,
      0.8328871726989746,
      0.012027150951325893,
      0.8111900687217712,
      0.15613314509391785,
      -0.4795382618904114,
      0.4626977741718292,
      -0.175996333360672,
      0.5078706741333008,
      -0.04518375173211098,
      -0.7926528453826904,
      1.0427765846252441,
      0.4239346385002136,
      -0.543075442314148,
      -0.9407732486724854,
      0.10173722356557846,
      -0.13431617617607117,
      0.685217559337616,
      -0.3063450753688812,
      0.6058547496795654,
      0.14879320561885834,
      0.038901522755622864,
      0.08124402165412903,
      -1.2283903360366821,
      0.2142682671546936,
      -0.8718780279159546,
      0.1557510644197464,
      -0.43110448122024536,
      0.635837972164154,
      -0.10273480415344238,
      0.2810220718383789,
      0.30778729915618896,
      0.06252524256706238,
      -0.27277374267578125,
      0.4294649064540863,
      0.3785713016986847,
      -0.2678714692592621,
      0.7215510606765747,
      -0.23368431627750397,
      -0.707478940486908,
      0.28103798627853394,
      0.3813565671443939,
      -0.20443174242973328,
      0.928064227104187,
      0.5393078923225403,
      0.8175334334373474,
      -1.1131300926208496,
      -0.2855347990989685,
      -0.4415420889854431,
      -0.6209626793861389,
      -0.39240339398384094,
      -0.5617074370384216,
      -0.5397056937217712,
      0.022925151512026787,
      0.3994949460029602,
      0.19771449267864227,
      0.8526054620742798,
      0.9198675155639648,
      0.6009663939476013,
      -0.3102622628211975,
      -0.009943724609911442,
      0.45677173137664795,
      0.5961800217628479,
      0.5117270350456238,
      0.14706405997276306,
      -0.6316606402397156,
      0.10001535713672638,
      -0.16593612730503082,
      -0.5597703456878662,
      0.3851451873779297,
      0.22373999655246735,
      0.5375919342041016,
      0.05931537225842476,
      0.37962454557418823,
      -0.24123036861419678,
      0.9681276082992554,
      -0.2424803078174591,
      -0.5065798759460449,
      -0.08004266023635864,
      0.5478028655052185,
      -0.31202876567840576,
      0.7091628909111023,
      0.35078519582748413,
      0.1098036989569664,
      -0.54465651512146,
      -0.27942395210266113,
      -0.5025118589401245,
      -0.12823419272899628,
      -0.44475531578063965,
      0.6078732013702393,
      -0.3233794867992401,
      -0.40776297450065613,
      0.2801097333431244,
      0.7597256302833557,
      0.2681031823158264,
      0.06470443308353424,
      0.7234935164451599,
      0.05405402556061745,
      -0.29933130741119385,
      -0.4221430718898773,
      -0.009561731480062008,
      -0.622791051864624,
      -0.9489690661430359,
      -0.407367467880249,
      -0.11731700599193573,
      0.059618253260850906,
      -0.1614382416009903,
      -0.09543730318546295,
      0.3534490764141083,
      0.274405300617218,
      0.23083749413490295,
      -0.051880087703466415,
      0.5132206678390503,
      -0.33614370226860046,
      0.267482191324234,
      0.2500667870044708,
      0.4773883819580078,
      0.5776695609092712,
      -0.2953711152076721,
      -0.03825435787439346,
      -0.02984437346458435,
      0.9153209924697876,
      1.2491132020950317,
      1.2016960382461548,
      0.4730665683746338,
      -0.5373378992080688,
      -0.22908158600330353,
      -0.31986933946609497,
      0.06332842260599136,
      0.6152535080909729,
      0.10089973360300064,
      -0.7755988240242004,
      0.37774625420570374,
      -0.2836094796657562,
      0.9649257063865662,
      -0.43126562237739563,
      -0.0996406152844429,
      0.7915667295455933,
      -0.02440851368010044,
      0.49860671162605286,
      -0.44544750452041626,
      -0.18616290390491486,
      0.020569732412695885,
      -0.022839723154902458,
      0.13906732201576233,
      -0.17901255190372467,
      0.7129396796226501,
      -0.7202536463737488,
      0.7698067426681519,
      0.5672317147254944,
      -0.7870991230010986,
      0.3166666626930237,
      -0.16193003952503204,
      0.7086117267608643,
      -1.2737538814544678,
      -1.128955602645874,
      -0.2870986759662628,
      -0.7449198365211487,
      0.12269596755504608,
      -0.06272280216217041,
      0.15318690240383148,
      0.2654046416282654,
      -0.06738697737455368,
      0.08410967141389847,
      -0.4548654854297638,
      -0.4168655276298523,
      0.07204009592533112,
      -1.290040135383606,
      -1.202598214149475,
      0.8860135674476624,
      0.08603755384683609,
      -0.5064744353294373,
      0.25585266947746277,
      0.26494091749191284,
      -0.3974955379962921,
      -0.11942819505929947,
      -0.17825588583946228,
      0.3786657750606537,
      0.21254178881645203,
      -0.10254960507154465,
      0.5654962062835693,
      0.5067456364631653,
      -0.18883487582206726,
      0.30148348212242126,
      -0.3272419273853302,
      0.15555138885974884,
      0.5925580263137817,
      0.9512615203857422,
      -0.33766287565231323,
      0.8807452917098999,
      -0.13849155604839325,
      0.00912366434931755,
      -0.012524588964879513,
      -0.18601524829864502,
      0.5456202626228333,
      -0.413587361574173,
      -0.3314532935619354,
      -1.1506012678146362,
      -0.45051082968711853,
      -0.394510418176651,
      0.2935425043106079,
      0.634606122970581,
      -0.739300549030304,
      -0.344931423664093,
      -0.22672367095947266,
      0.43685072660446167,
      0.4678873121738434,
      0.21281634271144867,
      -0.7494932413101196,
      -0.09917118400335312,
      1.3250305652618408,
      -0.01562599092721939,
      -0.26217371225357056,
      -0.6252678632736206,
      -0.9664534330368042,
      0.9149963855743408,
      -0.18436573445796967,
      0.8625527024269104,
      0.12369268387556076,
      0.1340886652469635,
      -0.5535918474197388,
      -0.9540379047393799,
      -0.8214251399040222,
      -0.21125085651874542,
      -0.42697450518608093,
      -0.40139827132225037,
      -0.09387311339378357,
      -0.5127821564674377,
      -0.41402068734169006,
      0.12694402039051056,
      0.3850472569465637,
      0.5241521000862122,
      0.5298281908035278,
      0.44909659028053284,
      -0.8464676737785339,
      0.7203067541122437,
      -0.035471126437187195,
      0.9066853523254395,
      1.0817140340805054,
      -0.8611778616905212,
      -1.1828080415725708,
      0.26625943183898926,
      0.1254090964794159,
      -0.23857353627681732,
      0.1610078513622284,
      1.1883230209350586,
      0.09499797224998474,
      0.24290414154529572,
      0.4179539680480957,
      -0.43618863821029663,
      -1.4925013780593872,
      0.18043991923332214,
      0.2938607335090637,
      0.3310340642929077,
      -0.09387538582086563,
      -0.6608002781867981,
      -0.20810186862945557,
      0.4335871636867523,
      0.29350849986076355,
      -0.3099190890789032,
      1.0949944257736206,
      0.8414088487625122,
      0.0804203525185585,
      -0.6954757571220398,
      -0.509966254234314,
      0.1383615881204605,
      0.33069315552711487,
      0.9299368858337402,
      -0.9330959916114807,
      -0.8100226521492004,
      0.7100033164024353,
      -0.06805288046598434,
      0.13479390740394592,
      0.5587340593338013,
      0.5951454043388367,
      1.2191046476364136,
      -0.2356913983821869,
      0.1984895020723343,
      -0.21590620279312134,
      -0.060638926923274994,
      0.27061715722084045,
      -0.2464156448841095,
      0.2684701681137085,
      -0.28848621249198914,
      0.2047656774520874,
      -0.6989213824272156,
      -0.7445515990257263,
      -0.5797037482261658,
      -0.1893291473388672,
      0.46884432435035706,
      0.22310499846935272,
      -0.42220187187194824,
      -0.2956107258796692,
      0.23561176657676697,
      -0.40153244137763977,
      -0.10972698777914047,
      0.09870785474777222,
      0.19625847041606903,
      0.2976703941822052,
      0.5019139051437378,
      1.058330774307251,
      0.36137038469314575,
      -0.7584848999977112,
      -0.793538510799408,
      -0.5620080232620239,
      0.4063650965690613,
      1.2991251945495605,
      -0.051250431686639786,
      -0.1331128031015396,
      0.08623950928449631,
      -0.2625810205936432,
      0.07790757715702057,
      0.29164987802505493,
      -0.08437281847000122,
      0.21537581086158752,
      -0.2050127536058426,
      -0.3915680944919586,
      0.884894609451294,
      1.3762562274932861,
      0.44992801547050476,
      -0.06564828008413315,
      -0.18507733941078186,
      0.2687685191631317,
      -0.1988358199596405,
      -0.00018390548939350992,
      0.9481001496315002,
      0.10517942160367966,
      0.953427791595459,
      -0.0919293686747551,
      -0.5968823432922363,
      -0.057102981954813004,
      -0.09949345141649246,
      -0.3297344744205475,
      0.7013730406761169,
      0.9641250371932983,
      0.549564003944397,
      -0.9765350818634033,
      0.5798898935317993,
      0.2524957060813904,
      -0.516092836856842,
      -0.38918042182922363,
      0.2323327660560608,
      -0.19926561415195465,
      0.10800974816083908,
      -0.7775999307632446,
      -1.1402872800827026,
      0.5658054351806641,
      0.15224893391132355,
      -1.2036757469177246,
      0.3710879385471344,
      -0.08124598115682602,
      0.8299129009246826,
      -0.16312499344348907,
      -0.9842882752418518,
      -0.2589643895626068,
      0.0387578122317791,
      -0.3565771281719208,
      -0.9096843600273132,
      0.810753345489502,
      -0.2345501184463501,
      0.05218837410211563,
      0.09945555776357651,
      0.9305482506752014,
      -0.13780176639556885,
      -0.10361940413713455,
      0.08587685972452164,
      -0.2185087949037552,
      0.3876294791698456,
      0.26727113127708435,
      0.3899044990539551,
      -1.3833577632904053,
      -0.03893819823861122,
      -0.4653204381465912,
      0.27359527349472046,
      -1.0123366117477417,
      0.37440934777259827,
      -0.5506208539009094,
      -0.663814902305603,
      -0.8711496591567993,
      -1.0473182201385498,
      -0.21662046015262604,
      -1.0366781949996948,
      0.4873804450035095,
      1.6183128356933594,
      -0.025700781494379044,
      -0.25792521238327026,
      -0.20610010623931885,
      -0.3038298487663269,
      0.5009852051734924,
      0.4449107348918915,
      -0.10951783508062363,
      -0.25266194343566895,
      -0.5372886061668396,
      0.032636646181344986,
      0.10310067981481552,
      -0.38798391819000244,
      -0.07266127318143845,
      0.7287821173667908,
      0.4266883134841919,
      -0.48260802030563354,
      -0.8453114628791809,
      0.021441470831632614,
      -1.3025859594345093,
      0.8651571273803711,
      -0.14583104848861694,
      -0.24904818832874298,
      0.33054372668266296,
      0.2870003581047058,
      -0.6325174570083618,
      0.3389648497104645,
      0.31947416067123413,
      -0.19151660799980164,
      -0.33626413345336914,
      0.4001403748989105,
      0.16771633923053741,
      0.25850579142570496,
      0.011743664741516113,
      -0.3912619650363922,
      0.03200428932905197,
      -0.4744664430618286,
      -1.2686437368392944,
      -0.2768223285675049,
      0.8686453700065613,
      1.322992205619812,
      -1.4667519330978394,
      -0.3913191556930542,
      1.051038384437561,
      -0.5945175290107727,
      0.7232300639152527,
      -0.1983100324869156,
      0.491133451461792,
      -0.1518910527229309,
      -0.3471381366252899,
      0.06393039971590042,
      -0.20782120525836945,
      0.14663462340831757,
      -1.0782591104507446,
      1.0904617309570312,
      0.1634153127670288,
      -0.36417898535728455,
      -0.45333948731422424,
      -0.27921542525291443,
      -1.0278236865997314,
      1.100298285484314,
      -0.9807625412940979,
      0.5399817228317261,
      -0.800242006778717,
      -0.5315051078796387,
      0.5285961627960205,
      0.7004291415214539,
      0.6445908546447754,
      -1.012231707572937,
      0.1096806451678276,
      -2.2492899894714355,
      0.21840643882751465,
      -0.8382148146629333,
      0.8017602562904358,
      -0.19045300781726837,
      0.3519853949546814,
      1.006279468536377,
      0.5526552796363831,
      -0.15048035979270935,
      0.19376425445079803,
      -0.48931604623794556,
      0.1644686460494995,
      -0.5975830554962158,
      -0.6168534755706787,
      0.9394932985305786,
      0.8357389569282532,
      -0.5783244371414185,
      -0.46989232301712036,
      0.9321250319480896,
      1.3581840991973877,
      -0.13299185037612915,
      -0.14604566991329193,
      0.6061818599700928,
      -0.5513761043548584,
      -0.17612002789974213,
      -0.5749222040176392,
      -0.8339312076568604,
      0.04923631623387337,
      0.2382570505142212,
      -0.27968671917915344,
      -0.08251368254423141,
      -0.32736629247665405,
      0.8299753665924072,
      -0.010774146765470505,
      -0.7214717864990234,
      -0.14715473353862762,
      -0.2230842262506485,
      -0.5498026609420776,
      0.24852456152439117,
      0.3535231351852417,
      -0.6107185482978821,
      0.5147336721420288,
      0.2515953481197357,
      -0.3717792332172394,
      0.7287268042564392,
      0.605766236782074,
      0.11157184839248657,
      0.2652818262577057,
      0.27023130655288696,
      0.06867162138223648,
      0.2375480830669403,
      -0.043829623609781265,
      0.9812418222427368,
      -1.5927283763885498,
      0.17647887766361237,
      -1.1088733673095703,
      -0.1793445497751236,
      -0.520781397819519,
      -0.29721799492836,
      0.7117486596107483,
      0.27241891622543335,
      0.12332490086555481,
      -0.7663608193397522,
      0.4684232175350189,
      -0.17658071219921112,
      -0.6214078068733215,
      0.4637528955936432,
      0.5532646775245667,
      0.19545045495033264,
      -0.0516425259411335,
      -0.21808259189128876,
      0.5060351490974426,
      0.16091670095920563,
      -0.23400092124938965,
      0.026132311671972275,
      -0.6017221212387085,
      -0.3684254586696625,
      -0.2598024904727936,
      -0.11973924189805984,
      0.4171430170536041,
      -0.33552470803260803,
      1.094052791595459,
      0.44086137413978577,
      0.28263038396835327,
      -0.45430123805999756,
      -0.9304090738296509,
      -0.21814490854740143,
      -0.3248889744281769,
      0.13668355345726013,
      -0.48713910579681396,
      -1.12520432472229,
      0.16933666169643402,
      -0.6101928949356079,
      -0.8401447534561157,
      -0.04240364581346512,
      -0.5327675342559814,
      -0.6099477410316467,
      0.18074172735214233,
      -0.5592599511146545,
      0.19189223647117615,
      -1.1513386964797974,
      0.6878681182861328,
      -0.23577266931533813,
      0.19548936188220978,
      -0.7744702100753784,
      -0.790685772895813,
      -0.8064083456993103,
      -0.7536971569061279,
      -0.8190554976463318,
      0.7518938183784485,
      0.7590177059173584,
      0.3086010217666626,
      -0.15834791958332062,
      -0.4608401656150818,
      -0.484884113073349,
      0.9231748580932617,
      -0.28563231229782104,
      -0.30259451270103455,
      0.21713106334209442,
      -0.42853766679763794,
      -0.09452463686466217,
      -0.014292532578110695,
      -0.6343890428543091,
      -0.1932029277086258,
      -0.10429156571626663,
      0.6368275880813599,
      0.9644598364830017,
      0.4374440014362335,
      -0.1333787739276886,
      -0.21446630358695984,
      0.25551608204841614,
      0.4046582877635956,
      -0.7074203491210938,
      -0.7968330383300781,
      0.5051246881484985,
      -0.6897437572479248
    ],
    "label": {
      "level1": "AMO",
      "level2": "F",
      "level3": "F",
      "leafContractCategory": "F",
      "rootCause": "Missing Required State-specific Method Order",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/43452441",
    "title": "",
    "question": "\"I combine two VGG net in keras together to make classification task. When I run the program, it shows an error:\n\n  RuntimeError: The name \"\"predictions\"\" is used 2 times in the model. All layer names should be unique.\n\nI was confused because I only use prediction layer once in my code:\n\nfrom keras.layers import Dense\nimport keras\nfrom keras.models import  Model\nmodel1 = keras.applications.vgg16.VGG16(include_top=True, weights='imagenet',\n                                input_tensor=None, input_shape=None,\n                                pooling=None,\n                                classes=1000)\nmodel1.layers.pop()\n\nmodel2 =  keras.applications.vgg16.VGG16(include_top=True, weights='imagenet',\n                                input_tensor=None, input_shape=None,\n                                pooling=None,\n                                classes=1000)\nmodel2.layers.pop()\nfor layer in model2.layers:\n    layer.name = layer.name + str(\"\"two\"\")\nmodel1.summary()\nmodel2.summary()\nfeatureLayer1 = model1.output\nfeatureLayer2 = model2.output\ncombineFeatureLayer = keras.layers.concatenate([featureLayer1, featureLayer2])\nprediction = Dense(1, activation='sigmoid', name='main_output')(combineFeatureLayer)\n\nmodel = Model(inputs=[model1.input, model2.input], outputs= prediction)\nmodel.summary()\n\nThanks for @putonspectacles help, I follow his instruction and find some interesting part. If you use model2.layers.pop() and combine the last layer of two models using \"\"model.layers.keras.layers.concatenate([model1.output, model2.output])\"\", you will find that the last layer information is still showed using the model.summary(). But actually they do not exist in the structure. So instead, you can use model.layers.keras.layers.concatenate([model1.layers[-1].output, model2.layers[-1].output]). It looks tricky but it works.. I think it is a problem about synchronization of the log and structure.\"",
    "answer": "\"First, based on the code you posted you have no layers with a name attribute 'predictions', so this error has nothing to do with your layer \n Dense layer prediction: i.e:\n\nprediction = Dense(1, activation='sigmoid', \n             name='main_output')(combineFeatureLayer)\n\nThe VGG16 model has a Dense layer with name predictions. In particular this line:\n\nx = Dense(classes, activation='softmax', name='predictions')(x)\n\nAnd since you're using two of these models you have layers with duplicate names.\n\nWhat you could do is rename the layer in the second model to something other than predictions, maybe predictions_1, like so:\n\nmodel2 =  keras.applications.vgg16.VGG16(include_top=True, weights='imagenet',\n                                input_tensor=None, input_shape=None,\n                                pooling=None,\n                                classes=1000)\n\n# now change the name of the layer inplace.\nmodel2.get_layer(name='predictions').name='predictions_1'\"",
    "mlApiName": "keras.applications.vgg16.VGG16",
    "embedding": [
      0.4307458698749542,
      0.7140122056007385,
      -2.0773751735687256,
      -0.892408549785614,
      0.8208279013633728,
      -0.7565760016441345,
      0.17429262399673462,
      0.11051508784294128,
      -0.7827706933021545,
      -0.6207992434501648,
      -0.6636382341384888,
      0.33057671785354614,
      1.8929039239883423,
      0.6381353735923767,
      -0.6880089044570923,
      -0.49567729234695435,
      0.359469473361969,
      1.2085784673690796,
      -0.1572377234697342,
      0.3307598829269409,
      -0.4132162928581238,
      -0.7677378058433533,
      0.5953385829925537,
      -0.25840288400650024,
      1.0788151025772095,
      0.7331113219261169,
      -0.9772335290908813,
      0.012792483903467655,
      -0.5348689556121826,
      -0.09040684252977371,
      0.7911543250083923,
      -0.3373761475086212,
      0.006999861914664507,
      -1.1406444311141968,
      -1.0700737237930298,
      -0.7312349081039429,
      0.6349495649337769,
      -0.8685068488121033,
      -1.1403460502624512,
      0.11891565471887589,
      1.0286694765090942,
      0.8911933898925781,
      -0.014104124158620834,
      -0.14786884188652039,
      -0.42493340373039246,
      -0.1439737230539322,
      1.0683192014694214,
      0.5325453877449036,
      1.0505890846252441,
      -1.3950233459472656,
      0.6972615122795105,
      0.6590272188186646,
      0.3618144989013672,
      0.15631404519081116,
      1.0757009983062744,
      1.2463164329528809,
      0.7246069312095642,
      0.7252389192581177,
      1.0656111240386963,
      -0.8948712944984436,
      0.3351133465766907,
      1.3153949975967407,
      -0.8174036145210266,
      1.9164754152297974,
      0.5545839667320251,
      0.18107886612415314,
      -1.1968785524368286,
      0.8899335861206055,
      0.42112189531326294,
      -0.45077893137931824,
      0.17466358840465546,
      0.20496544241905212,
      0.43890807032585144,
      0.33509543538093567,
      0.06752647459506989,
      0.16516119241714478,
      -0.38295307755470276,
      -0.1419241577386856,
      -0.4610174894332886,
      1.0131217241287231,
      0.0067104012705385685,
      1.224120020866394,
      0.7454309463500977,
      -0.37510979175567627,
      -0.36319002509117126,
      0.6038908958435059,
      -1.2503360509872437,
      -0.18943652510643005,
      -1.2045769691467285,
      1.6048755645751953,
      -0.5289303660392761,
      -0.8765525221824646,
      0.4029412269592285,
      1.3803777694702148,
      -1.0620068311691284,
      -0.9730895757675171,
      -0.01322218682616949,
      0.1785954385995865,
      -0.5942289233207703,
      -0.002684570150449872,
      -0.5952164530754089,
      0.7746147513389587,
      -0.23614639043807983,
      -0.5757806897163391,
      -0.09305720776319504,
      1.310191035270691,
      -0.5390732288360596,
      0.12341362982988358,
      -0.0445316843688488,
      -0.27818575501441956,
      -0.5688768029212952,
      0.28950235247612,
      0.3500302731990814,
      -0.4181140959262848,
      0.06272462010383606,
      0.00637042336165905,
      0.3000165522098541,
      -0.47454774379730225,
      -0.24396014213562012,
      -0.4352334141731262,
      -0.012391225434839725,
      -0.847703754901886,
      0.5109071731567383,
      -0.3280480206012726,
      0.2564089000225067,
      0.8584554195404053,
      0.26794227957725525,
      -0.2646368741989136,
      -0.0025773453526198864,
      -1.4523980617523193,
      0.13063371181488037,
      -0.18561935424804688,
      0.13578976690769196,
      0.6200719475746155,
      0.9939008355140686,
      0.5270803570747375,
      -0.28167998790740967,
      -1.0977383852005005,
      1.2026655673980713,
      0.1422232836484909,
      0.06618127226829529,
      0.05435192212462425,
      0.04747895896434784,
      -0.8184240460395813,
      0.5593130588531494,
      -1.228600263595581,
      0.6353499889373779,
      -0.3077576756477356,
      -1.1525105237960815,
      0.2160688042640686,
      -0.1399019956588745,
      0.26472416520118713,
      -1.1136435270309448,
      0.06280253082513809,
      0.28154030442237854,
      -0.5196095108985901,
      0.34255924820899963,
      0.4780271351337433,
      0.44511711597442627,
      -0.2954864501953125,
      1.4361802339553833,
      0.39020100235939026,
      0.7882500290870667,
      0.5364833474159241,
      -0.9660006165504456,
      -0.6893125176429749,
      0.10730913281440735,
      0.052955545485019684,
      -0.47864410281181335,
      0.6269498467445374,
      -0.5195381045341492,
      -0.29842716455459595,
      -0.5223157405853271,
      0.48127225041389465,
      0.4616498053073883,
      0.8348297476768494,
      1.783725619316101,
      -0.6545457243919373,
      0.40524235367774963,
      -0.25517192482948303,
      0.9013965725898743,
      0.048616621643304825,
      0.12559805810451508,
      -0.19781827926635742,
      -0.45846596360206604,
      0.4040263295173645,
      0.3180265426635742,
      0.07049728184938431,
      -0.27055346965789795,
      -0.737958550453186,
      0.7419784069061279,
      -0.1070968359708786,
      -0.36950966715812683,
      -0.509472668170929,
      -0.061303868889808655,
      0.18932534754276276,
      0.5250926613807678,
      -0.8831431865692139,
      0.2273540496826172,
      -0.5545517802238464,
      -0.11106705665588379,
      0.3936721980571747,
      -1.093612551689148,
      0.7450958490371704,
      -0.8797515630722046,
      1.465617060661316,
      -0.881191074848175,
      0.6471198797225952,
      -0.07320252060890198,
      0.21767859160900116,
      1.0316176414489746,
      -0.18330669403076172,
      -0.1182960569858551,
      0.5497996211051941,
      0.46596184372901917,
      -1.0062193870544434,
      0.7309892177581787,
      -0.6461911797523499,
      -0.6117282509803772,
      -0.5101807117462158,
      0.30112436413764954,
      -0.20292048156261444,
      0.5604580640792847,
      -0.023627938702702522,
      0.37618792057037354,
      -1.0741686820983887,
      -0.1301623433828354,
      -0.1710270196199417,
      -1.2031471729278564,
      -0.5480104088783264,
      -0.35292527079582214,
      -1.3090969324111938,
      0.33740484714508057,
      0.16053594648838043,
      -0.17315660417079926,
      0.8703051209449768,
      1.4552814960479736,
      0.3309372365474701,
      -0.20371007919311523,
      -0.19268694519996643,
      0.13219259679317474,
      0.5090131163597107,
      -0.04464878514409065,
      0.23252005875110626,
      -0.8649559020996094,
      0.5088720917701721,
      0.35179054737091064,
      -0.7693096399307251,
      0.3943229019641876,
      1.0199987888336182,
      0.09408259391784668,
      -0.31617453694343567,
      -0.030018437653779984,
      0.5098862051963806,
      1.2134621143341064,
      -1.1949430704116821,
      -0.07844757288694382,
      -0.20436057448387146,
      0.4833845794200897,
      -0.5099203586578369,
      0.33170557022094727,
      0.4321100115776062,
      -0.30324724316596985,
      -0.197300523519516,
      -0.1943882554769516,
      -0.9996944665908813,
      0.31626057624816895,
      0.035431765019893646,
      0.8395111560821533,
      -0.5755929350852966,
      -0.5222120881080627,
      0.45624053478240967,
      0.7392709851264954,
      0.9643763899803162,
      0.19915485382080078,
      0.1389530897140503,
      -0.3418261706829071,
      0.057095300406217575,
      -0.02202315255999565,
      0.1865013986825943,
      -0.6817566752433777,
      -1.007514476776123,
      -0.01722658798098564,
      -0.3766416609287262,
      0.019451269879937172,
      -0.15145014226436615,
      0.05830395221710205,
      0.43666085600852966,
      0.6269039511680603,
      1.1530177593231201,
      -0.03145604580640793,
      -0.12466201186180115,
      0.24285374581813812,
      0.39895227551460266,
      0.22542764246463776,
      -0.13377994298934937,
      0.1103978380560875,
      0.07153031975030899,
      -0.14672015607357025,
      -0.9856243133544922,
      0.5755408406257629,
      1.0517833232879639,
      1.125530481338501,
      0.5192239284515381,
      0.46142321825027466,
      0.10092142224311829,
      -0.39900025725364685,
      0.4471946954727173,
      0.21491555869579315,
      -0.4599717855453491,
      -0.2099732756614685,
      -0.015642572194337845,
      0.5259279012680054,
      0.7297799587249756,
      -0.37818118929862976,
      0.3408551514148712,
      0.2632853090763092,
      0.9775924682617188,
      -0.10834843665361404,
      -0.42121410369873047,
      -0.5295363068580627,
      0.07498273253440857,
      -0.1916847825050354,
      0.044120099395513535,
      -0.6302598118782043,
      0.8095512986183167,
      -1.0715556144714355,
      0.2314341962337494,
      0.048542700707912445,
      0.13780167698860168,
      0.22855806350708008,
      -0.03597939759492874,
      0.15220998227596283,
      -1.255804181098938,
      -0.48251914978027344,
      -0.41816624999046326,
      -0.10014097392559052,
      -0.38674086332321167,
      0.16132792830467224,
      1.0394287109375,
      -0.24855856597423553,
      -0.3707401156425476,
      0.6795753836631775,
      -0.4728035032749176,
      0.023182155564427376,
      0.5671184062957764,
      -1.1138432025909424,
      -1.2822903394699097,
      0.8336077332496643,
      0.6692010164260864,
      -0.299519807100296,
      0.32042619585990906,
      0.370740681886673,
      0.5289373993873596,
      -0.5184360146522522,
      -0.31858232617378235,
      0.1182025745511055,
      0.1776433140039444,
      -0.02668585255742073,
      1.097565770149231,
      0.5322320461273193,
      -0.512811005115509,
      -0.4736575782299042,
      0.019013551995158195,
      0.017726363614201546,
      0.7676122784614563,
      0.9978037476539612,
      -0.10376687347888947,
      1.0057259798049927,
      -0.37556058168411255,
      -0.32816416025161743,
      0.05913548544049263,
      -0.9562340378761292,
      -0.027309603989124298,
      0.7174633145332336,
      -0.4377650022506714,
      -1.0248314142227173,
      0.17582882940769196,
      -0.3609970808029175,
      0.48123982548713684,
      0.31965091824531555,
      -0.877217710018158,
      -0.1617877334356308,
      0.33821046352386475,
      0.6532178521156311,
      0.9792495369911194,
      0.8063272833824158,
      -0.20297040045261383,
      -0.12840716540813446,
      1.3347822427749634,
      0.2669847309589386,
      0.03575892746448517,
      -1.0527567863464355,
      -0.3659253418445587,
      0.7415900826454163,
      -0.6475955843925476,
      0.5011112093925476,
      0.5980377793312073,
      -0.28657466173171997,
      0.4997517764568329,
      -1.3663274049758911,
      -1.2685943841934204,
      -0.2364708036184311,
      -0.6382005214691162,
      -0.16088876128196716,
      0.1130167692899704,
      0.6212062835693359,
      -0.012015697546303272,
      0.3501197397708893,
      0.6062813401222229,
      0.5038538575172424,
      0.9109266400337219,
      -0.11516734957695007,
      -1.1589548587799072,
      0.6841551661491394,
      -0.09303133189678192,
      0.4466836750507355,
      0.9080285429954529,
      -1.1629818677902222,
      -0.6124879717826843,
      -0.1326133757829666,
      1.3785293102264404,
      -0.2357371747493744,
      -0.5740321278572083,
      1.2431224584579468,
      -0.26769256591796875,
      0.712753415107727,
      1.4741473197937012,
      -0.2770058810710907,
      -1.82209050655365,
      0.45588597655296326,
      0.31506648659706116,
      0.5058060884475708,
      -0.5098925232887268,
      -0.8769239187240601,
      0.03569725155830383,
      0.151828333735466,
      1.1691123247146606,
      -0.10898632556200027,
      1.0668084621429443,
      1.1785635948181152,
      -0.8495836853981018,
      -0.9644715785980225,
      -0.25375109910964966,
      0.7360239028930664,
      0.30716657638549805,
      0.7779383063316345,
      -0.6799128651618958,
      -1.1468584537506104,
      1.419183611869812,
      -0.05971217527985573,
      -0.6157798767089844,
      0.46293726563453674,
      0.49130651354789734,
      1.5462989807128906,
      0.49405232071876526,
      0.051460232585668564,
      0.3350089490413666,
      -0.6580194234848022,
      0.292667955160141,
      0.3169964849948883,
      0.37470543384552,
      -0.7736381888389587,
      0.01979249157011509,
      -0.2462480217218399,
      -0.8560923933982849,
      -0.244779571890831,
      -0.30048486590385437,
      0.6376095414161682,
      1.0166411399841309,
      -0.2809067964553833,
      0.18804477155208588,
      -0.024441735818982124,
      -0.14041633903980255,
      0.4718434512615204,
      -0.08269079774618149,
      0.5723623633384705,
      0.18544763326644897,
      -0.07219795882701874,
      0.5683724880218506,
      -0.3227773904800415,
      -1.5758566856384277,
      -0.23618055880069733,
      -0.5086591243743896,
      -0.17338137328624725,
      1.201321005821228,
      0.189677432179451,
      -0.10178861021995544,
      0.5303056240081787,
      0.20240241289138794,
      0.43798282742500305,
      -0.5719177722930908,
      0.03378158435225487,
      0.6951674818992615,
      0.3445272743701935,
      -0.5046524405479431,
      -0.2814485728740692,
      0.9547271728515625,
      0.10780816525220871,
      0.35555675625801086,
      0.45565593242645264,
      0.445224404335022,
      -0.743657648563385,
      0.012234269641339779,
      0.6455490589141846,
      -0.6124951839447021,
      0.5511153936386108,
      -0.9596923589706421,
      0.3474937975406647,
      -0.2604272961616516,
      0.4427778124809265,
      -0.3017290234565735,
      -0.07961668819189072,
      0.031133629381656647,
      0.41947367787361145,
      -1.0522209405899048,
      0.3078444004058838,
      -0.19208264350891113,
      -0.7387054562568665,
      -0.7967578768730164,
      0.011166895739734173,
      -0.39422693848609924,
      -0.7294871807098389,
      -0.9785667657852173,
      -0.6896372437477112,
      0.08409582823514938,
      -0.2628418207168579,
      -1.0933209657669067,
      0.12251324206590652,
      -0.019864723086357117,
      0.38932955265045166,
      0.12939563393592834,
      -1.254082202911377,
      0.09205546975135803,
      1.1300609111785889,
      -0.5364887118339539,
      -0.4539680778980255,
      1.1486207246780396,
      0.669646143913269,
      0.07252074778079987,
      -0.013554075732827187,
      1.1939126253128052,
      0.01706213504076004,
      -1.2339630126953125,
      -1.2603468894958496,
      0.1329692304134369,
      0.24970994889736176,
      0.8998954892158508,
      0.9163612723350525,
      -0.16482102870941162,
      0.12388268113136292,
      -1.2953130006790161,
      0.7525899410247803,
      -0.5589778423309326,
      0.36156097054481506,
      -1.0043097734451294,
      -0.5928447246551514,
      -0.9134101271629333,
      -0.8255029916763306,
      0.13040302693843842,
      -0.6862937808036804,
      0.37440192699432373,
      2.066474676132202,
      -0.087232805788517,
      -0.03687501698732376,
      -0.5165446996688843,
      -0.9809362888336182,
      0.5506735444068909,
      -0.09230907261371613,
      0.7382776141166687,
      0.37402504682540894,
      -0.6727908849716187,
      -0.04984624683856964,
      0.32858070731163025,
      -0.000411294138757512,
      0.3800687789916992,
      0.9397948980331421,
      0.33910682797431946,
      -0.7602049112319946,
      -1.4797412157058716,
      0.5544125437736511,
      -1.1577943563461304,
      0.06366994231939316,
      -0.45844581723213196,
      0.06300054490566254,
      0.0943576842546463,
      -0.24728578329086304,
      -0.6436529755592346,
      0.2489384561777115,
      0.10034561157226562,
      -0.9226014614105225,
      -0.4619125425815582,
      0.8407171368598938,
      0.12194270640611649,
      0.3403152525424957,
      -0.2097717821598053,
      -0.5851110219955444,
      1.009750485420227,
      -0.40952882170677185,
      -1.1884623765945435,
      -0.039524149149656296,
      0.27332836389541626,
      1.8477288484573364,
      -0.8905912637710571,
      -0.47932231426239014,
      1.2204443216323853,
      -1.1095308065414429,
      0.11601521819829941,
      -0.3517155647277832,
      0.7940849661827087,
      0.2985350787639618,
      0.005125424824655056,
      -0.06207512319087982,
      0.15043002367019653,
      0.16329079866409302,
      -1.2490038871765137,
      0.15932013094425201,
      0.043168406933546066,
      0.057295843958854675,
      -0.9540243744850159,
      -0.5142136812210083,
      -0.7503255605697632,
      0.7570253610610962,
      -1.2280230522155762,
      0.25064101815223694,
      -0.30329951643943787,
      -0.2774672210216522,
      -0.39605391025543213,
      0.5231931209564209,
      0.5695423483848572,
      -1.558424711227417,
      0.4646824896335602,
      -1.453681230545044,
      -0.3844717741012573,
      -0.7628888487815857,
      1.3736869096755981,
      -0.6186656951904297,
      0.36561915278434753,
      0.2094869464635849,
      0.30552178621292114,
      0.3459221124649048,
      0.3514595627784729,
      -0.5317599177360535,
      0.7215255498886108,
      0.5487484931945801,
      -0.6210330724716187,
      0.9061418175697327,
      -0.12963487207889557,
      -0.09375698119401932,
      0.5251021385192871,
      0.692467451095581,
      0.7256554365158081,
      -0.23020724952220917,
      0.08468063920736313,
      0.688413679599762,
      -0.3627190887928009,
      0.5604479908943176,
      -0.41219502687454224,
      -0.6645637154579163,
      0.4821760952472687,
      -0.5739314556121826,
      -0.18971718847751617,
      -1.174687385559082,
      -0.3535684645175934,
      0.40666064620018005,
      -0.10157296806573868,
      0.5312038064002991,
      -0.5094729065895081,
      0.19113574922084808,
      -0.7399236559867859,
      -0.1510051041841507,
      0.48510581254959106,
      0.39642658829689026,
      0.37802860140800476,
      0.3969663679599762,
      0.13362710177898407,
      0.8998806476593018,
      0.42811715602874756,
      0.2726188600063324,
      -0.45775845646858215,
      0.6335596442222595,
      0.10702431201934814,
      0.917665421962738,
      0.25363463163375854,
      0.4803068935871124,
      -1.3253239393234253,
      0.02106069214642048,
      -0.9116687178611755,
      -0.08774857968091965,
      -0.6967146396636963,
      0.6060497164726257,
      -0.3210138976573944,
      0.7575053572654724,
      -0.6956729292869568,
      -0.7326391339302063,
      0.9750717282295227,
      0.15574364364147186,
      -1.3290332555770874,
      0.29441389441490173,
      0.8185398578643799,
      0.4378819167613983,
      0.05229853466153145,
      -0.46994391083717346,
      0.31141796708106995,
      0.10416936129331589,
      0.3450567424297333,
      0.3706299960613251,
      0.4656737446784973,
      -0.4231273829936981,
      -0.8744332790374756,
      -1.4381272792816162,
      0.1165773868560791,
      -0.3202294111251831,
      1.3279471397399902,
      -1.1690325736999512,
      0.18695829808712006,
      0.4113377630710602,
      -0.3929392993450165,
      -0.01705397106707096,
      0.011612356640398502,
      -0.3595953583717346,
      -1.0324482917785645,
      -1.3979898691177368,
      0.02179565653204918,
      -0.6005264520645142,
      -0.4491633474826813,
      0.6046561598777771,
      -0.1748855710029602,
      -0.1819583773612976,
      0.2655130922794342,
      -1.125393033027649,
      0.18595948815345764,
      -1.4988754987716675,
      1.1093590259552002,
      -0.9926157593727112,
      0.042657479643821716,
      -0.6254456639289856,
      -0.26193365454673767,
      -0.6963622570037842,
      -0.7326974868774414,
      -1.0880244970321655,
      0.336013525724411,
      0.568423330783844,
      -0.1892378181219101,
      -0.6106866598129272,
      -0.36325138807296753,
      -1.0117394924163818,
      1.3758549690246582,
      -0.023185478523373604,
      -0.28952378034591675,
      -0.5471962094306946,
      0.09823959320783615,
      -0.9392375946044922,
      0.0963996946811676,
      0.33432212471961975,
      0.16429020464420319,
      -0.642645001411438,
      1.1939740180969238,
      0.4705469012260437,
      0.5237913727760315,
      -0.5045265555381775,
      -0.9654873013496399,
      -0.03466397523880005,
      -0.271725058555603,
      0.21056409180164337,
      -0.834998369216919,
      -0.22497320175170898,
      0.23190556466579437
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SAI",
      "level3": "F,IC-2",
      "leafContractCategory": "SAM (Level 3) ? AMO(Level 2)",
      "rootCause": "Missing Input value-Method order Dependency",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/43715047",
    "title": "",
    "question": "\"I am using Windows 10, Python 3.5, and tensorflow 1.1.0. I have the following script:\n\nimport tensorflow as tf\nimport tensorflow.contrib.keras.api.keras.backend as K\nfrom tensorflow.contrib.keras.api.keras.layers import Dense\n\ntf.reset_default_graph()\ninit = tf.global_variables_initializer()\nsess =  tf.Session()\nK.set_session(sess) # Keras will use this sesssion to initialize all variables\n\ninput_x = tf.placeholder(tf.float32, [None, 10], name='input_x')    \ndense1 = Dense(10, activation='relu')(input_x)\n\nsess.run(init)\n\ndense1.get_weights()\n\nI get the error: AttributeError: 'Tensor' object has no attribute 'weights'\n\nWhat am I doing wrong, and how do I get the weights of dense1? I have look at this and this SO post, but I still can't make it work.\"",
    "answer": "\"If you want to get weights and biases of all layers, you can simply use:\n\nfor layer in model.layers: print(layer.get_config(), layer.get_weights())\n\nThis will print all information that's relevant.\n\nIf you want the weights directly returned as numpy arrays, you can use:\n\nfirst_layer_weights = model.layers[0].get_weights()[0]\nfirst_layer_biases  = model.layers[0].get_weights()[1]\nsecond_layer_weights = model.layers[1].get_weights()[0]\nsecond_layer_biases  = model.layers[1].get_weights()[1]\n\netc.\"",
    "mlApiName": "keras.layers.Dense",
    "embedding": [
      0.6644178032875061,
      1.233604073524475,
      -2.445286750793457,
      -1.3016198873519897,
      1.3198298215866089,
      0.2767997980117798,
      0.36471468210220337,
      0.98253333568573,
      -1.0967925786972046,
      -0.5204409956932068,
      -0.739732027053833,
      0.6647365689277649,
      1.9778443574905396,
      -0.44929569959640503,
      -0.9419746398925781,
      -0.030609924346208572,
      0.6008818745613098,
      0.1875503659248352,
      0.6909131407737732,
      0.5068613290786743,
      -0.13814586400985718,
      -0.8255053758621216,
      0.6308562755584717,
      -0.23879125714302063,
      1.9812654256820679,
      0.7405498027801514,
      -1.0117896795272827,
      0.568096399307251,
      -0.8077623248100281,
      0.013040806166827679,
      0.4370121359825134,
      -0.11978567391633987,
      -0.3615657389163971,
      -0.4804401695728302,
      -0.3643108308315277,
      -0.43192198872566223,
      0.9177448749542236,
      0.11796144396066666,
      -0.6134358048439026,
      0.025655990466475487,
      0.6799697875976562,
      0.0495978519320488,
      0.23583604395389557,
      0.8321507573127747,
      -0.01993733085691929,
      -0.07682489603757858,
      1.1864577531814575,
      0.6935948729515076,
      -0.11376138776540756,
      -1.287469744682312,
      -0.4385611414909363,
      0.60372394323349,
      0.04782308638095856,
      0.49033090472221375,
      1.165886402130127,
      -0.14011545479297638,
      0.05230053886771202,
      0.1176573783159256,
      1.1314060688018799,
      -0.6534016132354736,
      0.13154175877571106,
      1.0685970783233643,
      -1.558481216430664,
      0.8162491917610168,
      1.0373551845550537,
      0.24918700754642487,
      -0.6279348134994507,
      0.15794607996940613,
      -0.5039358735084534,
      -0.32681435346603394,
      0.6083841919898987,
      -0.03870046138763428,
      -0.37262028455734253,
      0.6009224057197571,
      -1.434394121170044,
      -0.2087959349155426,
      -0.9266947507858276,
      -0.5159673094749451,
      -0.005536145530641079,
      -0.20452755689620972,
      0.07645507901906967,
      1.146198034286499,
      1.58830726146698,
      -0.8474907875061035,
      0.03952537477016449,
      0.2708607614040375,
      -1.063634991645813,
      -0.15643109381198883,
      -0.5765736103057861,
      1.853079915046692,
      -0.5578299760818481,
      -0.49107295274734497,
      0.26523879170417786,
      0.9649173617362976,
      -0.64265376329422,
      -0.3711386024951935,
      0.19458813965320587,
      -0.11715684086084366,
      -0.6569334268569946,
      -0.5385771989822388,
      -0.5539972186088562,
      0.9439592361450195,
      -0.6904680132865906,
      -1.3125708103179932,
      -0.17061959207057953,
      1.6876763105392456,
      -0.6317608952522278,
      0.514979362487793,
      -0.26911166310310364,
      0.05674813315272331,
      -0.6253757476806641,
      0.3109965920448303,
      0.16863976418972015,
      -0.1325877457857132,
      -0.009340997785329819,
      -0.39365899562835693,
      0.2339555323123932,
      -0.632793128490448,
      -0.16636379063129425,
      0.2970174551010132,
      -0.786469578742981,
      -0.3746572434902191,
      0.9094517827033997,
      0.9373319745063782,
      -0.5267553329467773,
      0.7994900941848755,
      -0.4768213927745819,
      -0.381334513425827,
      0.044530175626277924,
      -1.2008309364318848,
      0.4729958474636078,
      -0.8383970260620117,
      -0.9921696186065674,
      0.3761664032936096,
      0.22756776213645935,
      1.1557000875473022,
      -1.3068898916244507,
      -0.7110111117362976,
      0.3916780352592468,
      0.49804335832595825,
      0.8422430753707886,
      0.6492769122123718,
      -0.953015148639679,
      -0.6360796093940735,
      0.9033999443054199,
      -1.1592340469360352,
      0.679226279258728,
      -0.5699454545974731,
      0.041624799370765686,
      0.25560450553894043,
      0.6433069109916687,
      1.3417896032333374,
      -1.7782704830169678,
      -0.30067145824432373,
      0.35677191615104675,
      -1.2759960889816284,
      1.1428126096725464,
      0.5174432396888733,
      0.48664823174476624,
      -0.056442905217409134,
      1.8635661602020264,
      1.2024316787719727,
      0.5667974352836609,
      0.5866425633430481,
      0.5090645551681519,
      -1.014441728591919,
      0.2676178216934204,
      0.5787217617034912,
      0.10393792390823364,
      0.3569387197494507,
      -0.8605960011482239,
      -0.05519020929932594,
      -0.09089048206806183,
      -0.45874324440956116,
      0.008355427533388138,
      1.2028632164001465,
      0.8616392016410828,
      -0.8625826239585876,
      0.5562782287597656,
      -0.06283971667289734,
      0.5206273794174194,
      -0.1251019537448883,
      1.0219480991363525,
      -0.6551476120948792,
      -0.3100130259990692,
      0.2506941556930542,
      0.45679372549057007,
      0.14799737930297852,
      0.30473747849464417,
      -0.1731014996767044,
      0.6601882576942444,
      -0.39491090178489685,
      -0.4492095112800598,
      -0.3270817995071411,
      -0.30071982741355896,
      0.24820612370967865,
      1.252139687538147,
      -0.7924947738647461,
      0.7822192311286926,
      0.33562588691711426,
      0.37193137407302856,
      0.4073867201805115,
      -1.1874949932098389,
      0.8768914937973022,
      -1.2311240434646606,
      1.14296555519104,
      -0.6091188788414001,
      0.3516635298728943,
      -0.3368712365627289,
      0.3753931522369385,
      -0.03230864927172661,
      -0.3746340274810791,
      0.29185283184051514,
      0.6090884804725647,
      0.22192856669425964,
      -0.03287363797426224,
      0.8666455149650574,
      -0.6470118761062622,
      -0.17686906456947327,
      0.4828808903694153,
      0.03168899938464165,
      0.01750010810792446,
      0.2528908848762512,
      0.40550804138183594,
      0.7148012518882751,
      -0.6650542616844177,
      0.29241684079170227,
      -0.4313852787017822,
      -0.4234369397163391,
      -0.5824563503265381,
      -1.4681864976882935,
      -0.3737592399120331,
      0.39589330554008484,
      0.49656519293785095,
      0.2035055309534073,
      0.6852163672447205,
      0.9392132759094238,
      0.2963002324104309,
      -0.33753201365470886,
      0.38076117634773254,
      -0.2671319842338562,
      1.0157432556152344,
      0.43715307116508484,
      0.4435547888278961,
      -0.9968231320381165,
      0.40524956583976746,
      -0.23008419573307037,
      -0.8512489199638367,
      0.6520284414291382,
      0.41007500886917114,
      0.072354257106781,
      0.12695609033107758,
      0.4624065160751343,
      0.1623733639717102,
      0.9869969487190247,
      -0.47041499614715576,
      -0.4413212537765503,
      -0.5035930275917053,
      0.9555355310440063,
      -0.24898819625377655,
      0.715557336807251,
      0.02099035680294037,
      0.22444170713424683,
      -0.07209209352731705,
      -1.038643479347229,
      -0.6378388404846191,
      -0.617337703704834,
      -0.8260777592658997,
      -0.1417427808046341,
      -0.6554660797119141,
      -0.08192076534032822,
      0.7732890844345093,
      0.631786048412323,
      0.6463942527770996,
      -0.03084133192896843,
      0.6281923651695251,
      -0.12393422424793243,
      0.3466658890247345,
      0.12660789489746094,
      0.03757533058524132,
      -0.6631869077682495,
      -0.854902982711792,
      -0.5905637741088867,
      0.06652962416410446,
      -0.005881105083972216,
      -0.06621520966291428,
      0.6654064059257507,
      0.3337860107421875,
      0.6785955429077148,
      0.20755557715892792,
      1.1035234928131104,
      0.35044336318969727,
      -0.2560803294181824,
      -0.1768771857023239,
      0.3372279405593872,
      0.9334629774093628,
      0.6774248480796814,
      -0.9464420676231384,
      0.025601880624890327,
      -0.43740928173065186,
      0.33440709114074707,
      1.4304157495498657,
      0.7777804136276245,
      -0.047878675162792206,
      -0.7662867903709412,
      -0.19232790172100067,
      0.7026357054710388,
      0.670214831829071,
      0.3349232077598572,
      -0.1683649867773056,
      -0.938403308391571,
      0.2860517203807831,
      0.4869600236415863,
      1.177009105682373,
      -0.06553080677986145,
      -0.1583143174648285,
      0.35918039083480835,
      0.05518374592065811,
      0.04670216888189316,
      -1.381361484527588,
      0.03720594942569733,
      0.15239699184894562,
      0.13011504709720612,
      0.019277794286608696,
      -0.690213143825531,
      0.21926359832286835,
      -0.4546041786670685,
      0.4055197238922119,
      0.6617844700813293,
      -0.5354690551757812,
      0.38888970017433167,
      0.20656470954418182,
      0.669259250164032,
      -1.116481900215149,
      -1.4780057668685913,
      -0.5290338397026062,
      -0.05602608248591423,
      -0.160018652677536,
      0.6919238567352295,
      0.221054345369339,
      -0.8057165741920471,
      -0.2175372838973999,
      0.22892646491527557,
      0.1354515105485916,
      -0.6325896382331848,
      0.5387216210365295,
      -1.3474431037902832,
      -0.7706999182701111,
      0.5421584248542786,
      0.24652081727981567,
      -0.402355432510376,
      0.2738935351371765,
      -0.035689156502485275,
      -0.3422330319881439,
      0.05026644840836525,
      -0.27223435044288635,
      1.1257178783416748,
      0.11539894342422485,
      0.20117352902889252,
      -0.03139949217438698,
      0.29161718487739563,
      -0.3106001615524292,
      0.09012412279844284,
      -0.4469178020954132,
      -0.30406370759010315,
      -0.053419873118400574,
      1.0452029705047607,
      0.42914193868637085,
      0.6857752203941345,
      0.05215365067124367,
      0.5768174529075623,
      -0.3209919333457947,
      -0.4767151474952698,
      -0.21232755482196808,
      -0.6151048541069031,
      -0.2565135061740875,
      -0.8242262005805969,
      0.1303252875804901,
      -0.09998856484889984,
      0.2787455916404724,
      0.7541075944900513,
      -0.7127474546432495,
      0.13960891962051392,
      -0.15372522175312042,
      0.5932262539863586,
      0.5876609683036804,
      0.25598910450935364,
      -0.7154790163040161,
      0.32583102583885193,
      0.8391501903533936,
      0.5028700232505798,
      0.16211596131324768,
      -0.5363101959228516,
      -0.1620703786611557,
      1.1472413539886475,
      -0.691619873046875,
      1.246923565864563,
      0.9167139530181885,
      -0.14547467231750488,
      -0.32789161801338196,
      -0.8232189416885376,
      -0.43481922149658203,
      -0.1240679919719696,
      -0.31299182772636414,
      0.1680019199848175,
      0.5100629925727844,
      0.3600444495677948,
      -0.08205752819776535,
      0.2277740091085434,
      0.3657681345939636,
      0.14299321174621582,
      0.5835414528846741,
      0.47486644983291626,
      -1.485603928565979,
      1.0045264959335327,
      0.19463813304901123,
      0.050827041268348694,
      0.08720462769269943,
      -1.0466647148132324,
      -1.3389569520950317,
      0.017915397882461548,
      0.007345293648540974,
      0.07414568960666656,
      -0.11914869397878647,
      0.3618435859680176,
      0.2915288805961609,
      0.18134547770023346,
      0.8546451330184937,
      0.4267989695072174,
      -1.0462042093276978,
      0.04536791145801544,
      0.646800696849823,
      0.44682538509368896,
      -0.3379072844982147,
      -0.21777361631393433,
      0.8023220896720886,
      0.32741910219192505,
      1.04088294506073,
      -0.656173825263977,
      0.79017174243927,
      0.5433129072189331,
      0.08260686695575714,
      -1.1236467361450195,
      -0.33542487025260925,
      0.1001991555094719,
      0.4515618085861206,
      0.8171575665473938,
      -0.2286321520805359,
      -1.3683196306228638,
      1.048720359802246,
      0.041537947952747345,
      0.03789140656590462,
      0.08430805057287216,
      -0.1361454278230667,
      1.7136235237121582,
      -0.011739189736545086,
      -0.03834237903356552,
      0.3253292441368103,
      -0.5571489334106445,
      -0.08949419856071472,
      0.21352067589759827,
      -0.2736440598964691,
      -1.0865000486373901,
      -0.2475736141204834,
      -0.9671880006790161,
      -1.5226472616195679,
      -0.8099027276039124,
      0.4270767867565155,
      0.5359360575675964,
      0.48441365361213684,
      -1.2639425992965698,
      -0.5453737378120422,
      0.23940293490886688,
      0.14770002663135529,
      0.3888976573944092,
      0.2524878978729248,
      0.6991195678710938,
      -0.3704235851764679,
      -0.09357797354459763,
      0.7712633013725281,
      0.13090147078037262,
      -0.3259681165218353,
      -0.7646604776382446,
      -0.44492873549461365,
      -0.17984044551849365,
      1.7892800569534302,
      -0.4392009377479553,
      0.3126368522644043,
      0.23175957798957825,
      0.14529049396514893,
      -0.21715807914733887,
      -0.6247715950012207,
      -0.5513995289802551,
      -0.1835206001996994,
      -0.3706745207309723,
      -0.004837918095290661,
      0.10745295882225037,
      0.22178371250629425,
      0.677081823348999,
      0.20501558482646942,
      -0.04348229616880417,
      0.42693477869033813,
      -0.45099011063575745,
      0.7485218048095703,
      0.7550321817398071,
      -0.3335665762424469,
      1.3855938911437988,
      -0.8575295805931091,
      0.40593117475509644,
      0.20633059740066528,
      -0.01668858900666237,
      -0.08442559838294983,
      0.8736618757247925,
      0.1976490318775177,
      0.6157671213150024,
      -1.014032006263733,
      0.32974404096603394,
      0.21900521218776703,
      -0.4983643591403961,
      -0.003530869958922267,
      0.47418174147605896,
      -0.6932561993598938,
      -0.3234294652938843,
      -0.9635053277015686,
      -1.1296336650848389,
      0.4721195101737976,
      0.11031505465507507,
      -0.7770053744316101,
      0.09992969036102295,
      -0.09208828955888748,
      0.2904060184955597,
      -0.44958972930908203,
      -1.285958170890808,
      -0.375262975692749,
      1.3946032524108887,
      -0.6968920826911926,
      -0.2920307219028473,
      1.1851767301559448,
      -0.22614893317222595,
      -0.2723017930984497,
      0.3034846782684326,
      1.5038552284240723,
      -0.6571037173271179,
      -0.39281028509140015,
      -1.0431989431381226,
      0.0613519661128521,
      0.057003702968358994,
      0.34086790680885315,
      0.9416211843490601,
      -1.1350685358047485,
      0.1292497217655182,
      -0.5916531682014465,
      0.9843231439590454,
      -0.9286583065986633,
      0.18728609383106232,
      -0.0962158665060997,
      -0.8120496869087219,
      -0.6418489813804626,
      -1.0783261060714722,
      -0.4191703200340271,
      -0.6644420027732849,
      -0.04078558087348938,
      1.3381223678588867,
      0.0100117651745677,
      -0.014137799851596355,
      -0.27846959233283997,
      -0.5465002655982971,
      0.13245202600955963,
      0.3348706364631653,
      0.47661128640174866,
      -0.27469131350517273,
      -0.56068354845047,
      0.041096244007349014,
      -0.36541852355003357,
      0.036655839532613754,
      0.2502037286758423,
      0.017841272056102753,
      -0.011646649800240993,
      -0.6575700044631958,
      -0.6672185659408569,
      0.13427087664604187,
      -0.7126215100288391,
      0.23530016839504242,
      -0.2435048669576645,
      0.3902755081653595,
      -0.1035240888595581,
      -0.3602159321308136,
      -1.0266655683517456,
      0.08986362814903259,
      -0.3563859760761261,
      -0.7805740833282471,
      -0.3089866042137146,
      0.7449954748153687,
      -1.1164346933364868,
      -0.6549714207649231,
      -0.24577541649341583,
      -0.6568291187286377,
      0.7340922951698303,
      -0.5386141538619995,
      -0.9047196507453918,
      -0.09460143744945526,
      0.6237008571624756,
      1.152154803276062,
      -1.0581738948822021,
      0.043103862553834915,
      0.5530874729156494,
      -0.7266488671302795,
      -0.11721372604370117,
      -0.4246489703655243,
      0.9290469288825989,
      0.5349256992340088,
      0.2947530150413513,
      -0.18989159166812897,
      0.3763313889503479,
      0.13358405232429504,
      -0.45063847303390503,
      0.7752892971038818,
      0.5329129099845886,
      0.013228773139417171,
      -0.9005480408668518,
      -0.3307911455631256,
      -1.1939924955368042,
      1.4575555324554443,
      -1.2015085220336914,
      1.166989803314209,
      -0.6341390013694763,
      -0.47143906354904175,
      0.9827862977981567,
      -0.17253440618515015,
      0.45981648564338684,
      -1.1047736406326294,
      0.6248812079429626,
      -0.7948994636535645,
      0.027545010671019554,
      -1.1448328495025635,
      1.324804425239563,
      0.251418799161911,
      0.971519947052002,
      0.7732027769088745,
      0.4232081174850464,
      -0.15803061425685883,
      0.019374188035726547,
      -1.438370704650879,
      0.44783928990364075,
      -0.27878043055534363,
      -1.1608649492263794,
      0.4094401001930237,
      1.038212776184082,
      -0.38763952255249023,
      0.46060648560523987,
      1.1658544540405273,
      1.1023951768875122,
      0.13110871613025665,
      -0.04910670220851898,
      0.5636005997657776,
      -1.0562248229980469,
      0.3603106737136841,
      -1.261610507965088,
      -1.0716227293014526,
      0.38368237018585205,
      -0.4417744576931,
      -0.3780226707458496,
      -0.7853984236717224,
      0.2404162734746933,
      0.12543095648288727,
      0.1175602376461029,
      -0.0956864133477211,
      0.23344191908836365,
      -0.20603471994400024,
      -0.4472595453262329,
      0.24863845109939575,
      0.4201715588569641,
      -0.15168426930904388,
      1.3298587799072266,
      0.1621870994567871,
      0.019002504646778107,
      0.29543834924697876,
      0.8115589022636414,
      0.4226095676422119,
      0.006449627690017223,
      0.5423303246498108,
      0.7028888463973999,
      0.10467332601547241,
      0.400882750749588,
      0.15370948612689972,
      -1.2145576477050781,
      -0.43542182445526123,
      -1.42693030834198,
      0.19244642555713654,
      -0.49858659505844116,
      -0.2624117136001587,
      0.2876601219177246,
      0.17225056886672974,
      -0.35785508155822754,
      -0.6707485914230347,
      0.22248691320419312,
      -0.16737911105155945,
      -0.7541543841362,
      0.3821119964122772,
      0.06022467091679573,
      0.7821261882781982,
      -0.3394627869129181,
      0.005427258089184761,
      0.3826201260089874,
      -0.03335340693593025,
      0.021986905485391617,
      0.2160804271697998,
      -0.28094348311424255,
      -0.93106609582901,
      -0.15294718742370605,
      -0.18883131444454193,
      0.24727532267570496,
      -0.7940726280212402,
      0.9813132882118225,
      0.10554590821266174,
      0.8838698267936707,
      -0.018778791651129723,
      -0.9717092514038086,
      -0.6564242839813232,
      -0.574324369430542,
      -0.2338276207447052,
      -0.01591896079480648,
      -1.2624967098236084,
      -0.21227267384529114,
      -0.8537049889564514,
      -0.9032536745071411,
      -0.5096735954284668,
      -0.11317477375268936,
      -0.20954850316047668,
      0.6361456513404846,
      -1.1954509019851685,
      0.7128965258598328,
      -1.1990094184875488,
      1.3756755590438843,
      -0.1429855227470398,
      0.5154102444648743,
      0.2706400752067566,
      -0.8227856159210205,
      -0.5981553196907043,
      -0.08364752680063248,
      -1.1045316457748413,
      0.7067064642906189,
      0.4040386378765106,
      0.2644233703613281,
      -0.4520051181316376,
      -0.2747149169445038,
      -1.211369514465332,
      1.2022669315338135,
      -0.7690938115119934,
      -0.6069756150245667,
      0.11352536082267761,
      0.19398951530456543,
      -0.5685908794403076,
      0.07505590468645096,
      -0.9295217990875244,
      -0.08992095291614532,
      -0.2617880702018738,
      0.928341805934906,
      1.0774396657943726,
      0.2510491907596588,
      0.17633412778377533,
      -0.9025383591651917,
      0.3679453134536743,
      0.860672652721405,
      -1.0700297355651855,
      -0.6787179112434387,
      -0.13321982324123383,
      -0.20304177701473236
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/47671732",
    "title": "",
    "question": "\"I have read a sequence of images into a numpy array with shape (7338, 225, 1024, 3) where 7338 is the sample size, 225 are the time steps and 1024 (32x32) are flattened image pixels, in 3 channels (RGB).\n\nI have a sequential model with an LSTM layer:\n\nmodel = Sequential()\nmodel.add(LSTM(128, input_shape=(225, 1024, 3))\n\nBut this results in the error:\n\nInput 0 is incompatible with layer lstm_1: expected ndim=3, found ndim=4\n\nThe documentation mentions that the input tensor for LSTM layer should be a 3D tensor with shape (batch_size, timesteps, input_dim), but in my case my input_dim is 2D.\n\nWhat is the suggested way to input a 3 channel image into an LSTM layer  in Keras?\"",
    "answer": "\"If you want the number of images to be a sequence (like a movie with frames), you need to put pixels AND channels as features:\n\ninput_shape = (225,3072)  #a 3D input where the batch size 7338 wasn't informed\n\nIf you want more processing before throwing 3072 features into an LSTM, you can combine or interleave 2D convolutions and LSTMs for a more refined model (not necessarily better, though, each application has its particular behavior). \n\nYou can also try to use the new ConvLSTM2D, which will take the five dimensional input:\n\ninput_shape=(225,32,32,3) #a 5D input where the batch size 7338 wasn't informed\n\nI'd probably create a convolutional net with several TimeDistributed(Conv2D(...)) and TimeDistributed(MaxPooling2D(...)) before adding a TimeDistributed(Flatten()) and finally the LSTM(). This will very probably improve both your image understanding and the performance of the LSTM.\"",
    "mlApiName": "keras.layers.LSTM",
    "embedding": [
      -0.13385805487632751,
      0.8541667461395264,
      -2.5630059242248535,
      -1.2391549348831177,
      0.3872806429862976,
      -0.30781376361846924,
      0.433453768491745,
      -0.22035542130470276,
      -1.3253123760223389,
      -1.0351049900054932,
      -0.12667177617549896,
      0.6741353273391724,
      1.8681838512420654,
      0.7712132930755615,
      -0.504168689250946,
      -0.41175225377082825,
      0.534487783908844,
      -0.5571784973144531,
      0.160837784409523,
      0.9703543186187744,
      -0.2742774188518524,
      0.40675485134124756,
      -0.25180506706237793,
      -0.5350028872489929,
      1.4608054161071777,
      0.22600394487380981,
      0.3511200547218323,
      0.4338620603084564,
      -0.9837189316749573,
      0.024219147861003876,
      1.7835121154785156,
      -1.2368416786193848,
      -0.37670305371284485,
      -1.2917003631591797,
      -0.9143627882003784,
      -0.8672552704811096,
      1.241788387298584,
      -0.24797987937927246,
      -0.13602374494075775,
      0.550048291683197,
      1.0987604856491089,
      -0.1825999915599823,
      -0.5105016231536865,
      0.6113316416740417,
      0.327049195766449,
      0.17168332636356354,
      0.8520784974098206,
      0.8002145290374756,
      0.5964829325675964,
      -0.6754113435745239,
      0.15147174894809723,
      1.1660062074661255,
      0.03525391221046448,
      0.12210282683372498,
      0.5195027589797974,
      0.8023623824119568,
      -0.7816739678382874,
      0.32272830605506897,
      0.49139487743377686,
      -0.7702476978302002,
      -0.26918575167655945,
      0.8585992455482483,
      -1.4642598628997803,
      0.513459324836731,
      0.9822044968605042,
      0.47747141122817993,
      -1.2268078327178955,
      0.3011679947376251,
      -0.01855345629155636,
      -0.31029441952705383,
      1.0068504810333252,
      -0.1037241742014885,
      0.35075581073760986,
      0.46938249468803406,
      -0.37917360663414,
      0.0020033682230859995,
      -0.5825890898704529,
      -0.8903973698616028,
      -0.5149907469749451,
      0.5327775478363037,
      0.11349142342805862,
      0.3318788707256317,
      1.0488662719726562,
      -0.46164003014564514,
      0.6308672428131104,
      0.5153560042381287,
      -0.42170068621635437,
      -0.5124600529670715,
      -0.12230062484741211,
      1.8496367931365967,
      -1.2713545560836792,
      0.15864816308021545,
      0.2905438542366028,
      1.1215760707855225,
      -0.6189243793487549,
      -0.45799365639686584,
      0.3971562683582306,
      0.8635851740837097,
      -0.3578408658504486,
      -0.2831341624259949,
      -0.5544014573097229,
      1.0389615297317505,
      -0.04416222125291824,
      -1.0881059169769287,
      -0.6253174543380737,
      1.3938648700714111,
      0.009895076043903828,
      -0.10237181931734085,
      0.3215951919555664,
      -0.2708966135978699,
      -0.8594322204589844,
      -0.4023370146751404,
      -0.1400008648633957,
      -0.38141557574272156,
      0.2708292305469513,
      -0.3524726331233978,
      0.407746821641922,
      -0.2789425551891327,
      -0.1362236887216568,
      0.5296040177345276,
      -0.3467424213886261,
      -1.19688880443573,
      0.6780793070793152,
      0.544400691986084,
      -0.0879426896572113,
      0.7795498967170715,
      -0.8843777179718018,
      0.30221572518348694,
      0.5988025069236755,
      -1.0261616706848145,
      0.14482489228248596,
      -0.5179049968719482,
      -0.06634075939655304,
      0.22282133996486664,
      0.6489501595497131,
      1.5925387144088745,
      -1.13628089427948,
      -1.4499703645706177,
      0.3646039366722107,
      0.24623391032218933,
      0.21189051866531372,
      -0.10986721515655518,
      0.11814852058887482,
      -0.6708852052688599,
      1.0882869958877563,
      -0.7249127626419067,
      0.21992260217666626,
      -0.42063793540000916,
      -0.8548471927642822,
      0.03748439624905586,
      -0.4178619384765625,
      1.345574140548706,
      -1.0407872200012207,
      -0.1507905125617981,
      0.378501832485199,
      -0.17875021696090698,
      1.197892427444458,
      0.7293461561203003,
      0.42857906222343445,
      -0.42545509338378906,
      0.6499529480934143,
      0.36605897545814514,
      -0.7868155837059021,
      0.5396954417228699,
      -0.30006226897239685,
      -1.1378895044326782,
      0.6351274847984314,
      -0.018495259806513786,
      -0.17790697515010834,
      -0.1133270263671875,
      -1.1299859285354614,
      -0.14855408668518066,
      -0.29394224286079407,
      -0.5785557627677917,
      -0.5837233662605286,
      0.6961866021156311,
      1.0723928213119507,
      -0.7893964052200317,
      0.6797538995742798,
      -0.08651761710643768,
      0.41110676527023315,
      -0.10218338668346405,
      -0.16596657037734985,
      -0.8034600615501404,
      -0.5037690997123718,
      -0.30477434396743774,
      0.5899463891983032,
      -0.18631988763809204,
      0.16611763834953308,
      -0.005327670834958553,
      0.5682617425918579,
      0.2686607241630554,
      -0.6467608213424683,
      -0.18941763043403625,
      -0.33287760615348816,
      0.7684344053268433,
      1.300833821296692,
      -1.203109622001648,
      0.807356595993042,
      -0.1537325084209442,
      -0.20441283285617828,
      0.2180354744195938,
      0.01197820995002985,
      0.8328396677970886,
      -0.6520471572875977,
      1.4238018989562988,
      -0.677117109298706,
      0.7419935464859009,
      -0.651454508304596,
      0.12796460092067719,
      0.43262434005737305,
      -0.37214037775993347,
      -0.3332245945930481,
      0.09789616614580154,
      0.2586972117424011,
      -0.05799615755677223,
      1.1414566040039062,
      -0.8791919350624084,
      -0.3885684609413147,
      0.7633333206176758,
      0.46044424176216125,
      -0.052515845745801926,
      0.9621476531028748,
      -0.11621515452861786,
      0.5143020153045654,
      -0.832520067691803,
      0.4357559084892273,
      -0.6962344646453857,
      -0.8704394102096558,
      -0.1777888387441635,
      -0.9360756278038025,
      -1.0241440534591675,
      0.6995970010757446,
      0.8386269211769104,
      -0.16134494543075562,
      0.20841090381145477,
      0.3851105570793152,
      0.39699220657348633,
      -0.5037046670913696,
      0.35029682517051697,
      -0.32933977246284485,
      1.3381413221359253,
      0.41330069303512573,
      -0.035433944314718246,
      -1.6886188983917236,
      -0.14369526505470276,
      -0.3521156907081604,
      -1.179347038269043,
      -0.14612498879432678,
      1.4153504371643066,
      -0.4557611048221588,
      -0.03617054969072342,
      0.8891538381576538,
      0.11821561306715012,
      1.1145923137664795,
      -0.5491885542869568,
      -0.7490012645721436,
      -0.06026746705174446,
      0.4885978400707245,
      -0.25909316539764404,
      0.6124746799468994,
      0.9995266199111938,
      0.11208845674991608,
      -0.15250590443611145,
      -0.8000707626342773,
      -0.39069703221321106,
      -0.14987485110759735,
      0.4590218663215637,
      -0.25975143909454346,
      -0.08523134887218475,
      -0.02830168604850769,
      0.332053005695343,
      1.0927069187164307,
      -0.17883561551570892,
      0.5754805207252502,
      1.0682904720306396,
      0.0737825557589531,
      -0.3968903720378876,
      -0.11875753849744797,
      -0.07121042162179947,
      -0.9663463830947876,
      -1.004225730895996,
      -0.0800197646021843,
      0.22465211153030396,
      0.3316863179206848,
      0.19415344297885895,
      0.07453544437885284,
      0.3910082280635834,
      0.38589099049568176,
      0.36973732709884644,
      -0.22612601518630981,
      0.1024121567606926,
      -0.8373356461524963,
      0.4344639480113983,
      -0.028835497796535492,
      0.08092517405748367,
      0.979225754737854,
      -0.6611719727516174,
      0.2302427440881729,
      -0.49344131350517273,
      0.06315574795007706,
      1.001610517501831,
      1.0308133363723755,
      -0.2733776867389679,
      -0.39052996039390564,
      -0.4140535593032837,
      0.4343337416648865,
      0.24030329287052155,
      0.032819099724292755,
      -0.5052986145019531,
      -0.4936952292919159,
      -0.14865551888942719,
      -0.6119633316993713,
      0.5829910039901733,
      -0.24802470207214355,
      -0.17770785093307495,
      -0.22978876531124115,
      0.6252666115760803,
      0.06241520121693611,
      -0.10760585218667984,
      -0.12366367131471634,
      -0.05679299682378769,
      -0.3771825134754181,
      -0.19356514513492584,
      -0.3493060767650604,
      0.8370576500892639,
      0.5060277581214905,
      0.27105438709259033,
      -0.18578307330608368,
      0.153954416513443,
      0.650673508644104,
      0.3784997761249542,
      0.2682757079601288,
      -0.5735421776771545,
      -0.9923036098480225,
      -0.2720564007759094,
      0.15919360518455505,
      0.054087284952402115,
      0.7820001840591431,
      -0.012930883094668388,
      -0.30826887488365173,
      0.6506850719451904,
      0.36048877239227295,
      -1.1116158962249756,
      0.21004913747310638,
      -0.06570703536272049,
      -1.4385384321212769,
      -0.4836239218711853,
      0.05336062237620354,
      0.5342972278594971,
      -0.29599443078041077,
      0.019552847370505333,
      0.08690766990184784,
      -0.6630788445472717,
      1.1676548719406128,
      0.19497543573379517,
      0.7079114317893982,
      0.9879196882247925,
      1.2013181447982788,
      -0.1883634775876999,
      0.8265377283096313,
      -0.210188090801239,
      -0.31173598766326904,
      -0.40925219655036926,
      0.10985811054706573,
      0.25505363941192627,
      0.6054521799087524,
      0.28125959634780884,
      1.2575253248214722,
      0.3587709665298462,
      0.08861196786165237,
      -0.5893742442131042,
      -0.41601496934890747,
      0.3929228186607361,
      -0.3125338554382324,
      0.49568068981170654,
      -1.3357353210449219,
      0.5086641907691956,
      -0.2304365038871765,
      0.31228727102279663,
      0.5060280561447144,
      -0.5052942633628845,
      0.6034258008003235,
      -0.8362970948219299,
      0.12566617131233215,
      0.4179251492023468,
      0.657704770565033,
      -1.0105839967727661,
      -0.553467333316803,
      0.6557494401931763,
      0.21565726399421692,
      -0.24006517231464386,
      -0.7532559037208557,
      -0.49633297324180603,
      0.03247322514653206,
      -0.3046683669090271,
      1.28789222240448,
      0.43929627537727356,
      -0.6760638356208801,
      0.33795034885406494,
      -0.4835178554058075,
      -0.9959031343460083,
      -0.34102094173431396,
      -0.1746062934398651,
      -0.4287169575691223,
      -0.31314653158187866,
      0.2618560492992401,
      -0.31845223903656006,
      0.7350655794143677,
      0.28301218152046204,
      0.013788714073598385,
      0.07480467855930328,
      0.1967015415430069,
      -1.6956101655960083,
      0.9847120642662048,
      0.31190723180770874,
      0.2852466106414795,
      -0.15890835225582123,
      -1.3232587575912476,
      -0.28225472569465637,
      -0.6303216218948364,
      1.3048685789108276,
      -0.7334569096565247,
      -0.5322416424751282,
      1.0143561363220215,
      0.39607346057891846,
      0.8826157450675964,
      1.4800118207931519,
      0.02173548750579357,
      -1.0796443223953247,
      0.6133682727813721,
      0.5212964415550232,
      0.4045935869216919,
      -0.20900216698646545,
      -0.3250991404056549,
      -0.13165530562400818,
      0.030110416933894157,
      1.4732162952423096,
      -0.156960591673851,
      0.4255804419517517,
      0.5818399786949158,
      -0.70510333776474,
      -0.510442316532135,
      -0.44614169001579285,
      0.5487520694732666,
      1.0898548364639282,
      0.7526944875717163,
      -0.5956140160560608,
      -1.4031105041503906,
      2.0463662147521973,
      -0.03550342842936516,
      -0.38775795698165894,
      0.100483737885952,
      0.7534499764442444,
      1.4213366508483887,
      0.08636900782585144,
      -0.08427687734365463,
      -0.0231075007468462,
      -0.08085078746080399,
      0.5270724892616272,
      0.2603035569190979,
      0.7486890554428101,
      -1.6633732318878174,
      -0.01357346773147583,
      -0.021029548719525337,
      -0.9802309274673462,
      -0.11247138679027557,
      -0.7316590547561646,
      -0.01709655672311783,
      0.7847329378128052,
      -0.8574308156967163,
      -0.329560250043869,
      0.7287924289703369,
      -0.06069548800587654,
      -0.44460487365722656,
      -0.42911988496780396,
      -0.4818822145462036,
      -0.6146948933601379,
      -0.010106636211276054,
      0.7215152382850647,
      0.2980573773384094,
      -1.720928430557251,
      0.1530333161354065,
      -0.1461772620677948,
      0.06694279611110687,
      2.1481611728668213,
      -0.702743411064148,
      -0.1878495216369629,
      0.6488770246505737,
      0.23887906968593597,
      0.7742128968238831,
      -0.4973347783088684,
      0.1112094596028328,
      0.15135933458805084,
      -0.40390172600746155,
      -0.08833745867013931,
      0.583209753036499,
      0.8944720029830933,
      -0.09507820010185242,
      1.1728286743164062,
      0.42721399664878845,
      -0.005219630431383848,
      -1.029000163078308,
      -0.4392862617969513,
      0.3496963679790497,
      -1.080849528312683,
      0.8436842560768127,
      -0.8550400137901306,
      -0.12791003286838531,
      0.23049375414848328,
      0.3219987154006958,
      0.1377083659172058,
      0.3441617786884308,
      -0.3299788236618042,
      0.14817269146442413,
      -0.9502034783363342,
      0.7804644703865051,
      0.19009453058242798,
      -0.7602522969245911,
      0.05016587674617767,
      0.2508012056350708,
      -0.4278550446033478,
      -0.41179654002189636,
      -0.4731255769729614,
      -0.37804967164993286,
      0.16514572501182556,
      0.436320960521698,
      -0.6464270949363708,
      0.2460944652557373,
      -0.5503955483436584,
      0.07339824736118317,
      -0.25304144620895386,
      -1.56882905960083,
      -0.29133543372154236,
      0.6621649265289307,
      -0.17905116081237793,
      -0.06049136444926262,
      1.0098276138305664,
      0.780551016330719,
      -0.09699288755655289,
      0.17946544289588928,
      0.8531020879745483,
      -0.11222411692142487,
      -0.10655152797698975,
      -0.13085907697677612,
      -0.16962429881095886,
      0.673176109790802,
      1.0471242666244507,
      0.23515881597995758,
      -1.0724539756774902,
      -0.03975275903940201,
      -0.7254142761230469,
      0.13904714584350586,
      -0.854484498500824,
      -0.17660202085971832,
      -0.6440306901931763,
      -1.1444118022918701,
      -0.73210608959198,
      -0.30485019087791443,
      -0.2875345051288605,
      -0.8345924615859985,
      -0.3898353576660156,
      1.7480839490890503,
      0.16992704570293427,
      0.3416711091995239,
      -1.0203428268432617,
      -0.8958396315574646,
      0.3168272376060486,
      0.3540593981742859,
      -0.13341647386550903,
      -0.5358039140701294,
      -1.4194042682647705,
      -0.2973916232585907,
      0.15946075320243835,
      0.27216461300849915,
      -0.011472613550722599,
      0.8017762899398804,
      0.35158050060272217,
      -0.6386131644248962,
      0.12042416632175446,
      -0.18602468073368073,
      -0.7373244166374207,
      0.3826647400856018,
      0.2827627658843994,
      0.05127507448196411,
      0.8595271706581116,
      -0.2378724366426468,
      -0.8874456882476807,
      -0.060833342373371124,
      -0.6507240533828735,
      -1.023240089416504,
      -0.8668822050094604,
      1.1527941226959229,
      -0.4672258496284485,
      0.3273000717163086,
      0.18579643964767456,
      -0.47530397772789,
      0.4772793650627136,
      -0.8000032901763916,
      -0.7841551303863525,
      -0.05647007003426552,
      0.4873560070991516,
      1.0940946340560913,
      -1.2245359420776367,
      -0.22976860404014587,
      0.9416369199752808,
      -0.5603287816047668,
      0.05156830698251724,
      0.15110884606838226,
      0.4754321873188019,
      1.1924340724945068,
      0.1453830748796463,
      -0.3902508020401001,
      0.49306610226631165,
      0.3743312954902649,
      -0.7832933068275452,
      0.6626153588294983,
      -0.5822670459747314,
      -0.1366840898990631,
      -0.34286248683929443,
      0.03972052037715912,
      -0.5137178897857666,
      1.1350293159484863,
      -1.4633102416992188,
      0.11631036549806595,
      -0.8696803450584412,
      -0.33479663729667664,
      0.10650152713060379,
      0.2674451172351837,
      1.1248944997787476,
      -0.8943890333175659,
      -0.9538545608520508,
      -1.3818353414535522,
      -0.0019881774205714464,
      -1.1987838745117188,
      0.7773482203483582,
      -0.12952668964862823,
      0.7768869996070862,
      0.5937340259552002,
      1.2803744077682495,
      0.09468952566385269,
      0.32591912150382996,
      -0.13930876553058624,
      0.6167385578155518,
      0.37979573011398315,
      -0.9976649880409241,
      0.7698431611061096,
      1.040176510810852,
      -0.21426139771938324,
      0.03366142511367798,
      1.0985286235809326,
      1.6180769205093384,
      -0.17046546936035156,
      -0.6950191855430603,
      0.44591695070266724,
      -0.053424082696437836,
      -0.02192748710513115,
      -1.0658966302871704,
      -0.7238708734512329,
      -0.8535664081573486,
      -0.08199580013751984,
      -0.7800884246826172,
      -0.8944773077964783,
      -0.4189133048057556,
      0.6418676376342773,
      0.34749874472618103,
      -0.11621396988630295,
      0.2825944721698761,
      -0.021686088293790817,
      -1.156952977180481,
      0.22380957007408142,
      0.6334988474845886,
      0.01133720763027668,
      0.7913432717323303,
      0.0353589802980423,
      -0.1898871809244156,
      1.079020380973816,
      1.1560629606246948,
      0.23367230594158173,
      0.3075442910194397,
      0.8050078749656677,
      -0.4306133985519409,
      0.8132671117782593,
      0.282051682472229,
      -0.219052255153656,
      -0.604085385799408,
      0.4342891573905945,
      -1.5464587211608887,
      0.016133425757288933,
      -0.7248799204826355,
      0.6244548559188843,
      0.11223199963569641,
      -0.5172174572944641,
      -0.17948611080646515,
      -0.6791113615036011,
      0.5765095949172974,
      0.0002949680492747575,
      -0.7547696828842163,
      0.5636924505233765,
      1.3616095781326294,
      0.022750603035092354,
      0.09726972877979279,
      -0.13228274881839752,
      0.9451477527618408,
      -0.32949021458625793,
      0.10834856331348419,
      0.2997167706489563,
      0.4026089310646057,
      -0.16436463594436646,
      -0.14893564581871033,
      -0.48633843660354614,
      0.12890715897083282,
      -0.4310159683227539,
      1.3018556833267212,
      0.10565081238746643,
      0.9236209392547607,
      -0.053645387291908264,
      -0.823501467704773,
      -0.4968816041946411,
      -0.3186766505241394,
      0.1683797538280487,
      -0.11217530071735382,
      -1.6295628547668457,
      0.46358203887939453,
      -0.5159701108932495,
      -1.0241694450378418,
      0.03250839561223984,
      -0.5089937448501587,
      0.23647555708885193,
      0.012337773106992245,
      -0.3813263773918152,
      -0.14002445340156555,
      -1.5266565084457397,
      1.2455445528030396,
      -0.11518936604261398,
      0.2248965948820114,
      -0.664052426815033,
      -0.11475343257188797,
      -0.9157987236976624,
      -0.053106896579265594,
      -1.1897424459457397,
      1.1656678915023804,
      -0.2680768370628357,
      -0.09656549245119095,
      -0.3889169991016388,
      -0.09091414511203766,
      -0.8346526026725769,
      1.2977325916290283,
      0.07507388293743134,
      -0.2304382622241974,
      -0.5394468903541565,
      -0.48818111419677734,
      0.2872357964515686,
      0.2585272192955017,
      0.004212565254420042,
      0.3487023711204529,
      -0.44563135504722595,
      0.8718347549438477,
      1.4103878736495972,
      -0.43957263231277466,
      0.06420766562223434,
      -1.4140431880950928,
      1.1182974576950073,
      0.4297025501728058,
      0.20883458852767944,
      -0.5172803401947021,
      -0.7997559905052185,
      -0.6205688118934631
    ],
    "label": {
      "level1": "SAM",
      "level2": "DT",
      "level3": "MT",
      "leafContractCategory": "MT",
      "rootCause": "Unacceptable Input Type",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/45930844",
    "title": "",
    "question": "\"I am trying to create my first ensemble models in keras. I have 3 input values and a single output value in my dataset.\n\nfrom keras.optimizers import SGD,Adam\nfrom keras.layers import Dense,Merge\nfrom keras.models import Sequential\n\nmodel1 = Sequential()\nmodel1.add(Dense(3, input_dim=3, activation='relu'))\nmodel1.add(Dense(2, activation='relu'))\nmodel1.add(Dense(2, activation='tanh'))\nmodel1.compile(loss='mse', optimizer='Adam', metrics=['accuracy'])\n\nmodel2 = Sequential()\nmodel2.add(Dense(3, input_dim=3, activation='linear'))\nmodel2.add(Dense(4, activation='tanh'))\nmodel2.add(Dense(3, activation='tanh'))\nmodel2.compile(loss='mse', optimizer='SGD', metrics=['accuracy'])\n\nmodel3 = Sequential()\nmodel3.add(Merge([model1, model2], mode = 'concat'))\nmodel3.add(Dense(1, activation='sigmoid'))\nmodel3.compile(loss='binary_crossentropy', optimizer='Adam', metrics=['accuracy'])\n\nmodel3.input_shape\n\nThe ensemble model(model3) compiles without any error but while fitting the model I have to pass the same input two times model3.fit([X,X],y). Which I think is an unnecessary step and instead of passing input twice I want to have a common input nodes for my ensemble model. How can I do it?\"",
    "answer": "\"Keras functional API seems to be a better fit for your use case, as it allows more flexibility in the computation graph. e.g.:\n\nfrom keras.layers import concatenate\nfrom keras.models import Model\nfrom keras.layers import Input, Merge\nfrom keras.layers.core import Dense\nfrom keras.layers.merge import concatenate\n\n# a single input layer\ninputs = Input(shape=(3,))\n\n# model 1\nx1 = Dense(3, activation='relu')(inputs)\nx1 = Dense(2, activation='relu')(x1)\nx1 = Dense(2, activation='tanh')(x1)\n\n# model 2 \nx2 = Dense(3, activation='linear')(inputs)\nx2 = Dense(4, activation='tanh')(x2)\nx2 = Dense(3, activation='tanh')(x2)\n\n# merging models\nx3 = concatenate([x1, x2])\n\n# output layer\npredictions = Dense(1, activation='sigmoid')(x3)\n\n# generate a model from the layers above\nmodel = Model(inputs=inputs, outputs=predictions)\nmodel.compile(optimizer='adam',\n              loss='binary_crossentropy',\n              metrics=['accuracy'])\n\n# Always a good idea to verify it looks as you expect it to \n# model.summary()\n\ndata = [[1,2,3], [1,1,3], [7,8,9], [5,8,10]]\nlabels = [0,0,1,1]\n\n# The resulting model can be fit with a single input:\nmodel.fit(data, labels, epochs=50)\n\nNotes:\n\nThere might be slight differences in the API between Keras versions (pre- and post- version 2)\nThe example above specifies different optimizer and loss function for each of the models. However, since fit() is being called only once (on model3), the same settings - those of model3 - will apply to the entire model. In order to have different settings when training the sub-models, they will have to be fit() separately - \nsee comment by @Daniel.\n\nEDIT: updated notes based on comments\"",
    "mlApiName": "keras.models.Model,keras.layers.merge.concatenate",
    "embedding": [
      -0.38890209794044495,
      0.25586172938346863,
      -2.582374334335327,
      -1.2739461660385132,
      1.0296801328659058,
      -0.5650720596313477,
      0.21175332367420197,
      0.37129440903663635,
      -1.2107863426208496,
      -0.23555782437324524,
      -0.6637580394744873,
      0.7257077693939209,
      1.870690107345581,
      0.8415038585662842,
      -0.6314884424209595,
      -0.18425564467906952,
      0.40229538083076477,
      0.8041677474975586,
      -0.06250791251659393,
      1.2757593393325806,
      -1.0143742561340332,
      -0.6095424294471741,
      0.3010357618331909,
      -0.5777121186256409,
      0.9384100437164307,
      0.27520525455474854,
      -0.4810889661312103,
      0.5895660519599915,
      -0.3437856137752533,
      0.21991148591041565,
      0.7694381475448608,
      -0.1546657383441925,
      0.01504772063344717,
      -1.013353705406189,
      -1.3216285705566406,
      -0.5116603374481201,
      0.8989211320877075,
      -0.12544547021389008,
      0.010492411442101002,
      -0.36434170603752136,
      1.2079460620880127,
      0.6682833433151245,
      0.15413132309913635,
      -0.020915452390909195,
      0.3834743797779083,
      -0.6200146079063416,
      2.074259042739868,
      -0.27767840027809143,
      0.7223799228668213,
      -1.2407162189483643,
      0.051482249051332474,
      1.0220545530319214,
      -0.12553595006465912,
      0.21182508766651154,
      1.2617141008377075,
      0.5580044388771057,
      0.126653254032135,
      0.7339603900909424,
      1.2473007440567017,
      -1.0519832372665405,
      0.12526291608810425,
      0.41077008843421936,
      -1.6325575113296509,
      1.7592774629592896,
      0.7944612503051758,
      -0.2611446678638458,
      -0.5510556101799011,
      1.6512476205825806,
      -0.028863392770290375,
      -0.40170779824256897,
      0.16934801638126373,
      0.4602784514427185,
      0.6794551014900208,
      -0.03744390606880188,
      -0.2297075092792511,
      -0.18101172149181366,
      -0.4332878291606903,
      -0.596348226070404,
      -0.2291383445262909,
      0.5407531261444092,
      -0.1689942628145218,
      0.7265521883964539,
      1.2818965911865234,
      -0.4513663053512573,
      0.30633166432380676,
      0.08089683949947357,
      -0.5973197221755981,
      -0.7383742928504944,
      -1.141524076461792,
      1.117013692855835,
      0.07673704624176025,
      -0.45424404740333557,
      0.7765951156616211,
      0.8228937983512878,
      -0.6740301251411438,
      -0.348579078912735,
      -0.4440939724445343,
      0.6039421558380127,
      -0.49184510111808777,
      -0.4292179048061371,
      -0.36678293347358704,
      0.2887613773345947,
      -0.4599376320838928,
      -0.8609800934791565,
      -0.2972298562526703,
      1.1682337522506714,
      0.2942005395889282,
      -0.29123514890670776,
      0.34210798144340515,
      -0.3629998564720154,
      -1.0943633317947388,
      -0.0004584530834108591,
      0.09523992985486984,
      -0.3562590479850769,
      -0.4440097510814667,
      -0.34794941544532776,
      -0.06815565377473831,
      -0.5629304647445679,
      0.5351404547691345,
      -0.33847934007644653,
      0.3207925260066986,
      -0.8966970443725586,
      0.327878475189209,
      -0.3780697286128998,
      -0.1832515001296997,
      0.859914243221283,
      -0.41884371638298035,
      0.2777596414089203,
      -0.5687375664710999,
      -1.3400893211364746,
      0.13604700565338135,
      -0.23143945634365082,
      -0.049822427332401276,
      0.30742600560188293,
      0.7286190986633301,
      0.9370951652526855,
      -1.0429940223693848,
      -0.8342275023460388,
      0.05973578616976738,
      0.4101381301879883,
      0.45985108613967896,
      0.09097731858491898,
      -0.34857654571533203,
      -1.4080109596252441,
      0.22241896390914917,
      -0.9970703125,
      0.18391525745391846,
      -0.7429673671722412,
      -1.490352988243103,
      0.3386709690093994,
      0.22527095675468445,
      0.20409470796585083,
      -0.897416889667511,
      0.8387336730957031,
      0.1842489391565323,
      -0.6496177315711975,
      0.2876281440258026,
      0.19913356006145477,
      0.23995903134346008,
      -0.23450440168380737,
      0.7272861003875732,
      -0.2990119457244873,
      -0.4330357313156128,
      0.4667998254299164,
      0.005224919877946377,
      -0.3062366247177124,
      0.3115074038505554,
      0.27658429741859436,
      0.25612393021583557,
      0.3189932703971863,
      -0.7260101437568665,
      -1.0214598178863525,
      -0.39106956124305725,
      0.31066495180130005,
      0.14494292438030243,
      0.8535071611404419,
      1.4243134260177612,
      -0.9343571662902832,
      0.4142599403858185,
      0.1721443235874176,
      1.020262598991394,
      0.43120333552360535,
      0.39679229259490967,
      -0.28598669171333313,
      -0.01946982927620411,
      0.09605540335178375,
      0.03820965066552162,
      0.40652552247047424,
      0.10666705667972565,
      -0.619099497795105,
      1.102859616279602,
      -0.12937821447849274,
      -0.12649084627628326,
      -0.4255789816379547,
      -0.10286885499954224,
      0.026769107207655907,
      0.9140443205833435,
      -0.8294324278831482,
      0.7822399139404297,
      -0.019998297095298767,
      -0.06589656323194504,
      -0.0024756607599556446,
      -0.4444226622581482,
      0.7060680389404297,
      -0.5794029831886292,
      1.7580708265304565,
      -0.2591610550880432,
      1.0542964935302734,
      -0.1739392727613449,
      0.3327239155769348,
      0.15667754411697388,
      -0.33748626708984375,
      0.45996251702308655,
      0.37390241026878357,
      -0.2553730607032776,
      -0.7773882746696472,
      0.4269954562187195,
      -0.30015483498573303,
      -0.3215104341506958,
      0.2807222902774811,
      -0.026038935407996178,
      -0.2504449784755707,
      0.872959315776825,
      0.224539652466774,
      0.4692949950695038,
      -1.1202497482299805,
      0.39542609453201294,
      0.03664691373705864,
      -1.0382429361343384,
      -0.4053575396537781,
      -0.413713276386261,
      -0.716611921787262,
      0.7503249645233154,
      -0.5351114869117737,
      -0.21181721985340118,
      1.0818510055541992,
      0.8564692735671997,
      0.9889625310897827,
      -0.8044648170471191,
      0.19007201492786407,
      0.6736054420471191,
      0.581416666507721,
      0.038146425038576126,
      -0.40272068977355957,
      -0.7315837740898132,
      0.10383743047714233,
      -0.28564876317977905,
      -0.3661127984523773,
      0.39729568362236023,
      0.8778631091117859,
      -0.19860953092575073,
      0.41342878341674805,
      -0.18853457272052765,
      0.02892403118312359,
      0.9301677346229553,
      -1.1800589561462402,
      -0.19511574506759644,
      0.0986730083823204,
      0.8294131755828857,
      -0.27158987522125244,
      0.29743921756744385,
      0.4185481369495392,
      -0.3959408402442932,
      -0.20015206933021545,
      -0.5262421369552612,
      -1.1625953912734985,
      0.053824905306100845,
      -0.6832902431488037,
      0.10374954342842102,
      -0.3070756494998932,
      -0.4076039791107178,
      -0.06359399855136871,
      0.6585449576377869,
      0.8135652542114258,
      0.6388599872589111,
      0.5211640000343323,
      -0.18125174939632416,
      -0.6048548221588135,
      -0.002932014875113964,
      -0.2335740178823471,
      -0.6563414931297302,
      -1.107702374458313,
      -0.5077288746833801,
      0.39416027069091797,
      -0.6736047267913818,
      0.12280860543251038,
      0.11105260252952576,
      0.7018150687217712,
      0.43001237511634827,
      0.779717743396759,
      -0.20397140085697174,
      0.12723776698112488,
      0.42132365703582764,
      0.024770811200141907,
      0.031974680721759796,
      0.49819013476371765,
      1.181166410446167,
      -0.5828437209129333,
      0.14198163151741028,
      -0.44973257184028625,
      0.2832781970500946,
      1.1722296476364136,
      1.1701139211654663,
      0.6555642485618591,
      0.7623327374458313,
      0.207512766122818,
      -0.30115845799446106,
      0.0034489468671381474,
      0.42987221479415894,
      -0.48607516288757324,
      -0.2757624387741089,
      -0.49664226174354553,
      -0.48159709572792053,
      0.8418567776679993,
      -0.2650357484817505,
      -0.07210821658372879,
      0.20811383426189423,
      0.29269206523895264,
      0.30719685554504395,
      -0.8517273664474487,
      -0.09962880611419678,
      -0.6019153594970703,
      0.414375901222229,
      -0.2947784960269928,
      -0.022007878869771957,
      0.9654064178466797,
      -0.46868717670440674,
      -0.12365519255399704,
      0.21487605571746826,
      -0.5283074975013733,
      0.5115108489990234,
      0.5611367225646973,
      0.25241920351982117,
      -1.3067940473556519,
      -1.095794439315796,
      -0.4590296447277069,
      0.26127272844314575,
      -0.22184185683727264,
      0.17510153353214264,
      1.4695651531219482,
      -0.4905175566673279,
      -0.017035512253642082,
      0.31945011019706726,
      -0.6234898567199707,
      -0.4578184187412262,
      -0.06428312510251999,
      -0.5529411435127258,
      -0.7864388823509216,
      0.9446621537208557,
      0.06180882081389427,
      -0.7095955610275269,
      0.10543563961982727,
      0.01489610131829977,
      -0.6773130297660828,
      -0.2598811686038971,
      -0.5846307277679443,
      0.6533611416816711,
      -0.09709754586219788,
      0.22022521495819092,
      0.9427295923233032,
      1.1066105365753174,
      -0.4970940351486206,
      -0.14014793932437897,
      -0.5253848433494568,
      0.09405723959207535,
      0.18554961681365967,
      1.4158360958099365,
      0.08292629569768906,
      1.2851217985153198,
      -0.02626713737845421,
      -0.3406578600406647,
      -0.5958389639854431,
      -0.8874670267105103,
      0.4222160875797272,
      0.057628143578767776,
      -0.2218131422996521,
      -0.7110142707824707,
      0.5313706994056702,
      -0.18854883313179016,
      0.3736148774623871,
      0.7277788519859314,
      -0.36785444617271423,
      0.1606949269771576,
      0.33728668093681335,
      0.4714990258216858,
      0.5953725576400757,
      0.6081699728965759,
      -0.42865172028541565,
      -0.4214874505996704,
      1.0246254205703735,
      0.24511466920375824,
      -0.2974405586719513,
      -0.7527541518211365,
      -0.333126425743103,
      0.9185953736305237,
      -0.4871487319469452,
      0.546389639377594,
      0.09379459172487259,
      -0.7481898665428162,
      1.101245641708374,
      -1.1183030605316162,
      -0.6246557831764221,
      -0.5209147930145264,
      -0.4617879390716553,
      -0.4048526883125305,
      -0.5780233144760132,
      -0.006125000771135092,
      -0.5120002031326294,
      -0.11075440794229507,
      0.5123592615127563,
      0.09788522869348526,
      0.777859091758728,
      0.019602812826633453,
      -1.0723000764846802,
      0.5407698750495911,
      0.1369876265525818,
      0.6187746524810791,
      0.67181795835495,
      -0.731383740901947,
      -0.8159993290901184,
      -1.0732088088989258,
      1.0866210460662842,
      -0.41080242395401,
      0.16867516934871674,
      1.1474684476852417,
      0.4571501314640045,
      1.2860087156295776,
      1.1830201148986816,
      -0.03876771777868271,
      -1.7316423654556274,
      0.6134686470031738,
      0.5392295122146606,
      0.8285669684410095,
      -0.6293197274208069,
      -0.5300619006156921,
      -0.15341374278068542,
      -0.1182413250207901,
      0.7699035406112671,
      -0.7176302075386047,
      0.774341344833374,
      0.753879725933075,
      -0.5188493132591248,
      -1.0641182661056519,
      -0.6795120239257812,
      0.4104040861129761,
      0.47188130021095276,
      0.8820911645889282,
      -0.9158424139022827,
      -1.3232274055480957,
      0.7989835739135742,
      0.15270714461803436,
      0.18136662244796753,
      0.48285701870918274,
      0.8932079076766968,
      1.646826982498169,
      0.5228768587112427,
      0.051686275750398636,
      0.07951149344444275,
      0.1796698421239853,
      0.3238220512866974,
      0.3680357336997986,
      0.64347904920578,
      -0.789129912853241,
      0.039469387382268906,
      0.18470118939876556,
      -1.1080000400543213,
      -0.4228273630142212,
      -0.27668407559394836,
      0.4838215708732605,
      0.5716515183448792,
      -0.29919955134391785,
      -0.1821560114622116,
      0.39501887559890747,
      -0.17939840257167816,
      0.05632121115922928,
      -0.03070656955242157,
      0.07746052742004395,
      -0.11006836593151093,
      0.5668178796768188,
      0.8526818752288818,
      0.195603147149086,
      -1.7798784971237183,
      -0.3425479829311371,
      -0.6200827956199646,
      -0.18620729446411133,
      1.3101459741592407,
      0.5640075206756592,
      -0.45356544852256775,
      0.6040700078010559,
      -0.3119692802429199,
      0.4414878487586975,
      0.12058223783969879,
      0.4774523675441742,
      -0.22742070257663727,
      -0.02095557190477848,
      -0.13919255137443542,
      0.4036984145641327,
      0.5806019902229309,
      0.5716325044631958,
      0.21302078664302826,
      0.06897664070129395,
      0.5094031691551208,
      -0.4454212486743927,
      0.4650503695011139,
      0.33337560296058655,
      -0.34051162004470825,
      0.5234053134918213,
      -0.921547532081604,
      0.308147668838501,
      0.4205792248249054,
      0.1244533509016037,
      -0.22815249860286713,
      0.040856000036001205,
      0.23832790553569794,
      0.11233242601156235,
      -0.9035286903381348,
      0.2264745831489563,
      0.055735159665346146,
      -0.5053470134735107,
      -0.5029276013374329,
      0.613879382610321,
      -0.33078140020370483,
      -0.9771124124526978,
      -0.31434524059295654,
      -0.44844183325767517,
      0.471377432346344,
      -0.13535428047180176,
      -1.4615792036056519,
      0.06289348006248474,
      -0.326359361410141,
      0.15710005164146423,
      0.2657131552696228,
      -1.3836866617202759,
      0.5931815505027771,
      0.8523347973823547,
      -0.2661462426185608,
      -0.7441666722297668,
      0.7297767400741577,
      0.5787548422813416,
      -0.23763608932495117,
      0.10297985374927521,
      0.838911235332489,
      0.21619416773319244,
      -0.5135245323181152,
      -0.5195630788803101,
      0.5194160342216492,
      0.495460569858551,
      0.7318394184112549,
      0.6790142059326172,
      -0.7886516451835632,
      0.10554207116365433,
      -1.5464166402816772,
      0.5885011553764343,
      -1.3049982786178589,
      0.7908428311347961,
      -0.8133987784385681,
      -0.6578789949417114,
      -0.8198040127754211,
      -0.22705048322677612,
      -0.08145106583833694,
      -0.9115620851516724,
      -0.2996860444545746,
      1.4827533960342407,
      -0.00980739388614893,
      -0.4279060661792755,
      -1.0616482496261597,
      -0.6385003328323364,
      0.8959018588066101,
      0.028984755277633667,
      0.4143439829349518,
      0.1062481477856636,
      -2.3443984985351562,
      0.394973486661911,
      0.6316919922828674,
      -0.3317238688468933,
      0.156411811709404,
      0.969902515411377,
      0.04603123664855957,
      -0.46862277388572693,
      -0.890060305595398,
      0.559691309928894,
      -1.7063848972320557,
      -0.25105783343315125,
      0.20876507461071014,
      -0.2712870240211487,
      1.3260769844055176,
      0.024654120206832886,
      -0.15681608021259308,
      0.013323070481419563,
      -0.008415833115577698,
      -0.6461250185966492,
      -0.4712282717227936,
      1.3512426614761353,
      -0.26173487305641174,
      0.5094782710075378,
      -0.08919825404882431,
      -0.05904117599129677,
      1.0518358945846558,
      -0.29267629981040955,
      -1.0811189413070679,
      -0.4507787227630615,
      0.5947362780570984,
      1.4100862741470337,
      -1.2611639499664307,
      0.1877993792295456,
      1.2974497079849243,
      -0.6150620579719543,
      -0.3922365605831146,
      -0.48194411396980286,
      0.3925441801548004,
      0.1615229696035385,
      -0.4705173671245575,
      0.2028692215681076,
      0.10846873372793198,
      0.47225356101989746,
      -0.6441390514373779,
      0.5352887511253357,
      -0.2058684229850769,
      -0.053249310702085495,
      -0.2505897283554077,
      -0.1563982367515564,
      -1.2564358711242676,
      0.8575947880744934,
      -0.9229618310928345,
      -0.16426394879817963,
      -0.487775057554245,
      -0.432559072971344,
      -0.7380319237709045,
      0.5010327100753784,
      0.21811768412590027,
      -0.8965446352958679,
      0.04296490550041199,
      -1.1253927946090698,
      0.12396325170993805,
      -1.5092819929122925,
      1.4087555408477783,
      -0.4925712049007416,
      0.3946385085582733,
      0.33613070845603943,
      1.2520502805709839,
      0.1652449071407318,
      0.47180455923080444,
      -0.0161899384111166,
      0.8070331811904907,
      0.38674813508987427,
      -0.8373242616653442,
      1.159909725189209,
      0.5082447528839111,
      0.06661086529493332,
      -0.2940046787261963,
      0.644912838935852,
      0.6190169453620911,
      0.08878891915082932,
      0.11861857026815414,
      0.8816592693328857,
      0.06691841781139374,
      0.1423938274383545,
      -0.18507476150989532,
      -0.6384943127632141,
      0.3148984909057617,
      -0.24370478093624115,
      -0.50495845079422,
      -0.862278401851654,
      0.17233236134052277,
      0.6683923006057739,
      -0.11552265286445618,
      0.2667710781097412,
      -0.049514032900333405,
      -0.5712056159973145,
      -1.4351216554641724,
      0.5441110730171204,
      0.23064403235912323,
      0.07011952996253967,
      0.4108695387840271,
      0.24308335781097412,
      -0.7521914839744568,
      0.9582007527351379,
      1.1153929233551025,
      0.5169417858123779,
      0.11252180486917496,
      0.7539981007575989,
      -0.08679531514644623,
      0.9439861178398132,
      0.3530162572860718,
      0.6320897340774536,
      -1.0403321981430054,
      0.12518122792243958,
      -0.7929655313491821,
      -0.22370950877666473,
      -0.7180039882659912,
      0.04635985195636749,
      -0.20486122369766235,
      -0.1258988380432129,
      0.19069141149520874,
      -1.0627100467681885,
      1.248047113418579,
      0.34925907850265503,
      -0.9956813454627991,
      0.40760886669158936,
      1.1638703346252441,
      0.2177479863166809,
      -0.679745614528656,
      0.17361514270305634,
      0.20899473130702972,
      -0.2352142184972763,
      0.03619727864861488,
      0.24395908415317535,
      0.17520372569561005,
      -0.3398817181587219,
      -0.7227219343185425,
      -0.35412344336509705,
      0.2583606541156769,
      -0.9914735555648804,
      1.0161420106887817,
      -0.3264022767543793,
      0.193726047873497,
      0.0833318755030632,
      -0.48514536023139954,
      -0.804452121257782,
      0.46011143922805786,
      -0.1837358921766281,
      -0.2783169746398926,
      -1.163311243057251,
      0.3694309592247009,
      -0.9574365615844727,
      -0.8980852365493774,
      -0.08248426765203476,
      -0.5631088614463806,
      -0.3156402111053467,
      0.17616553604602814,
      -0.8745153546333313,
      -0.2646928131580353,
      -1.9262837171554565,
      1.3690803050994873,
      -0.16311247646808624,
      0.29671555757522583,
      -1.060259222984314,
      -0.14583377540111542,
      -0.8687676191329956,
      -0.014065253548324108,
      -1.3826844692230225,
      0.36410245299339294,
      0.13154415786266327,
      -0.08166047185659409,
      -0.7408905029296875,
      -0.49048513174057007,
      -1.3394403457641602,
      1.1611227989196777,
      0.5978606343269348,
      -0.2453959733247757,
      -0.05584650859236717,
      -0.40309131145477295,
      -0.5094396471977234,
      0.13852868974208832,
      0.25083550810813904,
      0.05404121056199074,
      0.18994444608688354,
      1.4950214624404907,
      0.9872649908065796,
      0.6229491233825684,
      -0.13528189063072205,
      -0.7029474377632141,
      -0.1552511602640152,
      0.33348605036735535,
      0.4263848066329956,
      -0.5427693724632263,
      0.39444592595100403,
      -0.3948608338832855
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SL",
      "level3": "F",
      "leafContractCategory": "AMO(Level-2)",
      "rootCause": "Missing Options",
      "effect": "Unknown",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/42886049",
    "title": "",
    "question": "\"I am trying to train 1000x of Sequential models in a loop. In every loop my program leaks memory until I run out and get an OOM exception.\n\nI already asked a similar question before\n(Training multiple Sequential models in a row slows down)\n\nand have seen others in similar problems (Keras: Out of memory when doing hyper parameter grid search)\n\nand the solution is always to add K.clear_session() to your code after you have finished using the model. So I did that in my previous question and I am still leaking memory\n\nHere is code to reproduce the issue.\n\nimport random\nimport time\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras import backend as K\nimport tracemalloc\n\ndef run():\n    tracemalloc.start()\n    num_input_nodes = 12\n    num_hidden_nodes = 8\n    num_output_nodes = 1\n\n    random_numbers = random.sample(range(1000), 50)\n    train_x, train_y = create_training_dataset(random_numbers, num_input_nodes)\n\n    for i in range(100):\n        snapshot = tracemalloc.take_snapshot()\n        for j in range(10):\n            start_time = time.time()\n            nn = Sequential()\n            nn.add(Dense(num_hidden_nodes, input_dim=num_input_nodes, activation='relu'))\n            nn.add(Dense(num_output_nodes))\n            nn.compile(loss='mean_squared_error', optimizer='adam')\n            nn.fit(train_x, train_y, nb_epoch=300, batch_size=2, verbose=0)\n            K.clear_session()\n            print(\"\"Iteration {iter}. Current time {t}. Took {elapsed} seconds\"\".\n                  format(iter=i*10 + j + 1, t=time.strftime('%H:%M:%S'), elapsed=int(time.time() - start_time)))\n\n        top_stats = tracemalloc.take_snapshot().compare_to(snapshot, 'lineno')\n\n        print(\"\"[ Top 5 differences ]\"\")\n        for stat in top_stats[:5]:\n            print(stat)\n\ndef create_training_dataset(dataset, input_nodes):\n    \"\"\"\"\"\"\n    Outputs a training dataset (train_x, train_y) as numpy arrays.\n    Each item in train_x has 'input_nodes' number of items while train_y items are of size 1\n    :param dataset: list of ints\n    :param input_nodes:\n    :return: (numpy array, numpy array), train_x, train_y\n    \"\"\"\"\"\"\n    data_x, data_y = [], []\n    for i in range(len(dataset) - input_nodes - 1):\n        a = dataset[i:(i + input_nodes)]\n        data_x.append(a)\n        data_y.append(dataset[i + input_nodes])\n    return numpy.array(data_x), numpy.array(data_y)\n\nrun()\n\nHere is the output I get from the first memory debug print\n\n/tensorflow/python/framework/ops.py:121: size=3485 KiB (+3485 KiB), count=42343 (+42343)\n/tensorflow/python/framework/ops.py:1400: size=998 KiB (+998 KiB), count=8413 (+8413)\n/tensorflow/python/framework/ops.py:116: size=888 KiB (+888 KiB), count=32468 (+32468)\n/tensorflow/python/framework/ops.py:1185: size=795 KiB (+795 KiB), count=3179 (+3179)\n/tensorflow/python/framework/ops.py:2354: size=599 KiB (+599 KiB), count=5886 (+5886)\n\nSystem info:\n\npython 3.5\nkeras (1.2.2)\ntensorflow(1.0.0)\"",
    "answer": "\"The memory leak stems from Keras and TensorFlow using a single \"\"default graph\"\" to store the network structure, which increases in size with each iteration of the inner for loop. \n\nCalling K.clear_session() frees some of the (backend) state associated with the default graph between iterations, but an additional call to tf.reset_default_graph() is needed to clear the Python state.\n\nNote that there might be a more efficient solution: since nn does not depend on either of the loop variables, you can define it outside the loop, and reuse the same instance inside the loop. If you do that, there is no need to clear the session or reset the default graph, and performance should increase because you benefit from caching between iterations.\"",
    "mlApiName": "keras.backend.clear_session,keras.models.fit",
    "embedding": [
      1.3130711317062378,
      1.2620728015899658,
      -2.974091053009033,
      -0.9539828896522522,
      0.7049549221992493,
      -0.9282152056694031,
      0.004740264266729355,
      0.42624518275260925,
      -0.05075034871697426,
      -0.2585204541683197,
      -0.22662007808685303,
      0.5867592096328735,
      1.0914225578308105,
      0.5481421947479248,
      -0.26147210597991943,
      -0.31520402431488037,
      0.5609447956085205,
      -0.23106499016284943,
      -0.5485454201698303,
      -0.021945998072624207,
      0.07360783219337463,
      -0.17715388536453247,
      0.1983632892370224,
      -0.1890832632780075,
      1.268638253211975,
      0.8278297185897827,
      -0.5128611922264099,
      0.019451633095741272,
      0.10674342513084412,
      0.7340523600578308,
      1.4463224411010742,
      -0.7121681571006775,
      -0.8099992871284485,
      -1.4975521564483643,
      -1.5032893419265747,
      -0.5205619931221008,
      0.4688163995742798,
      -0.6230935454368591,
      0.29527199268341064,
      -0.04397062212228775,
      0.6033746004104614,
      -0.183504119515419,
      0.32773056626319885,
      0.17986446619033813,
      0.002311025746166706,
      0.05781133845448494,
      1.2423864603042603,
      0.3547983467578888,
      0.5221610069274902,
      -1.100624442100525,
      0.5430765748023987,
      0.39339902997016907,
      -0.6819704174995422,
      0.023274896666407585,
      0.9854456186294556,
      0.9016846418380737,
      -0.0874774158000946,
      0.16477787494659424,
      1.3773914575576782,
      -0.6018383502960205,
      1.0268219709396362,
      0.5936434268951416,
      -1.3821049928665161,
      1.1852917671203613,
      -0.13751602172851562,
      -0.14449666440486908,
      -0.6745337247848511,
      0.9236584305763245,
      0.2747655510902405,
      -0.06393881887197495,
      0.8960309028625488,
      0.4505266845226288,
      -0.1254691332578659,
      -0.20326928794384003,
      -0.6161590814590454,
      0.9766106605529785,
      -0.6306892037391663,
      0.3632740080356598,
      -0.02235318161547184,
      0.8075252771377563,
      -0.5135327577590942,
      1.272027850151062,
      0.5231975317001343,
      -0.16367515921592712,
      0.4899615943431854,
      0.5280088782310486,
      -1.2729688882827759,
      -0.5942108631134033,
      -0.8323507308959961,
      1.4904147386550903,
      -0.26411575078964233,
      -0.34457194805145264,
      0.9094905257225037,
      0.7589215040206909,
      -0.664556622505188,
      -0.3373810648918152,
      0.29753386974334717,
      0.5496038198471069,
      -1.099429726600647,
      0.06362588703632355,
      0.10077415406703949,
      -0.3566111624240875,
      -0.358396053314209,
      -1.2548692226409912,
      0.4663980305194855,
      1.2364166975021362,
      -0.36548948287963867,
      0.2669275104999542,
      0.11735142022371292,
      -0.03447338938713074,
      -0.23077717423439026,
      0.14525827765464783,
      -0.6256449222564697,
      -0.3323819637298584,
      -0.5853767991065979,
      0.42997312545776367,
      0.6504266262054443,
      -0.4300498366355896,
      0.10546287894248962,
      -0.2347492277622223,
      -0.6699016094207764,
      -1.052018642425537,
      0.4382329285144806,
      0.04461405798792839,
      0.5536295771598816,
      0.4321732521057129,
      -0.8012992739677429,
      0.4349256753921509,
      -0.08333735167980194,
      -0.399979829788208,
      -0.6539434790611267,
      -0.12242885679006577,
      -0.6680885553359985,
      0.8539645671844482,
      0.6937808394432068,
      0.8866112232208252,
      -0.893493115901947,
      -0.47130733728408813,
      -0.32698938250541687,
      0.2831531763076782,
      0.701310932636261,
      -0.302304744720459,
      0.1615769863128662,
      -0.11605342477560043,
      0.6043587923049927,
      -0.6055839657783508,
      0.2095915824174881,
      -0.5572842955589294,
      -0.8763044476509094,
      -0.0484953336417675,
      0.08849068731069565,
      0.40493538975715637,
      -1.495782732963562,
      0.020800750702619553,
      0.8120637536048889,
      -0.5001702308654785,
      0.22170525789260864,
      0.11880559474229813,
      1.061254620552063,
      0.21722063422203064,
      0.9086534976959229,
      0.46598488092422485,
      -0.43284767866134644,
      0.9040424227714539,
      -0.8928988575935364,
      -0.8248108625411987,
      0.3245527148246765,
      0.5968066453933716,
      -0.4585230350494385,
      0.35547271370887756,
      -0.7110523581504822,
      -0.933016836643219,
      -0.033618807792663574,
      -0.3216150403022766,
      -0.09777680784463882,
      1.2263461351394653,
      1.5061370134353638,
      -0.47140970826148987,
      0.5394560098648071,
      -0.037315309047698975,
      1.0313730239868164,
      -0.4517101049423218,
      0.7415993809700012,
      0.417951375246048,
      -0.5736420154571533,
      0.2933303415775299,
      -0.03427021577954292,
      -0.16457238793373108,
      -0.16883045434951782,
      -1.1762787103652954,
      0.726317822933197,
      -0.26856938004493713,
      -0.6722235679626465,
      -0.12641218304634094,
      -0.3793124556541443,
      -0.46018168330192566,
      0.7841298580169678,
      -0.6443195939064026,
      0.9484090805053711,
      -0.03120390698313713,
      -0.17200925946235657,
      0.005633238703012466,
      -1.421848177909851,
      0.43210843205451965,
      -0.18617424368858337,
      0.5549457669258118,
      -0.21991471946239471,
      0.8811037540435791,
      -0.18329952657222748,
      -0.1277504861354828,
      0.621832549571991,
      0.3108452558517456,
      0.3674697279930115,
      0.9128170013427734,
      -0.1423567235469818,
      -0.9182044863700867,
      0.7208309769630432,
      -0.34599125385284424,
      0.05673632398247719,
      0.3593289852142334,
      0.7073377966880798,
      -0.48437175154685974,
      0.6737567186355591,
      -0.3896905779838562,
      0.16795755922794342,
      -0.5079506039619446,
      0.3360871970653534,
      -0.4106876850128174,
      -0.4984866976737976,
      0.07738395780324936,
      -0.5775503516197205,
      -0.8730586767196655,
      0.26020699739456177,
      0.03949617221951485,
      0.05874158442020416,
      0.13575850427150726,
      0.5561275482177734,
      0.8223203420639038,
      -0.6567350625991821,
      0.2998718023300171,
      0.5577974915504456,
      0.4683249294757843,
      -0.12806743383407593,
      -0.3826805353164673,
      -0.46966004371643066,
      0.3493925631046295,
      -0.2235596626996994,
      -1.0956759452819824,
      0.2863328754901886,
      0.2763404846191406,
      -0.15999670326709747,
      0.0777883529663086,
      0.641109049320221,
      0.28504982590675354,
      0.833928644657135,
      -0.24799153208732605,
      -0.3039124310016632,
      -0.22225989401340485,
      0.1793278455734253,
      -0.8095545172691345,
      0.716147243976593,
      0.415001779794693,
      -0.446093887090683,
      -0.05412811040878296,
      -0.31439146399497986,
      -0.7657215595245361,
      0.0899202823638916,
      -0.561389148235321,
      -0.2208155393600464,
      0.012751513160765171,
      0.4275687336921692,
      0.29006221890449524,
      0.672478973865509,
      0.8009576797485352,
      0.5127101540565491,
      0.47739243507385254,
      0.20685350894927979,
      -0.22675250470638275,
      0.20950989425182343,
      -0.2393626570701599,
      -0.7180156111717224,
      -0.8853208422660828,
      -0.5822342038154602,
      0.5887891054153442,
      -0.3100622296333313,
      -0.16510751843452454,
      0.2868395447731018,
      -0.03353910148143768,
      0.6018408536911011,
      0.5928683280944824,
      0.07405929267406464,
      0.5203078389167786,
      0.6754288077354431,
      0.3088420331478119,
      0.16301049292087555,
      0.9574683904647827,
      0.644517183303833,
      -0.2974887192249298,
      0.06528566777706146,
      -0.8042817711830139,
      0.5699847936630249,
      0.877830445766449,
      0.3804132342338562,
      0.6037684082984924,
      -0.4658627510070801,
      0.051315948367118835,
      -0.10138583183288574,
      0.283792108297348,
      -0.2714579403400421,
      -0.325764000415802,
      -0.1713452935218811,
      -0.32764843106269836,
      -0.4657575190067291,
      0.9438174962997437,
      -0.3661665618419647,
      0.4499697983264923,
      0.2468629777431488,
      0.021111126989126205,
      0.5654352903366089,
      -0.27690377831459045,
      -0.12618346512317657,
      -0.31906822323799133,
      -0.14818093180656433,
      -0.2793629467487335,
      -0.46219968795776367,
      0.09927495568990707,
      -0.11542525887489319,
      0.5748434662818909,
      -0.030088011175394058,
      0.367933064699173,
      0.47778287529945374,
      0.3616311848163605,
      0.6315518617630005,
      -0.9655779600143433,
      -0.8360548615455627,
      -0.26086628437042236,
      -0.08832404017448425,
      0.3412133753299713,
      -0.051280345767736435,
      0.45586034655570984,
      -0.23042547702789307,
      0.41573500633239746,
      0.15304814279079437,
      -0.6090304255485535,
      0.08072991669178009,
      0.6216365098953247,
      -0.4566009044647217,
      -0.7644780278205872,
      1.1711478233337402,
      -0.11901280283927917,
      0.05044177919626236,
      -0.04148330166935921,
      -0.2959476411342621,
      -0.7657915949821472,
      -0.4007011651992798,
      -0.45723235607147217,
      0.020630350336432457,
      -0.008249076083302498,
      0.014377109706401825,
      0.09109941869974136,
      1.0353801250457764,
      -0.4247467815876007,
      -0.26494842767715454,
      -0.3749851584434509,
      0.1188216581940651,
      0.2070113569498062,
      1.5819941759109497,
      0.24857600033283234,
      0.6987218856811523,
      -0.67841637134552,
      0.05478578433394432,
      -0.0963234007358551,
      -0.3869662582874298,
      0.52433842420578,
      -0.5494527816772461,
      -0.11733966320753098,
      -1.044011116027832,
      0.25701475143432617,
      -0.1630229502916336,
      0.5845527052879333,
      0.41984760761260986,
      -0.9132704138755798,
      -0.2608110308647156,
      0.162692129611969,
      0.1204557716846466,
      0.3506951630115509,
      0.7961279153823853,
      -1.2043943405151367,
      -0.7276939749717712,
      0.821128785610199,
      -0.09650903195142746,
      -0.27893441915512085,
      -0.8425597548484802,
      -0.6639972925186157,
      0.4775160551071167,
      -0.8342410326004028,
      0.12336909025907516,
      0.15532715618610382,
      0.2548738718032837,
      0.30375224351882935,
      -1.0498046875,
      -0.8212840557098389,
      -0.08551009744405746,
      0.08612552285194397,
      -0.08129466325044632,
      -0.037657611072063446,
      -0.04719645529985428,
      0.11575444042682648,
      0.23472879827022552,
      0.3898361921310425,
      0.5207063555717468,
      1.2358765602111816,
      -0.11892803013324738,
      -1.4061448574066162,
      0.9824855923652649,
      -0.15774159133434296,
      1.540419101715088,
      1.5658758878707886,
      -0.5407041311264038,
      -1.3172839879989624,
      -0.3006037473678589,
      0.5377001762390137,
      -0.14343346655368805,
      0.03795580938458443,
      0.722143828868866,
      0.46104204654693604,
      -0.007372428197413683,
      0.8021361231803894,
      0.3328234553337097,
      -1.7204564809799194,
      0.023907212540507317,
      0.3970549404621124,
      0.2978299558162689,
      0.26581117510795593,
      -0.3596542775630951,
      -0.14025285840034485,
      0.23813661932945251,
      0.8883874416351318,
      -0.6886767745018005,
      1.0699818134307861,
      0.7284418344497681,
      -0.09282317757606506,
      -0.7369533181190491,
      -0.019898157566785812,
      0.2569422125816345,
      0.28130602836608887,
      1.122697114944458,
      -1.0609495639801025,
      -1.6788525581359863,
      0.8760182857513428,
      -0.11150108277797699,
      -0.18345297873020172,
      0.7189856171607971,
      0.36226680874824524,
      1.2361433506011963,
      -0.3571072220802307,
      -0.706757664680481,
      0.07862524688243866,
      -0.2058957815170288,
      0.48686641454696655,
      -0.0771288052201271,
      0.8061700463294983,
      -0.3421575427055359,
      0.650377094745636,
      -0.04589356482028961,
      -0.9374646544456482,
      -0.2028190791606903,
      -1.090749979019165,
      0.6862670183181763,
      1.2815216779708862,
      -0.5054296255111694,
      -0.2222641259431839,
      0.2538682222366333,
      -0.29147863388061523,
      0.07603655010461807,
      -0.6876240968704224,
      -0.2780050039291382,
      0.5055504441261292,
      0.34471768140792847,
      1.2094783782958984,
      0.3522461950778961,
      -0.5912503004074097,
      -0.4290512800216675,
      -0.2090827375650406,
      -0.4896894693374634,
      1.4391971826553345,
      0.4087621569633484,
      -0.41428619623184204,
      0.49119633436203003,
      0.1746070832014084,
      0.847004234790802,
      0.05591781809926033,
      -0.015666330233216286,
      0.315645307302475,
      -0.0830335021018982,
      -0.48784011602401733,
      0.24369479715824127,
      0.40403833985328674,
      0.4368613362312317,
      0.05745289474725723,
      0.030474631115794182,
      0.14655253291130066,
      0.13657651841640472,
      0.07805458456277847,
      0.7303293943405151,
      0.5935487151145935,
      0.30527862906455994,
      -0.3999359607696533,
      -0.6048641800880432,
      -0.06476462632417679,
      -0.22510184347629547,
      0.1763497143983841,
      -0.14455720782279968,
      0.5106287598609924,
      0.40836119651794434,
      -1.2053009271621704,
      0.41178613901138306,
      -0.0035420162603259087,
      -0.5547738671302795,
      0.039082832634449005,
      0.6403259634971619,
      -0.017899461090564728,
      -0.43032655119895935,
      0.08371032029390335,
      -1.1482179164886475,
      0.27911806106567383,
      0.2368088960647583,
      -1.2916334867477417,
      0.10124745965003967,
      -0.38061490654945374,
      0.4116285443305969,
      -0.41509580612182617,
      -1.4009164571762085,
      0.019549502059817314,
      0.20533517003059387,
      -0.04205964133143425,
      -0.16833272576332092,
      0.18463654816150665,
      0.13333454728126526,
      0.5161963701248169,
      0.5873961448669434,
      0.8999961614608765,
      0.41027936339378357,
      -0.3159046173095703,
      -0.8300201892852783,
      -0.5997759699821472,
      -0.007915321737527847,
      0.04887659475207329,
      0.9296213388442993,
      -1.4659817218780518,
      0.4498949944972992,
      -0.5566911697387695,
      0.35281533002853394,
      -1.1834485530853271,
      -0.14307698607444763,
      -0.5097818970680237,
      -0.08809865266084671,
      -0.7891841530799866,
      -1.3591279983520508,
      -0.08074227720499039,
      -0.8982720971107483,
      0.461571604013443,
      1.713956594467163,
      0.19019028544425964,
      0.1797628104686737,
      0.02102883905172348,
      -0.5870223045349121,
      0.17249779403209686,
      0.24772343039512634,
      0.05616598576307297,
      -0.22461651265621185,
      -1.299882173538208,
      -0.08946599066257477,
      0.3272218108177185,
      -0.05530140548944473,
      0.8749343752861023,
      0.47661182284355164,
      0.2268434464931488,
      -0.9417842030525208,
      -0.9452949166297913,
      -0.014973568730056286,
      -1.2104337215423584,
      0.5490435361862183,
      0.23557250201702118,
      0.26542869210243225,
      0.411235511302948,
      -0.007576894015073776,
      -0.6634369492530823,
      0.9401052594184875,
      -0.15566974878311157,
      -0.7527293562889099,
      0.1898961365222931,
      0.7461063861846924,
      -0.5412818789482117,
      0.169230118393898,
      0.21639013290405273,
      -0.8099839091300964,
      -0.17061243951320648,
      -0.8106151819229126,
      -1.4653980731964111,
      0.07161233574151993,
      0.7363768815994263,
      0.9793495535850525,
      -1.69442880153656,
      -0.7010737657546997,
      1.2377686500549316,
      -0.3309067189693451,
      0.00023916822101455182,
      -0.4409853518009186,
      0.158817321062088,
      0.7084267139434814,
      -0.663162350654602,
      0.00460983207449317,
      -0.4622361361980438,
      -0.11806879192590714,
      -0.7841006517410278,
      1.7361927032470703,
      0.5452366471290588,
      -0.3817250430583954,
      -0.7870705723762512,
      -0.40848568081855774,
      -0.9135798811912537,
      0.9021983742713928,
      -0.8005555868148804,
      0.37679997086524963,
      -0.31926605105400085,
      -0.5712838768959045,
      -0.9151125550270081,
      0.5558682084083557,
      0.5332506895065308,
      -0.6821475625038147,
      0.09775622189044952,
      -1.7656677961349487,
      -0.23700952529907227,
      -1.0375758409500122,
      0.890661895275116,
      -0.5116394758224487,
      0.20101623237133026,
      0.33287733793258667,
      0.7136901617050171,
      0.13558070361614227,
      -0.4987891912460327,
      -0.7643465399742126,
      0.4441528022289276,
      0.17067283391952515,
      -1.0191056728363037,
      0.8618331551551819,
      1.6241605281829834,
      0.09590452164411545,
      -0.4063248932361603,
      1.1724412441253662,
      0.7983313202857971,
      -0.26707640290260315,
      -0.032296162098646164,
      0.2596781849861145,
      -0.35634052753448486,
      -0.16405022144317627,
      -0.44493231177330017,
      -0.693522036075592,
      -0.714347243309021,
      0.20237092673778534,
      0.2046295553445816,
      -0.2887645661830902,
      -0.7714633345603943,
      0.6290720701217651,
      0.20140698552131653,
      0.05546700581908226,
      -0.051306746900081635,
      -0.8122994303703308,
      -1.1190239191055298,
      0.6278634071350098,
      0.6283299326896667,
      -0.21981821954250336,
      0.1875370889902115,
      0.5416026711463928,
      0.25439462065696716,
      1.219120979309082,
      0.7158037424087524,
      -0.4806029200553894,
      0.10196830332279205,
      0.7435731291770935,
      -0.5918229818344116,
      0.6164902448654175,
      0.27388906478881836,
      0.36227545142173767,
      -0.8619322776794434,
      0.2621103525161743,
      -1.3472224473953247,
      -0.1604272425174713,
      -0.7879846096038818,
      -0.03150602802634239,
      -0.0011081505799666047,
      0.4505805969238281,
      -0.7416342496871948,
      -0.235635906457901,
      0.9075466394424438,
      0.08396465331315994,
      -1.353071928024292,
      0.8353865146636963,
      0.49367642402648926,
      -0.5752994418144226,
      0.18442676961421967,
      0.4085369408130646,
      0.6762340664863586,
      0.47122666239738464,
      0.33824193477630615,
      0.44052332639694214,
      0.3800416886806488,
      0.054780468344688416,
      -0.29988011717796326,
      -0.48718756437301636,
      -0.10692045092582703,
      -0.8602691888809204,
      1.1378653049468994,
      -0.24811694025993347,
      0.15385937690734863,
      -0.09904457628726959,
      -1.0646276473999023,
      0.1453833431005478,
      -0.003975050523877144,
      -0.23465567827224731,
      -0.4853944778442383,
      -1.2600376605987549,
      0.7075215578079224,
      -0.3015165627002716,
      -1.0675982236862183,
      0.1942453235387802,
      -0.4287416636943817,
      -0.34238922595977783,
      -0.04699867218732834,
      -0.7192440032958984,
      -0.6392149925231934,
      -1.2972408533096313,
      0.5275594592094421,
      0.1989048570394516,
      -0.41442084312438965,
      -0.8031988739967346,
      -0.7364639639854431,
      -0.8351764678955078,
      -0.261000394821167,
      -0.5708153247833252,
      0.3731473982334137,
      0.4401845633983612,
      -0.0036253221333026886,
      -0.048241544514894485,
      -0.31051012873649597,
      -0.6212098598480225,
      0.6918564438819885,
      0.08309407532215118,
      -0.34853214025497437,
      0.22806140780448914,
      -0.08604276925325394,
      -0.5790476202964783,
      0.3352205157279968,
      -0.1682925820350647,
      0.12064860761165619,
      0.19394396245479584,
      1.2340846061706543,
      1.0164541006088257,
      0.7266944646835327,
      -0.07678275555372238,
      -0.34873244166374207,
      0.33906257152557373,
      0.5051201581954956,
      0.1828940361738205,
      -0.582260251045227,
      0.42087188363075256,
      -0.5879190564155579
    ],
    "label": {
      "level1": "AMO",
      "level2": "G",
      "level3": "G",
      "leafContractCategory": "G",
      "rootCause": "Missing Required Method Order",
      "effect": "MOB",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Train",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/48547688",
    "title": "",
    "question": "\"Using Keras from Tensorflow 1.4.1, how does one copy weights from one model to another?\n\nAs some background, I'm trying to implement a deep-q network (DQN) for Atari games following the DQN publication by DeepMind.  My understanding is that the implementation uses two networks, Q and Q'.  The weights of Q are trained using gradient descent, and then the weights are copied periodically to Q'.\n\nHere's how I build Q and Q':\n\nACT_SIZE   = 4\nLEARN_RATE = 0.0025\nOBS_SIZE   = 128\n\ndef buildModel():\n  model = tf.keras.models.Sequential()\n\n  model.add(tf.keras.layers.Lambda(lambda x: x / 255.0, input_shape=OBS_SIZE))\n  model.add(tf.keras.layers.Dense(128, activation=\"\"relu\"\"))\n  model.add(tf.keras.layers.Dense(128, activation=\"\"relu\"\"))\n  model.add(tf.keras.layers.Dense(ACT_SIZE, activation=\"\"linear\"\"))\n  opt = tf.keras.optimizers.RMSprop(lr=LEARN_RATE)\n\n  model.compile(loss=\"\"mean_squared_error\"\", optimizer=opt)\n\n  return model\n\nI call that twice to get Q and Q'.\n\nI have an updateTargetModel method below that is my attempt at copying weights.  The code runs fine, but my overall DQN implementation is failing.  I'm really just trying to verify if this is a valid way of copying weights from one network to another.\n\ndef updateTargetModel(model, targetModel):\n  modelWeights       = model.trainable_weights\n  targetModelWeights = targetModel.trainable_weights\n\n  for i in range(len(targetModelWeights)):\n    targetModelWeights[i].assign(modelWeights[i])\n\nThere's another question here that discusses saving and loading weights to and from disk (Tensorflow Copy Weights Issue), but there's no accepted answer.  There is also a question about loading weights from individual layers (Copying weights from one Conv2D layer to another), but I'm wanting to copy the entire model's weights.\"",
    "answer": "Actually what you've done is much more than simply copying weights. You made these two models identical all the time. Every time you update one model - the second one is also updated - as both models have the same weights variables.\n\nIf you want to just copy weights - the simplest way is by this command:\n\ntarget_model.set_weights(model.get_weights())",
    "mlApiName": "0",
    "embedding": [
      0.18257750570774078,
      0.27781733870506287,
      -3.120584726333618,
      -1.2947486639022827,
      1.8153704404830933,
      0.3973638415336609,
      0.23369474709033966,
      -0.3337389826774597,
      -1.716098666191101,
      -0.14976288378238678,
      -1.9004319906234741,
      0.5150418281555176,
      1.1793218851089478,
      -0.49478110671043396,
      -1.3226943016052246,
      0.44524818658828735,
      -0.05165879800915718,
      -0.5409210920333862,
      0.3857108950614929,
      0.09496907889842987,
      0.08516402542591095,
      -0.9293758273124695,
      0.3238425552845001,
      -1.161135196685791,
      1.0648118257522583,
      -0.04520786553621292,
      -0.46719151735305786,
      0.3830205798149109,
      -0.770098865032196,
      0.3206527829170227,
      0.49090829491615295,
      -1.508226990699768,
      0.2370682656764984,
      -1.274659276008606,
      -1.1114219427108765,
      -0.0016790709923952818,
      1.0115867853164673,
      -0.722681999206543,
      -0.0006112193805165589,
      0.4305467903614044,
      0.5735539197921753,
      0.5469874143600464,
      -0.4662509858608246,
      -0.5512102246284485,
      0.6727400422096252,
      -0.2681277096271515,
      1.2123669385910034,
      -0.29070258140563965,
      0.9045589566230774,
      -1.0384366512298584,
      0.3714689612388611,
      0.5696160793304443,
      -0.03736242279410362,
      -0.13549800217151642,
      1.4301100969314575,
      0.39137470722198486,
      -0.12064820528030396,
      0.7489191293716431,
      0.6892752647399902,
      -0.9210025668144226,
      0.5471493601799011,
      1.3621037006378174,
      -0.49424949288368225,
      1.0205626487731934,
      0.2598972022533417,
      0.30749329924583435,
      -0.05207822099328041,
      0.7340720295906067,
      -0.42918822169303894,
      -0.3959013819694519,
      0.1313278079032898,
      0.5799879431724548,
      -0.1874435544013977,
      -0.45138925313949585,
      -0.039712145924568176,
      0.10112176090478897,
      0.2483932077884674,
      -0.7355468273162842,
      -0.3788250982761383,
      0.1234491765499115,
      -0.6301510334014893,
      0.9451065063476562,
      1.5609112977981567,
      0.7241062521934509,
      0.5503565073013306,
      0.913308322429657,
      -1.411669373512268,
      0.893294095993042,
      -0.7444892525672913,
      2.077728509902954,
      0.11231932789087296,
      -0.426779568195343,
      0.8543667793273926,
      0.8083057403564453,
      -0.6657337546348572,
      -0.9478747844696045,
      -0.6337396502494812,
      0.31086465716362,
      -0.6969310641288757,
      -0.5147001147270203,
      -0.2471894472837448,
      0.12449633330106735,
      -0.33354872465133667,
      -0.7621324062347412,
      -0.5535983443260193,
      1.5082664489746094,
      0.6177195906639099,
      0.8311588168144226,
      0.35867518186569214,
      0.6131206750869751,
      -0.503085732460022,
      -0.3043835163116455,
      0.3506660759449005,
      -0.008192257024347782,
      -0.5650410056114197,
      -0.5432484149932861,
      0.17745837569236755,
      0.08553977310657501,
      -0.5984538793563843,
      0.5724177360534668,
      0.024661650881171227,
      -0.7656170129776001,
      0.4018246829509735,
      -0.04502025246620178,
      -0.19031915068626404,
      -0.23982296884059906,
      -1.084256887435913,
      0.16559012234210968,
      -0.5444973707199097,
      -0.806718111038208,
      0.2765926122665405,
      -0.13821418583393097,
      -0.18896722793579102,
      0.3554654121398926,
      0.1469689905643463,
      0.35198917984962463,
      -0.6325054168701172,
      -1.143531084060669,
      0.6122668981552124,
      -0.501201868057251,
      0.15163545310497284,
      0.22065913677215576,
      -0.37234267592430115,
      -0.6040695309638977,
      0.7947481274604797,
      -0.39116430282592773,
      0.18815799057483673,
      -0.8192821741104126,
      -1.2351566553115845,
      0.39279675483703613,
      0.6353470683097839,
      0.8014593124389648,
      -0.9278343319892883,
      -0.36639201641082764,
      1.1178390979766846,
      -0.7207543253898621,
      0.42386072874069214,
      -0.17216341197490692,
      0.39720380306243896,
      0.24737034738063812,
      0.9002305269241333,
      0.1462733894586563,
      0.829993486404419,
      -0.07965102791786194,
      0.520501434803009,
      -0.5048233866691589,
      0.5392256379127502,
      0.6928579807281494,
      0.6342556476593018,
      0.8955194354057312,
      -1.1276946067810059,
      -0.5521396398544312,
      0.015465285629034042,
      0.1951974332332611,
      0.04670219495892525,
      0.7478146553039551,
      1.2281115055084229,
      -0.2783021926879883,
      0.00025704060681164265,
      -0.7975033521652222,
      0.9040315747261047,
      -0.0819614976644516,
      1.192961573600769,
      -0.08588959276676178,
      -0.7775334119796753,
      0.8587720394134521,
      0.031769201159477234,
      -0.7484970092773438,
      0.7507994174957275,
      -0.637202799320221,
      -0.06516051292419434,
      -0.04989097639918327,
      0.049757156521081924,
      0.10657034069299698,
      -0.19809681177139282,
      -0.4407030940055847,
      1.1551908254623413,
      -0.863719642162323,
      0.8834357857704163,
      0.3195769488811493,
      0.18363218009471893,
      0.3900720477104187,
      -0.5551925897598267,
      0.21091528236865997,
      -0.6409798264503479,
      0.8782151937484741,
      -0.67159104347229,
      0.33630403876304626,
      0.4356289803981781,
      0.12293164432048798,
      0.42089012265205383,
      0.28417953848838806,
      0.32571935653686523,
      -0.2436673790216446,
      0.6212339997291565,
      -0.25461211800575256,
      0.13230448961257935,
      0.0015231731813400984,
      -0.275687575340271,
      -0.6270166039466858,
      0.019770925864577293,
      0.16558200120925903,
      1.1394234895706177,
      -0.52799391746521,
      0.8307037949562073,
      -0.5397470593452454,
      -0.20668591558933258,
      -0.0008802839438430965,
      -0.3519395589828491,
      -0.03806692361831665,
      -0.10568466037511826,
      -0.8152563571929932,
      0.21739496290683746,
      -0.2382516711950302,
      0.2954166829586029,
      0.9197940826416016,
      0.386538028717041,
      1.675782322883606,
      0.0125046968460083,
      0.11722841113805771,
      0.5590425729751587,
      0.4171393811702728,
      -0.11860902607440948,
      0.1666891723871231,
      -1.220639705657959,
      0.2597637176513672,
      -0.0005451152683235705,
      -1.2531888484954834,
      0.02818896435201168,
      0.9109665155410767,
      0.41251543164253235,
      -0.13878560066223145,
      0.24227991700172424,
      0.4533942937850952,
      1.2855887413024902,
      -0.7664302587509155,
      0.2306223064661026,
      -0.2841813564300537,
      0.5223919153213501,
      -0.749110996723175,
      0.3895062506198883,
      0.0749838724732399,
      -0.1615774929523468,
      -0.22497235238552094,
      -0.7846148014068604,
      -1.4089927673339844,
      -0.09782145917415619,
      -0.9189056158065796,
      0.1091947853565216,
      0.22880373895168304,
      -0.11099372804164886,
      0.5417655110359192,
      1.0756202936172485,
      1.3949166536331177,
      0.09115786850452423,
      0.4789803624153137,
      0.3674726188182831,
      -0.6281270384788513,
      -0.20201118290424347,
      -0.4217347502708435,
      -0.0768994465470314,
      -1.0260974168777466,
      -1.0353057384490967,
      -0.5758970379829407,
      0.07940037548542023,
      -0.721956729888916,
      0.0584244504570961,
      0.06791628897190094,
      0.3778632879257202,
      0.3784213662147522,
      0.19620992243289948,
      -0.044588230550289154,
      0.5136069655418396,
      -0.2913966476917267,
      -0.16685600578784943,
      1.2846673727035522,
      1.0006763935089111,
      -0.5911656022071838,
      -0.2709941565990448,
      -0.5437141060829163,
      0.08896318078041077,
      1.231050729751587,
      1.156709909439087,
      0.5631414651870728,
      0.44192802906036377,
      0.4898228347301483,
      -0.12834057211875916,
      0.5115532875061035,
      0.33406737446784973,
      0.2388496994972229,
      -0.3684528172016144,
      -0.007767845876514912,
      0.12428511679172516,
      0.8920262455940247,
      -0.4786356985569,
      -0.5227402448654175,
      0.657387375831604,
      -0.39217066764831543,
      0.7691153883934021,
      -1.5829098224639893,
      -0.554642379283905,
      -0.6858071684837341,
      0.16901493072509766,
      0.11278695613145828,
      -0.5878822207450867,
      1.4510895013809204,
      -0.988155722618103,
      1.089018702507019,
      0.07675064355134964,
      0.17069101333618164,
      1.1322215795516968,
      0.42959722876548767,
      0.339377224445343,
      -1.201034426689148,
      -0.8149608373641968,
      -0.2325756847858429,
      -0.19329607486724854,
      0.5776503086090088,
      0.3354795575141907,
      1.1283900737762451,
      0.02348155900835991,
      0.23620851337909698,
      0.4805060625076294,
      0.061148691922426224,
      -0.10159599781036377,
      0.23728439211845398,
      -0.3921465277671814,
      -0.08237319439649582,
      0.5054953098297119,
      -0.12031867355108261,
      -0.4001973569393158,
      0.3425658047199249,
      -0.1174350380897522,
      0.3065347671508789,
      0.11818873137235641,
      -0.43458229303359985,
      0.0007149691227823496,
      0.2284415364265442,
      0.4632616937160492,
      0.7192181944847107,
      1.2935216426849365,
      -0.10256396234035492,
      0.8883845806121826,
      0.2865910828113556,
      0.3462630808353424,
      0.5515936613082886,
      0.6679834127426147,
      -0.6112459301948547,
      0.25272196531295776,
      0.22020189464092255,
      0.13166943192481995,
      -0.9624552130699158,
      -0.9003306031227112,
      0.5712213516235352,
      -0.44813889265060425,
      0.03106491081416607,
      -0.6514729857444763,
      -0.13479866087436676,
      -0.2820051908493042,
      0.7142061591148376,
      0.09097670018672943,
      -0.9549186825752258,
      -0.8486325144767761,
      -0.5253372192382812,
      0.7779726982116699,
      0.8127428293228149,
      0.3500523269176483,
      -0.9567399024963379,
      0.26615282893180847,
      0.678119421005249,
      0.4159536361694336,
      -0.2902873158454895,
      -0.39620062708854675,
      0.0031986546237021685,
      1.7613734006881714,
      0.03833410516381264,
      1.032650351524353,
      0.2966090738773346,
      -0.045183517038822174,
      0.23913215100765228,
      -1.1472035646438599,
      -0.2556680738925934,
      -0.19047033786773682,
      -0.5198079943656921,
      -1.0090850591659546,
      -0.04239368811249733,
      -0.13626478612422943,
      -0.11672049015760422,
      0.33527839183807373,
      0.9792365431785583,
      0.19918672740459442,
      0.14555911719799042,
      0.29528990387916565,
      -0.538524329662323,
      0.8244303464889526,
      -0.11123166978359222,
      0.637215793132782,
      1.1058708429336548,
      -0.7341403961181641,
      -0.8418301343917847,
      -0.531879723072052,
      0.725043535232544,
      -0.16268499195575714,
      0.009832157753407955,
      0.9651583433151245,
      0.5542331337928772,
      0.6223242878913879,
      0.9993209838867188,
      0.5505730509757996,
      -2.278756618499756,
      0.11494028568267822,
      0.5651919841766357,
      0.9972178339958191,
      0.00020128108735661954,
      0.0840822234749794,
      -0.21663500368595123,
      0.7518770694732666,
      0.8686825037002563,
      -0.10225921124219894,
      0.5681499242782593,
      1.1192549467086792,
      -0.1850358098745346,
      -1.054750919342041,
      -0.2027125358581543,
      0.8046001195907593,
      1.0410056114196777,
      0.3426181674003601,
      -0.8967121243476868,
      -1.1048952341079712,
      0.9388141632080078,
      0.35401952266693115,
      0.5664656758308411,
      0.5925092697143555,
      0.43732401728630066,
      1.709363579750061,
      -0.3732927143573761,
      0.922781229019165,
      0.33520540595054626,
      0.5449968576431274,
      -0.040595460683107376,
      0.7066400647163391,
      0.63606858253479,
      -0.40481430292129517,
      -0.33265063166618347,
      -0.7666347622871399,
      -1.2062522172927856,
      -0.6736437082290649,
      0.3990904986858368,
      0.6824474334716797,
      0.9274144172668457,
      -0.32441869378089905,
      -0.23545143008232117,
      0.08789577335119247,
      0.3691898286342621,
      0.15798139572143555,
      -0.0343438945710659,
      0.0959862768650055,
      -0.3434879779815674,
      0.9119272828102112,
      0.7844871878623962,
      -0.1312100887298584,
      -1.1949045658111572,
      -0.9334396123886108,
      -0.9919453263282776,
      -0.42604508996009827,
      1.1896415948867798,
      -0.5110023617744446,
      -0.06078605353832245,
      0.48442238569259644,
      0.4309634566307068,
      0.3089258074760437,
      -0.2862284779548645,
      0.27812129259109497,
      0.27546408772468567,
      -0.8822316527366638,
      -0.3692152500152588,
      0.31319567561149597,
      0.9579731822013855,
      0.2767152190208435,
      -0.45429474115371704,
      0.6997098922729492,
      0.9141439199447632,
      0.13972319662570953,
      0.1747330129146576,
      0.633094072341919,
      -0.4574544429779053,
      0.961513876914978,
      -0.818834662437439,
      -0.2702745795249939,
      -0.006564590148627758,
      -0.3332783877849579,
      -0.03169531747698784,
      -0.15636129677295685,
      -0.059119369834661484,
      1.0931395292282104,
      -1.643359661102295,
      0.192796990275383,
      -0.22686511278152466,
      -0.888995349407196,
      -0.16256733238697052,
      0.14083078503608704,
      -0.6426573395729065,
      -0.2731007933616638,
      -0.6627119779586792,
      -1.120835542678833,
      0.4654698669910431,
      -0.5234850645065308,
      -1.709956407546997,
      0.04213089495897293,
      -0.3622473478317261,
      0.5718953609466553,
      0.8287906050682068,
      -1.1339095830917358,
      0.26399368047714233,
      -0.37956079840660095,
      -0.40689414739608765,
      -0.16706404089927673,
      0.40383395552635193,
      -0.22360090911388397,
      -0.20845308899879456,
      1.154571771621704,
      0.30215516686439514,
      -0.2145986109972,
      0.4218376874923706,
      -0.8182361721992493,
      -0.5900595784187317,
      -0.008292235434055328,
      0.26501405239105225,
      0.6246744990348816,
      -0.9581642746925354,
      0.0980135053396225,
      -0.47519782185554504,
      1.2555091381072998,
      -0.5315007567405701,
      0.7561563849449158,
      -0.7079890966415405,
      -1.375754714012146,
      -0.766876220703125,
      -1.0789657831192017,
      -0.4139727056026459,
      -0.27579110860824585,
      0.8307562470436096,
      1.224255084991455,
      -0.3755730986595154,
      -0.1988126039505005,
      -0.7987269163131714,
      -0.8777704238891602,
      0.2804485559463501,
      0.2669454514980316,
      0.5558615922927856,
      0.054781556129455566,
      -0.838921308517456,
      -0.8010590672492981,
      -0.05895638093352318,
      0.0760778933763504,
      -0.3573210835456848,
      0.39872241020202637,
      0.15826007723808289,
      -1.3362846374511719,
      -1.3967067003250122,
      0.14413641393184662,
      -1.5715125799179077,
      -0.30297696590423584,
      0.22961436212062836,
      -0.3567606806755066,
      0.9893399477005005,
      -0.4304226338863373,
      -1.1867282390594482,
      0.97784823179245,
      -0.015711843967437744,
      -1.1302796602249146,
      -0.2693813443183899,
      -0.0743553638458252,
      -0.16444070637226105,
      -0.24968509376049042,
      0.08846934139728546,
      -0.10152292251586914,
      0.4016399681568146,
      -0.6420337557792664,
      -1.4114933013916016,
      -0.14113089442253113,
      0.42481350898742676,
      1.5403348207473755,
      -2.1647627353668213,
      0.0003519854508340359,
      1.9671173095703125,
      -0.646892249584198,
      0.15747593343257904,
      -0.22896717488765717,
      0.7450803518295288,
      -0.7086776494979858,
      0.17823410034179688,
      -0.03364785015583038,
      -0.42717957496643066,
      0.9930953979492188,
      -1.0347378253936768,
      0.6761125326156616,
      0.1483234465122223,
      -0.8859383463859558,
      -0.9330141544342041,
      -0.6725612878799438,
      -1.3619635105133057,
      0.6353437304496765,
      -1.3175009489059448,
      0.3258671462535858,
      -0.23516668379306793,
      -0.7087019681930542,
      0.06716032326221466,
      0.3057407736778259,
      0.4170148968696594,
      -1.1848810911178589,
      0.09895838052034378,
      -1.2940162420272827,
      0.047877028584480286,
      -1.4470880031585693,
      1.9629218578338623,
      0.434156596660614,
      1.3616602420806885,
      -0.22737982869148254,
      0.3299954831600189,
      0.2754482924938202,
      0.09620261192321777,
      -0.8127452731132507,
      0.13900676369667053,
      0.11719469726085663,
      -1.1409434080123901,
      0.8924852609634399,
      1.013852834701538,
      0.20545463263988495,
      0.6836308240890503,
      0.36298057436943054,
      0.5697848796844482,
      -0.212630033493042,
      -0.021159254014492035,
      0.5452739596366882,
      -0.24499475955963135,
      -0.0017494077328592539,
      -0.19403962790966034,
      -1.200953722000122,
      -0.0524846687912941,
      -0.7604265213012695,
      -0.9558794498443604,
      -0.15848341584205627,
      -0.1298966258764267,
      0.4759306311607361,
      -0.01673661544919014,
      -0.17125321924686432,
      -0.501804530620575,
      -0.31500619649887085,
      -0.4802215099334717,
      0.6577727198600769,
      0.30644863843917847,
      -0.2763901650905609,
      0.258550763130188,
      0.39213985204696655,
      -0.3506166934967041,
      0.4458391070365906,
      0.813279390335083,
      -0.1098514050245285,
      -0.05528131499886513,
      0.2302023023366928,
      -0.39467379450798035,
      0.694461464881897,
      -0.1682737022638321,
      0.4821796715259552,
      -0.7313884496688843,
      0.22147336602210999,
      -0.23399803042411804,
      -0.31563466787338257,
      -0.5705690979957581,
      -0.7203394174575806,
      0.020189501345157623,
      0.3456866443157196,
      -0.0872151181101799,
      -0.5602086186408997,
      1.723681092262268,
      -0.20056995749473572,
      -0.4172442555427551,
      0.7507550120353699,
      1.6665587425231934,
      0.7104665040969849,
      -0.3056178689002991,
      -0.25292539596557617,
      0.4183073341846466,
      0.26780572533607483,
      0.4850682318210602,
      -0.009602885693311691,
      -0.02505539171397686,
      -0.14513851702213287,
      -1.1615095138549805,
      -0.45380955934524536,
      0.10792125761508942,
      -0.6593713164329529,
      1.0873997211456299,
      0.5805025696754456,
      0.25040990114212036,
      0.15749198198318481,
      -0.423724889755249,
      -0.2510288655757904,
      -0.4231264889240265,
      0.12784989178180695,
      -0.41556403040885925,
      -1.402572512626648,
      -0.10878460854291916,
      -0.6858993172645569,
      -0.6376180648803711,
      -0.043909285217523575,
      -1.269727349281311,
      -0.356693297624588,
      0.49575275182724,
      -0.3375474512577057,
      -0.32316046953201294,
      -1.9073092937469482,
      0.6557274460792542,
      0.565421462059021,
      -0.15198774635791779,
      -0.6707897186279297,
      0.17300723493099213,
      -0.441815048456192,
      -0.4003779888153076,
      -0.8989793062210083,
      0.7711841464042664,
      0.4948965907096863,
      0.435963898897171,
      -0.47165408730506897,
      -0.053004276007413864,
      -1.6599804162979126,
      1.1429052352905273,
      0.0817631334066391,
      -0.9430169463157654,
      0.19436481595039368,
      -0.04964791610836983,
      -0.9729680418968201,
      0.5887859463691711,
      -0.5318019986152649,
      -0.28595709800720215,
      -0.09139362722635269,
      1.016173243522644,
      1.771369218826294,
      0.16919845342636108,
      -0.5090638399124146,
      -0.9527413249015808,
      0.09535977244377136,
      0.4137672483921051,
      -0.6000039577484131,
      -0.4588932693004608,
      0.0684112086892128,
      0.9258025288581848
    ],
    "label": {
      "level1": "0",
      "level2": "0",
      "level3": "0",
      "leafContractCategory": "0",
      "rootCause": "0",
      "effect": "0",
      "mlLibrary": "Keras",
      "contractViolationLocation": "0",
      "detectionTechnique": "0",
      "reasonsForNotLabeling": "General Clarification",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/50920908",
    "title": "",
    "question": "\"This question already has answers here:\n                                \n                            \n                    \n                \n            \n                    \n                        Multilabel-indicator is not supported for confusion matrix\n                            \n                                (4 answers)\n                            \n                    \n                Closed 5 years ago.\n        \n\n    \n\nI am building a multiclass model with Keras.\n\nmodel.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])\nmodel.fit(X_train, y_train, batch_size=batch_size, epochs=epochs, verbose=1, callbacks=[checkpoint], validation_data=(X_test, y_test))  # starts training\n\nHere is how my test data looks like (it's text data).\n\nX_test\nOut[25]: \narray([[621, 139, 549, ...,   0,   0,   0],\n       [621, 139, 543, ...,   0,   0,   0]])\n\ny_test\nOut[26]: \narray([[0, 0, 1],\n       [0, 1, 0]])\n\nAfter generating predictions...\n\npredictions = model.predict(X_test)\npredictions\nOut[27]: \narray([[ 0.29071924,  0.2483743 ,  0.46090645],\n       [ 0.29566404,  0.45295066,  0.25138539]], dtype=float32)\n\nI did the following to get the confusion matrix.\n\ny_pred = (predictions > 0.5)\n\nconfusion_matrix(y_test, y_pred)\nTraceback (most recent call last):\n\n  File \"\"\"\", line 1, in \n    confusion_matrix(y_test, y_pred)\n\n  File \"\"/Users/abrahammathew/anaconda3/lib/python3.6/site-packages/sklearn/metrics/classification.py\"\", line 252, in confusion_matrix\n    raise ValueError(\"\"%s is not supported\"\" % y_type)\n\nValueError: multilabel-indicator is not supported\n\nHowever, I am getting the above error.\n\nHow can I get a confusion matrix when doing a multiclass neural network in Keras?\"",
    "answer": "\"Your input to confusion_matrix must be an array of int not one hot encodings.\n\nmatrix = metrics.confusion_matrix(y_test.argmax(axis=1), y_pred.argmax(axis=1))\"",
    "mlApiName": "keras.models.compile.metrics.confusion_matrix",
    "embedding": [
      -0.42787110805511475,
      0.547946572303772,
      -2.5952541828155518,
      -0.616327166557312,
      1.8638426065444946,
      0.16038401424884796,
      0.27745941281318665,
      0.2460157424211502,
      -0.4935603439807892,
      -1.0713688135147095,
      0.2655239403247833,
      0.24837999045848846,
      1.7271267175674438,
      -0.08207716792821884,
      -0.48593950271606445,
      -1.242225170135498,
      0.43825656175613403,
      -0.28764617443084717,
      -0.00039088301127776504,
      1.1255221366882324,
      -0.6243159770965576,
      -0.0673331618309021,
      -1.0536433458328247,
      -0.7534082531929016,
      1.9315564632415771,
      0.11465579271316528,
      -0.3276742994785309,
      0.17188237607479095,
      -0.015373642556369305,
      0.8908202052116394,
      1.1803405284881592,
      -0.29324108362197876,
      0.7060982584953308,
      -1.103661298751831,
      -1.4376821517944336,
      -1.0227973461151123,
      0.8768900036811829,
      0.19346070289611816,
      0.5228813290596008,
      0.9887304902076721,
      1.0975767374038696,
      -0.22511166334152222,
      0.3222503662109375,
      0.2613666355609894,
      0.5290650129318237,
      0.5868747234344482,
      1.2516734600067139,
      0.28702205419540405,
      0.23493799567222595,
      -1.1240193843841553,
      0.568787157535553,
      0.1327630579471588,
      1.063773512840271,
      0.3144913911819458,
      1.4734944105148315,
      0.9317301511764526,
      -0.4897260069847107,
      0.43753141164779663,
      0.8266811370849609,
      -0.5913317203521729,
      0.4805474877357483,
      0.9032187461853027,
      -0.6207414865493774,
      0.5232250690460205,
      0.17677293717861176,
      -0.24026177823543549,
      -1.1651355028152466,
      0.11056630313396454,
      -0.8292176127433777,
      -0.9753909707069397,
      1.2466356754302979,
      -0.3567509651184082,
      0.9116925001144409,
      1.331876277923584,
      -0.7310754656791687,
      0.648772120475769,
      -0.4744093418121338,
      -0.7666597962379456,
      -0.18454240262508392,
      0.5994409918785095,
      0.5335962772369385,
      0.9776442646980286,
      0.9613156914710999,
      -0.11540686339139938,
      -0.04591294005513191,
      0.6154043674468994,
      -0.5420930981636047,
      -0.2821689546108246,
      -0.7301622629165649,
      0.9234200119972229,
      -0.20359647274017334,
      -0.25532037019729614,
      -0.13899850845336914,
      1.186824917793274,
      -0.7795554995536804,
      -0.32079175114631653,
      -0.5976410508155823,
      -0.5187910795211792,
      -0.5048739910125732,
      -0.656030535697937,
      -0.6925997734069824,
      0.6034333109855652,
      0.12734271585941315,
      -0.6191468834877014,
      -0.07701415568590164,
      1.2568767070770264,
      -0.009510491974651814,
      -0.08175425976514816,
      -0.32749155163764954,
      -0.639258086681366,
      -0.5269924402236938,
      0.69320148229599,
      -0.15873165428638458,
      -0.544201672077179,
      -0.8554344177246094,
      -0.39145639538764954,
      0.599992036819458,
      -0.9472202658653259,
      0.7992191314697266,
      0.014517880976200104,
      0.4567980468273163,
      -0.3354202210903168,
      0.8331264853477478,
      0.26619961857795715,
      -0.505885660648346,
      0.32086536288261414,
      -0.4986725449562073,
      0.5062621235847473,
      0.0991753488779068,
      -1.1966891288757324,
      0.04883011430501938,
      0.23882709443569183,
      -0.1675127148628235,
      0.7814326882362366,
      0.0729636624455452,
      0.9625352621078491,
      -0.9454756379127502,
      0.04424197971820831,
      -0.14024895429611206,
      0.9724068641662598,
      0.3272060453891754,
      0.5286333560943604,
      -0.3307550847530365,
      -0.7820407152175903,
      0.6618077754974365,
      -1.211957573890686,
      0.3303293287754059,
      -0.6413457989692688,
      -0.2927989363670349,
      0.03318152576684952,
      0.22196827828884125,
      1.1499828100204468,
      -0.7100059986114502,
      0.33235037326812744,
      0.24043892323970795,
      -0.00593765452504158,
      -0.05153791606426239,
      0.1916211098432541,
      1.1294971704483032,
      -0.7982447743415833,
      1.5762455463409424,
      -0.008980951271951199,
      -0.5626364946365356,
      0.5502203106880188,
      0.01723526604473591,
      -0.09508863836526871,
      0.037865493446588516,
      0.3489338159561157,
      -0.018587907776236534,
      0.1708201766014099,
      -0.8988485336303711,
      -0.8461689352989197,
      0.5127841830253601,
      -0.3592376708984375,
      0.23262155055999756,
      1.0224025249481201,
      0.34806835651397705,
      -0.4564496874809265,
      0.9560285806655884,
      0.0694611668586731,
      0.27809596061706543,
      0.6308348774909973,
      0.615412175655365,
      -0.8277772068977356,
      -0.34914615750312805,
      -0.2622535228729248,
      -0.017541738227009773,
      0.19496573507785797,
      -0.7146620750427246,
      -0.2569558918476105,
      1.165834903717041,
      0.29992544651031494,
      -1.0175750255584717,
      -0.984487771987915,
      -0.3604571223258972,
      -0.5839878916740417,
      0.8777512311935425,
      -0.9659948945045471,
      0.6487799286842346,
      0.21288469433784485,
      -0.13306768238544464,
      0.5928521156311035,
      -0.8957714438438416,
      0.6320078372955322,
      -1.1265405416488647,
      0.7286003232002258,
      -0.4931705594062805,
      0.8281605839729309,
      -0.4611503481864929,
      0.35558223724365234,
      0.9284864664077759,
      -0.45530974864959717,
      0.332285076379776,
      0.8186661601066589,
      -0.12351246178150177,
      -0.7205628156661987,
      0.45973238348960876,
      -0.3740290105342865,
      0.053168609738349915,
      0.27501559257507324,
      -0.07622494548559189,
      -0.7401215434074402,
      0.14930996298789978,
      0.2183290421962738,
      0.040440142154693604,
      -0.15190717577934265,
      0.2455965280532837,
      -0.2096049040555954,
      -0.48965519666671753,
      -0.6254984736442566,
      -0.6514872908592224,
      -0.8185228109359741,
      0.3497157394886017,
      0.5141584873199463,
      0.5116904377937317,
      -0.03360971435904503,
      0.7665482759475708,
      0.6102661490440369,
      0.12669621407985687,
      0.20048244297504425,
      0.30306506156921387,
      0.873735785484314,
      -0.46729713678359985,
      0.8728728294372559,
      -0.46401247382164,
      0.6059730052947998,
      -0.16535241901874542,
      -0.6531926393508911,
      0.5970293879508972,
      1.3355953693389893,
      -0.8770116567611694,
      0.680645763874054,
      0.3178178071975708,
      -0.3769412934780121,
      1.0423710346221924,
      -0.37538596987724304,
      -0.3562298119068146,
      -0.14743053913116455,
      0.31201282143592834,
      0.07543055713176727,
      0.8461339473724365,
      -0.622771143913269,
      -0.4024776518344879,
      -0.32853248715400696,
      -0.3262256681919098,
      -1.0570462942123413,
      0.01748083531856537,
      -0.1760735660791397,
      0.07435178756713867,
      -0.6178747415542603,
      0.0028792337980121374,
      -0.021709974855184555,
      1.0623735189437866,
      0.5052765607833862,
      0.548547089099884,
      0.49745622277259827,
      -0.71589595079422,
      0.1973845511674881,
      0.7452800869941711,
      -0.4108748137950897,
      -1.0396286249160767,
      -0.8328263163566589,
      -0.05311071500182152,
      -0.5276957750320435,
      0.4438256621360779,
      0.1219058483839035,
      -0.5313546061515808,
      0.8390786051750183,
      0.39380258321762085,
      0.6366842985153198,
      -0.42934438586235046,
      -0.05180331692099571,
      -0.602308988571167,
      -0.3788768947124481,
      -0.4407386779785156,
      0.026237059384584427,
      0.5684816837310791,
      -0.15055356919765472,
      0.02438494563102722,
      -1.2958439588546753,
      0.7181903719902039,
      0.5077029466629028,
      0.424425333738327,
      0.058359771966934204,
      1.1051788330078125,
      -0.6834210753440857,
      -0.125337615609169,
      0.04448458552360535,
      0.4245032072067261,
      -0.28065916895866394,
      -0.6951813101768494,
      -0.3293549418449402,
      -1.2850444316864014,
      0.6904682517051697,
      -0.08854399621486664,
      0.4388126730918884,
      0.14359831809997559,
      0.11323235929012299,
      0.839261531829834,
      -0.20333117246627808,
      -0.4116651713848114,
      -0.8562561869621277,
      -0.06412165611982346,
      0.13429413735866547,
      -0.6261186003684998,
      0.758208692073822,
      0.37274953722953796,
      0.37437960505485535,
      0.2679825723171234,
      -0.1944190263748169,
      0.6020180583000183,
      -0.4685695469379425,
      0.8575652241706848,
      -0.7966011166572571,
      -0.7071321606636047,
      -0.032154157757759094,
      0.04773439094424248,
      0.31487220525741577,
      -0.20152677595615387,
      0.25640007853507996,
      0.06545453518629074,
      0.14824220538139343,
      0.7290387749671936,
      -1.0272095203399658,
      -0.5805184245109558,
      -0.20726044476032257,
      -1.2928990125656128,
      -0.6722467541694641,
      0.5943152904510498,
      0.5328043103218079,
      0.3094173073768616,
      0.9118937253952026,
      -0.47551125288009644,
      -0.09497737884521484,
      -0.34645649790763855,
      -0.13650718331336975,
      1.0426783561706543,
      0.17010949552059174,
      -0.47963905334472656,
      0.6574355363845825,
      1.1328858137130737,
      0.6133320331573486,
      -0.030371226370334625,
      -0.5914773941040039,
      -0.43358632922172546,
      0.6911065578460693,
      0.48019710183143616,
      0.5068996548652649,
      1.5140933990478516,
      -0.017680302262306213,
      -0.10049495100975037,
      -0.29514575004577637,
      -0.7162359356880188,
      0.1258848011493683,
      -0.2872934639453888,
      -0.5653494000434875,
      -0.7366811037063599,
      -0.2903067171573639,
      -0.4943969249725342,
      0.6638696193695068,
      0.051666468381881714,
      -0.6161195635795593,
      0.004407728556543589,
      -0.39759138226509094,
      0.6101014018058777,
      0.9692689180374146,
      -0.1271050125360489,
      -0.5159498453140259,
      -0.5470238327980042,
      0.5320178866386414,
      0.26257944107055664,
      -0.15073712170124054,
      -1.0071240663528442,
      -0.23214735090732574,
      0.5493378639221191,
      -1.2641608715057373,
      0.5244190096855164,
      0.3663962781429291,
      -0.6285154819488525,
      1.16689932346344,
      -1.1919687986373901,
      -0.09775889664888382,
      0.030009310692548752,
      -0.5436927676200867,
      -0.7671491503715515,
      0.030720900744199753,
      -0.49384981393814087,
      -0.20891639590263367,
      1.0092649459838867,
      0.34840548038482666,
      0.18463784456253052,
      0.9160065650939941,
      0.17092137038707733,
      -1.7414339780807495,
      0.24117706716060638,
      0.6816042065620422,
      0.4656165540218353,
      0.5516147017478943,
      -1.3554028272628784,
      -0.4822867214679718,
      -0.17290286719799042,
      0.5517323613166809,
      -0.1878904402256012,
      -0.21584060788154602,
      1.0779476165771484,
      0.3045550286769867,
      0.7675933837890625,
      0.9574607014656067,
      -0.11512536555528641,
      -1.6655340194702148,
      0.6206340789794922,
      0.29085201025009155,
      0.025419026613235474,
      -0.5210020542144775,
      -0.00876715499907732,
      0.38163039088249207,
      -0.3362267315387726,
      0.5970000624656677,
      0.046175435185432434,
      0.696914553642273,
      -0.15435653924942017,
      0.34035763144493103,
      -0.11728814989328384,
      -0.9548144340515137,
      -0.0023937332443892956,
      -0.09535839408636093,
      1.172616720199585,
      -0.6484208106994629,
      -2.0842878818511963,
      1.5661715269088745,
      -0.31682491302490234,
      -0.031767211854457855,
      0.20008988678455353,
      0.5355454087257385,
      1.1002411842346191,
      -0.8414475321769714,
      0.6333529353141785,
      0.48498791456222534,
      0.3894304037094116,
      1.0554986000061035,
      0.25846803188323975,
      0.2705777585506439,
      -1.2118735313415527,
      0.22294215857982635,
      -0.03580058366060257,
      -0.7755856513977051,
      -0.011852703057229519,
      -0.23325636982917786,
      0.41677552461624146,
      0.30020883679389954,
      -1.176056981086731,
      -0.12055117636919022,
      0.18327324092388153,
      0.33483272790908813,
      0.6092148423194885,
      1.0884846448898315,
      -0.5009722113609314,
      0.6227986812591553,
      0.1629866510629654,
      0.5559718608856201,
      -0.3151901662349701,
      -0.9666982293128967,
      0.24719615280628204,
      -0.012323439121246338,
      0.011765604838728905,
      1.632257103919983,
      0.4861275553703308,
      -0.27738088369369507,
      0.485371857881546,
      -0.08746407181024551,
      0.9159440398216248,
      -0.3630342483520508,
      -0.29955729842185974,
      -0.916857898235321,
      -0.46213310956954956,
      -0.16668131947517395,
      0.13097438216209412,
      0.333233505487442,
      0.6746995449066162,
      0.6663107872009277,
      -0.19976608455181122,
      -0.1461658626794815,
      0.4909268319606781,
      -0.2208770513534546,
      0.21713662147521973,
      -0.2778327167034149,
      0.8971664905548096,
      -1.1501071453094482,
      0.09955618530511856,
      -0.08557724952697754,
      0.24350808560848236,
      -0.09912046790122986,
      0.5440629124641418,
      0.16943787038326263,
      -0.21287241578102112,
      -1.3378081321716309,
      0.5444207787513733,
      0.029532311484217644,
      -0.777249813079834,
      -0.5525016188621521,
      0.37854698300361633,
      -1.0883989334106445,
      0.29900556802749634,
      -0.9308010935783386,
      -0.5239267945289612,
      0.4224953055381775,
      0.8318568468093872,
      -1.4458634853363037,
      0.06425132602453232,
      -0.4590066373348236,
      0.5806264877319336,
      0.07159952074289322,
      -0.6339393258094788,
      -0.3010731637477875,
      0.8368608951568604,
      -0.2717245817184448,
      -0.34697964787483215,
      0.2219882756471634,
      0.7260701656341553,
      0.04846542328596115,
      0.5087041854858398,
      0.8507432341575623,
      0.12788692116737366,
      -0.3343777656555176,
      0.027546484023332596,
      -0.13703888654708862,
      -0.21608631312847137,
      0.7296924591064453,
      -0.00459492951631546,
      -1.3587396144866943,
      1.0429266691207886,
      -0.3832606375217438,
      0.27651527523994446,
      -0.5794441103935242,
      0.07946509122848511,
      -0.5381506085395813,
      -0.5037295818328857,
      -0.7997815608978271,
      -0.4900612533092499,
      -0.23218584060668945,
      -0.8029686212539673,
      0.4776192307472229,
      1.1866554021835327,
      0.584682822227478,
      -0.2899063527584076,
      -0.10089899599552155,
      -1.0864944458007812,
      0.7088935971260071,
      0.296335905790329,
      1.2961755990982056,
      -0.040936585515737534,
      -0.8655200600624084,
      -0.15859273076057434,
      0.5043184161186218,
      0.333136647939682,
      -0.3318348824977875,
      0.393263041973114,
      0.4078557789325714,
      -0.6622353792190552,
      -0.9512590765953064,
      0.4145391583442688,
      -1.4453895092010498,
      0.29506823420524597,
      0.35601767897605896,
      -0.5699306726455688,
      0.3562728762626648,
      -0.11372669786214828,
      -0.6417946815490723,
      0.0261673703789711,
      -0.6719581484794617,
      -1.1642543077468872,
      -0.41888827085494995,
      0.9873299598693848,
      -0.7452533841133118,
      -0.06315848976373672,
      -0.07684683799743652,
      -1.3371074199676514,
      0.4602102041244507,
      -0.19531603157520294,
      -1.2460167407989502,
      -0.1646886169910431,
      0.5302616357803345,
      1.0153039693832397,
      -0.7699267864227295,
      0.5161978006362915,
      0.7447831034660339,
      -1.2937647104263306,
      -0.05764377862215042,
      -0.5321239233016968,
      0.013033047318458557,
      0.1521454006433487,
      0.04076604172587395,
      0.18638356029987335,
      0.3597474992275238,
      0.8681789636611938,
      -0.7478566765785217,
      1.2619307041168213,
      0.0510125495493412,
      -1.582397222518921,
      -0.39035773277282715,
      -0.5847123861312866,
      -1.0789024829864502,
      1.0668004751205444,
      -1.271501064300537,
      0.34073927998542786,
      -0.9698214530944824,
      0.20546238124370575,
      -0.8054051399230957,
      0.6036564111709595,
      0.5581707954406738,
      -1.3246253728866577,
      0.0925828218460083,
      -0.8552201986312866,
      -0.4311518669128418,
      -0.9648796916007996,
      0.8524211049079895,
      -0.09466344863176346,
      1.1242934465408325,
      1.219732403755188,
      1.5847586393356323,
      0.023081427440047264,
      -0.41110891103744507,
      -0.5373338460922241,
      0.5552536845207214,
      0.762399435043335,
      -0.7002964019775391,
      0.8555796146392822,
      0.782214879989624,
      -0.012137053534388542,
      0.5147817134857178,
      0.7913968563079834,
      0.7931150794029236,
      -0.31927385926246643,
      -0.10717171430587769,
      0.3250284194946289,
      0.1466621607542038,
      0.459128201007843,
      -0.553442656993866,
      -0.3402499258518219,
      -0.1039285957813263,
      0.406486839056015,
      -0.5786249041557312,
      -0.7911601662635803,
      0.28986504673957825,
      -0.24913311004638672,
      0.02045087143778801,
      -0.6692692637443542,
      0.2951158881187439,
      -0.18026527762413025,
      -1.009599208831787,
      0.5310949087142944,
      0.3645469844341278,
      -0.005189202260226011,
      -0.13146387040615082,
      1.2108066082000732,
      0.11616872251033783,
      -0.19573669135570526,
      0.9510045051574707,
      0.23342444002628326,
      -0.04904766380786896,
      0.37040868401527405,
      -0.06090506166219711,
      0.7913116812705994,
      0.3650951683521271,
      0.10447323322296143,
      -1.1248582601547241,
      0.2999156415462494,
      -0.3139357268810272,
      0.04263407364487648,
      -0.029136650264263153,
      0.15916602313518524,
      -0.6110700964927673,
      0.7159298658370972,
      -0.18778103590011597,
      -0.5740739703178406,
      -0.321515828371048,
      -0.09020260721445084,
      -0.5050400495529175,
      0.5840771198272705,
      0.6909244656562805,
      -0.8334596753120422,
      -0.4009395241737366,
      -0.7279068231582642,
      0.8419382572174072,
      -0.1774415820837021,
      0.2675674855709076,
      -0.088454969227314,
      0.04159938171505928,
      -0.3417944014072418,
      -0.7228309512138367,
      -0.4850800633430481,
      0.21590393781661987,
      -0.8743386268615723,
      1.255069375038147,
      -0.7806533575057983,
      0.15307623147964478,
      -0.32239022850990295,
      -0.9457321166992188,
      -1.0847246646881104,
      -0.7259078025817871,
      0.3165164887905121,
      0.08853871375322342,
      -1.570328950881958,
      0.23479264974594116,
      -1.0999382734298706,
      -1.285809874534607,
      0.47811368107795715,
      -0.11685045063495636,
      -0.3865828216075897,
      -0.5606720447540283,
      -0.9490025639533997,
      0.18553607165813446,
      -1.425415277481079,
      0.9073194265365601,
      -0.382804274559021,
      0.1965312510728836,
      -0.21272382140159607,
      -0.7032644152641296,
      0.12500859797000885,
      0.4759158492088318,
      -0.7286356687545776,
      0.5685821771621704,
      0.8024681210517883,
      0.2543884217739105,
      -0.2374667376279831,
      -0.5499884486198425,
      -0.6248112320899963,
      1.5430916547775269,
      0.5764333605766296,
      -1.2460196018218994,
      -0.6126443147659302,
      -0.05714864656329155,
      -0.12507985532283783,
      0.8392155170440674,
      -0.04043183475732803,
      0.1860172152519226,
      0.39105892181396484,
      0.9043095111846924,
      1.273913025856018,
      0.13364367187023163,
      0.6452412009239197,
      -0.6382485628128052,
      0.17254407703876495,
      0.25044190883636475,
      -0.48021557927131653,
      -0.3970147371292114,
      -0.45050251483917236,
      0.0748416855931282
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Evaluation",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/46204569",
    "title": "",
    "question": "\"I am trying to perform the usual classification on the MNIST database but with randomly cropped digits. \nImages are cropped the following way : removed randomly first/last and/or row/column.\n\nI would like to use a Convolutional Neural Network using Keras (and Tensorflow backend) to perform convolution and then the usual classification.\n\nInputs are of variable size and i can't manage to get it to work.\n\nHere is how I cropped digits\n\nimport numpy as np\nfrom keras.utils import to_categorical\nfrom sklearn.datasets import load_digits\n\ndigits = load_digits()\n\nX = digits.images\nX = np.expand_dims(X, axis=3)\n\nX_crop = list()\nfor index in range(len(X)):\n    X_crop.append(X[index, np.random.randint(0,2):np.random.randint(7,9), np.random.randint(0,2):np.random.randint(7,9), :])\nX_crop = np.array(X_crop)\n\ny = to_categorical(digits.target)\n\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X_crop, y, train_size=0.8, test_size=0.2)\n\nAnd here is the architecture of the model I want to use\n\nfrom keras.layers import Dense, Dropout\nfrom keras.layers.convolutional import Conv2D\nfrom keras.models import Sequential\n\nmodel = Sequential()\n\nmodel.add(Conv2D(filters=10, \n                 kernel_size=(3,3), \n                 input_shape=(None, None, 1), \n                 data_format='channels_last'))\n\nmodel.add(Dense(128, activation='relu'))\nmodel.add(Dropout(0.2))\n\nmodel.add(Dense(10, activation='softmax'))\n\nmodel.compile(loss='categorical_crossentropy', optimizer='sgd', metrics=['accuracy'])\n\nmodel.summary()\n\nmodel.fit(X_train, y_train, epochs=100, batch_size=16, validation_data=(X_test, y_test))\n\nDoes someone have an idea on how to handle variable sized input in my neural network? \nAnd how to perform classification?\"",
    "answer": "\"TL/DR - go to point 4\n\nSo - before we get to the point - let's fix some problems with your network:\n\nYour network will not work because of activation: with categorical_crossentropy you need to have a softmax activation:\n\nmodel.add(Dense(10, activation='softmax'))\n\nVectorize spatial tensors: as Daniel mentioned - you need to, at some stage, switch your vectors from spatial (images) to vectorized (vectors). Currently - applying Dense to output from a Conv2D is equivalent to (1, 1) convolution. So basically - output from your network is spatial - not vectorized what causes dimensionality mismatch (you can check that by running your network or checking the model.summary(). In order to change that you need to use either GlobalMaxPooling2D or GlobalAveragePooling2D. E.g.:\n\nmodel.add(Conv2D(filters=10, \n             kernel_size=(3, 3), \n             input_shape=(None, None, 1),\n             padding=\"\"same\"\",\n             data_format='channels_last'))\nmodel.add(GlobalMaxPooling2D())\nmodel.add(Dense(128, activation='relu'))\nmodel.add(Dropout(0.2))\n\nmodel.add(Dense(10, activation='softmax'))\n\nConcatenated numpy arrays need to have the same shape: if you check the shape of X_crop you'll see that it's not a spatial matrix. It's because you concatenated matrices with different shapes. Sadly - it's impossible to overcome this issue as numpy.array need to have a fixed shape.\nHow to make your network train on examples of different shape: The most important thing in doing this is to understand two things. First - is that in a single batch every image should have the same size. Second - is that calling fit multiple times is a bad idea - as you reset inner model states. So here is what needs to be done:\n\na. Write a function which crops a single batch - e.g. a get_cropped_batches_generator which given a matrix cuts a batch out of it and crops it randomly.\n\nb. Use train_on_batch method. Here is an example code:\n\nfrom six import next\n\nbatches_generator = get_cropped_batches_generator(X, batch_size=16)\nlosses = list()\nfor epoch_nb in range(nb_of_epochs):\n    epoch_losses = list()\n    for batch_nb in range(nb_of_batches):\n        # cropped_x has a different shape for different batches (in general)\n        cropped_x, cropped_y = next(batches_generator) \n        current_loss = model.train_on_batch(cropped_x, cropped_y)\n        epoch_losses.append(current_loss)\n    losses.append(epoch_losses.sum() / (1.0 * len(epoch_losses))\nfinal_loss = losses.sum() / (1.0 * len(losses))\n\nSo - a few comments to code above: First, train_on_batch doesn't use nice keras progress bar. It returns a single loss value (for a given batch) - that's why I added logic to compute loss. You could use Progbar callback for that also. Second - you need to implement get_cropped_batches_generator - I haven't written a code to keep my answer a little bit more clear. You could ask another question on how to implement it. Last thing - I use six to keep compatibility between Python 2 and Python 3.\"",
    "mlApiName": "keras.layers.Dense,keras.models.compile",
    "embedding": [
      0.754435658454895,
      0.5982885956764221,
      -2.3233909606933594,
      -1.162305235862732,
      0.21251752972602844,
      -0.7050960063934326,
      -0.09014292061328888,
      0.36987605690956116,
      -0.34460997581481934,
      -0.5140647888183594,
      0.2214389592409134,
      0.7045042514801025,
      1.9948055744171143,
      0.5803444385528564,
      -0.6128206849098206,
      -0.9041651487350464,
      -0.21665047109127045,
      0.08841120451688766,
      0.13585607707500458,
      0.8858287930488586,
      0.6338194012641907,
      0.38715922832489014,
      0.06262084096670151,
      -0.49500802159309387,
      1.2192689180374146,
      -0.09348643571138382,
      -0.557166337966919,
      0.5743676424026489,
      0.16965647041797638,
      0.5110666155815125,
      0.669745147228241,
      0.1620858907699585,
      -0.43380945920944214,
      -0.41188621520996094,
      -1.1664788722991943,
      0.041626885533332825,
      0.754194438457489,
      -0.7535421848297119,
      0.7271020412445068,
      0.3085532486438751,
      0.7563876509666443,
      0.6360190510749817,
      0.2804308533668518,
      0.31861987709999084,
      -0.12686766684055328,
      0.28009724617004395,
      1.6688061952590942,
      -0.040510598570108414,
      0.8402041792869568,
      -0.5702561140060425,
      0.6801639795303345,
      0.37314215302467346,
      0.1208498552441597,
      0.04807385429739952,
      1.0224745273590088,
      0.7331182360649109,
      0.35804903507232666,
      0.6847949028015137,
      0.7962941527366638,
      -0.7140501737594604,
      0.6012269854545593,
      0.6042495965957642,
      -1.8383554220199585,
      1.1686208248138428,
      0.2210233211517334,
      0.13802136480808258,
      -0.35829806327819824,
      0.7121407985687256,
      -0.4023270010948181,
      -0.5482704639434814,
      0.22529280185699463,
      0.1385609358549118,
      0.06533309072256088,
      0.3210681080818176,
      0.007386197801679373,
      0.03216230124235153,
      -0.9617965817451477,
      -0.7002572417259216,
      -0.2575761377811432,
      0.9030879139900208,
      -0.015282000415027142,
      0.5108692049980164,
      1.1762053966522217,
      -0.1634836047887802,
      -0.01580808497965336,
      0.5492122769355774,
      -0.6682864427566528,
      -0.5157113671302795,
      -0.528614342212677,
      1.0157160758972168,
      0.041746772825717926,
      -0.02737974375486374,
      0.2114546000957489,
      0.7676972150802612,
      -0.25971075892448425,
      -0.16499276459217072,
      -0.24522504210472107,
      0.5815089344978333,
      -0.9257186651229858,
      -0.5494624376296997,
      -0.2473592758178711,
      0.4544026255607605,
      -0.055637869983911514,
      -1.5036896467208862,
      -0.20022635161876678,
      0.9555439352989197,
      -0.22378934919834137,
      -0.17513017356395721,
      0.5378962159156799,
      0.015196933411061764,
      -0.7686078548431396,
      -0.10268508642911911,
      -0.04543786123394966,
      0.14701060950756073,
      -0.03186986595392227,
      -0.001527269254438579,
      -0.16997677087783813,
      -0.4195777177810669,
      0.1978999525308609,
      0.01652960665524006,
      0.0027155198622494936,
      -0.7878082990646362,
      0.39138948917388916,
      -0.12669365108013153,
      -0.01121828705072403,
      0.7260939478874207,
      -0.4256407618522644,
      0.09478006511926651,
      0.02643675170838833,
      -1.0277358293533325,
      0.268468976020813,
      -0.06520987302064896,
      0.038863617926836014,
      0.3987765610218048,
      0.32614484429359436,
      1.2256158590316772,
      -0.8357620239257812,
      -1.036424160003662,
      0.5329455137252808,
      -0.09730219841003418,
      0.8736949563026428,
      0.36102041602134705,
      -0.06644552201032639,
      -0.2392721325159073,
      0.2913036048412323,
      -0.3207140564918518,
      0.2732064723968506,
      -0.6831766366958618,
      -0.7939686179161072,
      -0.38760268688201904,
      -0.02727951481938362,
      0.734259307384491,
      -1.0377477407455444,
      -0.6381215453147888,
      0.2522142827510834,
      -0.17838212847709656,
      0.2350827306509018,
      0.763140857219696,
      0.00957772321999073,
      0.07916589826345444,
      1.2531384229660034,
      0.06006048247218132,
      -0.5114395618438721,
      0.718793511390686,
      -0.27401164174079895,
      -0.7489680647850037,
      0.27477458119392395,
      0.09799830615520477,
      -0.2982334792613983,
      0.21013499796390533,
      -0.4807131290435791,
      -0.4158914387226105,
      -0.02292810194194317,
      -0.5736048221588135,
      -0.09796133637428284,
      1.011145830154419,
      0.6520801186561584,
      -0.4457644522190094,
      0.535469114780426,
      -0.2243301123380661,
      0.6353468298912048,
      0.1663452535867691,
      0.7722863554954529,
      0.10419710725545883,
      -0.12295631319284439,
      -0.4214058518409729,
      0.07697455585002899,
      0.09697188436985016,
      0.06404316425323486,
      -0.7192012667655945,
      0.9023605585098267,
      -0.35989874601364136,
      -0.5420507788658142,
      -0.5626200437545776,
      -0.3296022415161133,
      -0.2002771645784378,
      0.7379985451698303,
      -1.0222781896591187,
      0.7748078107833862,
      -0.5792309045791626,
      -0.2593643069267273,
      0.6837466955184937,
      -0.8338426351547241,
      1.2035183906555176,
      -0.5046073794364929,
      0.6942306756973267,
      -0.37652111053466797,
      0.8321227431297302,
      -0.9161442518234253,
      0.4758225381374359,
      0.37255826592445374,
      -0.6644060015678406,
      0.019720200449228287,
      0.5344173312187195,
      -0.3316299319267273,
      -0.5945196151733398,
      0.5527535676956177,
      -0.7465246319770813,
      -0.16799050569534302,
      0.4082167446613312,
      0.5005022883415222,
      -0.5810685753822327,
      1.1894121170043945,
      -0.0015286775305867195,
      0.5530510544776917,
      -0.5349617600440979,
      0.4951300323009491,
      0.17105746269226074,
      -0.1804371476173401,
      0.0006134637515060604,
      -1.0668812990188599,
      -0.7073330283164978,
      0.4292275905609131,
      -0.03918481990695,
      -0.47446322441101074,
      0.6545884609222412,
      0.8332257866859436,
      0.8810279965400696,
      -0.6313130259513855,
      -0.00945420190691948,
      0.03910604491829872,
      0.36593708395957947,
      0.11964245140552521,
      0.06532302498817444,
      -0.7380682229995728,
      0.25146418809890747,
      -0.01318442728370428,
      -0.4436531066894531,
      -0.055264316499233246,
      0.5999953150749207,
      -0.02089877426624298,
      0.1873328983783722,
      0.4839414358139038,
      0.11844664067029953,
      0.8358635902404785,
      -0.5242665410041809,
      -0.02899138070642948,
      0.07551141828298569,
      0.6350289583206177,
      -0.10814069956541061,
      0.6398648023605347,
      0.6036102175712585,
      -0.2691788077354431,
      0.44197243452072144,
      0.2067711353302002,
      -0.9677377939224243,
      -0.257472962141037,
      -0.016590794548392296,
      -0.34330180287361145,
      -0.295210599899292,
      -0.1934693157672882,
      0.12949557602405548,
      1.059306025505066,
      0.03899482637643814,
      0.925701379776001,
      0.6364632248878479,
      -0.03440675511956215,
      -0.504719078540802,
      0.2752944231033325,
      -0.21178488433361053,
      -0.861535906791687,
      -1.088853120803833,
      -0.5033747553825378,
      0.014060397632420063,
      -0.08706410229206085,
      0.14186586439609528,
      0.24017232656478882,
      0.11203905940055847,
      0.13190382719039917,
      0.44305261969566345,
      -0.19435012340545654,
      0.41383084654808044,
      -0.39143139123916626,
      -0.007919369265437126,
      0.5591180920600891,
      0.41933754086494446,
      0.46182897686958313,
      0.06192559748888016,
      0.16251280903816223,
      -0.5852583646774292,
      0.6064001321792603,
      0.13080893456935883,
      0.8090469241142273,
      0.17349635064601898,
      0.0017184816533699632,
      0.361235111951828,
      -0.1960279792547226,
      -0.07627702504396439,
      0.1306142359972,
      -0.6385089159011841,
      -0.8534286618232727,
      -0.06403529644012451,
      -0.5182679295539856,
      0.4886185824871063,
      -0.32415124773979187,
      -0.6494951248168945,
      0.13945700228214264,
      0.28538382053375244,
      0.5799611806869507,
      -0.33778131008148193,
      0.18425601720809937,
      -0.347420334815979,
      0.26049724221229553,
      0.29255592823028564,
      -0.29020944237709045,
      0.7732890844345093,
      0.01069149374961853,
      0.3661212623119354,
      0.3597869575023651,
      0.3369258940219879,
      0.7121462821960449,
      0.22001641988754272,
      0.23428063094615936,
      -1.2330691814422607,
      -0.7427639961242676,
      -0.4695250988006592,
      0.16082198917865753,
      -0.22429563105106354,
      0.8404989242553711,
      0.3799523711204529,
      0.10094033926725388,
      0.17181994020938873,
      -0.2201656997203827,
      -0.8115624785423279,
      -0.36060279607772827,
      0.6473056674003601,
      -0.783065915107727,
      -0.8880056142807007,
      -0.05153360590338707,
      0.22014056146144867,
      -0.03793591260910034,
      -0.48228177428245544,
      0.05765867978334427,
      -0.5077259540557861,
      0.26848116517066956,
      0.3706727623939514,
      0.3882022798061371,
      -0.5295443534851074,
      -0.0860954225063324,
      0.07983379065990448,
      0.6418836116790771,
      -0.08388014882802963,
      -0.1226157695055008,
      -0.18591579794883728,
      -0.3254093527793884,
      0.5370712280273438,
      1.5005443096160889,
      0.2131429761648178,
      0.9127211570739746,
      -0.2826418876647949,
      -0.254095196723938,
      -0.2830609977245331,
      -0.4307880699634552,
      0.19015836715698242,
      -0.7895154356956482,
      0.2891644239425659,
      -0.8392327427864075,
      0.0222966019064188,
      0.17605598270893097,
      0.13222970068454742,
      0.17094816267490387,
      -0.6708729267120361,
      0.5236801505088806,
      0.08572955429553986,
      0.332131564617157,
      0.216460183262825,
      0.2348211407661438,
      -0.9488534331321716,
      -0.5256453156471252,
      0.7105251550674438,
      0.18864300847053528,
      -0.9918042421340942,
      -0.8107486367225647,
      -0.808142364025116,
      0.4234972894191742,
      -0.29832547903060913,
      0.885616660118103,
      0.3623593747615814,
      -0.2583688199520111,
      0.6909130215644836,
      -0.9283424019813538,
      -0.7883191704750061,
      0.019602607935667038,
      -0.4913080632686615,
      -0.4201103448867798,
      -0.28445324301719666,
      0.02912897802889347,
      -0.2409374713897705,
      -0.22314219176769257,
      0.3564113974571228,
      -0.04885426163673401,
      0.3306877017021179,
      0.05152814835309982,
      -1.4683115482330322,
      0.4651152789592743,
      0.13735198974609375,
      1.0193477869033813,
      0.8852521181106567,
      -0.4532356262207031,
      -0.9222996830940247,
      -0.35875439643859863,
      0.9007949829101562,
      -0.015338501892983913,
      -0.2774835228919983,
      0.7977524995803833,
      0.5395945310592651,
      0.47533637285232544,
      1.4872362613677979,
      0.33757513761520386,
      -1.0028661489486694,
      0.5409457087516785,
      0.4988119602203369,
      0.758019208908081,
      -0.047321390360593796,
      -0.2862613797187805,
      -0.08040285110473633,
      -0.6146620512008667,
      0.7505573630332947,
      0.06398368626832962,
      0.39733967185020447,
      0.8792734742164612,
      -0.4869059920310974,
      -0.5010077357292175,
      -0.5711000561714172,
      0.5934784412384033,
      0.4643220901489258,
      1.014018177986145,
      -0.7292762398719788,
      -1.146474003791809,
      1.3826004266738892,
      -0.4843543767929077,
      -0.17545750737190247,
      0.3136770725250244,
      0.25569042563438416,
      1.6081262826919556,
      -0.28162115812301636,
      -0.3004137873649597,
      -0.33931320905685425,
      0.3917193114757538,
      0.3894829750061035,
      0.13668565452098846,
      0.6917499303817749,
      -0.9548394083976746,
      0.0025228848680853844,
      -0.30342286825180054,
      -0.9145504236221313,
      0.009284031577408314,
      -0.5455592274665833,
      0.35304999351501465,
      0.7297783493995667,
      -0.9811319708824158,
      -0.21993876993656158,
      0.3711259961128235,
      -0.17081943154335022,
      -0.11295004189014435,
      0.562555730342865,
      -0.00044157824595458806,
      -0.5420799851417542,
      0.3419821858406067,
      0.43688637018203735,
      -0.1651700884103775,
      -1.3579970598220825,
      -0.04156296327710152,
      -0.19022639095783234,
      -0.5129511952400208,
      1.6008358001708984,
      0.30940085649490356,
      -0.07498696446418762,
      0.38918089866638184,
      0.32345277070999146,
      0.46346595883369446,
      -0.22555875778198242,
      0.636080801486969,
      0.2927767038345337,
      -0.3717639148235321,
      -0.5941516757011414,
      0.15429221093654633,
      0.6400858163833618,
      0.23445799946784973,
      0.29150328040122986,
      0.1514461636543274,
      0.19521555304527283,
      -0.7779278755187988,
      0.09256697446107864,
      0.8142918348312378,
      -0.4039197564125061,
      0.6710436344146729,
      -0.6043067574501038,
      -0.40290552377700806,
      0.06576051563024521,
      0.29249346256256104,
      0.025806432589888573,
      0.4731612801551819,
      0.108086958527565,
      -0.27412664890289307,
      -1.114213466644287,
      0.33020907640457153,
      0.5703787803649902,
      -0.5161423683166504,
      -0.449709951877594,
      0.6154435276985168,
      -0.3679754436016083,
      -0.5231236219406128,
      -0.5619125366210938,
      -0.6925659775733948,
      0.15770100057125092,
      -0.09375569224357605,
      -1.379300832748413,
      -0.056304626166820526,
      -1.4574757814407349,
      0.3863014876842499,
      -0.4075711965560913,
      -1.596421241760254,
      -0.16376939415931702,
      -0.06916998326778412,
      -0.20272208750247955,
      0.051468200981616974,
      1.109855055809021,
      0.07408563792705536,
      -0.03848668932914734,
      0.5011972188949585,
      1.0232237577438354,
      0.1607477068901062,
      -0.7119935750961304,
      -0.46081557869911194,
      -0.29644209146499634,
      0.8481945395469666,
      0.8125300407409668,
      0.5184252262115479,
      -0.8272086977958679,
      -0.25992801785469055,
      -0.48403897881507874,
      0.4015210270881653,
      -0.8946501612663269,
      -0.3884149193763733,
      -0.7636507749557495,
      -0.6040207147598267,
      -0.859161913394928,
      -0.4458814859390259,
      -0.7180160284042358,
      -1.226008415222168,
      0.07087428122758865,
      1.6012274026870728,
      -0.235127791762352,
      -0.3553348481655121,
      -0.1477760225534439,
      -0.6863514184951782,
      0.2357785403728485,
      0.4883005917072296,
      0.7421024441719055,
      -0.40480735898017883,
      -0.9267832636833191,
      0.2473965287208557,
      0.28360122442245483,
      -0.1449957638978958,
      -0.23996470868587494,
      0.9029793739318848,
      0.28316161036491394,
      -0.4138505160808563,
      -0.5076643824577332,
      -0.039389412850141525,
      -0.9390652775764465,
      -0.5918602347373962,
      0.31760838627815247,
      0.030962062999606133,
      0.29234349727630615,
      -0.056117236614227295,
      -0.24781811237335205,
      0.4386124908924103,
      -0.33155253529548645,
      -0.6301929354667664,
      -0.633675754070282,
      0.9166848659515381,
      -0.18896259367465973,
      0.05372719466686249,
      0.0056516258046031,
      -0.33455413579940796,
      0.35831916332244873,
      -0.8996386528015137,
      -1.171693205833435,
      -0.6351953148841858,
      0.5623266696929932,
      1.5858079195022583,
      -1.0947203636169434,
      -0.336143434047699,
      1.2423111200332642,
      -0.6137745976448059,
      0.15826500952243805,
      -0.1955774426460266,
      -0.08509387820959091,
      0.5198734402656555,
      -0.35173675417900085,
      0.22609135508537292,
      -0.17207151651382446,
      0.3164953589439392,
      -1.1215988397598267,
      0.7242646217346191,
      -0.1255931705236435,
      -0.23529672622680664,
      -0.04252757504582405,
      -0.38667771220207214,
      -0.5709719061851501,
      1.222495436668396,
      -0.770553469657898,
      0.36126500368118286,
      -0.04384322836995125,
      -0.5035693049430847,
      -0.36629167199134827,
      0.5162823796272278,
      0.14740225672721863,
      -1.3172255754470825,
      0.10467120260000229,
      -1.1784089803695679,
      0.20079118013381958,
      -1.2328161001205444,
      1.3043427467346191,
      -0.15631480515003204,
      1.1457316875457764,
      0.7974844574928284,
      0.7712186574935913,
      -0.023053381592035294,
      -0.01642771065235138,
      -0.5837310552597046,
      0.3507591784000397,
      0.2937491834163666,
      -1.080138921737671,
      1.170371413230896,
      1.0868356227874756,
      0.27670273184776306,
      -0.09066914767026901,
      0.8465823531150818,
      0.9716459512710571,
      -0.07853124290704727,
      -0.2055729180574417,
      0.29143890738487244,
      0.41947540640830994,
      0.03979479894042015,
      -0.3973771631717682,
      -0.4307614266872406,
      -0.29858940839767456,
      -0.11934966593980789,
      -0.3187614381313324,
      -0.8694262504577637,
      -0.7323154807090759,
      0.6773693561553955,
      -0.02964182384312153,
      -0.14764878153800964,
      0.19597309827804565,
      -0.5357087850570679,
      -0.8617424964904785,
      0.31033673882484436,
      0.3119371831417084,
      0.300077348947525,
      0.7818340063095093,
      0.831000030040741,
      -0.35835158824920654,
      1.0116771459579468,
      1.0793968439102173,
      0.3473416566848755,
      -0.21854422986507416,
      0.9826503396034241,
      -0.1020996943116188,
      0.954802393913269,
      -0.13775195181369781,
      0.40349259972572327,
      -1.0121732950210571,
      0.014615820720791817,
      -0.4507101774215698,
      0.47924208641052246,
      -0.5531445145606995,
      -0.03684599697589874,
      -0.20378702878952026,
      0.19528914988040924,
      -0.5537726283073425,
      -0.5466277599334717,
      0.8694866299629211,
      -0.0886363685131073,
      -0.7937255501747131,
      0.5926895141601562,
      1.0799360275268555,
      0.11959589272737503,
      0.2612000107765198,
      0.28743717074394226,
      0.2907014787197113,
      -0.04893078655004501,
      -0.23561471700668335,
      -0.12451077252626419,
      0.2507864832878113,
      -0.23835743963718414,
      -0.25977909564971924,
      -0.7610969543457031,
      -0.25407782196998596,
      -0.5520275235176086,
      1.5316433906555176,
      -0.19623017311096191,
      0.19499482214450836,
      0.17287172377109528,
      -0.5224806666374207,
      -0.39735281467437744,
      -0.2461376041173935,
      -0.08507296442985535,
      -0.5193639993667603,
      -0.9287720322608948,
      0.44712698459625244,
      -0.0024594548158347607,
      -1.0321805477142334,
      0.05247385427355766,
      0.028484202921390533,
      -0.2480870634317398,
      -0.19459469616413116,
      -0.7844865322113037,
      -0.6832261681556702,
      -1.5329262018203735,
      0.9363129734992981,
      -0.28557947278022766,
      -0.09696795791387558,
      -1.2759878635406494,
      -0.7585200071334839,
      -0.6623799800872803,
      -0.24116092920303345,
      -0.930722713470459,
      0.4759044349193573,
      0.5879226922988892,
      -0.2696886658668518,
      -0.7861893177032471,
      -0.22623352706432343,
      -1.1993447542190552,
      1.5098655223846436,
      -0.0051731206476688385,
      -0.5562065243721008,
      0.14469505846500397,
      -0.44670307636260986,
      -0.6930844783782959,
      0.6254203915596008,
      -0.41310998797416687,
      0.9507426023483276,
      -0.040651287883520126,
      0.9347755908966064,
      1.0897271633148193,
      0.07219743728637695,
      0.003392887068912387,
      -0.40154343843460083,
      0.14374305307865143,
      0.563262939453125,
      0.07387525588274002,
      -0.5054358839988708,
      -0.21423198282718658,
      -0.0761786475777626
    ],
    "label": {
      "level1": "Hybrid",
      "level2": "SAI",
      "level3": "IC-2,F",
      "leafContractCategory": "SAM (Level 3) ? AMO(Level 2)",
      "rootCause": "Missing Input value-Method order Dependency",
      "effect": "Unknown",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/47167630",
    "title": "",
    "question": "\"Lets say I have a simple neural network with an input layer and a single convolution layer programmed in tensorflow:\n\n  # Input Layer\n  input_layer = tf.reshape(features[\"\"x\"\"], [-1, 28, 28, 1])\n\n  # Convolutional Layer #1\n  conv1 = tf.layers.conv2d(\n      inputs=input_layer,\n      filters=32,\n      kernel_size=[5, 5],\n      padding=\"\"same\"\",\n      activation=tf.nn.relu)\n\nI leave out any further parts of the network definitions for the features.\n\nIf I wanted to add an LSTM Layer after this convolution layer, I would have to make the convolution layer TimeDistributed (in the language of keras) and then put the output of the TimeDistributed layer into the LSTM. \n\nTensorflow offers access to the keras layers in tf.keras.layers. Can I use the keras layers directly in the tensorflow code? If so, how? Could I also use the tf.keras.layers.lstm for the implementation of the LSTM Layer?\n\nSo in general: Is a mixture of pure tensorflow code and keras code possible and can I use the tf.keras.layers?\"",
    "answer": "\"Yes, this is possible.\n\nImport both TensorFlow and Keras and link your Keras session to the TF one:\n\nimport tensorflow as tf\nimport keras\nfrom keras import backend as K\n\ntf_sess = tf.Session()\nK.set_session(tf_sess)\n\nNow, in your model definition, you can mix TF and Keras layers like so:\n\n# Input Layer\ninput_layer = tf.reshape(features[\"\"x\"\"], [-1, 28, 28, 1])\n\n# Convolutional Layer #1\nconv1 = tf.layers.conv2d(\n    inputs=input_layer,\n    filters=32,\n    kernel_size=[5, 5],\n    padding=\"\"same\"\",\n    activation=tf.nn.relu)\n\n# Flatten conv output\nflat = tf.contrib.layers.flatten(conv1)\n\n# Fully-connected Keras layer\nlayer2_dense = keras.layers.Dense(128, activation='relu')(flat)\n\n# Fully-connected TF layer (output)\noutput_preds = tf.layers.dense(layer2_dense, units=10)\n\nThis answer is adopted from a Keras blog post by Francois Chollet.\"",
    "mlApiName": "keras.backend.set_session",
    "embedding": [
      0.1133100837469101,
      1.2996740341186523,
      -2.4690101146698,
      -1.3539868593215942,
      0.7451135516166687,
      -0.9134760499000549,
      -0.14995712041854858,
      0.5932282209396362,
      -1.2336162328720093,
      -1.1618613004684448,
      -0.6080519556999207,
      0.5070878267288208,
      1.902580976486206,
      0.45622459053993225,
      -0.46012192964553833,
      -0.20294781029224396,
      0.5687592625617981,
      1.2279084920883179,
      -0.04143147170543671,
      -0.07952194660902023,
      -1.073758602142334,
      -0.2522370219230652,
      0.5347739458084106,
      -0.42652612924575806,
      1.394212007522583,
      0.323681503534317,
      -0.5417731404304504,
      0.7032168507575989,
      -0.7466652989387512,
      -0.3007408082485199,
      1.8718129396438599,
      -0.8193991780281067,
      0.1125912293791771,
      -0.41214078664779663,
      -0.8447607159614563,
      -1.6055363416671753,
      0.957429826259613,
      -0.08485452830791473,
      -0.8704811334609985,
      -0.263132780790329,
      0.565358579158783,
      0.3178821802139282,
      -0.41345539689064026,
      -0.3485027551651001,
      0.5177026391029358,
      -0.28740033507347107,
      1.218239188194275,
      -0.12411873787641525,
      0.4372224509716034,
      -1.6624406576156616,
      0.24680817127227783,
      1.1046063899993896,
      -0.6997374892234802,
      0.27592477202415466,
      1.1914172172546387,
      0.21301600337028503,
      0.2884620130062103,
      0.7019516825675964,
      1.2259068489074707,
      -0.8408852219581604,
      0.17414242029190063,
      1.4086003303527832,
      -1.001055121421814,
      0.888573169708252,
      0.41528642177581787,
      0.2558532655239105,
      -0.9272792339324951,
      0.8501453995704651,
      0.05609000846743584,
      -0.0416376031935215,
      0.20148587226867676,
      0.6500110030174255,
      0.014364614151418209,
      0.6835736632347107,
      -0.03425360471010208,
      0.23484674096107483,
      -0.3012576103210449,
      -0.4583522081375122,
      -0.25897416472435,
      0.8389319777488708,
      -0.46298396587371826,
      0.8449755311012268,
      1.170664668083191,
      -0.5850716233253479,
      0.3074655532836914,
      0.824590802192688,
      -0.15105842053890228,
      -0.9510253667831421,
      -0.6649066209793091,
      2.110530376434326,
      -0.46516096591949463,
      -0.2600989043712616,
      0.8486899733543396,
      1.3719266653060913,
      -0.596621572971344,
      -1.1309690475463867,
      0.18640273809432983,
      0.05682855844497681,
      -0.7127224802970886,
      -0.289099782705307,
      -0.8451170325279236,
      0.5087947845458984,
      -0.413374125957489,
      -1.0793676376342773,
      -0.29073601961135864,
      0.6151864528656006,
      -0.04591413587331772,
      -0.22702287137508392,
      -0.043105412274599075,
      -0.0951240211725235,
      -0.9714543223381042,
      -0.23361743986606598,
      0.08437977731227875,
      0.837396502494812,
      0.10276953130960464,
      -0.2327633798122406,
      -0.09773742407560349,
      -0.12413319200277328,
      0.4794495701789856,
      0.7601752877235413,
      -0.31249937415122986,
      -0.9186761975288391,
      0.5334941148757935,
      0.3786773383617401,
      0.1720668375492096,
      1.215651512145996,
      -1.0741820335388184,
      -0.36598655581474304,
      0.20120519399642944,
      -1.3088433742523193,
      0.13069534301757812,
      -0.6281811594963074,
      -0.32465660572052,
      0.6554722785949707,
      0.6143357753753662,
      1.800391674041748,
      -0.7287111282348633,
      -1.3196805715560913,
      -0.08787038177251816,
      0.06417590379714966,
      0.6086753010749817,
      0.006151974201202393,
      -0.8169323205947876,
      -0.2792000472545624,
      0.5605120062828064,
      -0.6814301013946533,
      0.11661291867494583,
      -0.7436184883117676,
      -0.6357699632644653,
      0.3334062099456787,
      0.5123615860939026,
      0.6857729554176331,
      -1.0672454833984375,
      0.4467962682247162,
      1.1782464981079102,
      -1.0061205625534058,
      0.5863162279129028,
      0.5657660961151123,
      0.2750692367553711,
      0.02124299667775631,
      1.1272315979003906,
      0.46396633982658386,
      0.41965627670288086,
      0.05860424414277077,
      -1.051924705505371,
      -1.0938916206359863,
      0.24224695563316345,
      0.57840895652771,
      0.24898675084114075,
      -0.009723014198243618,
      -0.5584829449653625,
      0.14582084119319916,
      -0.4143983721733093,
      -0.0198881346732378,
      0.09979948401451111,
      1.0341380834579468,
      0.9632158875465393,
      -0.8301695585250854,
      0.7620252370834351,
      0.41878199577331543,
      0.2913426458835602,
      0.03930341824889183,
      -0.06342467665672302,
      -0.2796693444252014,
      -0.37723103165626526,
      0.5605764985084534,
      -0.3004084825515747,
      -0.7480676770210266,
      0.01649041287600994,
      -0.3149321377277374,
      1.100152850151062,
      0.0036394731141626835,
      -0.7160348296165466,
      0.056958988308906555,
      -0.7876706123352051,
      0.49909377098083496,
      0.38418594002723694,
      -0.6321316361427307,
      0.9828571677207947,
      0.8438645601272583,
      -0.082209013402462,
      0.32721394300460815,
      -1.329874038696289,
      0.7085590362548828,
      -0.8381274938583374,
      1.7614810466766357,
      -0.8039458394050598,
      0.888134777545929,
      -0.3165956437587738,
      -0.11565583944320679,
      0.6815811395645142,
      0.6282413601875305,
      0.19753427803516388,
      0.48759016394615173,
      -0.3611394762992859,
      -0.3897307515144348,
      1.0224205255508423,
      -0.9529387354850769,
      -1.0398967266082764,
      0.5720995664596558,
      0.19771577417850494,
      -0.3601842522621155,
      1.0510703325271606,
      0.14007878303527832,
      0.37568557262420654,
      -1.2415637969970703,
      -0.37831252813339233,
      -0.4711230397224426,
      -0.8703857660293579,
      0.3876020908355713,
      -1.2282464504241943,
      -0.6780198216438293,
      -0.2266000509262085,
      0.6116964817047119,
      0.30581438541412354,
      1.098347783088684,
      1.1908236742019653,
      0.7926527857780457,
      -0.3897056579589844,
      1.0772336721420288,
      0.23730623722076416,
      0.3621487617492676,
      0.4361053705215454,
      0.07365767657756805,
      -1.3714334964752197,
      0.24785421788692474,
      -0.2123992145061493,
      -1.3650015592575073,
      0.39202064275741577,
      0.37436965107917786,
      -0.020094558596611023,
      -0.3805864453315735,
      0.35062894225120544,
      -0.23911641538143158,
      0.9188858866691589,
      -0.5161798596382141,
      -0.3649633824825287,
      0.4097196161746979,
      0.6139558553695679,
      -0.34019777178764343,
      0.6429730653762817,
      0.6299479007720947,
      0.13817468285560608,
      -0.07839268445968628,
      -1.0316708087921143,
      -0.2570980191230774,
      -0.7744359970092773,
      0.23525819182395935,
      -0.05309779942035675,
      -0.21584516763687134,
      -0.2245393544435501,
      0.6927716135978699,
      0.4520910978317261,
      0.7867941856384277,
      0.08774197101593018,
      0.6933930516242981,
      0.24286618828773499,
      -0.306100994348526,
      -0.14654068648815155,
      -0.19030159711837769,
      -0.597756028175354,
      -1.5513283014297485,
      -0.66109699010849,
      -0.1582965850830078,
      -0.5066009759902954,
      -0.14297927916049957,
      0.3769392967224121,
      0.2540857493877411,
      0.30543944239616394,
      0.6729461550712585,
      0.6368997693061829,
      0.09892456233501434,
      -0.009887566789984703,
      -0.2645774185657501,
      0.7539194226264954,
      0.7146927714347839,
      0.9416725635528564,
      -1.0267560482025146,
      -0.47951972484588623,
      -0.301943302154541,
      0.021449362859129906,
      0.6266301870346069,
      0.7594954967498779,
      0.5453402996063232,
      -0.09858623147010803,
      -0.3794390559196472,
      -0.1763465255498886,
      0.48835107684135437,
      0.14606048166751862,
      -0.1146487146615982,
      -0.20363610982894897,
      0.19414857029914856,
      0.23964302241802216,
      0.9706166982650757,
      0.03885331004858017,
      -0.008115730248391628,
      0.6869491934776306,
      0.1855926215648651,
      0.7407353520393372,
      -0.3717241585254669,
      -0.18747448921203613,
      0.3183364272117615,
      0.06820287555456161,
      -0.1133841946721077,
      0.009563606232404709,
      0.4712577164173126,
      -0.38642293214797974,
      0.2763088345527649,
      0.021243656054139137,
      -0.9350094199180603,
      0.49163898825645447,
      0.6542894244194031,
      0.3580988943576813,
      -1.19798743724823,
      -0.6438701748847961,
      -0.2534380853176117,
      -0.3256758153438568,
      0.09914564341306686,
      0.8125607371330261,
      0.8849948048591614,
      -0.001533095259219408,
      -0.24527192115783691,
      -0.05875493958592415,
      -0.08310697972774506,
      -0.051637109369039536,
      0.4820370376110077,
      -0.8715757727622986,
      -0.2745674252510071,
      0.39582061767578125,
      -0.3878389298915863,
      -0.8539703488349915,
      0.2214275449514389,
      -0.21481260657310486,
      -0.2676861882209778,
      0.2341407984495163,
      -0.11171279102563858,
      1.3646410703659058,
      0.49046167731285095,
      0.7225420475006104,
      -0.08177660405635834,
      1.075681447982788,
      -0.7668514251708984,
      0.053625889122486115,
      -0.5983664989471436,
      -0.18433436751365662,
      0.35125669836997986,
      1.546020746231079,
      0.38657906651496887,
      0.25613173842430115,
      0.18493090569972992,
      0.28457000851631165,
      -0.10451376438140869,
      -0.9821279048919678,
      0.5962886810302734,
      -0.7935844659805298,
      -0.04749070852994919,
      -1.148252248764038,
      0.9320175051689148,
      0.28176188468933105,
      -0.05084701254963875,
      0.3493359684944153,
      -0.1614513397216797,
      0.3187410831451416,
      0.4644151031970978,
      0.7452542781829834,
      0.38965246081352234,
      0.48903024196624756,
      -1.0741279125213623,
      0.3908742368221283,
      1.847883939743042,
      -0.40998396277427673,
      -0.410869300365448,
      -0.6124130487442017,
      -1.0278717279434204,
      0.7971246242523193,
      -0.11805112659931183,
      0.7833911180496216,
      0.07743839174509048,
      -0.017869768664240837,
      0.4868588149547577,
      -0.6035754084587097,
      -1.2586358785629272,
      0.12762245535850525,
      -0.4932902455329895,
      -0.1124410405755043,
      -0.05649897828698158,
      0.03772825002670288,
      -0.8598818778991699,
      0.08089857548475266,
      0.5104531049728394,
      0.5736045837402344,
      0.21278820931911469,
      0.3931243419647217,
      -1.4554334878921509,
      1.167205572128296,
      -0.39833521842956543,
      0.8743292689323425,
      0.5478667616844177,
      -1.1176960468292236,
      -0.7699977159500122,
      0.0020062625408172607,
      0.5092452764511108,
      -0.1363496631383896,
      0.15426088869571686,
      0.8960344195365906,
      0.5364891290664673,
      0.5793267488479614,
      0.7535603046417236,
      -0.5153754353523254,
      -1.383839726448059,
      0.594340980052948,
      0.20380575954914093,
      0.8093336224555969,
      -0.5261595845222473,
      -0.27974560856819153,
      -0.18270915746688843,
      -0.6174571514129639,
      0.5821576714515686,
      -0.32396620512008667,
      0.7711879014968872,
      0.7455836534500122,
      -0.2537291646003723,
      -0.6756417155265808,
      -1.1841599941253662,
      -0.00032268257928080857,
      0.615642249584198,
      0.4275975227355957,
      -0.85738205909729,
      -1.6743545532226562,
      0.9068033695220947,
      -0.0070566534996032715,
      0.45982953906059265,
      0.4565356373786926,
      0.7843936681747437,
      1.5418548583984375,
      0.04064493998885155,
      -0.1695968210697174,
      -0.2041931003332138,
      -0.8537099957466125,
      -0.3187691867351532,
      0.08030971139669418,
      0.3861348628997803,
      -0.3380579352378845,
      -0.5800336599349976,
      0.17637835443019867,
      -0.7790704369544983,
      -0.4451040029525757,
      -0.4842413663864136,
      -0.014134087599813938,
      0.8331272006034851,
      0.2595013678073883,
      -0.45928269624710083,
      0.442341148853302,
      0.3612317740917206,
      0.23139533400535583,
      -0.5413039922714233,
      0.7074919939041138,
      -0.16934005916118622,
      0.11786650121212006,
      0.665318489074707,
      0.30374497175216675,
      -0.9073478579521179,
      -0.007283621467649937,
      -0.8363136053085327,
      -0.13173961639404297,
      1.7195576429367065,
      -0.4607411026954651,
      0.09689964354038239,
      -0.6997238993644714,
      0.1722947657108307,
      0.1705237627029419,
      -0.0049591464921832085,
      -0.20781302452087402,
      0.572687566280365,
      0.05539138615131378,
      -0.0802452489733696,
      -0.18270763754844666,
      0.004937088582664728,
      0.17619535326957703,
      0.38261523842811584,
      0.9142507910728455,
      0.42380639910697937,
      -0.38683223724365234,
      0.263906329870224,
      0.6336336731910706,
      -0.4342263340950012,
      0.5111923217773438,
      -0.8655206561088562,
      -0.4584987461566925,
      0.34495222568511963,
      -0.23434273898601532,
      -0.2197633683681488,
      -0.712449312210083,
      0.6945196986198425,
      0.4841136038303375,
      -1.008100986480713,
      0.09013836830854416,
      -0.372140109539032,
      -0.841728925704956,
      -0.3255559504032135,
      0.6089673638343811,
      -0.01426892913877964,
      -0.7677570581436157,
      -0.3741012215614319,
      -1.610296368598938,
      0.358653724193573,
      0.14476101100444794,
      -0.5644283294677734,
      0.28040236234664917,
      -0.19165031611919403,
      -0.2693594694137573,
      -0.4469407796859741,
      -0.865871787071228,
      0.3326839804649353,
      0.5188121199607849,
      -0.5474143624305725,
      0.00120267691090703,
      1.0458201169967651,
      0.4956018924713135,
      0.16977554559707642,
      0.25723668932914734,
      0.9708826541900635,
      0.438823401927948,
      -0.10389843583106995,
      -0.2609200179576874,
      -0.2121884524822235,
      0.6739376187324524,
      0.9089004993438721,
      0.419233113527298,
      -1.8058785200119019,
      -0.5011466145515442,
      -1.618173360824585,
      1.0927294492721558,
      -0.9157388806343079,
      0.5087370872497559,
      -0.33270689845085144,
      -0.932348370552063,
      -0.9303717017173767,
      -0.29955825209617615,
      -0.04684019461274147,
      0.15722326934337616,
      -0.436365008354187,
      1.190179467201233,
      -0.7387946844100952,
      -0.0500229075551033,
      -0.13706056773662567,
      -0.17414738237857819,
      0.4994443953037262,
      0.3668273985385895,
      -0.11652200669050217,
      -0.5727314949035645,
      -1.1718080043792725,
      -0.3579869866371155,
      -0.2924262583255768,
      0.06987699866294861,
      0.1817212998867035,
      0.7405103445053101,
      0.679237425327301,
      -0.8454495072364807,
      -0.8351478576660156,
      0.046235959976911545,
      -1.1395595073699951,
      0.14012756943702698,
      -0.245978444814682,
      0.43535590171813965,
      0.743706226348877,
      -0.4466439187526703,
      -0.680823802947998,
      0.5646194815635681,
      -0.1281006634235382,
      -0.7699691653251648,
      -0.611008882522583,
      0.3711269497871399,
      -0.02228568308055401,
      0.2299361377954483,
      0.3030429184436798,
      -0.7842601537704468,
      1.279680609703064,
      -0.6759300231933594,
      -0.5701751708984375,
      -0.5736538767814636,
      1.1328465938568115,
      1.2209594249725342,
      -1.1786867380142212,
      -0.4753197431564331,
      1.6641911268234253,
      -0.6967342495918274,
      0.47466427087783813,
      0.018908893689513206,
      0.6642506122589111,
      0.17271354794502258,
      -0.3940129578113556,
      0.19434048235416412,
      -0.32340896129608154,
      0.025289928540587425,
      -0.4669876992702484,
      0.4178885519504547,
      -0.30395370721817017,
      0.17133934795856476,
      -0.36047059297561646,
      -0.09439880400896072,
      -1.7838354110717773,
      1.2482928037643433,
      -0.35639047622680664,
      0.40270501375198364,
      -0.5956137776374817,
      -0.998042643070221,
      0.2498304694890976,
      0.034281712025403976,
      0.870792806148529,
      -0.8860841393470764,
      0.17984320223331451,
      -1.5067349672317505,
      -0.458388090133667,
      -1.128452181816101,
      1.2527849674224854,
      -0.2039433866739273,
      0.08013967424631119,
      0.2732149064540863,
      0.4733707010746002,
      0.10619892179965973,
      0.29743820428848267,
      0.20747336745262146,
      0.6744743585586548,
      0.6753181219100952,
      -0.6280502080917358,
      0.806682288646698,
      0.4315967857837677,
      -0.741034746170044,
      0.4579416811466217,
      0.8409937024116516,
      0.4739326536655426,
      -0.020135696977376938,
      -0.22029758989810944,
      0.3306300938129425,
      -0.4304327964782715,
      0.02391308732330799,
      -0.9763234853744507,
      -0.9668384790420532,
      -0.07766791433095932,
      -0.17959073185920715,
      -0.4366038739681244,
      -0.9812031388282776,
      -0.254595547914505,
      0.22736112773418427,
      -0.020959051325917244,
      0.3729299306869507,
      0.030767623335123062,
      -0.3801417648792267,
      -0.864925742149353,
      0.4210563898086548,
      0.5399468541145325,
      -0.30858802795410156,
      1.0111546516418457,
      -0.20355954766273499,
      -0.4236231744289398,
      1.1475176811218262,
      1.907265067100525,
      0.29265761375427246,
      0.43511077761650085,
      0.5785136818885803,
      0.39647114276885986,
      0.6030288934707642,
      -0.06892002373933792,
      0.1896842122077942,
      -1.19329833984375,
      0.5383510589599609,
      -1.3086142539978027,
      -0.2376391887664795,
      -0.7952062487602234,
      0.4433536231517792,
      0.3187696933746338,
      -0.10696568340063095,
      -0.22295323014259338,
      -0.6734361052513123,
      0.8022492527961731,
      -0.024364786222577095,
      -1.1495023965835571,
      0.24942409992218018,
      0.883966326713562,
      0.5401600003242493,
      -0.3794579803943634,
      -0.30164188146591187,
      0.1442170888185501,
      0.6918132901191711,
      0.236251562833786,
      0.15052177011966705,
      0.03712071105837822,
      -0.659854531288147,
      -0.7430670261383057,
      -0.23108604550361633,
      0.7035641670227051,
      -0.6452987194061279,
      1.3402677774429321,
      -0.36838874220848083,
      0.6134721040725708,
      0.03023509681224823,
      -0.4550836980342865,
      -0.19323283433914185,
      0.0707395076751709,
      -0.2539532780647278,
      -0.5345334410667419,
      -1.181335687637329,
      0.05615825578570366,
      -0.7527112364768982,
      -0.2755362391471863,
      0.32032158970832825,
      -0.3399304151535034,
      -0.5541673898696899,
      0.4455990195274353,
      -0.5005573630332947,
      -0.3978581726551056,
      -0.7973055243492126,
      1.0039681196212769,
      -0.261832594871521,
      -0.5810961127281189,
      -0.8433060050010681,
      -0.8336786031723022,
      -0.6510471105575562,
      -0.3673381507396698,
      -1.576593279838562,
      -0.09904927015304565,
      0.0917116329073906,
      0.27383142709732056,
      -0.6989761590957642,
      -0.01775365136563778,
      -0.43448278307914734,
      1.3305619955062866,
      -0.1329963058233261,
      -0.5476924180984497,
      0.2412382811307907,
      -0.1867087334394455,
      -0.3566300868988037,
      -0.619668185710907,
      -0.0029379341285675764,
      0.01164128165692091,
      -0.6140773296356201,
      1.5909864902496338,
      1.1247705221176147,
      0.9109861254692078,
      0.7420974969863892,
      -0.5639669895172119,
      0.18334679305553436,
      0.7854397296905518,
      -0.6120806932449341,
      -0.5458401441574097,
      0.2853739559650421,
      -0.42922404408454895
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Unknown",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Initialization",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/48493755",
    "title": "",
    "question": "\"I'm running a Keras neural network model in Jupyter Notebook (Python 3.6)\n\nI get the following error\n\n  AttributeError: 'list' object has no attribute 'ndim'\n\nafter calling the .fit() method from Keras.model\n\nmodel  = Sequential()\nmodel.add(Dense(5, input_dim=len(X_data[0]), activation='sigmoid' ))\nmodel.add(Dense(1, activation = 'sigmoid'))\nmodel.compile(loss='mean_squared_error', optimizer='adam', metrics=['acc'])\nmodel.fit(X_data, y_data, epochs=20, batch_size=10)\n\nI checked the requirements.txt file for Keras (in Anaconda3) and the numpy, scipy, and six module versions are all up to date.\n\nWhat can explain this AttributeError?\n\nThe full error message is the following (seems to be somewhat related to Numpy):\n\n  --------------------------------------------------------------------------- AttributeError                            Traceback (most recent call\n  last)  in ()\n        3 model.add(Dense(1, activation = 'sigmoid'))\n        4 model.compile(loss='mean_squared_error', optimizer='adam', metrics=['acc'])\n  ----> 5 model.fit(X_data, y_data, epochs=20, batch_size=10)\n  \n  ~\\Anaconda3\\lib\\site-packages\\keras\\models.py in fit(self, x, y,\n  batch_size, epochs, verbose, callbacks, validation_split,\n  validation_data, shuffle, class_weight, sample_weight, initial_epoch,\n  steps_per_epoch, validation_steps, **kwargs)\n      963                               initial_epoch=initial_epoch,\n      964                               steps_per_epoch=steps_per_epoch,\n  --> 965                               validation_steps=validation_steps)\n      966 \n      967     def evaluate(self, x=None, y=None,\n  \n  ~\\Anaconda3\\lib\\site-packages\\keras\\engine\\training.py in fit(self, x,\n  y, batch_size, epochs, verbose, callbacks, validation_split,\n  validation_data, shuffle, class_weight, sample_weight, initial_epoch,\n  steps_per_epoch, validation_steps, **kwargs)    1591\n\n  class_weight=class_weight,    1592             check_batch_axis=False,\n  -> 1593             batch_size=batch_size)    1594         # Prepare validation data.    1595         do_validation = False\n  \n  ~\\Anaconda3\\lib\\site-packages\\keras\\engine\\training.py in\n  _standardize_user_data(self, x, y, sample_weight, class_weight, check_batch_axis, batch_size)    1424\n\n  self._feed_input_shapes,    1425\n\n  check_batch_axis=False,\n  -> 1426                                     exception_prefix='input')    1427         y = _standardize_input_data(y, self._feed_output_names,\n\n  1428                                     output_shapes,\n  \n  ~\\Anaconda3\\lib\\site-packages\\keras\\engine\\training.py in\n  _standardize_input_data(data, names, shapes, check_batch_axis, exception_prefix)\n       68     elif isinstance(data, list):\n       69         data = [x.values if x.class.name == 'DataFrame' else x for x in data]\n  ---> 70         data = [np.expand_dims(x, 1) if x is not None and x.ndim == 1 else x for x in data]\n       71     else:\n       72         data = data.values if data.class.name == 'DataFrame' else data\n  \n  ~\\Anaconda3\\lib\\site-packages\\keras\\engine\\training.py in\n  (.0)\n       68     elif isinstance(data, list):\n       69         data = [x.values if x.class.name == 'DataFrame' else x for x in data]\n  ---> 70         data = [np.expand_dims(x, 1) if x is not None and x.ndim == 1 else x for x in data]\n       71     else:\n       72         data = data.values if data.class.name == 'DataFrame' else data\n  \n  AttributeError: 'list' object has no attribute 'ndim'\"",
    "answer": "\"model.fit expects x and y to be numpy array. Seems like you pass a list, it tried to get shape of input by reading ndim attribute of numpy array and failed. \n\nYou can simply transform it using np.array:\n\nimport numpy as np\n...\nmodel.fit(np.array(train_X),np.array(train_Y), epochs=20, batch_size=10)\"",
    "mlApiName": "keras.models.fit",
    "embedding": [
      0.40084949135780334,
      0.1988029032945633,
      -2.284029245376587,
      -0.9734311699867249,
      1.3423603773117065,
      0.770728588104248,
      -0.19524863362312317,
      0.248423233628273,
      -0.510160505771637,
      -0.8528628349304199,
      -0.7388359904289246,
      0.4628768563270569,
      2.075836181640625,
      0.178558811545372,
      -0.8655735850334167,
      -0.36808833479881287,
      0.09346599876880646,
      0.1938389390707016,
      -0.4201919138431549,
      0.7543206214904785,
      -0.16991972923278809,
      -0.08473864197731018,
      -0.2104359269142151,
      -0.3861716687679291,
      1.4950028657913208,
      0.16392801702022552,
      -0.5055124759674072,
      0.4714922308921814,
      0.4877244234085083,
      1.1710784435272217,
      0.9578526616096497,
      -0.11334303766489029,
      0.32590726017951965,
      -0.7170852422714233,
      -1.152368426322937,
      -0.3423539698123932,
      1.4070481061935425,
      0.3818590044975281,
      0.229684978723526,
      0.37385520339012146,
      0.7183386087417603,
      -0.3333074748516083,
      -0.5504366159439087,
      0.9555864334106445,
      0.2870792746543884,
      -0.21126295626163483,
      1.427150845527649,
      0.49362659454345703,
      0.5222317576408386,
      -0.12123308330774307,
      0.37663504481315613,
      0.0007672601495869458,
      0.5208620429039001,
      0.29349321126937866,
      1.8822962045669556,
      0.7036457657814026,
      0.24441955983638763,
      1.1651052236557007,
      0.37664860486984253,
      -0.5297470092773438,
      0.8969137668609619,
      0.785326361656189,
      -0.6243898272514343,
      1.362943410873413,
      1.1160041093826294,
      -0.5832296013832092,
      -0.747455358505249,
      0.7677174806594849,
      -0.28204962611198425,
      0.034858930855989456,
      0.939879834651947,
      0.37228238582611084,
      0.20604757964611053,
      0.8151320815086365,
      -0.8344560861587524,
      0.17104282975196838,
      -0.7849062085151672,
      -0.43406975269317627,
      -0.557900071144104,
      0.22052395343780518,
      0.26959118247032166,
      1.607520580291748,
      0.8323917388916016,
      -0.26359906792640686,
      0.09847957640886307,
      -0.18845731019973755,
      -1.0592039823532104,
      -0.3835059106349945,
      -0.4693163335323334,
      1.0287361145019531,
      -0.09632934629917145,
      0.2256229817867279,
      0.2709960639476776,
      0.5395883917808533,
      -0.5412287712097168,
      -0.019086437299847603,
      -0.5707670450210571,
      -0.10293632745742798,
      -1.0884469747543335,
      -0.37477943301200867,
      -0.060853511095047,
      0.706235945224762,
      -0.047727689146995544,
      -1.0146805047988892,
      0.5253017544746399,
      1.3990187644958496,
      0.49199551343917847,
      -0.10502499341964722,
      0.09804468601942062,
      -0.4654853641986847,
      -0.9569842219352722,
      0.358410507440567,
      0.3929547369480133,
      -0.5522213578224182,
      -0.5584205985069275,
      -0.6494908332824707,
      0.33837607502937317,
      -0.7505281567573547,
      0.1790100634098053,
      0.7256855368614197,
      -0.3460710346698761,
      -0.5738920569419861,
      0.7137498259544373,
      0.28065648674964905,
      -0.028853222727775574,
      0.42562994360923767,
      -0.2028331309556961,
      0.5102682709693909,
      -0.054211895912885666,
      -0.998464822769165,
      0.36869296431541443,
      -0.19110620021820068,
      -1.057642936706543,
      -0.03801030293107033,
      0.8138154745101929,
      0.7732917666435242,
      -0.9141743183135986,
      -0.7924460768699646,
      -0.34990057349205017,
      0.21702797710895538,
      0.35045772790908813,
      0.23905214667320251,
      0.49814388155937195,
      -0.5956667065620422,
      0.6723765134811401,
      -0.8685736656188965,
      0.6360036730766296,
      -0.4410574734210968,
      -0.5581022500991821,
      0.10110875964164734,
      0.06005655229091644,
      0.951038122177124,
      -0.8075394034385681,
      -0.15976116061210632,
      0.06414447724819183,
      -0.6528741717338562,
      0.36081430315971375,
      0.6375952363014221,
      0.35610252618789673,
      -0.48147496581077576,
      0.7746644616127014,
      0.24294310808181763,
      -0.789329469203949,
      1.0128005743026733,
      -0.11685609072446823,
      -0.8994500637054443,
      0.6255948543548584,
      0.3391791582107544,
      -0.4115109145641327,
      0.08845885097980499,
      -0.9626896381378174,
      -0.8775216341018677,
      0.21404100954532623,
      -0.3205360472202301,
      0.675167441368103,
      1.0805314779281616,
      0.7373706698417664,
      -0.6736827492713928,
      0.3767170011997223,
      -0.4164086878299713,
      0.9376111626625061,
      -0.3078129291534424,
      0.5845781564712524,
      -0.5675557851791382,
      -0.6883861422538757,
      -0.2502158284187317,
      0.16312061250209808,
      0.29211926460266113,
      0.1288151890039444,
      -0.9482337236404419,
      0.7334996461868286,
      0.1043287143111229,
      -0.22484184801578522,
      -0.7118712067604065,
      0.3300117552280426,
      -0.6074097752571106,
      0.5154232382774353,
      -0.5940983891487122,
      1.0524191856384277,
      0.5326266884803772,
      0.011816616170108318,
      0.22859451174736023,
      -1.1821606159210205,
      0.1863269805908203,
      -0.42039036750793457,
      0.7922440767288208,
      -0.509138286113739,
      0.8625597953796387,
      -0.2711849510669708,
      0.5923383235931396,
      0.1541927456855774,
      -0.34875160455703735,
      0.00430125230923295,
      0.03256941959261894,
      -0.27536338567733765,
      -0.14223946630954742,
      0.5739179849624634,
      -0.6885191202163696,
      -0.3174602687358856,
      0.11964651942253113,
      0.23237569630146027,
      -0.6631711721420288,
      0.8941163420677185,
      -0.0819988027215004,
      1.1076703071594238,
      -0.6148185729980469,
      0.12105043977499008,
      0.218588188290596,
      -0.4986289441585541,
      -0.5425002574920654,
      -1.2622854709625244,
      -0.8582597970962524,
      0.37083619832992554,
      0.7208196520805359,
      0.15577125549316406,
      0.6321175694465637,
      0.5748580098152161,
      0.7793721556663513,
      -0.15424327552318573,
      -0.12443796545267105,
      0.1678885668516159,
      0.7567340731620789,
      -0.32138755917549133,
      0.005434364080429077,
      -0.798583984375,
      0.25227412581443787,
      -0.5796440839767456,
      -0.922208309173584,
      -0.3717408776283264,
      1.0972872972488403,
      0.3479992747306824,
      0.6958862543106079,
      0.52555912733078,
      -0.28591012954711914,
      1.594048261642456,
      -0.023599056527018547,
      -0.7032262682914734,
      -0.3902991712093353,
      0.3252914547920227,
      -0.6776215434074402,
      0.581689715385437,
      -0.051542896777391434,
      0.24367384612560272,
      0.31966859102249146,
      -0.7885782718658447,
      -0.9535428285598755,
      -0.03941526263952255,
      -0.010244700126349926,
      -0.02995462343096733,
      -0.5636134147644043,
      -0.7457985877990723,
      0.11403143405914307,
      0.5787636637687683,
      0.05894444137811661,
      0.8285683393478394,
      0.9920663833618164,
      -0.5360025763511658,
      0.4219489097595215,
      -0.1124759241938591,
      -0.10924191027879715,
      -0.945768415927887,
      -0.6472983360290527,
      -0.7654614448547363,
      -0.14990289509296417,
      -0.4796310067176819,
      0.05308758467435837,
      0.03427150472998619,
      0.12413399666547775,
      0.442950040102005,
      -0.06987250596284866,
      0.04364484176039696,
      -0.40293318033218384,
      -0.27827802300453186,
      0.5061348080635071,
      0.04963002726435661,
      0.5348399877548218,
      1.07068932056427,
      0.034585606306791306,
      0.0441182404756546,
      -0.33636507391929626,
      0.5807797312736511,
      1.0484291315078735,
      0.6024796366691589,
      0.0934344157576561,
      -0.24905352294445038,
      -0.20776577293872833,
      -0.13528139889240265,
      -0.0023027723655104637,
      -0.13372643291950226,
      -0.13122855126857758,
      -1.3501017093658447,
      -0.004542342387139797,
      -0.19761095941066742,
      0.2937510311603546,
      -0.5174998044967651,
      0.5803136825561523,
      -0.2957945168018341,
      -0.08372233808040619,
      0.5270018577575684,
      -1.0816015005111694,
      0.2771763503551483,
      -0.8413662314414978,
      -0.07889364659786224,
      -0.39073944091796875,
      -0.4031713008880615,
      0.7736055850982666,
      0.1902485191822052,
      0.12457994371652603,
      0.47263360023498535,
      -0.1083524152636528,
      0.5295918583869934,
      0.1397111564874649,
      0.5718359351158142,
      -0.6443296074867249,
      -0.4722789525985718,
      -0.05601801723241806,
      -0.31041219830513,
      0.3764074146747589,
      0.36939072608947754,
      1.0445646047592163,
      0.10379702597856522,
      -0.16873647272586823,
      0.8053036332130432,
      -0.5464532971382141,
      -0.41799479722976685,
      0.27591750025749207,
      -1.7031810283660889,
      -1.0753424167633057,
      0.49238136410713196,
      0.6983997821807861,
      0.021284671500325203,
      0.26722976565361023,
      0.02295871078968048,
      -0.9588388800621033,
      0.06960466504096985,
      -0.06398056447505951,
      0.25213614106178284,
      -0.4777314364910126,
      0.330466091632843,
      0.10398052632808685,
      0.9884235858917236,
      0.2011561542749405,
      -0.29568082094192505,
      -0.3878357410430908,
      -0.29475635290145874,
      0.5201845765113831,
      1.116698980331421,
      0.2946048974990845,
      0.9889281988143921,
      -0.026831751689314842,
      0.06506173312664032,
      -0.40247297286987305,
      -0.3736688494682312,
      0.1236313134431839,
      -0.45065927505493164,
      0.3084224760532379,
      -0.6148726344108582,
      0.04432523623108864,
      -1.1748217344284058,
      0.5861841440200806,
      0.5422750115394592,
      -0.6698266863822937,
      -0.3417978882789612,
      -0.2088402509689331,
      0.4578416645526886,
      0.21900574862957,
      0.46067237854003906,
      -0.9848700165748596,
      -0.717092752456665,
      0.8110605478286743,
      -0.49486812949180603,
      -0.10956470668315887,
      -0.8777108192443848,
      -0.2957638204097748,
      0.4821995198726654,
      -1.1576753854751587,
      0.8014801740646362,
      0.4473283588886261,
      -0.5267464518547058,
      0.623063325881958,
      -1.0211843252182007,
      -0.3880164921283722,
      -0.05862347036600113,
      -0.1712818145751953,
      0.09049489349126816,
      -0.04765214025974274,
      -0.8536946177482605,
      -0.09044446796178818,
      0.3327685296535492,
      0.5952956080436707,
      0.13273285329341888,
      1.0521390438079834,
      -0.16044674813747406,
      -1.36281156539917,
      0.8807153701782227,
      0.06037360802292824,
      1.1189006567001343,
      0.7150535583496094,
      -1.2313982248306274,
      -0.5063353180885315,
      -0.2693740427494049,
      0.3580847978591919,
      -0.16130226850509644,
      -0.31119367480278015,
      0.6542398929595947,
      0.3043983578681946,
      0.5123977661132812,
      1.3024653196334839,
      0.4710308015346527,
      -1.4179047346115112,
      -0.1798705905675888,
      0.5557836890220642,
      0.22171908617019653,
      -0.14263971149921417,
      -0.48913300037384033,
      0.47518450021743774,
      0.2702363133430481,
      0.8468661308288574,
      -0.13227662444114685,
      0.767139732837677,
      0.5571249127388,
      0.04618518054485321,
      -0.45882976055145264,
      -0.6233429908752441,
      0.4253508150577545,
      0.7011592984199524,
      1.0621001720428467,
      -0.4740297496318817,
      -1.533291220664978,
      1.6002800464630127,
      0.5335779190063477,
      -0.12819913029670715,
      0.31860119104385376,
      0.2591312527656555,
      1.4916892051696777,
      -0.31202003359794617,
      0.27647095918655396,
      0.053292471915483475,
      0.33236467838287354,
      0.9014442563056946,
      -0.3230908513069153,
      0.4090592861175537,
      -1.473475694656372,
      0.1963689774274826,
      -0.7922634482383728,
      -1.1067537069320679,
      -0.17430710792541504,
      -0.5317460894584656,
      0.20743368566036224,
      1.0214293003082275,
      -0.34962040185928345,
      -0.3701532185077667,
      0.7281264662742615,
      -0.6307576298713684,
      -0.015839211642742157,
      0.40037864446640015,
      0.34425070881843567,
      -0.18330788612365723,
      0.1925709843635559,
      0.8414595127105713,
      -0.3324402868747711,
      -1.5670582056045532,
      -0.1698828488588333,
      -0.21896231174468994,
      0.1805688887834549,
      1.3677159547805786,
      0.4071555435657501,
      0.18966826796531677,
      0.8774932622909546,
      -0.11153684556484222,
      0.5645806789398193,
      -0.49232369661331177,
      -0.6611525416374207,
      -0.26552411913871765,
      -0.41108381748199463,
      -0.14621780812740326,
      -0.577431321144104,
      0.7581900358200073,
      0.4190657436847687,
      0.28692713379859924,
      -0.8230687975883484,
      0.13892145454883575,
      -0.15590213239192963,
      -0.0016839096788316965,
      0.47780323028564453,
      0.32623714208602905,
      1.00237238407135,
      -0.5718483328819275,
      -0.2572864890098572,
      -0.40752923488616943,
      0.5320013165473938,
      0.2627836763858795,
      0.904237687587738,
      0.3141166865825653,
      0.11733812093734741,
      -1.0759245157241821,
      0.6038399338722229,
      0.025800926610827446,
      -0.5808790326118469,
      0.09795935451984406,
      0.02196296490728855,
      -0.8560177683830261,
      0.14415812492370605,
      -1.2589852809906006,
      -0.47385525703430176,
      0.21250908076763153,
      0.5147882103919983,
      -1.5135105848312378,
      0.5303617715835571,
      0.09539665281772614,
      0.8240930438041687,
      0.16589857637882233,
      -1.5827929973602295,
      -0.05881139636039734,
      0.49665576219558716,
      -0.29085636138916016,
      -0.6346781849861145,
      0.7559963464736938,
      -0.26823246479034424,
      -0.6533940434455872,
      -0.06552790105342865,
      0.518488347530365,
      -0.27662381529808044,
      -0.7197743654251099,
      -0.6729878783226013,
      0.2013506293296814,
      0.2959670424461365,
      0.49450695514678955,
      0.3032207489013672,
      -0.9951833486557007,
      0.4499933123588562,
      -0.6630924940109253,
      -0.13704834878444672,
      -0.9269809722900391,
      0.20729213953018188,
      -0.36556023359298706,
      -0.4496389329433441,
      -0.1685846447944641,
      -1.2023521661758423,
      -1.1415607929229736,
      -1.0604701042175293,
      -0.07251812517642975,
      1.1245208978652954,
      -0.24519211053848267,
      -0.4954649806022644,
      0.1086830273270607,
      -1.0230108499526978,
      0.6070041060447693,
      0.38341304659843445,
      0.4999229609966278,
      0.152419313788414,
      -1.0857876539230347,
      0.5200311541557312,
      0.33772704005241394,
      -0.6759586334228516,
      -0.3435799181461334,
      1.111202597618103,
      0.053207989782094955,
      -0.667233943939209,
      -0.749601423740387,
      0.4774680733680725,
      -1.3170565366744995,
      -0.07191994786262512,
      1.0985230207443237,
      -0.5615139603614807,
      0.4272960424423218,
      0.4256860911846161,
      -0.5870996117591858,
      0.6384832859039307,
      0.09990684688091278,
      -0.5929653644561768,
      -0.2367076873779297,
      0.49043044447898865,
      -1.252825379371643,
      -0.3399488925933838,
      -0.15301188826560974,
      -0.1424361616373062,
      -0.09618936479091644,
      -0.4358268976211548,
      -1.4035391807556152,
      0.07097738981246948,
      0.7040570378303528,
      1.1077251434326172,
      -0.847456693649292,
      0.1187347024679184,
      0.8172329068183899,
      -0.4812792241573334,
      0.20765429735183716,
      -0.6040579080581665,
      0.48341643810272217,
      0.8044627904891968,
      0.33200904726982117,
      0.015324761159718037,
      0.6851353645324707,
      0.440644770860672,
      -0.8535774350166321,
      1.0808820724487305,
      0.20910599827766418,
      -1.3503570556640625,
      -0.31784990429878235,
      -0.4784500300884247,
      -0.464369535446167,
      0.9620229601860046,
      -1.0083140134811401,
      0.11856226623058319,
      -0.9029238820075989,
      -0.6745800971984863,
      0.3534342050552368,
      0.4500831067562103,
      0.20916660130023956,
      -1.7663443088531494,
      -0.06275957077741623,
      -1.7812737226486206,
      -0.5862278342247009,
      -1.4431334733963013,
      1.1180946826934814,
      -0.2665984034538269,
      0.652186930179596,
      0.8170949220657349,
      1.0542902946472168,
      0.31428271532058716,
      -0.37749993801116943,
      -0.7119490504264832,
      0.518543541431427,
      -0.0776628851890564,
      -0.7617284655570984,
      0.31154897809028625,
      0.8745099306106567,
      0.3370882272720337,
      -0.42750003933906555,
      1.9363868236541748,
      1.395934820175171,
      0.007297027390450239,
      -0.36823129653930664,
      0.4700829088687897,
      -0.4615574777126312,
      -0.3244839310646057,
      -0.24366316199302673,
      -0.7407009601593018,
      -1.0409539937973022,
      -0.025031499564647675,
      -0.3737655580043793,
      -0.15626023709774017,
      0.16626422107219696,
      0.6271844506263733,
      0.2760920226573944,
      -0.19782346487045288,
      0.038683608174324036,
      -0.02709604986011982,
      -0.9884781837463379,
      0.30048462748527527,
      0.798464834690094,
      0.3476121723651886,
      0.2555999457836151,
      0.33143123984336853,
      0.18720844388008118,
      0.8328863382339478,
      0.7051439881324768,
      0.07745826989412308,
      -0.33299174904823303,
      0.7142762541770935,
      -0.5805850028991699,
      0.2217618227005005,
      0.010089434683322906,
      0.6652267575263977,
      -0.9882670044898987,
      0.4472319781780243,
      -1.2489521503448486,
      0.4190507233142853,
      0.1833595335483551,
      -0.414717435836792,
      -0.521092414855957,
      -0.22515375912189484,
      -0.4369766414165497,
      -0.8354359269142151,
      0.4799633324146271,
      -0.27316826581954956,
      -0.5259400606155396,
      0.37797021865844727,
      0.14605173468589783,
      0.18380144238471985,
      -0.24912060797214508,
      -0.09791676700115204,
      0.25780317187309265,
      -0.21819834411144257,
      0.00337013928219676,
      0.5490593910217285,
      0.015467183664441109,
      -0.14239056408405304,
      -0.2846969664096832,
      -0.18349076807498932,
      0.1358245313167572,
      -1.0119450092315674,
      1.133095622062683,
      0.18888305127620697,
      1.1732152700424194,
      0.8668498992919922,
      -0.8359490633010864,
      -1.0045019388198853,
      -0.37767544388771057,
      -0.28749290108680725,
      -0.0340389721095562,
      -0.8763562440872192,
      0.39449432492256165,
      -0.7875894904136658,
      -0.9769399762153625,
      0.020494114607572556,
      0.25227463245391846,
      -0.506072998046875,
      0.009635881520807743,
      -0.9584584832191467,
      0.16018183529376984,
      -1.6371257305145264,
      0.8990965485572815,
      -0.39856481552124023,
      0.5337246656417847,
      -0.5163012146949768,
      -0.4037715196609497,
      -1.1015841960906982,
      -0.04957866668701172,
      -0.8836949467658997,
      1.0729130506515503,
      0.7778186202049255,
      0.08812941610813141,
      -0.13310642540454865,
      -0.865697979927063,
      -0.7809042930603027,
      1.5359368324279785,
      0.35780179500579834,
      0.11300965398550034,
      -0.9374171495437622,
      -0.445318341255188,
      -0.2442602813243866,
      1.089991569519043,
      -0.686936616897583,
      0.5037539005279541,
      -0.09460064023733139,
      1.0618895292282104,
      1.273630142211914,
      -0.2156502604484558,
      0.11855242401361465,
      -0.9993822574615479,
      0.8292546272277832,
      0.8349191546440125,
      0.11363731324672699,
      -0.49144601821899414,
      -0.3227454721927643,
      -0.2116829752922058
    ],
    "label": {
      "level1": "SAM",
      "level2": "DT",
      "level3": "MT",
      "leafContractCategory": "MT",
      "rootCause": "Unacceptable Input Type",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Train",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/46464549",
    "title": "",
    "question": "\"In Keras (with Tensorflow backend), is the current input pattern available to my custom loss function?\n\nThe current input pattern is defined as the input vector used to produce the prediction. For example, consider the following: X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42, shuffle=False). Then the current input pattern is the current X_train vector associated with the y_train (which is termed y_true in the loss function).\n\nWhen designing a custom loss function, I intend to optimize/minimize a value that requires access to the current input pattern, not just the current prediction.\n\nI've taken a look through https://github.com/fchollet/keras/blob/master/keras/losses.py\n\nI've also looked through \"\"Cost function that isn't just y_pred, y_true?\"\"\n\nI am also familiar with previous examples to produce a customized loss function:\n\nimport keras.backend as K\n\ndef customLoss(y_true,y_pred):\n    return K.sum(K.log(y_true) - K.log(y_pred))\n\nPresumably (y_true,y_pred) are defined elsewhere. I've taken a look through the source code without success and I'm wondering whether I need to define the current input pattern myself or whether this is already accessible to my loss function.\"",
    "answer": "\"You can wrap the loss function as a inner function and pass your input tensor to it (as commonly done when passing additional arguments to the loss function).\n\ndef custom_loss_wrapper(input_tensor):\n    def custom_loss(y_true, y_pred):\n        return K.binary_crossentropy(y_true, y_pred) + K.mean(input_tensor)\n    return custom_loss\n\ninput_tensor = Input(shape=(10,))\nhidden = Dense(100, activation='relu')(input_tensor)\nout = Dense(1, activation='sigmoid')(hidden)\nmodel = Model(input_tensor, out)\nmodel.compile(loss=custom_loss_wrapper(input_tensor), optimizer='adam')\n\nYou can verify that input_tensor and the loss value (mostly, the K.mean(input_tensor) part) will change as different X is passed to the model.\n\nX = np.random.rand(1000, 10)\ny = np.random.randint(2, size=1000)\nmodel.test_on_batch(X, y)  # => 1.1974642\n\nX *= 1000\nmodel.test_on_batch(X, y)  # => 511.15466\"",
    "mlApiName": "keras.models.compile",
    "embedding": [
      -0.1389470100402832,
      -0.2579469084739685,
      -2.4331624507904053,
      -1.7425328493118286,
      1.1046385765075684,
      -0.5961127877235413,
      0.7506086230278015,
      0.4173266589641571,
      -0.7460574507713318,
      -1.3637182712554932,
      -0.7220954298973083,
      0.8143467307090759,
      2.1405575275421143,
      0.07292545586824417,
      -0.550770103931427,
      -0.16383570432662964,
      0.5588580965995789,
      0.042084842920303345,
      0.32141363620758057,
      1.206620216369629,
      0.2942155599594116,
      -0.9391406178474426,
      -0.7710862159729004,
      0.6815634369850159,
      1.4560149908065796,
      0.23305058479309082,
      -0.017092416062951088,
      0.29462119936943054,
      -0.3351248800754547,
      0.40197259187698364,
      1.0279476642608643,
      -1.0598926544189453,
      0.666467010974884,
      -1.1707971096038818,
      -2.301551342010498,
      -0.9679076075553894,
      0.943001389503479,
      -0.11454924196004868,
      0.3662748336791992,
      0.1378762573003769,
      0.3818225562572479,
      0.7861426472663879,
      -0.0864727571606636,
      0.38166582584381104,
      0.7056887745857239,
      0.16674712300300598,
      1.4290298223495483,
      -0.411507785320282,
      -0.3543965220451355,
      -1.1802390813827515,
      0.23247960209846497,
      0.6025280952453613,
      -0.1444946974515915,
      -0.4305713474750519,
      1.5154871940612793,
      0.29906147718429565,
      0.29475137591362,
      0.6849898099899292,
      0.6918889880180359,
      -1.006821870803833,
      0.6019834876060486,
      1.5929453372955322,
      -1.2120802402496338,
      0.6004098057746887,
      0.059599827975034714,
      -0.9584131240844727,
      -1.4898760318756104,
      0.8705989718437195,
      -0.9239682555198669,
      0.12498423457145691,
      0.29808297753334045,
      0.825076162815094,
      -0.020970972254872322,
      -0.13760340213775635,
      -0.166984423995018,
      0.8051794171333313,
      -0.11932262778282166,
      -0.30201390385627747,
      0.022224165499210358,
      0.4500044286251068,
      -0.48918506503105164,
      0.8226318359375,
      1.3092949390411377,
      -0.21236717700958252,
      0.6127827763557434,
      0.2604145109653473,
      -0.5139350891113281,
      -0.12419546395540237,
      -0.18209822475910187,
      1.3451851606369019,
      -0.006548718083649874,
      -0.46255576610565186,
      1.163370966911316,
      0.48245176672935486,
      -0.4665026366710663,
      -0.4760870933532715,
      -0.8340221047401428,
      -0.10429982095956802,
      -0.17491109669208527,
      -0.27593323588371277,
      0.1454598307609558,
      -0.313015341758728,
      -0.9642335176467896,
      -0.9897894263267517,
      -0.8946245908737183,
      1.1423876285552979,
      0.5288549065589905,
      -0.38194167613983154,
      0.6391733288764954,
      -0.4144805073738098,
      -0.3728688657283783,
      0.1610264927148819,
      -0.3981694281101227,
      0.2734549045562744,
      -0.30408284068107605,
      -0.6344887018203735,
      0.2826874852180481,
      -0.8027909398078918,
      -0.047341082245111465,
      1.0233343839645386,
      -0.6439674496650696,
      -0.3262943625450134,
      0.5749503374099731,
      0.130120649933815,
      -0.20657537877559662,
      1.6969419717788696,
      -0.9075368642807007,
      0.042189326137304306,
      -0.12397497892379761,
      -0.9045498967170715,
      -0.5626454949378967,
      -1.1318771839141846,
      -0.055794890969991684,
      0.3267129063606262,
      1.1307806968688965,
      0.7730621695518494,
      -0.25541794300079346,
      -0.6196568012237549,
      0.33412203192710876,
      0.629810631275177,
      0.9263195395469666,
      -0.10827817767858505,
      -0.32496586441993713,
      -1.1055783033370972,
      -0.0648977980017662,
      -0.690596878528595,
      0.7173928022384644,
      -0.47563883662223816,
      -0.6640729308128357,
      -0.14840224385261536,
      0.3589199185371399,
      0.6687660217285156,
      -1.0295448303222656,
      0.12122111767530441,
      0.7285711169242859,
      -1.1696213483810425,
      0.047328848391771317,
      0.3618513345718384,
      0.19293025135993958,
      -0.6961804628372192,
      0.9535959959030151,
      0.06189379096031189,
      -0.1112414225935936,
      0.9866457581520081,
      -0.7512031197547913,
      -1.6508750915527344,
      0.46851059794425964,
      0.28938210010528564,
      0.018849389627575874,
      -0.21537986397743225,
      -0.45701900124549866,
      -0.5399239659309387,
      0.44372883439064026,
      -0.005498918239027262,
      0.32647302746772766,
      0.6493793725967407,
      1.2831748723983765,
      -0.7328494787216187,
      1.0065624713897705,
      -0.5808804035186768,
      0.24094609916210175,
      -0.1185479536652565,
      0.9425898790359497,
      -0.22854451835155487,
      -0.566510021686554,
      0.38078972697257996,
      -0.052681151777505875,
      0.2573009729385376,
      0.24978937208652496,
      -0.7640830874443054,
      0.44322821497917175,
      0.452437162399292,
      -0.9233145117759705,
      -0.4143877327442169,
      0.3013809621334076,
      0.04018881916999817,
      0.4877806305885315,
      -0.35886406898498535,
      0.6069405674934387,
      0.534816563129425,
      0.16949696838855743,
      1.0234841108322144,
      -0.37938135862350464,
      0.7396741509437561,
      -0.2574034035205841,
      0.4380897879600525,
      0.4844297468662262,
      0.48361650109291077,
      0.04085130617022514,
      0.015155217610299587,
      0.7760180830955505,
      -0.18559421598911285,
      0.11876332759857178,
      1.2401689291000366,
      0.27454009652137756,
      -0.47275635600090027,
      0.14110052585601807,
      0.3183545172214508,
      -0.5133165717124939,
      -0.16185437142848969,
      0.5357108116149902,
      -1.042638897895813,
      0.9593627452850342,
      0.6449486613273621,
      -0.3597656190395355,
      -0.39194735884666443,
      -0.8624681830406189,
      -0.5573264360427856,
      -1.398529291152954,
      -0.30656149983406067,
      -0.8917975425720215,
      -1.2308876514434814,
      0.562082052230835,
      0.4017496705055237,
      -0.021186701953411102,
      1.1148074865341187,
      0.8843969106674194,
      1.0449855327606201,
      -0.1185385063290596,
      -0.17453038692474365,
      0.1327526867389679,
      0.5056582093238831,
      0.798892080783844,
      1.0160231590270996,
      -1.2261511087417603,
      0.30916035175323486,
      -0.5209169387817383,
      -0.5644532442092896,
      0.23303361237049103,
      1.119168758392334,
      -0.39143460988998413,
      1.1263072490692139,
      0.5944608449935913,
      0.2616051137447357,
      0.7994139790534973,
      -0.8192237615585327,
      -0.2940596044063568,
      -0.6528587341308594,
      0.38347727060317993,
      -0.015115783549845219,
      0.3468126058578491,
      0.38453584909439087,
      -0.13015708327293396,
      0.10198875516653061,
      -0.9259585738182068,
      -0.7761948108673096,
      0.18471133708953857,
      -0.12099971622228622,
      -0.17100445926189423,
      -0.39704927802085876,
      -0.453622043132782,
      -0.19243687391281128,
      0.8332898020744324,
      0.7969589829444885,
      0.8325501084327698,
      0.8322359323501587,
      -0.31436291337013245,
      -0.3706447184085846,
      -0.04859655722975731,
      0.20841611921787262,
      0.11834724992513657,
      -0.9367371201515198,
      -1.1685186624526978,
      0.25238198041915894,
      -0.8545987606048584,
      0.24275262653827667,
      -0.14905793964862823,
      1.0965255498886108,
      -0.2568371593952179,
      0.9195398092269897,
      -0.24339993298053741,
      0.5129256248474121,
      0.22722694277763367,
      -0.18761716783046722,
      -0.28524601459503174,
      0.10434647649526596,
      1.0544153451919556,
      -0.23915418982505798,
      -0.4773756265640259,
      -0.5486776232719421,
      0.3939934968948364,
      1.0149887800216675,
      0.41607481241226196,
      -0.1985008269548416,
      0.3075304925441742,
      -0.47390544414520264,
      -0.5442563891410828,
      0.2997029721736908,
      0.3244175612926483,
      -0.056918565183877945,
      -0.18956251442432404,
      -0.10868122428655624,
      -0.18986348807811737,
      0.4529009759426117,
      -0.9335561990737915,
      0.4944848418235779,
      0.7049646973609924,
      0.6475685238838196,
      -0.10929764062166214,
      -0.10632117092609406,
      0.5484580397605896,
      -0.4424387216567993,
      0.06126920133829117,
      -0.022833118215203285,
      0.026292724534869194,
      0.8701454401016235,
      -0.630760133266449,
      -0.18313159048557281,
      0.7754977941513062,
      -0.6064811944961548,
      0.29635727405548096,
      0.6720609068870544,
      -0.05981392040848732,
      -1.055267333984375,
      -0.9241737127304077,
      0.05373898148536682,
      0.11919016391038895,
      0.09249631315469742,
      -0.49411189556121826,
      1.0190173387527466,
      0.22128912806510925,
      -0.24249911308288574,
      1.150123119354248,
      -1.093224287033081,
      -0.5534578561782837,
      -0.020086584612727165,
      -1.4790928363800049,
      -0.055227942764759064,
      0.6065185070037842,
      -0.36278969049453735,
      -0.29762697219848633,
      -0.009750226512551308,
      0.02783246897161007,
      0.19057337939739227,
      -0.12885631620883942,
      0.2822013795375824,
      0.8834388852119446,
      -0.14735789597034454,
      0.13346847891807556,
      1.017108678817749,
      0.9806758165359497,
      -0.27995550632476807,
      0.37027016282081604,
      -0.11040174961090088,
      0.2727888226509094,
      0.11440599709749222,
      0.9132458567619324,
      -0.19383485615253448,
      0.2727001905441284,
      -0.6787170171737671,
      -0.2070809155702591,
      0.4028705060482025,
      -0.0710936114192009,
      1.0135798454284668,
      -0.6790011525154114,
      -0.6152007579803467,
      -0.9093247652053833,
      0.5086309313774109,
      -0.8910723924636841,
      0.9695265293121338,
      0.20340988039970398,
      -0.09086402505636215,
      -0.025393541902303696,
      0.1333419680595398,
      0.8563408255577087,
      0.793490469455719,
      0.36466675996780396,
      -0.3792990744113922,
      0.4258453845977783,
      1.419297456741333,
      -0.01170306745916605,
      -0.5138053297996521,
      -0.7433785796165466,
      -0.6384448409080505,
      0.36573243141174316,
      -0.5385190844535828,
      0.2664649784564972,
      0.21252374351024628,
      0.07238425314426422,
      0.5277059674263,
      -1.5267096757888794,
      -0.4340045154094696,
      0.46253538131713867,
      -0.8463042974472046,
      0.3089089095592499,
      -0.6184301376342773,
      -0.4275422692298889,
      -0.637956976890564,
      0.2809295952320099,
      -0.6240047812461853,
      0.30431604385375977,
      0.21635214984416962,
      -0.06308145821094513,
      -1.479447603225708,
      1.0600664615631104,
      0.312592476606369,
      0.23285351693630219,
      0.739267885684967,
      0.012473943643271923,
      -0.8629730939865112,
      0.02254367806017399,
      0.5928201079368591,
      -0.20687256753444672,
      0.7525057196617126,
      0.5900347232818604,
      0.23407305777072906,
      0.6672109365463257,
      1.0146751403808594,
      0.7297341227531433,
      -2.0140764713287354,
      0.357184499502182,
      0.6759355664253235,
      0.7913878560066223,
      -0.5420930981636047,
      -0.625515878200531,
      -0.20845547318458557,
      -0.403749942779541,
      0.16274698078632355,
      -0.6230950355529785,
      1.2836798429489136,
      0.7086930274963379,
      -0.3908596932888031,
      -0.8680323362350464,
      -0.8657970428466797,
      0.11296939849853516,
      0.35683491826057434,
      1.3458049297332764,
      -0.4186736047267914,
      -0.8923505544662476,
      1.2646205425262451,
      -0.46505770087242126,
      -0.014422501437366009,
      0.062084782868623734,
      0.35718485713005066,
      1.404449224472046,
      -0.6035435199737549,
      0.08026804029941559,
      -0.1521400660276413,
      0.06788420677185059,
      0.5388969779014587,
      -0.20390631258487701,
      0.7183839082717896,
      -0.9661720991134644,
      0.13776132464408875,
      0.17108246684074402,
      -1.2385456562042236,
      0.1740313321352005,
      -0.5701369643211365,
      0.7814972996711731,
      0.6458756923675537,
      -0.5331518054008484,
      -0.1002151295542717,
      0.46298736333847046,
      -0.31312158703804016,
      -0.5300976037979126,
      0.15170226991176605,
      0.16438601911067963,
      -0.14892703294754028,
      0.6937873363494873,
      0.8685709834098816,
      -0.3761703670024872,
      -1.1413508653640747,
      -0.8918278813362122,
      -0.01835201494395733,
      -0.1701548546552658,
      1.5532097816467285,
      0.6401724815368652,
      -0.17831267416477203,
      -0.2328127771615982,
      0.15614336729049683,
      0.9262179732322693,
      0.528955340385437,
      0.06902068108320236,
      -0.17493021488189697,
      -0.2123328447341919,
      -0.191269651055336,
      0.014012298546731472,
      0.520057201385498,
      -0.7257391214370728,
      0.08060570806264877,
      0.2689139246940613,
      -0.07169888913631439,
      -0.39900481700897217,
      -0.2658580541610718,
      0.4237822890281677,
      0.0988750159740448,
      0.8941336274147034,
      -1.0723145008087158,
      -0.5126104950904846,
      -0.38662341237068176,
      0.32437217235565186,
      0.20195913314819336,
      -0.17409704625606537,
      -0.04729492589831352,
      -0.042876917868852615,
      -0.9838370084762573,
      0.6807942390441895,
      0.6456063389778137,
      -0.599665641784668,
      -0.18260444700717926,
      0.25968822836875916,
      -0.28795957565307617,
      -0.1230451688170433,
      -0.11059341579675674,
      -1.2830909490585327,
      -0.02468658611178398,
      0.31571877002716064,
      -1.0807558298110962,
      0.14020989835262299,
      -0.2117219865322113,
      0.02772344835102558,
      0.09436235576868057,
      -1.4800069332122803,
      0.49797070026397705,
      -0.43393951654434204,
      -0.3699083626270294,
      -0.6243525743484497,
      0.7871216535568237,
      0.261690229177475,
      -0.4739029109477997,
      0.378664493560791,
      1.3962057828903198,
      -0.3010365962982178,
      -0.13043832778930664,
      -0.27688294649124146,
      0.49967604875564575,
      -0.049814172089099884,
      0.4670598804950714,
      0.24784021079540253,
      -2.0534374713897705,
      0.043609097599983215,
      -0.2896161675453186,
      0.32154086232185364,
      -0.9805378317832947,
      -0.16936850547790527,
      -0.5499014854431152,
      -0.8213695287704468,
      -0.8250017762184143,
      0.1808096319437027,
      -0.24593965709209442,
      -0.5434447526931763,
      0.4188954830169678,
      1.2516824007034302,
      -0.08250878751277924,
      0.12198982387781143,
      -0.32934287190437317,
      -0.17939932644367218,
      0.27281495928764343,
      0.5425869226455688,
      0.7104666829109192,
      -0.10680331289768219,
      -1.7618457078933716,
      0.22917000949382782,
      0.4657602310180664,
      -0.3933970630168915,
      0.29822105169296265,
      0.27191323041915894,
      0.043782468885183334,
      -0.7785199880599976,
      -0.35135844349861145,
      0.1277056485414505,
      -1.3748470544815063,
      0.7281999588012695,
      0.39520540833473206,
      0.7071833610534668,
      0.7523378133773804,
      0.09516622126102448,
      -0.7417447566986084,
      -0.20558792352676392,
      0.33118194341659546,
      -1.3939170837402344,
      -0.16795025765895844,
      1.4033697843551636,
      -0.22123640775680542,
      0.35150015354156494,
      0.5090184211730957,
      -1.1620211601257324,
      0.5843145847320557,
      -0.0892753154039383,
      -1.3424257040023804,
      -0.39307019114494324,
      0.6144819855690002,
      1.3251724243164062,
      -1.587592363357544,
      0.3708822727203369,
      1.691715955734253,
      -0.4416143596172333,
      0.6564909219741821,
      -0.26255571842193604,
      0.26964864134788513,
      0.5630157589912415,
      -0.3098151683807373,
      0.1573934108018875,
      -0.24290870130062103,
      0.5593907237052917,
      -1.2158395051956177,
      0.7499298453330994,
      0.2670966386795044,
      -1.1706544160842896,
      0.022927721962332726,
      -0.25154805183410645,
      -0.698843777179718,
      0.567480742931366,
      -0.7596244215965271,
      0.30847272276878357,
      0.06457971781492233,
      -0.8396943807601929,
      -0.5109038352966309,
      0.5116453170776367,
      0.5946657657623291,
      -1.3901293277740479,
      0.009776665829122066,
      -1.2546823024749756,
      -0.32298022508621216,
      -0.6658585071563721,
      1.6293208599090576,
      -0.11553367227315903,
      0.8151850700378418,
      1.3542544841766357,
      0.11422044783830643,
      0.4966229498386383,
      0.42992472648620605,
      -0.8047431111335754,
      0.40879708528518677,
      -0.784972071647644,
      -0.37114855647087097,
      1.3550394773483276,
      0.930437445640564,
      0.35490262508392334,
      -0.3769010901451111,
      1.7626343965530396,
      0.9053386449813843,
      -0.2686094045639038,
      -0.6927019953727722,
      0.518161416053772,
      -0.2623373568058014,
      0.23747311532497406,
      -1.163468837738037,
      -0.8702333569526672,
      -0.24681882560253143,
      0.4612013101577759,
      -0.9247827529907227,
      -0.7472148537635803,
      -0.31742700934410095,
      1.3515501022338867,
      0.29048803448677063,
      -0.1449560970067978,
      -0.5152960419654846,
      -0.261015385389328,
      -0.8309990763664246,
      0.4307187497615814,
      0.2449474036693573,
      -0.4171885848045349,
      1.183633804321289,
      0.7235016226768494,
      -0.3779893219470978,
      1.1487871408462524,
      0.9577145576477051,
      -0.43497541546821594,
      -0.4251495599746704,
      1.0206403732299805,
      -0.2190454602241516,
      0.30833783745765686,
      0.5613596439361572,
      -0.07112805545330048,
      -1.0866338014602661,
      -0.18097658455371857,
      -1.2749412059783936,
      -0.1974877417087555,
      0.028041349723935127,
      -0.7928698658943176,
      0.5428147315979004,
      0.5711126923561096,
      -0.6878604888916016,
      -0.1314200758934021,
      0.7001678347587585,
      0.3195776641368866,
      -0.8939862847328186,
      0.4838329255580902,
      1.4104162454605103,
      0.4433463215827942,
      0.873149037361145,
      0.3505686819553375,
      0.20186619460582733,
      0.693142831325531,
      -0.18780142068862915,
      0.17874900996685028,
      -0.35389795899391174,
      -0.6834745407104492,
      0.03465323522686958,
      0.07651253044605255,
      -0.05937286093831062,
      -0.9039548635482788,
      1.0592436790466309,
      -0.7273203730583191,
      1.3300541639328003,
      0.019578641280531883,
      -1.020959734916687,
      -0.5599871277809143,
      -0.3536277711391449,
      0.08660409599542618,
      -0.2520211338996887,
      -1.2420964241027832,
      0.8275019526481628,
      -0.5965690016746521,
      -0.4960918724536896,
      0.1268821805715561,
      0.6193713545799255,
      -0.814376711845398,
      -0.5720629096031189,
      -1.311098337173462,
      -0.452147513628006,
      -0.829139769077301,
      0.752557098865509,
      -0.7069997191429138,
      0.28220802545547485,
      -1.2101960182189941,
      -0.45457378029823303,
      -0.6613303422927856,
      0.1924397498369217,
      -1.2238563299179077,
      -0.21892079710960388,
      -0.057347625494003296,
      -0.038537267595529556,
      -0.6668131351470947,
      -0.11137623339891434,
      -0.5364455580711365,
      0.8690429329872131,
      -0.02561272121965885,
      -0.11143910884857178,
      0.223861426115036,
      -0.35418298840522766,
      -0.7022764086723328,
      0.03529060259461403,
      0.03860485553741455,
      -0.03464672341942787,
      0.22614751756191254,
      0.7028933167457581,
      1.2999439239501953,
      0.48604509234428406,
      0.30497437715530396,
      -0.6974996328353882,
      -0.10256925225257874,
      0.3962962031364441,
      -0.22931858897209167,
      -0.7910180687904358,
      0.283368855714798,
      -0.3284412622451782
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Unknown",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/50304156",
    "title": "",
    "question": "\"Using ResNet50 pre-trained Weights I am trying to build a classifier. The code base is fully implemented in Keras high-level Tensorflow API. The complete code is posted in the below GitHub Link.\nSource Code: Classification Using RestNet50 Architecture\nThe file size of the pre-trained model is 94.7mb.\nI loaded the pre-trained file\nnew_model = Sequential()\n\nnew_model.add(ResNet50(include_top=False,\n                pooling='avg',\n                weights=resnet_weight_paths))\n\nand fit the model\ntrain_generator = data_generator.flow_from_directory(\n    'path_to_the_training_set',\n    target_size = (IMG_SIZE,IMG_SIZE),\n    batch_size = 12,\n    class_mode = 'categorical'\n    )\n\nvalidation_generator = data_generator.flow_from_directory(\n    'path_to_the_validation_set',\n    target_size = (IMG_SIZE,IMG_SIZE),\n    class_mode = 'categorical'\n    )\n\n#compile the model\n\nnew_model.fit_generator(\n    train_generator,\n    steps_per_epoch = 3,\n    validation_data = validation_generator,\n    validation_steps = 1\n)\n\nand in the Training dataset, I have two folders dog and cat, each holder almost 10,000 images. When  I compiled the script, I get the following error\n\nEpoch 1/1 2018-05-12 13:04:45.847298: W\ntensorflow/core/framework/allocator.cc:101] Allocation of 38535168\nexceeds 10% of system memory. 2018-05-12 13:04:46.845021: W\ntensorflow/core/framework/allocator.cc:101] Allocation of 37171200\nexceeds 10% of system memory. 2018-05-12 13:04:47.552176: W\ntensorflow/core/framework/allocator.cc:101] Allocation of 37171200\nexceeds 10% of system memory. 2018-05-12 13:04:48.199240: W\ntensorflow/core/framework/allocator.cc:101] Allocation of 37171200\nexceeds 10% of system memory. 2018-05-12 13:04:48.918930: W\ntensorflow/core/framework/allocator.cc:101] Allocation of 37171200\nexceeds 10% of system memory. 2018-05-12 13:04:49.274137: W\ntensorflow/core/framework/allocator.cc:101] Allocation of 19267584\nexceeds 10% of system memory. 2018-05-12 13:04:49.647061: W\ntensorflow/core/framework/allocator.cc:101] Allocation of 19267584\nexceeds 10% of system memory. 2018-05-12 13:04:50.028839: W\ntensorflow/core/framework/allocator.cc:101] Allocation of 19267584\nexceeds 10% of system memory. 2018-05-12 13:04:50.413735: W\ntensorflow/core/framework/allocator.cc:101] Allocation of 19267584\nexceeds 10% of system memory.\n\nAny ideas to optimize the way to load the pre-trained model (or) get rid of this warning message?\nThanks!\"",
    "answer": "\"Try reducing batch_size attribute to a small number(like 1,2 or 3).\nExample:\n\ntrain_generator = data_generator.flow_from_directory(\n    'path_to_the_training_set',\n    target_size = (IMG_SIZE,IMG_SIZE),\n    batch_size = 2,\n    class_mode = 'categorical'\n    )\"",
    "mlApiName": "keras.preprocessing.image.ImageDataGenerator.data_generator.flow_from_directory",
    "embedding": [
      0.24711614847183228,
      1.4442540407180786,
      -3.0416817665100098,
      -1.1489759683609009,
      0.7235869765281677,
      -0.2638089656829834,
      0.7195428013801575,
      1.3889318704605103,
      -1.3944138288497925,
      -1.5413652658462524,
      -0.2597633898258209,
      0.4623112380504608,
      2.3628244400024414,
      0.28034332394599915,
      -0.37620943784713745,
      -0.114869624376297,
      0.28918570280075073,
      -1.062501311302185,
      -0.05196763575077057,
      0.5066335201263428,
      -0.5388373136520386,
      0.006933541037142277,
      0.19932466745376587,
      -0.5044872164726257,
      1.11417555809021,
      -0.34916892647743225,
      -0.4315040707588196,
      0.01791510544717312,
      -0.2733026444911957,
      0.7816300392150879,
      0.9820567965507507,
      0.30821287631988525,
      -0.6071068644523621,
      -1.1442186832427979,
      -0.8642463684082031,
      -0.6228616237640381,
      0.5469873547554016,
      -0.2627093195915222,
      0.6810551881790161,
      0.08141481131315231,
      0.8233212232589722,
      -0.11936333775520325,
      0.5073209404945374,
      -0.33117514848709106,
      -0.8106664419174194,
      -0.05553709715604782,
      1.270051121711731,
      0.27576982975006104,
      0.3218727707862854,
      -0.2103346288204193,
      0.4893801808357239,
      0.4297439157962799,
      -0.27631738781929016,
      0.6525388956069946,
      0.8011381030082703,
      1.3118507862091064,
      -0.3336900770664215,
      -0.19648624956607819,
      0.09512263536453247,
      -1.70917546749115,
      0.40885770320892334,
      1.170082926750183,
      -1.0480577945709229,
      1.1260298490524292,
      -0.10272717475891113,
      -0.3255116641521454,
      -1.2754448652267456,
      0.7549222111701965,
      0.35901686549186707,
      -0.4111090302467346,
      0.8456984162330627,
      0.01568114198744297,
      0.4962819218635559,
      1.0168081521987915,
      -0.8003509640693665,
      0.1551184207201004,
      -0.7776545286178589,
      -0.23382003605365753,
      0.21605852246284485,
      0.44172075390815735,
      0.8415672779083252,
      1.019785761833191,
      0.8433838486671448,
      -0.42780691385269165,
      0.3048241436481476,
      0.5358640551567078,
      -0.9907587170600891,
      0.3657281696796417,
      -0.5689468383789062,
      1.7831302881240845,
      -0.328764408826828,
      -0.008583213202655315,
      0.36889371275901794,
      0.13598936796188354,
      -0.5465986132621765,
      0.02891426347196102,
      -0.2760705351829529,
      0.32011646032333374,
      -0.8615149855613708,
      -0.8619101643562317,
      0.0626799613237381,
      -0.2641385495662689,
      -0.151769757270813,
      -0.45871102809906006,
      -0.32899224758148193,
      0.957809567451477,
      -0.5818617343902588,
      0.001286379643715918,
      0.04500339552760124,
      -0.7512345314025879,
      -0.45625197887420654,
      0.30004483461380005,
      -0.4519352614879608,
      0.16324898600578308,
      -0.3414207994937897,
      0.358319491147995,
      0.7720139622688293,
      -0.6148010492324829,
      -0.5745180249214172,
      0.0871376320719719,
      -0.36441123485565186,
      -1.120341420173645,
      0.6286551356315613,
      -0.4030122756958008,
      -0.20371860265731812,
      0.6836784482002258,
      -1.0611932277679443,
      -0.17309540510177612,
      0.04062780365347862,
      -0.494291216135025,
      0.3419428765773773,
      -0.9244199991226196,
      -0.5019633769989014,
      -0.3038281202316284,
      0.8055552244186401,
      1.714219570159912,
      -0.986839771270752,
      -0.38813304901123047,
      -0.4340614378452301,
      0.15368236601352692,
      0.4189371168613434,
      0.32321280241012573,
      0.027712741866707802,
      -0.11205559223890305,
      0.8876783847808838,
      -1.0268299579620361,
      0.3399375379085541,
      -0.3295656740665436,
      -0.6909694671630859,
      0.07592097669839859,
      0.08665532618761063,
      0.7690473794937134,
      -1.119302749633789,
      -0.280117005109787,
      0.8694606423377991,
      -0.7507614493370056,
      0.23434260487556458,
      0.9776625037193298,
      0.3034621775150299,
      -0.39788997173309326,
      0.8006762862205505,
      0.5377395749092102,
      0.23769737780094147,
      0.6020534038543701,
      -0.14866459369659424,
      -1.5176008939743042,
      0.2784866392612457,
      0.2517787218093872,
      0.15803977847099304,
      0.47219204902648926,
      -0.9387717843055725,
      -0.801709771156311,
      0.22527921199798584,
      -0.7213641405105591,
      -0.011959696188569069,
      0.40781137347221375,
      1.6319644451141357,
      -0.6318840384483337,
      0.7385209798812866,
      0.33565273880958557,
      0.43805861473083496,
      -0.014451219700276852,
      0.9932709336280823,
      0.30018991231918335,
      -0.30012932419776917,
      -0.021363699808716774,
      0.4825231432914734,
      0.17528390884399414,
      -0.0849003791809082,
      -0.4771634042263031,
      0.35542088747024536,
      -0.18105171620845795,
      -0.49100837111473083,
      -0.23589569330215454,
      -0.18952549993991852,
      -0.2157968133687973,
      0.676274836063385,
      -0.9426770210266113,
      0.475181519985199,
      -0.3283018171787262,
      0.45447859168052673,
      0.3924483060836792,
      -1.766845703125,
      0.8853309154510498,
      -0.24492789804935455,
      1.0246995687484741,
      -0.5730125308036804,
      1.0619502067565918,
      -0.33162400126457214,
      0.7097595930099487,
      0.26762712001800537,
      -0.1255553513765335,
      0.059087179601192474,
      0.794184148311615,
      -0.044194404035806656,
      -0.8191890120506287,
      0.6065051555633545,
      0.13034605979919434,
      -0.4626025855541229,
      0.16734696924686432,
      0.27282726764678955,
      -0.4996858835220337,
      0.5803191661834717,
      -0.065181665122509,
      -0.041229069232940674,
      -0.6488905549049377,
      -0.28146570920944214,
      -0.7283143401145935,
      -0.6887843608856201,
      -0.2559741735458374,
      -0.6226690411567688,
      -0.41775476932525635,
      0.15212900936603546,
      0.2282858043909073,
      -0.1778995394706726,
      0.47182899713516235,
      0.006086040288209915,
      0.6211424469947815,
      -0.5333266258239746,
      0.14129027724266052,
      0.3739108145236969,
      1.2093675136566162,
      -0.008096309378743172,
      -0.29519563913345337,
      -0.6310147047042847,
      -0.3026086091995239,
      0.26083794236183167,
      -0.9108519554138184,
      0.2425381988286972,
      0.6078771948814392,
      0.3717193007469177,
      0.37148696184158325,
      1.1394379138946533,
      -0.17460373044013977,
      0.7997204661369324,
      0.08737576752901077,
      -0.6921826601028442,
      -0.0016676235245540738,
      0.5650141835212708,
      -0.16579630970954895,
      0.5582961440086365,
      0.21704983711242676,
      0.158467099070549,
      -0.22607021033763885,
      -0.4858369827270508,
      -0.5105651021003723,
      -0.2942751348018646,
      -0.06282759457826614,
      0.5778471231460571,
      -0.3763667047023773,
      0.5760433673858643,
      0.20250216126441956,
      0.8159465789794922,
      0.2576703429222107,
      0.29968106746673584,
      0.7924923896789551,
      -0.17053301632404327,
      0.7567852735519409,
      -0.16085873544216156,
      0.311281681060791,
      -0.44097334146499634,
      -1.0783576965332031,
      -0.39006972312927246,
      0.8241227269172668,
      -0.04122411459684372,
      -0.21020835638046265,
      0.8332756757736206,
      0.04948629438877106,
      0.5489813089370728,
      0.27679580450057983,
      0.41604530811309814,
      -0.04449305310845375,
      -0.5766181349754333,
      0.21943603456020355,
      -0.422146201133728,
      0.3662116229534149,
      0.4040409028530121,
      0.3687286078929901,
      0.2787371873855591,
      -0.11619901657104492,
      0.36485955119132996,
      0.5454201698303223,
      1.4551851749420166,
      -0.15787692368030548,
      -0.07320667058229446,
      -0.45254480838775635,
      0.12158700078725815,
      -0.17644019424915314,
      -0.479165643453598,
      -0.3959578573703766,
      -1.272455096244812,
      -0.5810039639472961,
      -0.7123823165893555,
      0.8139108419418335,
      0.21057654917240143,
      -0.02729707770049572,
      0.5986001491546631,
      0.1017635315656662,
      0.5284914374351501,
      -0.5046277046203613,
      0.5533499121665955,
      -0.16135941445827484,
      -0.4007836878299713,
      0.21515528857707977,
      -0.08559815585613251,
      0.5649123787879944,
      -0.08255963772535324,
      0.8854482173919678,
      0.9626160860061646,
      -0.2681249678134918,
      0.3960922062397003,
      0.33894336223602295,
      0.05300336703658104,
      -0.5857782363891602,
      -0.8513548970222473,
      -0.5194132924079895,
      0.016280248761177063,
      0.45656323432922363,
      0.20898711681365967,
      0.6987278461456299,
      0.4439730644226074,
      0.7423898577690125,
      0.6384689807891846,
      -0.9006472229957581,
      0.005783435422927141,
      0.5571723580360413,
      -0.5841996669769287,
      -0.39652761816978455,
      0.8118675947189331,
      0.2332943230867386,
      0.15055841207504272,
      0.20697233080863953,
      0.22166532278060913,
      -0.7713707089424133,
      0.17936524748802185,
      0.2699211537837982,
      0.6254640817642212,
      -0.172292560338974,
      0.039071619510650635,
      -0.2584678530693054,
      0.6210245490074158,
      0.28628167510032654,
      -0.13970144093036652,
      -0.18314670026302338,
      0.14390577375888824,
      0.045293789356946945,
      0.9283077120780945,
      0.049905192106962204,
      1.1474456787109375,
      -0.16949981451034546,
      -0.09658648818731308,
      -1.0106967687606812,
      -0.622683584690094,
      0.24132303893566132,
      -0.3289802670478821,
      0.43830084800720215,
      -0.07775579392910004,
      -0.2046022117137909,
      -0.05143745243549347,
      -0.18262742459774017,
      0.6266630291938782,
      -0.5115929841995239,
      0.4322849214076996,
      -0.6806617975234985,
      -0.20221766829490662,
      0.4978412985801697,
      -0.08046317845582962,
      -0.7677882313728333,
      0.26671814918518066,
      1.0948878526687622,
      -0.0912429541349411,
      -1.0293900966644287,
      -1.0953185558319092,
      -0.3699166774749756,
      -0.0052169556729495525,
      -0.6898588538169861,
      0.9377923011779785,
      0.6884822249412537,
      -0.14185728132724762,
      0.505217969417572,
      -1.651581883430481,
      -0.36232873797416687,
      0.20579470694065094,
      0.36740773916244507,
      -0.46471166610717773,
      -0.3104132115840912,
      -0.24170856177806854,
      0.1764366626739502,
      0.2487672120332718,
      -0.00005115307430969551,
      1.0259952545166016,
      0.138102725148201,
      -0.3607006371021271,
      -1.54111647605896,
      0.7851656675338745,
      -0.23054833710193634,
      1.0594255924224854,
      0.9110517501831055,
      -0.6518510580062866,
      -0.5860790014266968,
      0.5311316251754761,
      -0.13431012630462646,
      0.20593559741973877,
      0.17545080184936523,
      0.726565957069397,
      0.39978352189064026,
      0.1958286315202713,
      0.8934834599494934,
      -0.20575328171253204,
      -1.5971910953521729,
      0.400822252035141,
      0.3876984119415283,
      0.1287180483341217,
      0.1771261990070343,
      0.20937064290046692,
      0.3998897075653076,
      0.1075654998421669,
      0.6016907691955566,
      -0.31844693422317505,
      0.2655999958515167,
      0.5194888114929199,
      -0.00795675441622734,
      -0.46956849098205566,
      -0.15363149344921112,
      0.24370408058166504,
      0.17970044910907745,
      1.3808320760726929,
      -0.8918703198432922,
      -1.458967924118042,
      1.5688306093215942,
      0.3289714455604553,
      0.2363584339618683,
      0.7389346957206726,
      0.9571002721786499,
      1.431248426437378,
      -0.08545296639204025,
      -0.8010987639427185,
      -0.3815477192401886,
      0.026577293872833252,
      0.1159324124455452,
      -0.02605155110359192,
      0.7108489871025085,
      -0.8838620185852051,
      0.3057255446910858,
      -0.2282000035047531,
      -0.8595091104507446,
      -0.47738394141197205,
      -0.7662277221679688,
      0.4295825660228729,
      0.8408586382865906,
      -0.8398009538650513,
      -0.2507755756378174,
      -0.059275928884744644,
      -0.3410108685493469,
      -0.07408706098794937,
      1.0914900302886963,
      0.03512436896562576,
      0.0833761915564537,
      0.6790899634361267,
      0.956078827381134,
      0.43333831429481506,
      -1.0616374015808105,
      -0.890538215637207,
      -0.9220945239067078,
      0.03471449762582779,
      1.3747432231903076,
      0.8865481019020081,
      0.04910412058234215,
      0.7419492602348328,
      -0.4412953853607178,
      0.7086981534957886,
      0.21435235440731049,
      -0.16575157642364502,
      0.029017552733421326,
      -0.1385665386915207,
      -0.8412216901779175,
      0.1730758100748062,
      0.22637547552585602,
      0.3153029978275299,
      0.5028190612792969,
      -0.7013413310050964,
      -0.09219027310609818,
      -0.11641208827495575,
      -0.46235528588294983,
      0.7810036540031433,
      -0.2413623183965683,
      0.33175042271614075,
      -0.669857919216156,
      -0.6736034750938416,
      0.1379339098930359,
      -0.21378229558467865,
      0.10375110059976578,
      0.9477132558822632,
      0.5535961389541626,
      0.6380897760391235,
      -1.4427529573440552,
      0.569656491279602,
      0.08473668247461319,
      -0.16183312237262726,
      -0.11320991069078445,
      0.8907530307769775,
      -1.0142560005187988,
      -0.7348554134368896,
      -0.2030182033777237,
      -1.076297640800476,
      0.6510246992111206,
      0.728183388710022,
      -1.5897026062011719,
      0.8205044269561768,
      0.1503801792860031,
      0.9297270178794861,
      0.0884912982583046,
      -1.4308339357376099,
      0.10049764811992645,
      -0.3422037661075592,
      -0.12521061301231384,
      -0.5707906484603882,
      0.7180779576301575,
      0.1859387457370758,
      -0.042869094759225845,
      0.3469070494174957,
      0.9184621572494507,
      -0.20565004646778107,
      -1.0094847679138184,
      -0.6995157599449158,
      -0.2498936802148819,
      0.1652805060148239,
      0.43268346786499023,
      0.22020752727985382,
      -1.6928280591964722,
      0.7213823199272156,
      -0.7422055006027222,
      0.6459259986877441,
      -1.1370970010757446,
      0.09179958701133728,
      -0.5840110182762146,
      -0.9107288122177124,
      -0.848645806312561,
      -1.140042781829834,
      -0.4854048490524292,
      -0.6574022173881531,
      0.06303294748067856,
      1.4042983055114746,
      -0.42727503180503845,
      0.07846638560295105,
      0.21319854259490967,
      -0.2621341645717621,
      0.697610080242157,
      0.7053772211074829,
      0.46639585494995117,
      -0.3183840215206146,
      -1.3405580520629883,
      0.19580256938934326,
      0.014852968044579029,
      0.0032155660446733236,
      -0.08879277110099792,
      1.0581191778182983,
      0.34566736221313477,
      -0.5766094326972961,
      -0.9442844390869141,
      0.19842629134655,
      -0.827063262462616,
      0.9142432808876038,
      -0.5426899194717407,
      -0.5415010452270508,
      0.0738377794623375,
      0.03283340856432915,
      -0.676504909992218,
      -0.05284050479531288,
      -0.32697775959968567,
      -0.35124439001083374,
      -0.7301007509231567,
      0.8335033655166626,
      -0.6849989295005798,
      0.2145906686782837,
      -0.05996670573949814,
      0.06196507811546326,
      0.3276338279247284,
      -0.827741265296936,
      -0.9503686428070068,
      -0.6878551244735718,
      1.0776731967926025,
      0.7183935642242432,
      -1.2376773357391357,
      -0.2559949457645416,
      0.892981231212616,
      -0.9785257577896118,
      0.7592389583587646,
      -0.3750080168247223,
      0.4347555637359619,
      0.7867597341537476,
      -0.6094504594802856,
      -0.46863630414009094,
      -0.09976746141910553,
      0.16798052191734314,
      -0.748309314250946,
      1.280643343925476,
      0.09940613806247711,
      0.3519716262817383,
      -0.21992357075214386,
      -0.785658061504364,
      -0.42409399151802063,
      1.0162404775619507,
      -1.128636121749878,
      0.5694178938865662,
      -0.5011646151542664,
      -0.6698077917098999,
      -0.09507803618907928,
      1.1301963329315186,
      0.6371515393257141,
      -0.9801176190376282,
      -0.27693048119544983,
      -1.6295310258865356,
      0.05376577377319336,
      -1.4208346605300903,
      0.4115816056728363,
      -0.2472040057182312,
      0.36872485280036926,
      1.0521202087402344,
      1.249503493309021,
      0.4550507068634033,
      -0.5462006330490112,
      -0.9491867423057556,
      -0.04024608060717583,
      0.5428741574287415,
      -0.8318343758583069,
      0.672959566116333,
      1.3019819259643555,
      0.29527124762535095,
      -1.1999720335006714,
      1.0292199850082397,
      1.0384278297424316,
      0.7104235291481018,
      -0.4367474913597107,
      0.011298510245978832,
      -0.6066339015960693,
      0.4262539744377136,
      -0.8569767475128174,
      -0.8395493626594543,
      -0.8565100431442261,
      0.5303992033004761,
      -0.38880693912506104,
      -0.5783912539482117,
      0.11351820826530457,
      0.6270965337753296,
      0.001688642194494605,
      -0.7186450362205505,
      0.538496732711792,
      -0.5432057976722717,
      -1.0468101501464844,
      0.4889465570449829,
      0.7603952884674072,
      -0.4290946125984192,
      0.2774412930011749,
      0.4110023081302643,
      0.09599225968122482,
      0.8369690775871277,
      1.0924286842346191,
      0.383605033159256,
      -0.20675279200077057,
      -0.36606383323669434,
      -0.0882999524474144,
      0.4724575877189636,
      0.15270259976387024,
      0.3958335518836975,
      -1.1098191738128662,
      -0.15598949790000916,
      -1.0553840398788452,
      0.5715965032577515,
      -0.2969052195549011,
      -0.8225381374359131,
      0.03138332441449165,
      -0.05911598354578018,
      -0.2581683099269867,
      -0.9079668521881104,
      0.6638616919517517,
      0.26155778765678406,
      -1.15962815284729,
      0.6687372922897339,
      0.8850992321968079,
      0.14236950874328613,
      0.2699025869369507,
      -0.04545990005135536,
      0.6396579742431641,
      -0.28135621547698975,
      0.16311469674110413,
      0.7621618509292603,
      0.9061439037322998,
      -0.03759700804948807,
      -0.6172429323196411,
      -0.34101343154907227,
      -0.11913865059614182,
      -1.29723060131073,
      1.0240364074707031,
      -1.0207322835922241,
      0.1645439863204956,
      -0.10498818010091782,
      -0.20726895332336426,
      -0.18089771270751953,
      -0.20733030140399933,
      0.09489960223436356,
      -0.015351972542703152,
      -1.4785043001174927,
      -0.14428211748600006,
      -0.31768715381622314,
      -0.6432454586029053,
      -0.030075596645474434,
      -0.4350077509880066,
      -0.42368727922439575,
      -0.4866558313369751,
      -1.2565865516662598,
      -0.5859896540641785,
      -1.0347861051559448,
      1.6338613033294678,
      -0.5313645601272583,
      0.20177790522575378,
      -0.6285507082939148,
      -1.051480770111084,
      -0.6726382374763489,
      0.05144309625029564,
      -0.8086815476417542,
      1.0481417179107666,
      0.27741849422454834,
      0.25653842091560364,
      0.07402361184358597,
      -0.2930757403373718,
      -0.9008958339691162,
      1.3372465372085571,
      0.07873456925153732,
      -0.4174426794052124,
      0.5292837619781494,
      0.26417553424835205,
      0.5080598592758179,
      -0.03730307146906853,
      -0.6194668412208557,
      -0.09883257746696472,
      0.03927629441022873,
      1.1478800773620605,
      0.8526844382286072,
      0.27904051542282104,
      0.29051899909973145,
      -0.47701728343963623,
      0.8306447863578796,
      0.09612715989351273,
      -0.28539541363716125,
      -0.4617140293121338,
      -0.17199581861495972,
      -0.41870978474617004
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "MOB",
      "mlLibrary": "Keras",
      "contractViolationLocation": "0",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/44720822",
    "title": "",
    "question": "\"After some search here, I still can't find a solution for this. I'm new to Keras, apologies if there is a solution and I actually didn't understand how it was related to my problem.\n\nI am making a small RNN with Keras 2/Functional API, and I have trouble to make the Concatenate Layer work.\n\nHere is my structure :\n\ninputSentence = Input(shape=(30, 91))\nsentenceMatrix = LSTM(91, return_sequences=True, input_shape=(30, 91))(inputSentence)\n\ninputDeletion = Input(shape=(30, 1))\ndeletionMatrix = (LSTM(30, return_sequences=True, input_shape=(30, 1)))(inputDeletion)\n\nfusion = Concatenate([sentenceMatrix, deletionMatrix])\nfusion = Dense(122, activation='relu')(fusion)\nfusion = Dense(102, activation='relu')(fusion)\nfusion = Dense(91, activation='sigmoid')(fusion)\n\nF = Model(inputs=[inputSentence, inputDeletion], outputs=fusion)\n\nAnd here is the error:\n\nValueError: Unexpectedly found an instance of type ``. Expected a symbolic tensor instance.\n\nFull History if it helps a bit more :\n\nUsing TensorFlow backend.\n    str(inputs) + '. All inputs to the layer '\nValueError: Layer dense_1 was called with an input that isn't a symbolic tensor. Received type: . Full input: []. All inputs to the layer should be tensors.\nself.assert_input_compatibility(inputs)\n  File \"\"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\keras\\engine\\topology.py\"\", line 425, in assert_input_compatibility\nfusion = Dense(122, activation='relu')(fusion)\n  File \"\"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\keras\\engine\\topology.py\"\", line 552, in __call__\nTraceback (most recent call last):\n  File \"\"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\keras\\engine\\topology.py\"\", line 419, in assert_input_compatibility\nK.is_keras_tensor(x)\n  File \"\"C:\\ProgramData\\Anaconda3\\lib\\site-packages\\keras\\backend\\tensorflow_backend.py\"\", line 392, in is_keras_tensor\nraise ValueError('Unexpectedly found an instance of type `' + str(type(x)) + '`. '\nValueError: Unexpectedly found an instance of type ``. Expected a symbolic tensor instance.\n\nI'm using Python 3.6, with Spyder 3.1.4, on Windows 7. I upgraded TensorFlow and Keras with pip this morning.\n\nThank you for any help provided !\"",
    "answer": "\"Try:\n\nfusion = concatenate([sentenceMatrix, deletionMatrix])\n\nConcatenate is used in a Sequential model, whereas concatenate is used in a Functional API.\"",
    "mlApiName": "keras.layers.concatenate",
    "embedding": [
      0.6462808847427368,
      1.3456802368164062,
      -1.9431588649749756,
      -1.4130889177322388,
      0.5369359254837036,
      -1.2553625106811523,
      0.22666259109973907,
      0.7857651114463806,
      -1.0751086473464966,
      -1.1723098754882812,
      -0.23196834325790405,
      0.3993943929672241,
      1.525816559791565,
      -0.03373221680521965,
      -0.5252155661582947,
      -0.7175326347351074,
      1.095510721206665,
      1.1432387828826904,
      -0.08764979243278503,
      1.602767825126648,
      -1.070454716682434,
      0.04314793273806572,
      0.23678608238697052,
      -0.37979045510292053,
      1.562840461730957,
      0.3413727283477783,
      0.19097276031970978,
      0.5534510612487793,
      -0.32497426867485046,
      -0.5900801420211792,
      1.0407521724700928,
      0.11600019037723541,
      0.35865136981010437,
      -0.678418755531311,
      -1.235487937927246,
      -1.3821871280670166,
      1.2937045097351074,
      -0.14842639863491058,
      -0.014453547075390816,
      -0.09569698572158813,
      1.2487213611602783,
      0.4130608141422272,
      -0.18119671940803528,
      -0.14817404747009277,
      0.1324429214000702,
      -0.3979315161705017,
      0.8235414624214172,
      -0.030647292733192444,
      0.48114508390426636,
      -1.717290997505188,
      -0.2035580724477768,
      1.0301837921142578,
      0.03258179500699043,
      -0.3199847936630249,
      0.9957690834999084,
      0.7364774942398071,
      0.3949752151966095,
      -0.04941324144601822,
      0.5473453402519226,
      -0.9530177116394043,
      -0.6240133047103882,
      1.4922378063201904,
      -1.2880573272705078,
      1.2152425050735474,
      0.7542058229446411,
      -0.567561686038971,
      -0.9975095391273499,
      1.279048204421997,
      -0.3301868438720703,
      -0.4235292673110962,
      0.7026132345199585,
      -0.5418846607208252,
      0.8404783606529236,
      0.6616355776786804,
      -0.040161628276109695,
      -0.15119042992591858,
      -0.2648874521255493,
      -0.7932375073432922,
      0.5750975608825684,
      0.49980443716049194,
      -0.19848515093326569,
      0.3979620039463043,
      1.3662010431289673,
      -0.5000051259994507,
      0.1293865293264389,
      0.9961422681808472,
      -0.6379048824310303,
      -0.6408520936965942,
      -0.34474870562553406,
      1.111945629119873,
      -0.32303348183631897,
      -0.27948513627052307,
      0.09150468558073044,
      1.1865822076797485,
      -0.6244403719902039,
      -1.1155344247817993,
      0.7119634747505188,
      0.2831268608570099,
      -0.5102148056030273,
      -0.49557796120643616,
      -0.6231260895729065,
      0.6082625389099121,
      -0.31741201877593994,
      -1.0096848011016846,
      0.28526660799980164,
      1.1689668893814087,
      -0.11606355756521225,
      -0.3544332683086395,
      -0.291565477848053,
      0.16762802004814148,
      0.04865477234125137,
      0.22156922519207,
      -0.3313106596469879,
      -0.7484147548675537,
      0.5102670788764954,
      0.31636354327201843,
      -0.43782690167427063,
      -0.41268086433410645,
      0.6265017986297607,
      -0.08636897802352905,
      -0.07992594689130783,
      -0.5669304132461548,
      0.18929380178451538,
      0.623465895652771,
      -0.40657535195350647,
      1.1453872919082642,
      -0.6508328318595886,
      -0.7031031847000122,
      -0.27060550451278687,
      -1.3616834878921509,
      0.08858571946620941,
      -0.3493535816669464,
      0.23690123856067657,
      0.01416844967752695,
      0.3634253144264221,
      1.194251298904419,
      -0.868049681186676,
      -1.261429786682129,
      0.9603217840194702,
      0.06379207223653793,
      0.41761860251426697,
      -0.10224692523479462,
      -0.3316187858581543,
      -0.8383868336677551,
      0.6993485689163208,
      -1.5157840251922607,
      0.5109438300132751,
      -0.9457553625106812,
      -0.6596487760543823,
      0.3485734164714813,
      0.020737145096063614,
      0.5536398887634277,
      -0.6255236864089966,
      0.10726118087768555,
      0.47723323106765747,
      -0.40889397263526917,
      0.9850590229034424,
      0.9242051839828491,
      0.5816333293914795,
      -0.23248988389968872,
      0.9463489055633545,
      0.5204893946647644,
      -0.504182755947113,
      0.2502588927745819,
      0.23935745656490326,
      -0.5497422814369202,
      -0.02742951363325119,
      0.5423535108566284,
      -0.3704453706741333,
      0.12332364171743393,
      -0.8640494346618652,
      -0.3688355088233948,
      -0.03014286980032921,
      0.35577327013015747,
      -0.038068193942308426,
      0.9545521140098572,
      1.5040161609649658,
      -0.3134887218475342,
      1.0925596952438354,
      0.714043140411377,
      0.08292267471551895,
      -0.007899092510342598,
      0.22428271174430847,
      -0.39426594972610474,
      0.04844115301966667,
      0.6541786193847656,
      0.1500183343887329,
      0.3508710563182831,
      -0.16279283165931702,
      -0.23106199502944946,
      0.33371859788894653,
      -0.3950788378715515,
      -0.2894926071166992,
      -0.1348681002855301,
      -0.5111746788024902,
      0.5326519012451172,
      0.502818763256073,
      -0.6992166638374329,
      0.48687875270843506,
      -0.05002392828464508,
      -0.07990944385528564,
      0.0646313726902008,
      -0.5526843667030334,
      0.6897131204605103,
      -1.2384557723999023,
      1.2785671949386597,
      -1.1538017988204956,
      0.8429028391838074,
      -0.2264597862958908,
      0.802920401096344,
      0.7730631232261658,
      -0.15725930035114288,
      0.22315965592861176,
      0.37656089663505554,
      -0.3438322842121124,
      -0.6964181065559387,
      0.9856526851654053,
      -0.31500402092933655,
      -0.7748183608055115,
      -0.0698891207575798,
      0.8917973041534424,
      -0.1238543763756752,
      0.9587904214859009,
      0.8230377435684204,
      0.1787092685699463,
      -0.837548553943634,
      0.1573764830827713,
      -0.08295562118291855,
      -0.9734561443328857,
      -0.6324028372764587,
      -0.7110065221786499,
      -0.43085184693336487,
      0.48749589920043945,
      0.39732253551483154,
      0.10014523565769196,
      1.0156140327453613,
      0.775679886341095,
      0.842430830001831,
      -0.5664480924606323,
      0.41587427258491516,
      0.12102213501930237,
      0.3486716151237488,
      0.4139881730079651,
      0.20855019986629486,
      -0.43230050802230835,
      -0.15230435132980347,
      -0.4483577609062195,
      -1.0757945775985718,
      0.007080635521560907,
      0.9232809543609619,
      -0.11887460201978683,
      0.05487557128071785,
      0.38174790143966675,
      0.4355129897594452,
      0.8166329860687256,
      -0.7932937741279602,
      -0.5295264720916748,
      -0.18319019675254822,
      0.8693978786468506,
      -0.40352967381477356,
      0.6703541278839111,
      0.5523732900619507,
      0.048422425985336304,
      -0.07339596003293991,
      -0.7662930488586426,
      -0.9134101867675781,
      -0.3305869400501251,
      0.22113746404647827,
      0.23457376658916473,
      -0.24169006943702698,
      -0.23359699547290802,
      0.33809176087379456,
      0.649015486240387,
      0.8452074527740479,
      0.31294989585876465,
      0.060275088995695114,
      -0.026218019425868988,
      -0.39546841382980347,
      -0.2442033290863037,
      -0.06552234292030334,
      -0.10800973325967789,
      -0.6404913067817688,
      0.2234921157360077,
      0.5136204957962036,
      -0.6384680271148682,
      0.6118557453155518,
      -0.36874738335609436,
      0.7282441258430481,
      0.6539135575294495,
      0.9255359172821045,
      0.411197304725647,
      -0.24878060817718506,
      -0.7580513954162598,
      0.18724624812602997,
      0.04813940078020096,
      0.37613174319267273,
      0.8227030038833618,
      -0.6286377906799316,
      -0.5500079393386841,
      -0.4555869400501251,
      1.0148967504501343,
      0.9179047346115112,
      1.4011305570602417,
      0.4140653908252716,
      0.2278154045343399,
      0.21334946155548096,
      0.16986632347106934,
      -0.5065920948982239,
      0.77431720495224,
      -0.10710303485393524,
      -0.38614222407341003,
      0.3665332794189453,
      0.45257923007011414,
      0.42741748690605164,
      -0.10981184989213943,
      -0.059841886162757874,
      0.7449684739112854,
      0.8373777270317078,
      -0.22212275862693787,
      -0.38946637511253357,
      -0.6786845326423645,
      -0.40855079889297485,
      0.3729235529899597,
      0.6357808709144592,
      -0.46905359625816345,
      0.5390579104423523,
      -0.5745821595191956,
      0.4026346504688263,
      0.08276154100894928,
      -0.9674182534217834,
      -0.2981860637664795,
      0.25898224115371704,
      0.7091313004493713,
      -1.1169270277023315,
      -1.531115174293518,
      -0.49613282084465027,
      -0.42104312777519226,
      0.27846500277519226,
      0.34180939197540283,
      1.1111681461334229,
      0.03824145346879959,
      -0.19150279462337494,
      0.9883606433868408,
      -0.6447030305862427,
      0.14792609214782715,
      0.5855444073677063,
      -1.6292612552642822,
      -0.4559282064437866,
      0.7995997667312622,
      0.422574520111084,
      -0.18549960851669312,
      0.08794382214546204,
      0.40467268228530884,
      -0.6582674384117126,
      0.039653655141592026,
      0.15912280976772308,
      1.2042979001998901,
      -0.15545395016670227,
      -0.14498385787010193,
      0.5947421789169312,
      0.6799939274787903,
      -0.18549714982509613,
      -0.004716912750154734,
      -0.1238865852355957,
      -0.32324790954589844,
      0.9304415583610535,
      1.4715230464935303,
      -0.3973996341228485,
      0.7018148899078369,
      0.5365725159645081,
      0.30653199553489685,
      -0.6341333389282227,
      -0.48092973232269287,
      0.6435489654541016,
      0.10668947547674179,
      -0.33853450417518616,
      -1.6334152221679688,
      0.5293181538581848,
      0.7223811745643616,
      -0.19473326206207275,
      0.30425700545310974,
      -0.4187808334827423,
      0.4620998799800873,
      -0.22924521565437317,
      0.5491902232170105,
      0.25163382291793823,
      0.2627144157886505,
      -0.3385785222053528,
      -0.2804673910140991,
      1.4781265258789062,
      0.42120715975761414,
      -0.18353955447673798,
      -1.174941062927246,
      -0.9168126583099365,
      0.31507736444473267,
      -0.35867050290107727,
      0.45906320214271545,
      0.8394279479980469,
      -0.7712228894233704,
      0.1758563220500946,
      -0.37462425231933594,
      -1.1521402597427368,
      0.17964191734790802,
      -0.314141184091568,
      0.1691790074110031,
      -0.6773883104324341,
      0.08778642117977142,
      -0.3276421129703522,
      0.18015789985656738,
      0.07133834064006805,
      0.5550937652587891,
      0.3372161388397217,
      -0.6519320607185364,
      -1.8674217462539673,
      0.8983883261680603,
      -0.12934847176074982,
      0.49751177430152893,
      0.3919883966445923,
      -0.7070088386535645,
      -0.5724496245384216,
      -0.9418441653251648,
      0.7416976094245911,
      -0.09431513398885727,
      0.1722576916217804,
      1.3229777812957764,
      0.6394929885864258,
      0.522162914276123,
      1.3362983465194702,
      0.11151669174432755,
      -1.3281474113464355,
      0.7859963178634644,
      0.17706792056560516,
      0.5476506948471069,
      -0.7548765540122986,
      -0.04211952164769173,
      -0.48138535022735596,
      -0.7622307538986206,
      1.0205923318862915,
      -0.45677825808525085,
      1.2049981355667114,
      1.2233165502548218,
      -0.48067381978034973,
      -0.8432535529136658,
      -0.3988649845123291,
      0.08476898074150085,
      0.6135570406913757,
      0.32795479893684387,
      -0.9954289197921753,
      -1.6773518323898315,
      0.8155220746994019,
      0.17677293717861176,
      -0.3830230236053467,
      -0.0060330769047141075,
      0.31109103560447693,
      1.331519603729248,
      0.6585596203804016,
      -0.7908690571784973,
      -0.6242792010307312,
      -0.612674355506897,
      0.08176808804273605,
      0.3426818549633026,
      0.1747872531414032,
      -1.0141687393188477,
      -0.5579036474227905,
      0.10822150856256485,
      -0.7845349907875061,
      0.1022990420460701,
      -0.3262663185596466,
      -0.28780388832092285,
      0.21991121768951416,
      -0.25281044840812683,
      0.4107379913330078,
      0.25059080123901367,
      -0.8746992349624634,
      -0.060436639934778214,
      0.8994454145431519,
      0.1927327662706375,
      -0.2253682017326355,
      0.27068185806274414,
      0.7345702648162842,
      0.12872262299060822,
      -1.399055004119873,
      -0.32517382502555847,
      -0.5589892864227295,
      -0.32168084383010864,
      1.7967089414596558,
      -0.24684709310531616,
      0.03152124956250191,
      0.23614679276943207,
      -0.2006521224975586,
      0.4312235713005066,
      -0.3764774799346924,
      -0.054735664278268814,
      0.2145671546459198,
      -0.10390111804008484,
      -0.7881265878677368,
      0.03999760374426842,
      0.5906347036361694,
      0.26212626695632935,
      0.9245554804801941,
      0.24761618673801422,
      -0.07792887836694717,
      -0.7083948254585266,
      0.4413585066795349,
      -0.010069276206195354,
      -0.3705824315547943,
      1.111259937286377,
      -0.8239215016365051,
      0.2218264937400818,
      0.02200295403599739,
      0.189968079328537,
      -0.07818423956632614,
      -0.033796604722738266,
      0.44385674595832825,
      -0.2143397480249405,
      -0.7901171445846558,
      -0.106124646961689,
      -0.2080158144235611,
      -0.559241771697998,
      -0.17071618139743805,
      0.5189743638038635,
      -0.26759085059165955,
      -0.8702914714813232,
      -0.8557376861572266,
      -0.8212009072303772,
      0.46355965733528137,
      0.05030824989080429,
      -1.4683828353881836,
      -0.11857437342405319,
      -0.14625316858291626,
      0.09242838621139526,
      -0.6622903943061829,
      -1.169003963470459,
      0.0464024618268013,
      1.0297119617462158,
      -0.6051061153411865,
      -0.31057506799697876,
      0.6543977856636047,
      0.5908411145210266,
      0.7456273436546326,
      0.3617204427719116,
      1.0237077474594116,
      -0.8986542224884033,
      -1.0231584310531616,
      -0.23613549768924713,
      0.10990188270807266,
      0.47047680616378784,
      1.1369696855545044,
      0.4228915274143219,
      -1.1273272037506104,
      -0.1911613941192627,
      -1.9970111846923828,
      0.5077484846115112,
      -1.137734055519104,
      0.24034114181995392,
      -0.9809449315071106,
      -1.006422996520996,
      -1.1149815320968628,
      -0.7490944266319275,
      -0.13686731457710266,
      -1.0540932416915894,
      -0.35638371109962463,
      0.7135502099990845,
      -0.18572382628917694,
      -0.06297025084495544,
      -1.3543463945388794,
      -0.37380462884902954,
      0.4000162184238434,
      0.21853846311569214,
      0.368007093667984,
      0.10424443334341049,
      -0.9548407196998596,
      -0.09526193886995316,
      0.5050455927848816,
      0.25939881801605225,
      -0.31651008129119873,
      0.4055804908275604,
      0.35340604186058044,
      -0.5421060919761658,
      -0.20351213216781616,
      0.5135912299156189,
      -1.1923649311065674,
      0.5382939577102661,
      -0.4241751432418823,
      -0.46212267875671387,
      0.37758737802505493,
      0.45451322197914124,
      -0.35599130392074585,
      -0.00007930462015792727,
      0.14948409795761108,
      -0.3276301920413971,
      -0.02233356051146984,
      0.5549104809761047,
      0.4164619743824005,
      0.15601439774036407,
      -0.418530136346817,
      -0.13883233070373535,
      1.3542143106460571,
      -0.3134716749191284,
      -1.0012329816818237,
      -0.13190022110939026,
      0.6709384322166443,
      1.924371600151062,
      -0.7531949281692505,
      0.04394722729921341,
      1.2583686113357544,
      -0.8199669718742371,
      0.02346760593354702,
      -0.8633741140365601,
      0.7917560935020447,
      0.44692322611808777,
      -0.040473174303770065,
      -0.39659297466278076,
      0.0825670138001442,
      0.30083417892456055,
      -0.7707104682922363,
      0.7591719627380371,
      -0.2114989161491394,
      0.01996772550046444,
      -0.29061028361320496,
      0.4351271092891693,
      -0.7396771311759949,
      0.8885391354560852,
      -1.2785061597824097,
      -0.13172179460525513,
      -1.045893907546997,
      -0.15790551900863647,
      -0.16136214137077332,
      0.10481832176446915,
      0.4564570188522339,
      -1.1157357692718506,
      0.20024210214614868,
      -0.9798830151557922,
      0.09838122874498367,
      -0.919880211353302,
      1.0153008699417114,
      -0.6792812347412109,
      0.7561196088790894,
      0.6346802115440369,
      1.142227292060852,
      0.32408222556114197,
      0.1101379245519638,
      -0.11079386621713638,
      0.5675348043441772,
      0.4421316981315613,
      -0.5513717532157898,
      0.8633749485015869,
      0.750707745552063,
      -0.6269099712371826,
      0.0043309470638632774,
      0.8368359804153442,
      1.3048890829086304,
      -0.0032385606318712234,
      -0.036694787442684174,
      0.36174213886260986,
      0.12027398496866226,
      -0.08727195858955383,
      -0.6914403438568115,
      -0.9969472885131836,
      -0.3355081379413605,
      -0.05082165077328682,
      -0.04472985118627548,
      -0.971782922744751,
      0.12123694270849228,
      -0.24225515127182007,
      -0.1156686320900917,
      -0.43906331062316895,
      0.21512435376644135,
      0.16180966794490814,
      -1.5838117599487305,
      0.23011167347431183,
      0.6514279246330261,
      -0.23095965385437012,
      0.05388425290584564,
      0.15275876224040985,
      -0.2826114594936371,
      1.3708492517471313,
      0.9821878671646118,
      0.5942289233207703,
      0.3978852927684784,
      0.6083473563194275,
      0.08235568553209305,
      0.7180249094963074,
      -0.09750805050134659,
      0.4867926836013794,
      -0.7113301753997803,
      0.42245393991470337,
      -0.6216669082641602,
      -0.23891708254814148,
      -0.13807930052280426,
      0.9182263612747192,
      0.2993714213371277,
      0.03743888437747955,
      0.3851977288722992,
      -0.5242424607276917,
      0.09496445953845978,
      -0.21639162302017212,
      -0.9935958981513977,
      0.2691945433616638,
      0.5860311388969421,
      -0.11229094117879868,
      -0.23642803728580475,
      -0.17778299748897552,
      0.42043763399124146,
      0.21757084131240845,
      0.4256867468357086,
      0.05222586169838905,
      -0.04869982227683067,
      -1.0921423435211182,
      -0.269646018743515,
      -0.2488095611333847,
      0.03639436140656471,
      -0.5570947527885437,
      0.5168599486351013,
      -0.011800718493759632,
      0.8958985209465027,
      0.0027052797377109528,
      -0.7229086756706238,
      -0.37480321526527405,
      0.3834604322910309,
      -0.1087232381105423,
      -0.48616719245910645,
      -1.3698725700378418,
      -0.10567556321620941,
      -0.9841656684875488,
      -0.3715820908546448,
      0.12656264007091522,
      -0.5295029282569885,
      -0.2735654413700104,
      0.5034198760986328,
      -0.3692861795425415,
      -0.17110227048397064,
      -0.6093566417694092,
      1.4832223653793335,
      -0.5908210873603821,
      -0.06243833154439926,
      -0.8701611161231995,
      -0.5834149122238159,
      -0.8437051773071289,
      -0.46018072962760925,
      -0.8371220827102661,
      0.11996251344680786,
      -0.04345421865582466,
      -0.021931074559688568,
      -1.0599846839904785,
      -0.20645007491111755,
      -0.9893055558204651,
      1.7069939374923706,
      -0.01332278922200203,
      -0.26194941997528076,
      -0.14634045958518982,
      -0.3854871094226837,
      -0.22358499467372894,
      -0.3324754536151886,
      -0.579755961894989,
      -0.24249255657196045,
      -0.5151554942131042,
      1.7859697341918945,
      0.9653436541557312,
      0.42332082986831665,
      0.6337570548057556,
      -0.7722289562225342,
      -0.1533767431974411,
      -0.0949401780962944,
      0.20619304478168488,
      -0.10857081413269043,
      -0.2252480685710907,
      -0.9559668898582458
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Data Preprocessing",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/51763983",
    "title": "",
    "question": "\"I'm training a model to predict the stock price and input data is close price. I use 45 days data to predict the 46th day's close price and a economic Indicator to be second feature, here is the model:\n\nmodel = Sequential()\nmodel.add( LSTM( 512, input_shape=(45, 2), return_sequences=True))\nmodel.add( LSTM( 512, return_sequences=True))\nmodel.add( (Dense(1)))\nmodel.compile(loss='mse', optimizer='adam')\nhistory = model.fit( X_train, y_train, batch_size = batchSize, epochs=epochs, shuffle = False)\n\nWhen I run this I get the following error:\n\n  ValueError: Error when checking target: expected dense_1 to have 3\n  dimensions, but got array with shape (118, 1)\n\nHowever, I print the shape of data and they are:\n\nX_train:(118, 45, 2)\ny_train:(118, 1)\n\nI have no idea why the model is expecting a 3 dimensional output when y_train is (118, 1). Where am I wrong and what should I do?\"",
    "answer": "\"Your second LSTM layer also returns sequences and Dense layers by default apply the kernel to every timestep also producing a sequence:\n\n# (bs, 45, 2)\nmodel.add( LSTM( 512, input_shape=(45, 2), return_sequences=True))\n# (bs, 45, 512)\nmodel.add( LSTM( 512, return_sequences=True))\n# (bs, 45, 512)\nmodel.add( (Dense(1)))\n# (bs, 45, 1)\n\nSo your output is shape (bs, 45, 1). To solve the problem you need to set return_sequences=False in your second LSTM layer which will compress sequence:\n\n# (bs, 45, 2)\nmodel.add( LSTM( 512, input_shape=(45, 2), return_sequences=True))\n# (bs, 45, 512)\nmodel.add( LSTM( 512, return_sequences=False)) # SET HERE\n# (bs, 512)\nmodel.add( (Dense(1)))\n# (bs, 1)\n\nAnd you'll get the desired output. Note bs is the batch size.\"",
    "mlApiName": "keras.models.fit",
    "embedding": [
      0.11050115525722504,
      0.7524272203445435,
      -2.6437246799468994,
      -0.4831998646259308,
      1.2761294841766357,
      0.00879907887428999,
      0.3562176823616028,
      0.041636161506175995,
      -0.9429419636726379,
      -1.1546043157577515,
      0.08144848048686981,
      0.4810459315776825,
      2.132824659347534,
      0.22930878400802612,
      -0.17403094470500946,
      -0.3553062379360199,
      0.01931743137538433,
      -0.20797134935855865,
      -0.008402371779084206,
      0.8076149821281433,
      -0.18103192746639252,
      0.2751711905002594,
      -0.2942928969860077,
      -0.4114684462547302,
      0.7534223198890686,
      0.4271320104598999,
      -0.7175321578979492,
      0.3468104898929596,
      0.212673157453537,
      0.6386571526527405,
      1.3388460874557495,
      -0.3709560036659241,
      -0.2924061715602875,
      -1.3614252805709839,
      -1.482930064201355,
      -0.9185873866081238,
      0.937467098236084,
      0.3421492278575897,
      0.3622357249259949,
      -0.36854755878448486,
      0.8681995868682861,
      0.30732429027557373,
      -0.5292914509773254,
      0.7927420139312744,
      0.05715837702155113,
      0.22236797213554382,
      1.1898589134216309,
      0.4124948978424072,
      0.9983099102973938,
      -0.37435147166252136,
      0.29189378023147583,
      0.9152294993400574,
      -0.05671699717640877,
      -0.0891391858458519,
      1.729928970336914,
      0.6745002269744873,
      -0.45639076828956604,
      0.8527349829673767,
      1.2017695903778076,
      -0.7069520950317383,
      0.4664199650287628,
      0.9275684952735901,
      -1.4716367721557617,
      1.2180471420288086,
      0.4568677246570587,
      -0.3770744204521179,
      -0.5606761574745178,
      0.5557059049606323,
      -0.4317101836204529,
      -0.11710952967405319,
      0.6613644957542419,
      -0.13067398965358734,
      0.13579604029655457,
      -0.08687761425971985,
      -0.39807677268981934,
      -0.09072665870189667,
      -0.4346260726451874,
      -0.2702779471874237,
      -1.1729373931884766,
      0.613968551158905,
      0.2635994553565979,
      0.996086835861206,
      0.8074812293052673,
      -0.03845755383372307,
      -0.3603191077709198,
      0.33438217639923096,
      -1.1012396812438965,
      0.303812712430954,
      -0.3572506010532379,
      1.4929518699645996,
      -1.0226198434829712,
      0.19099268317222595,
      1.1187610626220703,
      1.170669436454773,
      -0.8687273859977722,
      -0.6085148453712463,
      0.15532808005809784,
      0.6762447953224182,
      -0.6225379705429077,
      0.20737536251544952,
      -0.5985696315765381,
      1.1239129304885864,
      0.3297732174396515,
      -1.294637680053711,
      -0.7408143281936646,
      1.55747652053833,
      -0.163987934589386,
      -0.04220716655254364,
      -0.00023979556863196194,
      -0.9397012591362,
      -0.7092009782791138,
      0.07308077067136765,
      -0.3467905521392822,
      -0.3381386995315552,
      -0.21992801129817963,
      0.22414490580558777,
      0.03988607972860336,
      -0.4329436421394348,
      0.4896736741065979,
      -0.24713723361492157,
      0.2156209498643875,
      -1.189869999885559,
      0.2659536600112915,
      0.35371243953704834,
      0.004225361160933971,
      0.7732560634613037,
      -1.0718332529067993,
      0.8006494641304016,
      -0.40481334924697876,
      -0.36447882652282715,
      0.040531814098358154,
      -0.364159494638443,
      -0.6159627437591553,
      0.5597824454307556,
      0.7825884819030762,
      1.3178783655166626,
      -1.4047430753707886,
      -0.6712885499000549,
      0.3652813136577606,
      1.435894250869751,
      0.17729543149471283,
      0.05660238489508629,
      -0.01154543086886406,
      -1.06016206741333,
      0.16431033611297607,
      -0.47282153367996216,
      0.45066940784454346,
      -0.7030822038650513,
      -1.0989532470703125,
      -0.27646583318710327,
      -0.7673189640045166,
      1.193961501121521,
      -1.1017097234725952,
      0.3354676067829132,
      0.9168769121170044,
      -0.09586451947689056,
      0.37805241346359253,
      0.6333812475204468,
      0.5596879124641418,
      -0.15368440747261047,
      1.1089576482772827,
      -0.21065141260623932,
      -0.6428698897361755,
      0.8804727792739868,
      -0.42524075508117676,
      -0.762435793876648,
      0.6345669627189636,
      0.055013857781887054,
      -0.5210157632827759,
      0.35406070947647095,
      -0.6549465656280518,
      -0.6691096425056458,
      0.02845042571425438,
      -0.24340753257274628,
      -0.2524207830429077,
      1.2924007177352905,
      1.4245823621749878,
      -0.45008161664009094,
      0.9325655698776245,
      -0.5638192892074585,
      0.746639609336853,
      0.04329685494303703,
      0.976040244102478,
      -0.396447092294693,
      -0.4220501780509949,
      -0.5426064133644104,
      0.704502522945404,
      -0.11592946946620941,
      -0.04460738226771355,
      -0.2961883544921875,
      0.4994211792945862,
      0.04245021194219589,
      -0.14899033308029175,
      -0.31447553634643555,
      0.06570006161928177,
      -0.09287387877702713,
      1.2285677194595337,
      -0.8282526135444641,
      0.5124740600585938,
      0.20213568210601807,
      -0.23206882178783417,
      0.05893692746758461,
      -0.28498589992523193,
      0.6965126991271973,
      -0.618942141532898,
      0.8070203065872192,
      -0.2403123527765274,
      0.8142318725585938,
      -0.873234212398529,
      0.9801619052886963,
      -0.36886706948280334,
      -0.18046781420707703,
      0.5280324220657349,
      0.20677347481250763,
      0.7923827171325684,
      -0.3018091320991516,
      0.9464429616928101,
      0.03231336176395416,
      -0.2403707057237625,
      0.1723659336566925,
      0.2647329270839691,
      -0.5498806238174438,
      0.9418260455131531,
      -0.13937310874462128,
      0.6720068454742432,
      -0.8619650602340698,
      0.6501137018203735,
      0.37236425280570984,
      -0.643717348575592,
      -0.1835184395313263,
      -0.16758500039577484,
      -0.8185592293739319,
      0.18080084025859833,
      0.3250872492790222,
      -0.05900240316987038,
      0.01784786954522133,
      0.17832738161087036,
      0.7292166948318481,
      -0.4011898636817932,
      0.3029502034187317,
      0.1470966935157776,
      0.8344844579696655,
      -0.05326743796467781,
      -0.26563912630081177,
      -0.6055561304092407,
      -0.016453515738248825,
      -0.0939953401684761,
      -0.8018421530723572,
      -0.23455199599266052,
      1.0062980651855469,
      -0.4838447570800781,
      0.5824673771858215,
      0.4567658603191376,
      0.0034200269728899,
      1.4699164628982544,
      -1.0492602586746216,
      -0.5984025597572327,
      -0.28123047947883606,
      0.7237487435340881,
      -0.725220799446106,
      0.42188015580177307,
      0.6373758316040039,
      0.3313932716846466,
      -0.1987190544605255,
      -0.8815129995346069,
      -1.1956071853637695,
      0.3840251863002777,
      0.01566050760447979,
      -0.5266145467758179,
      -0.3492646813392639,
      -0.12138425558805466,
      -0.006147992331534624,
      0.9703991413116455,
      0.5944210886955261,
      0.6194775700569153,
      0.5221935510635376,
      0.6095423102378845,
      -0.4359971880912781,
      0.1370849758386612,
      -0.4491080641746521,
      -0.7662472724914551,
      -0.489734947681427,
      -0.4383888244628906,
      0.381019651889801,
      0.21594198048114777,
      -0.1722067892551422,
      -0.3405189514160156,
      0.592754065990448,
      0.44253164529800415,
      0.6374773979187012,
      -0.57811439037323,
      0.005545107647776604,
      -0.1733817309141159,
      0.4890463650226593,
      0.2944503724575043,
      0.5041018724441528,
      1.0461541414260864,
      -0.24134251475334167,
      0.6340962648391724,
      -0.9358932375907898,
      0.1972457617521286,
      0.8606252074241638,
      0.7774821519851685,
      -0.2690826654434204,
      0.21614491939544678,
      -0.09452441334724426,
      0.5562422275543213,
      0.07218831777572632,
      -0.6288555860519409,
      -0.4540575444698334,
      -0.6262479424476624,
      -0.30770477652549744,
      -0.4101119935512543,
      0.2434406876564026,
      -0.5885831117630005,
      -0.4328976571559906,
      -0.11929837614297867,
      -0.06770006567239761,
      0.10901550948619843,
      -0.3544873595237732,
      0.3797300159931183,
      -0.6894651651382446,
      -0.24243243038654327,
      -0.35168713331222534,
      -0.6148925423622131,
      0.8192434310913086,
      -0.18609297275543213,
      -0.250458687543869,
      0.3573267459869385,
      0.1148306280374527,
      0.6561153531074524,
      0.20604871213436127,
      -0.022997327148914337,
      -0.9710515737533569,
      -0.9238737225532532,
      -0.21307842433452606,
      0.009408405981957912,
      0.23095054924488068,
      0.2945769727230072,
      0.5776733160018921,
      -0.3702588677406311,
      0.5251414775848389,
      0.691840410232544,
      -0.8400219082832336,
      -0.061610568314790726,
      0.2650522291660309,
      -1.3640964031219482,
      -0.31513288617134094,
      0.6528772711753845,
      0.3132319748401642,
      0.04368777200579643,
      0.15623551607131958,
      0.058895934373140335,
      -0.29562869668006897,
      0.12385497242212296,
      0.6544618010520935,
      0.6543982625007629,
      -0.07698582112789154,
      0.4626680910587311,
      0.1782602220773697,
      0.9558550715446472,
      -0.34123605489730835,
      -1.0009124279022217,
      -0.2257494032382965,
      0.3137805461883545,
      0.042384784668684006,
      0.948865532875061,
      0.18844346702098846,
      1.4173513650894165,
      -0.1895710825920105,
      -0.5148975849151611,
      -0.27038902044296265,
      -0.17575711011886597,
      -0.10246072709560394,
      -0.06533429026603699,
      0.32574793696403503,
      -0.8092381358146667,
      0.2696811854839325,
      -0.5197504162788391,
      0.18266455829143524,
      0.8373597264289856,
      -0.25338128209114075,
      0.015700312331318855,
      -0.6108123064041138,
      0.3483940660953522,
      0.22674024105072021,
      0.4109639823436737,
      -0.9826425909996033,
      -0.6187690496444702,
      0.3709251880645752,
      0.0665549486875534,
      -0.741870641708374,
      -0.9050235152244568,
      -0.33156728744506836,
      0.6373793482780457,
      -0.6892876625061035,
      0.8535611629486084,
      0.21065828204154968,
      -1.0094016790390015,
      0.6312376260757446,
      -1.1765419244766235,
      -0.49007049202919006,
      -0.5887758731842041,
      -0.4280001223087311,
      -0.6975326538085938,
      -0.35388728976249695,
      0.3397050201892853,
      0.04767898470163345,
      0.23331095278263092,
      0.5624896883964539,
      0.2539882957935333,
      0.49067428708076477,
      -0.10267676413059235,
      -1.822723150253296,
      1.0455515384674072,
      -0.3116339147090912,
      0.7586423754692078,
      0.2670099437236786,
      -0.9787549376487732,
      -0.41424494981765747,
      -0.09425094723701477,
      0.9044253826141357,
      0.15557080507278442,
      -0.3330062925815582,
      0.9179096817970276,
      1.1120537519454956,
      0.3811495006084442,
      1.0332039594650269,
      0.3306075930595398,
      -1.2905712127685547,
      0.438381165266037,
      0.36212772130966187,
      0.3906734883785248,
      0.3348389267921448,
      -0.5136797428131104,
      0.0802961215376854,
      -0.21832439303398132,
      1.0620770454406738,
      -0.5778574347496033,
      0.7462879419326782,
      0.049234144389629364,
      -0.22870022058486938,
      -0.9375966191291809,
      0.12230414152145386,
      0.40077757835388184,
      0.27766725420951843,
      0.4497450292110443,
      -0.6871012449264526,
      -1.869338035583496,
      1.3866043090820312,
      -0.29235008358955383,
      -0.2576267719268799,
      0.1916974037885666,
      0.8453521728515625,
      1.5003020763397217,
      -0.22972483932971954,
      -0.101120226085186,
      0.6421819925308228,
      0.20044797658920288,
      0.3227505385875702,
      -0.3915138244628906,
      0.36161041259765625,
      -1.0846046209335327,
      0.18334975838661194,
      -0.11157648265361786,
      -1.212794542312622,
      0.19155365228652954,
      -0.8860361576080322,
      0.3202308118343353,
      1.2950232028961182,
      -1.0499107837677002,
      -0.5582478046417236,
      0.18135066330432892,
      0.08616892248392105,
      0.1496938019990921,
      0.557944118976593,
      -0.446927547454834,
      -0.09705400466918945,
      0.729145348072052,
      1.1604726314544678,
      0.39369532465934753,
      -2.0614562034606934,
      -0.27381137013435364,
      -0.38027289509773254,
      0.13415274024009705,
      1.6939998865127563,
      0.5431692600250244,
      -0.12917737662792206,
      0.586106538772583,
      0.2396586388349533,
      1.1079328060150146,
      -0.7556391954421997,
      0.3753552734851837,
      -0.2867049276828766,
      -0.8464663624763489,
      -0.0804666206240654,
      0.3217468857765198,
      0.5192970633506775,
      0.03248494118452072,
      0.42598018050193787,
      -0.2230847328901291,
      -0.671885073184967,
      -0.5063268542289734,
      0.09357138723134995,
      0.2216643989086151,
      -0.23729516565799713,
      0.9874365925788879,
      -1.0455870628356934,
      -0.02868804894387722,
      -0.09358853846788406,
      0.4175907075405121,
      -0.3648938536643982,
      0.3584844470024109,
      -0.1507331281900406,
      0.16542795300483704,
      -1.9269176721572876,
      0.8770906329154968,
      0.851982057094574,
      -0.008084787987172604,
      -0.07183563709259033,
      0.47788700461387634,
      -0.32517194747924805,
      -0.2581440508365631,
      -0.6302495002746582,
      -0.26445913314819336,
      0.2478298395872116,
      0.3797359764575958,
      -1.441070556640625,
      0.406013160943985,
      -0.5495976209640503,
      0.36709412932395935,
      -0.03992258757352829,
      -1.0102344751358032,
      -0.13455168902873993,
      0.6547712087631226,
      0.23682373762130737,
      -0.016858572140336037,
      0.9132422804832458,
      1.3056834936141968,
      -0.46326327323913574,
      0.1453491598367691,
      0.7849154472351074,
      -0.5180196762084961,
      -0.22361387312412262,
      -0.39081236720085144,
      -0.32906782627105713,
      0.0858723521232605,
      0.5334488749504089,
      0.9757460355758667,
      -0.7598214149475098,
      -0.16457614302635193,
      -0.898338794708252,
      0.01586102321743965,
      -0.9377134442329407,
      0.2191137671470642,
      -0.6003480553627014,
      -0.4420508146286011,
      -0.5040185451507568,
      -0.8915366530418396,
      -0.1878606379032135,
      -1.135826587677002,
      0.20240293443202972,
      1.559296727180481,
      0.2933979630470276,
      0.18665745854377747,
      -0.8032318949699402,
      -0.6564728021621704,
      0.6180204749107361,
      0.3599351942539215,
      0.164108544588089,
      -0.20097887516021729,
      -1.283588171005249,
      0.4285576641559601,
      0.5571053624153137,
      -0.5227588415145874,
      0.32681339979171753,
      0.9558104872703552,
      -0.21867871284484863,
      -1.0604772567749023,
      -0.45358598232269287,
      0.20137041807174683,
      -1.2689952850341797,
      0.15005528926849365,
      0.7954114079475403,
      0.15410569310188293,
      1.0609267950057983,
      -0.08734538406133652,
      -0.7357720732688904,
      -0.006007389631122351,
      0.15030816197395325,
      -1.5181342363357544,
      -0.14249248802661896,
      0.9367481470108032,
      -0.5914268493652344,
      0.27876943349838257,
      -0.5966407656669617,
      -0.7920060157775879,
      0.3444567322731018,
      -0.7269830703735352,
      -1.696291208267212,
      -0.08416754752397537,
      0.5002921223640442,
      1.3784921169281006,
      -1.529228687286377,
      -0.07573575526475906,
      1.0739744901657104,
      -0.5815598368644714,
      0.17273679375648499,
      -0.14059221744537354,
      0.6699649691581726,
      0.2319662868976593,
      -0.14358875155448914,
      -0.22674886882305145,
      0.46376582980155945,
      0.6071125268936157,
      -0.7967473864555359,
      0.9935588240623474,
      0.0369003564119339,
      0.004551468417048454,
      -0.656596302986145,
      -0.28473183512687683,
      -0.7748642563819885,
      0.9957205653190613,
      -1.592663288116455,
      0.612234354019165,
      -0.9348201155662537,
      -0.5835790038108826,
      -0.1634492129087448,
      0.46150708198547363,
      0.5605001449584961,
      -1.4985089302062988,
      -0.11311948299407959,
      -1.7949191331863403,
      0.33743318915367126,
      -0.5502629280090332,
      0.971466064453125,
      -0.7529369592666626,
      1.230115532875061,
      0.48533207178115845,
      1.1635569334030151,
      0.0038203729782253504,
      0.029320506379008293,
      -0.6088033318519592,
      0.8011509776115417,
      -0.6619993448257446,
      -1.1924370527267456,
      0.39792600274086,
      0.9046831130981445,
      0.06068450212478638,
      -0.14195352792739868,
      1.228827714920044,
      1.3118276596069336,
      -0.3631186783313751,
      -0.3736085295677185,
      0.7224605083465576,
      -0.4257128834724426,
      -0.11213888972997665,
      -0.7083421349525452,
      -0.3620922267436981,
      -0.9645693302154541,
      -0.2526124119758606,
      -0.6217785477638245,
      -0.5122641324996948,
      -0.3350391089916229,
      0.9479062557220459,
      0.39161017537117004,
      -0.3964984714984894,
      0.24512101709842682,
      -0.4306672513484955,
      -1.5671128034591675,
      -0.10547886043787003,
      0.6492857336997986,
      0.16516320407390594,
      0.9213541150093079,
      0.9032381176948547,
      -0.015599667094647884,
      0.6201198697090149,
      0.595363199710846,
      0.5812719464302063,
      -0.5988503098487854,
      1.0171964168548584,
      0.37108585238456726,
      1.0024385452270508,
      0.6329139471054077,
      -0.21516811847686768,
      -0.5742539167404175,
      0.12906306982040405,
      -1.2141668796539307,
      -0.3571174740791321,
      0.15937332808971405,
      0.18188804388046265,
      0.30582883954048157,
      0.16206900775432587,
      -0.05849185213446617,
      -1.0434025526046753,
      0.965491771697998,
      -0.5348618030548096,
      -0.6813032627105713,
      0.4630649983882904,
      0.9018419981002808,
      0.11279506981372833,
      0.04034199193120003,
      0.5539984107017517,
      0.19852030277252197,
      -0.35786309838294983,
      -0.25037169456481934,
      0.5169732570648193,
      0.13723045587539673,
      -0.04424343630671501,
      -0.768951416015625,
      -0.20307394862174988,
      0.09946000576019287,
      -0.23415109515190125,
      1.0035483837127686,
      -0.26601025462150574,
      0.35849159955978394,
      -0.45058247447013855,
      -0.9769895076751709,
      -0.5689932107925415,
      -1.1990787982940674,
      -0.30264467000961304,
      -0.06340428441762924,
      -1.0932211875915527,
      0.6376811265945435,
      -0.16239458322525024,
      -0.9963628649711609,
      -0.41634583473205566,
      -0.5150376558303833,
      -0.24679920077323914,
      0.602656900882721,
      -1.312190294265747,
      0.053603582084178925,
      -1.5413756370544434,
      0.8383898138999939,
      0.572395384311676,
      0.44321709871292114,
      -0.5565657615661621,
      -0.21823035180568695,
      -0.9251230359077454,
      -0.2598329782485962,
      -0.862540602684021,
      0.8572487235069275,
      0.5242998600006104,
      -0.31193220615386963,
      -0.5735200047492981,
      -0.6516253352165222,
      -1.0868780612945557,
      1.3679875135421753,
      0.20946213603019714,
      -0.2480878382921219,
      0.10858271270990372,
      -0.21887804567813873,
      -0.7388781309127808,
      0.4983287453651428,
      -0.4100283980369568,
      0.40145018696784973,
      -0.13511338829994202,
      0.787156879901886,
      1.0832486152648926,
      -0.4730505347251892,
      -0.20169851183891296,
      -0.7409062385559082,
      0.5828744173049927,
      0.22313067317008972,
      0.5453203320503235,
      -0.6794981360435486,
      0.06248895451426506,
      -0.483261376619339
    ],
    "label": {
      "level1": "SAM",
      "level2": "DT",
      "level3": "BIT",
      "leafContractCategory": "BIT",
      "rootCause": "Unacceptable Input Type",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Evaluation",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/48674881",
    "title": "",
    "question": "\"I want to do multi label classification (20 distinct output labels), based on vectorized words using TfidfVectorizer. I have set of 39974 rows each one containing 2739 items (zeros or ones).\n\nI would like to classify this data using Keras model which will contain 1 hidden layer (~20 nodes with activation='relu') and output layer equal 20 possible output values (with activation='softmax' to choose best fit).\n\nHere's my code so far:\n\nmodel = Sequential()\nmodel.add(Dense(units=20, activation='relu', input_shape=tfidf_matrix.shape))\nmodel.add(Dense(units=20, activation='softmax'))\nmodel.compile(optimizer='rmsprop', loss='categorical_crossentropy', metrics=['accuracy'])\nmodel.fit(tfidf_matrix, train_data['cuisine_id'], epochs=10)\n\nBut got error: \n\n  ValueError: Error when checking input: expected dense_1_input to have\n  3 dimensions, but got array with shape (39774, 2739)\n\nHow can I specify this NN to fit using this matrix?\"",
    "answer": "\"The number of rows (number of training samples) is not the part of the input shape of the network because the training process feeds the network one sample per batch (or, more precisely, batch_size samples per batch).\n\nSo in your case, input shape of the network is (2739, ) and the right code should be like this:\n\nmodel = Sequential()\n# the shape of one training example is\ninput_shape = tfidf_matrix[0].shape\nmodel.add(Dense(units=20, activation='relu', input_shape=input_shape))\nmodel.add(Dense(units=20, activation='softmax'))\nmodel.compile(optimizer='rmsprop', loss='categorical_crossentropy', \nmetrics=['accuracy'])\nmodel.fit(tfidf_matrix, train_data['cuisine_id'], epochs=10)\"",
    "mlApiName": "keras.layers.Dense",
    "embedding": [
      -0.013241736218333244,
      0.9975419640541077,
      -2.6239778995513916,
      -0.7199615240097046,
      1.2152442932128906,
      -0.8091418743133545,
      0.3171249032020569,
      0.5776383280754089,
      -1.1535301208496094,
      -0.6347804069519043,
      -0.3277775049209595,
      0.15424451231956482,
      2.1743721961975098,
      0.03230166435241699,
      -0.6726041436195374,
      -0.7827604413032532,
      -0.032901473343372345,
      -0.08716857433319092,
      0.003942421637475491,
      0.27533870935440063,
      -0.1339384913444519,
      0.4832032322883606,
      -0.2889562249183655,
      -0.18968573212623596,
      0.9256039261817932,
      0.07057078927755356,
      -0.5541730523109436,
      0.539393961429596,
      -0.3162992000579834,
      0.7156696915626526,
      0.14193642139434814,
      -0.6013268232345581,
      -0.3018210828304291,
      -1.277126669883728,
      -1.0734140872955322,
      -0.3931891918182373,
      0.7712574601173401,
      0.6843015551567078,
      0.27438828349113464,
      0.7150819301605225,
      0.6252496838569641,
      0.05655980855226517,
      -0.2701972424983978,
      0.34928247332572937,
      0.046018775552511215,
      0.3399454355239868,
      1.41246497631073,
      0.0575578510761261,
      0.9840589165687561,
      -0.516309916973114,
      0.47210022807121277,
      0.5832500457763672,
      0.8196995258331299,
      0.03680214658379555,
      0.8941819667816162,
      0.27065446972846985,
      -1.2936654090881348,
      0.6615293622016907,
      0.6289358735084534,
      -0.4827618896961212,
      0.4328601062297821,
      0.5588492155075073,
      -1.6941075325012207,
      0.8501896858215332,
      0.3245779275894165,
      0.7894452214241028,
      -1.079359769821167,
      0.6399258375167847,
      -0.5354985594749451,
      -0.6838353872299194,
      0.7082833647727966,
      -0.22056658565998077,
      0.13223108649253845,
      0.4618180990219116,
      -0.5512677431106567,
      -0.054160140454769135,
      -0.8266140818595886,
      -0.7201034426689148,
      -0.09944236278533936,
      0.6584500670433044,
      0.40387144684791565,
      1.053020715713501,
      1.0091068744659424,
      -0.20442014932632446,
      -0.16840513050556183,
      0.6694446206092834,
      -1.224847674369812,
      -0.2250608652830124,
      -0.4936029016971588,
      1.599763035774231,
      -0.32557040452957153,
      -0.11201406270265579,
      0.5273365378379822,
      1.2187947034835815,
      -0.4574066996574402,
      -0.22548244893550873,
      -0.011978043243288994,
      -0.06979214400053024,
      -0.8665563464164734,
      -0.5560380220413208,
      -0.43764498829841614,
      0.5349669456481934,
      -0.2661398649215698,
      -1.036436915397644,
      -0.7206369042396545,
      1.2414255142211914,
      -0.15874606370925903,
      0.15567521750926971,
      0.18986602127552032,
      -0.23601706326007843,
      -0.35863062739372253,
      0.25322654843330383,
      -0.44029706716537476,
      -0.24459707736968994,
      -0.6799789667129517,
      -0.4659186899662018,
      0.7153619527816772,
      -0.4761543571949005,
      -0.05457717180252075,
      -0.043847259134054184,
      0.6147074699401855,
      -1.1591566801071167,
      0.8022879958152771,
      0.2999167740345001,
      -0.37138813734054565,
      1.0323715209960938,
      -0.5275312066078186,
      0.8462260961532593,
      -0.3891964852809906,
      -1.5589078664779663,
      -0.16758842766284943,
      -0.03988007456064224,
      0.02535862848162651,
      0.4212093651294708,
      0.06096811965107918,
      1.0277546644210815,
      -2.035830020904541,
      -0.5292457342147827,
      -0.27477410435676575,
      0.16622643172740936,
      0.2048889845609665,
      0.2908579111099243,
      0.17508865892887115,
      -0.7198383808135986,
      0.6037380695343018,
      -0.8671994805335999,
      -0.08667165040969849,
      -0.5957004427909851,
      -0.7504583597183228,
      -0.07351362705230713,
      0.11511096358299255,
      1.1531606912612915,
      -1.3129136562347412,
      -0.335491806268692,
      0.501079797744751,
      -0.08803402632474899,
      0.5796039700508118,
      0.18532225489616394,
      -0.1608467847108841,
      -0.25242501497268677,
      1.3716553449630737,
      0.16288666427135468,
      -0.48345181345939636,
      0.31227174401283264,
      -0.47044312953948975,
      -0.6286919713020325,
      0.044872917234897614,
      0.5801014304161072,
      -0.2083197385072708,
      0.21160736680030823,
      -0.9858511686325073,
      -1.0094050168991089,
      0.35049518942832947,
      -0.043847329914569855,
      0.008232012391090393,
      0.9530676603317261,
      0.9900490045547485,
      -0.7962896823883057,
      1.036334753036499,
      0.18086443841457367,
      0.6216076612472534,
      0.43922290205955505,
      0.923536479473114,
      -0.028856877237558365,
      -0.1310013085603714,
      -0.32618680596351624,
      0.4366699755191803,
      -0.18242838978767395,
      -0.24914683401584625,
      -0.10231031477451324,
      0.4055347442626953,
      0.16743332147598267,
      -0.35829657316207886,
      -0.47693488001823425,
      0.03449275717139244,
      0.018342215567827225,
      1.0230436325073242,
      -1.1828434467315674,
      0.48083174228668213,
      -0.2246006280183792,
      0.32358062267303467,
      0.5865420699119568,
      -0.2881520986557007,
      0.7871100306510925,
      -0.8709550499916077,
      0.9011173844337463,
      -0.33456194400787354,
      0.8325561285018921,
      -0.520892322063446,
      0.9359360933303833,
      -0.2182588130235672,
      -0.35395652055740356,
      0.2592257857322693,
      0.7802891135215759,
      0.2758672535419464,
      -0.33492907881736755,
      0.6677631139755249,
      0.14564841985702515,
      0.07873262465000153,
      -0.13588005304336548,
      0.03540429845452309,
      -0.3130720555782318,
      1.0176184177398682,
      -0.07526598870754242,
      0.7697259187698364,
      -1.0119606256484985,
      0.3927980959415436,
      0.004511272069066763,
      -0.2750248908996582,
      -0.6523784399032593,
      0.24061237275600433,
      -0.8956701755523682,
      0.7880862951278687,
      -0.3226906359195709,
      -0.557204008102417,
      -0.07472781836986542,
      0.295345276594162,
      0.755859911441803,
      -0.8706515431404114,
      -0.4953120946884155,
      -0.12619982659816742,
      1.2247792482376099,
      0.34628796577453613,
      -0.14469626545906067,
      -1.1705143451690674,
      -0.18641361594200134,
      -0.36387163400650024,
      -0.754553496837616,
      0.21157504618167877,
      0.8730225563049316,
      -0.2842136025428772,
      0.28451576828956604,
      0.8572714328765869,
      0.07659706473350525,
      0.8894225358963013,
      -0.6243073344230652,
      -0.22336527705192566,
      0.19372208416461945,
      0.8859747052192688,
      -0.3707939088344574,
      0.9572014212608337,
      0.4289110600948334,
      -0.004456214606761932,
      0.01740621030330658,
      -0.19823086261749268,
      -1.1506909132003784,
      0.05658166855573654,
      -0.2759995460510254,
      -0.09429491311311722,
      -0.47419553995132446,
      0.038907889276742935,
      0.32478979229927063,
      1.0588878393173218,
      0.10274426639080048,
      0.9728338718414307,
      1.3731940984725952,
      -0.16668452322483063,
      0.3211422264575958,
      0.282614529132843,
      -0.024014025926589966,
      -0.8743025660514832,
      -0.8225001096725464,
      -0.027068860828876495,
      0.0846046581864357,
      0.1839316338300705,
      -0.37222054600715637,
      0.19982829689979553,
      0.24759437143802643,
      0.08966068178415298,
      0.5093590617179871,
      -0.7345402240753174,
      -0.14672984182834625,
      -0.299540638923645,
      -0.5716068744659424,
      -0.2191145271062851,
      0.2755274474620819,
      0.7307931184768677,
      -0.49000221490859985,
      0.7847973704338074,
      -0.7744215726852417,
      -0.11218985915184021,
      0.589413583278656,
      0.7661769390106201,
      -0.40759846568107605,
      0.38175681233406067,
      0.37885645031929016,
      -0.07095902413129807,
      -0.30544033646583557,
      -0.2617369592189789,
      -0.5352765917778015,
      -0.6704820394515991,
      -0.14382188022136688,
      -0.5762238502502441,
      0.3933855891227722,
      -0.12015274167060852,
      -0.3549487292766571,
      -0.28349071741104126,
      0.34143683314323425,
      0.1564660221338272,
      -0.8881441950798035,
      0.01530630886554718,
      -0.26484206318855286,
      0.09009145945310593,
      -0.33986178040504456,
      -0.24757370352745056,
      1.15316641330719,
      0.07533969730138779,
      0.3697121739387512,
      0.22086890041828156,
      0.20328497886657715,
      0.7193624973297119,
      -0.03482162207365036,
      0.18225659430027008,
      -0.7914233207702637,
      -0.826094925403595,
      0.29081282019615173,
      -0.04175497218966484,
      0.003841796889901161,
      0.9508237242698669,
      0.26330745220184326,
      -0.5949953198432922,
      0.17014147341251373,
      0.48977333307266235,
      -1.1582605838775635,
      0.013762036338448524,
      0.26587367057800293,
      -1.125693917274475,
      -0.08884549140930176,
      0.30845019221305847,
      0.8335376977920532,
      0.0315895713865757,
      0.054894424974918365,
      -0.615415632724762,
      -0.5786066651344299,
      0.7524779438972473,
      -0.3029451072216034,
      1.194759488105774,
      0.3516015112400055,
      0.14422926306724548,
      -0.0664353147149086,
      0.6745315790176392,
      -0.22959092259407043,
      -0.3900865614414215,
      -0.10882201790809631,
      0.39857155084609985,
      0.5819644331932068,
      1.2861109972000122,
      -0.07839088141918182,
      1.539119005203247,
      -0.29097163677215576,
      0.033042699098587036,
      -0.3197269141674042,
      -0.3937103748321533,
      0.5775949954986572,
      -0.6241553425788879,
      0.37606605887413025,
      -0.9062848091125488,
      -0.04334146901965141,
      -0.4052346646785736,
      0.0410347618162632,
      0.20409902930259705,
      0.09925763309001923,
      0.42997097969055176,
      -0.2851758897304535,
      0.540982723236084,
      0.5619144439697266,
      0.5597211122512817,
      -0.6245402097702026,
      -0.32842931151390076,
      1.092512845993042,
      -0.18116474151611328,
      -0.34579625725746155,
      -0.9386127591133118,
      -0.5407341122627258,
      0.16602066159248352,
      -0.5803296566009521,
      0.6667706966400146,
      0.5745721459388733,
      -0.8364763259887695,
      0.8467386960983276,
      -0.5909280180931091,
      -0.5124496221542358,
      -0.0322653092443943,
      -0.36045464873313904,
      -0.5717598795890808,
      -0.5835846662521362,
      0.27654269337654114,
      0.34697699546813965,
      0.49469706416130066,
      0.7108173966407776,
      0.14879922568798065,
      0.03272267431020737,
      -0.2546579837799072,
      -1.32271409034729,
      0.32882118225097656,
      0.20616476237773895,
      0.7507848739624023,
      -0.33246850967407227,
      -0.9202746748924255,
      -0.9600649476051331,
      -0.46550124883651733,
      0.10975789278745651,
      -0.5777139067649841,
      -0.3866344094276428,
      1.0888054370880127,
      0.12106585502624512,
      0.708441436290741,
      0.9393466114997864,
      0.43752339482307434,
      -1.2532522678375244,
      -0.01380925066769123,
      0.5803254246711731,
      -0.2856222987174988,
      -0.5232125520706177,
      -0.21633213758468628,
      0.2816969156265259,
      -0.32955610752105713,
      0.6316680908203125,
      -0.1293952912092209,
      0.49613329768180847,
      -0.1557658165693283,
      -0.07556571811437607,
      -0.3578242063522339,
      -0.49689558148384094,
      0.09964002668857574,
      0.2707977890968323,
      0.8738341927528381,
      -0.9203671813011169,
      -1.8934581279754639,
      0.9540124535560608,
      0.11147718131542206,
      -0.33222323656082153,
      0.38028112053871155,
      0.6559170484542847,
      1.513034462928772,
      0.002816308755427599,
      0.13471315801143646,
      0.4551655054092407,
      0.7220088243484497,
      0.7344025373458862,
      0.17007170617580414,
      0.1374179571866989,
      -1.6810753345489502,
      0.2561091482639313,
      -0.43734458088874817,
      -1.126459002494812,
      -0.3385915160179138,
      -0.6393986940383911,
      0.3419550061225891,
      1.0370123386383057,
      -0.9134730696678162,
      -0.1832742840051651,
      0.43548303842544556,
      0.1709347814321518,
      0.1896751970052719,
      0.33790406584739685,
      -0.44151371717453003,
      0.3378314971923828,
      -0.12918518483638763,
      0.6447439193725586,
      0.1864633858203888,
      -1.4925732612609863,
      -0.16872599720954895,
      -0.16362665593624115,
      0.17904575169086456,
      2.0869626998901367,
      0.30718231201171875,
      -0.7252503633499146,
      0.5502855181694031,
      0.16366924345493317,
      0.6443156599998474,
      -0.5825734734535217,
      0.11557336151599884,
      -0.15655113756656647,
      -0.47137129306793213,
      -0.25382858514785767,
      0.06136927381157875,
      0.17969462275505066,
      0.20617350935935974,
      0.1898607462644577,
      0.03837965801358223,
      -0.18722385168075562,
      -0.4168063998222351,
      -0.18913981318473816,
      0.654411792755127,
      -0.6805612444877625,
      1.0393192768096924,
      -0.7589762806892395,
      0.25583675503730774,
      -0.22873803973197937,
      0.053394824266433716,
      -0.24674749374389648,
      0.25701507925987244,
      -0.6170130372047424,
      0.21830607950687408,
      -1.6851420402526855,
      0.49176767468452454,
      1.229640007019043,
      -0.23926100134849548,
      -0.23309285938739777,
      0.7962799668312073,
      -0.5602855682373047,
      -0.453398734331131,
      -0.7425705790519714,
      -0.10657056421041489,
      0.14943554997444153,
      0.2581815719604492,
      -1.1489477157592773,
      0.24532145261764526,
      -0.7973406314849854,
      0.8073814511299133,
      0.14495903253555298,
      -1.4889661073684692,
      -0.0819597914814949,
      0.43264859914779663,
      0.40348970890045166,
      0.12037168443202972,
      0.6995956301689148,
      0.8537991642951965,
      -0.44421112537384033,
      0.19447597861289978,
      0.6528390049934387,
      -0.10013836622238159,
      -0.6185749769210815,
      -0.38811612129211426,
      -0.4937460422515869,
      0.46134862303733826,
      0.6979812383651733,
      0.29020148515701294,
      -0.5336002111434937,
      0.0577678345143795,
      -1.0191725492477417,
      0.53898686170578,
      -0.3442193567752838,
      0.8141143321990967,
      -0.2876960039138794,
      -0.697990357875824,
      -0.7682032585144043,
      -0.334005743265152,
      0.0008231977699324489,
      -1.3324213027954102,
      0.3325057029724121,
      0.5183947682380676,
      0.4090019464492798,
      -0.4947736859321594,
      -0.38364747166633606,
      -0.7016682624816895,
      0.5337505340576172,
      0.14002123475074768,
      0.3355679214000702,
      0.16448426246643066,
      -1.581494688987732,
      0.34303271770477295,
      0.42737823724746704,
      -0.04948462173342705,
      0.12181102484464645,
      1.180455207824707,
      0.35752683877944946,
      -0.7679711580276489,
      -0.31564706563949585,
      0.21365047991275787,
      -1.1654921770095825,
      -0.14462779462337494,
      0.22814546525478363,
      0.3659302890300751,
      0.8732283115386963,
      -0.46518784761428833,
      -0.7972500920295715,
      -0.2831141948699951,
      -0.5255222916603088,
      -0.6351005434989929,
      -0.41274917125701904,
      1.2135580778121948,
      0.1658688187599182,
      -0.17680008709430695,
      -0.3816887438297272,
      -0.683813750743866,
      0.7111099362373352,
      -0.8620019555091858,
      -1.0344622135162354,
      -0.2156791090965271,
      0.6462574601173401,
      0.5285285711288452,
      -0.8721305131912231,
      0.5948538184165955,
      1.2322673797607422,
      -0.7970706820487976,
      0.35435816645622253,
      -0.5419183969497681,
      0.1916111260652542,
      0.384674608707428,
      -0.4024913012981415,
      -0.4062722325325012,
      0.1619657576084137,
      0.6407558917999268,
      -1.2247469425201416,
      0.8764828443527222,
      -0.13643063604831696,
      -0.4048483073711395,
      -0.3633977472782135,
      -0.41906988620758057,
      -1.1242858171463013,
      1.0385117530822754,
      -1.3567312955856323,
      0.2231886088848114,
      -0.7942520976066589,
      -0.2576713263988495,
      -0.16478541493415833,
      0.6573840975761414,
      0.5580425262451172,
      -1.1011899709701538,
      0.08115080744028091,
      -0.9274202585220337,
      -0.08516345918178558,
      -0.7381855845451355,
      0.8061693906784058,
      -0.5543188452720642,
      0.6101908087730408,
      0.9428237080574036,
      1.6413406133651733,
      -0.31357690691947937,
      -0.05275679752230644,
      -0.599442183971405,
      0.5298811197280884,
      0.3678703010082245,
      -0.6036390066146851,
      0.6364854574203491,
      0.6870336532592773,
      0.5658546090126038,
      0.4127880036830902,
      1.180884838104248,
      0.8124344348907471,
      -0.42659685015678406,
      0.0402979739010334,
      0.16507022082805634,
      0.02707255631685257,
      0.12358110398054123,
      -0.9781287908554077,
      -0.7846856117248535,
      0.009831711649894714,
      0.31108731031417847,
      -0.3646099865436554,
      -0.3514430820941925,
      -0.41029930114746094,
      0.26229313015937805,
      0.08741834759712219,
      -0.3032255470752716,
      0.005607730243355036,
      -0.4297392666339874,
      -1.7205467224121094,
      0.13351981341838837,
      0.30008986592292786,
      0.11581482738256454,
      0.8217839598655701,
      0.5230209827423096,
      -0.14380618929862976,
      1.084193468093872,
      1.1268301010131836,
      0.557180643081665,
      -0.0010622965637594461,
      0.8485133647918701,
      -0.3145744800567627,
      0.8832982778549194,
      0.2947057783603668,
      0.19054311513900757,
      -1.0874841213226318,
      -0.0686911940574646,
      -0.6878334283828735,
      0.6914588212966919,
      -0.059966109693050385,
      0.175558939576149,
      -0.264972984790802,
      -0.11738480627536774,
      -0.13323737680912018,
      -1.1856670379638672,
      1.4158655405044556,
      -0.17816407978534698,
      -0.5326929092407227,
      0.8446838855743408,
      1.069549322128296,
      0.05198831856250763,
      0.8030495643615723,
      0.011120445095002651,
      0.3205151855945587,
      -0.31949692964553833,
      0.5906304717063904,
      -0.17246177792549133,
      -0.026784880086779594,
      0.3339117467403412,
      -1.1653306484222412,
      -0.364752858877182,
      0.24687588214874268,
      -0.9644196629524231,
      0.9729758501052856,
      -0.3709557354450226,
      0.5728984475135803,
      -0.30204376578330994,
      -0.16718293726444244,
      -0.597849428653717,
      -0.9306479692459106,
      -0.1645839512348175,
      0.039240945130586624,
      -1.0004321336746216,
      0.6518906354904175,
      -0.2706563174724579,
      -0.8222414255142212,
      -0.2874247431755066,
      -0.2774144113063812,
      -0.024836407974362373,
      -0.10580067336559296,
      -1.1824091672897339,
      0.16496840119361877,
      -1.8009023666381836,
      1.1720809936523438,
      0.42138320207595825,
      -0.18160800635814667,
      -0.21426571905612946,
      -0.36529210209846497,
      -0.41129156947135925,
      0.43090882897377014,
      -0.5097455382347107,
      0.8914061784744263,
      0.16138027608394623,
      -0.01866929978132248,
      -0.44026896357536316,
      -0.12338723987340927,
      -1.0275979042053223,
      1.3872190713882446,
      -0.005730459000915289,
      -0.4310212731361389,
      -0.15098996460437775,
      -0.8245562314987183,
      -0.5368291735649109,
      0.7149477601051331,
      0.01107502356171608,
      0.5834769606590271,
      0.09779800474643707,
      0.899459958076477,
      1.645651936531067,
      -0.1187918484210968,
      0.23982581496238708,
      -0.5420898199081421,
      0.30338436365127563,
      0.5405398011207581,
      0.2960551381111145,
      -0.33393022418022156,
      0.10327133536338806,
      -0.38814467191696167
    ],
    "label": {
      "level1": "SAM",
      "level2": "DT",
      "level3": "MT",
      "leafContractCategory": "MT",
      "rootCause": "Unacceptable Input Type",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Model Construction",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  },
  {
    "postURL": "https://stackoverflow.com/questions/48373845",
    "title": "",
    "question": "\"In Keras, if you need to have a custom loss with additional parameters, we can use it like mentioned on https://datascience.stackexchange.com/questions/25029/custom-loss-function-with-additional-parameter-in-keras\n\ndef penalized_loss(noise):\n    def loss(y_true, y_pred):\n        return K.mean(K.square(y_pred - y_true) - K.square(y_true - noise), axis=-1)\n    return loss\n\nThe above method works when I am training the model. However, once the model is trained I am having difficulty in loading the model. When I try to use the custom_objects parameter in load_model like below\n\nmodel = load_model(modelFile, custom_objects={'penalized_loss': penalized_loss} )\n\nit complains ValueError: Unknown loss function:loss\n\nIs there any way to pass in the loss function as one of the custom losses in custom_objects ? From what I can gather, the inner function is not in the namespace during load_model call. Is there any easier way to load the model or use a custom loss with additional parameters\"",
    "answer": "\"Yes, there is! custom_objects expects the exact function that you used as loss function (the inner one in your case):\n\nmodel = load_model(modelFile, custom_objects={ 'loss': penalized_loss(noise) })\n\nUnfortunately keras won't store in the model the value of noise, so you need to feed it to the load_model function manually.\"",
    "mlApiName": "keras.models.load_model",
    "embedding": [
      0.34530264139175415,
      0.2724122107028961,
      -2.643554925918579,
      -1.778464674949646,
      1.3925495147705078,
      -0.1353931725025177,
      0.07954365015029907,
      -0.27752506732940674,
      -0.31363946199417114,
      -0.6829082369804382,
      -0.7630465626716614,
      0.358065664768219,
      2.5496983528137207,
      -0.1723213940858841,
      -0.5582065582275391,
      -0.570946991443634,
      0.5555515289306641,
      -0.11355281621217728,
      -0.6306388974189758,
      1.3888006210327148,
      0.0359518863260746,
      -0.9458004236221313,
      -0.24963243305683136,
      0.06912386417388916,
      0.8320899605751038,
      0.981387734413147,
      -0.19594085216522217,
      0.8482741713523865,
      -0.08611570298671722,
      1.2746683359146118,
      0.38201773166656494,
      -1.3258097171783447,
      0.29250627756118774,
      -1.2135355472564697,
      -1.6210055351257324,
      -0.4311297833919525,
      1.1103872060775757,
      0.40895959734916687,
      0.2655844986438751,
      0.4851267635822296,
      0.5475655198097229,
      -0.0739753246307373,
      -0.04787861555814743,
      0.8518753051757812,
      0.2820759415626526,
      -0.15129773318767548,
      1.0483453273773193,
      0.5600351095199585,
      0.7495356202125549,
      -0.5185621976852417,
      1.1227695941925049,
      -0.46571701765060425,
      -0.36465543508529663,
      -0.5986047983169556,
      1.4759677648544312,
      0.48720884323120117,
      0.4694601893424988,
      0.7064384818077087,
      1.1264766454696655,
      -1.1690171957015991,
      0.4288870692253113,
      1.3234044313430786,
      -1.2069706916809082,
      0.9688968062400818,
      0.23849521577358246,
      -0.7946242094039917,
      -0.7797375321388245,
      1.0401405096054077,
      -0.5919652581214905,
      -0.20871645212173462,
      0.9966117739677429,
      1.659119963645935,
      0.31186145544052124,
      -0.42055565118789673,
      -0.6892191767692566,
      0.6720333099365234,
      -0.5453222393989563,
      -0.471721887588501,
      -0.2980133593082428,
      0.179146870970726,
      -0.6725189089775085,
      1.2168443202972412,
      1.3439205884933472,
      -0.31357628107070923,
      0.3940218985080719,
      0.48548880219459534,
      -0.7634502649307251,
      -0.04156294837594032,
      -0.4849008619785309,
      1.2594090700149536,
      -0.19540730118751526,
      -0.665046751499176,
      0.35057878494262695,
      0.843895673751831,
      -0.9465368390083313,
      -0.32072529196739197,
      -0.7743548154830933,
      0.10966568440198898,
      -0.3143651783466339,
      -0.31435567140579224,
      0.043496184051036835,
      0.12711600959300995,
      -0.6406428217887878,
      -0.9935568571090698,
      -0.36987531185150146,
      0.9961597323417664,
      -0.025100886821746826,
      0.11446189135313034,
      0.3781203031539917,
      -0.7794162034988403,
      -0.45618510246276855,
      0.10094169527292252,
      0.21365197002887726,
      -0.5216720104217529,
      -0.24237455427646637,
      -0.821494460105896,
      0.801481306552887,
      -0.7761151194572449,
      0.04419221729040146,
      0.2841745615005493,
      -0.6586202383041382,
      0.029698975384235382,
      0.7636236548423767,
      -0.020101480185985565,
      -0.5508502125740051,
      1.2403734922409058,
      -0.011324719525873661,
      0.1021733433008194,
      -0.3149474263191223,
      -1.0820900201797485,
      -0.41445276141166687,
      -1.1010667085647583,
      -0.4788200259208679,
      0.6862484216690063,
      1.022892951965332,
      1.0852590799331665,
      -0.6750544309616089,
      -0.9598364233970642,
      -0.045367319136857986,
      0.3928145170211792,
      0.28347018361091614,
      0.019120151177048683,
      -0.034749556332826614,
      -0.8330559134483337,
      -0.314248651266098,
      -0.8834128379821777,
      1.2527707815170288,
      -0.9148672819137573,
      -0.9942158460617065,
      -0.3624747097492218,
      0.46768996119499207,
      0.38373908400535583,
      -0.9506320953369141,
      0.016209475696086884,
      0.5110005736351013,
      -1.1666090488433838,
      -0.06635761260986328,
      0.8844223618507385,
      0.4702799618244171,
      -0.08571048825979233,
      0.5477653741836548,
      0.6998882293701172,
      -0.6353015303611755,
      1.6588537693023682,
      -0.8166266679763794,
      -0.6902639269828796,
      -0.3764239251613617,
      0.42470335960388184,
      -0.4802125096321106,
      -0.23605595529079437,
      -0.44592565298080444,
      -0.9814937710762024,
      0.5735635757446289,
      -0.26411372423171997,
      0.6135841608047485,
      0.25590312480926514,
      1.0952271223068237,
      -0.5527507662773132,
      0.04922156035900116,
      -0.607016921043396,
      0.6736590266227722,
      -0.8001847267150879,
      0.7231517434120178,
      -0.3891143798828125,
      -0.7243703603744507,
      0.28792956471443176,
      0.17487689852714539,
      0.5511672496795654,
      0.42308878898620605,
      -0.5669183135032654,
      0.41988784074783325,
      0.520623505115509,
      0.3410479724407196,
      -0.7217081785202026,
      0.23236523568630219,
      -0.23827999830245972,
      0.688264787197113,
      -0.3039964437484741,
      0.7768052220344543,
      0.22888314723968506,
      0.09222415089607239,
      0.1321091204881668,
      -0.4989069402217865,
      -0.20299024879932404,
      -0.43280136585235596,
      0.47644713521003723,
      0.15967120230197906,
      0.3480842411518097,
      -0.12306500971317291,
      0.23961949348449707,
      0.44969984889030457,
      0.0015075716655701399,
      0.4156818389892578,
      0.6802889108657837,
      0.5448599457740784,
      -0.17381228506565094,
      0.013847040012478828,
      0.17422957718372345,
      -0.5476430058479309,
      0.07135412096977234,
      0.3188878893852234,
      -0.6367560625076294,
      0.5397779941558838,
      -0.34693798422813416,
      0.6002160906791687,
      -0.4729555547237396,
      -0.05194253847002983,
      -0.1670415848493576,
      -0.7938342690467834,
      -0.25437605381011963,
      -0.6433777213096619,
      -0.9540371298789978,
      0.7457401156425476,
      0.5116388201713562,
      0.1443215012550354,
      0.9499605894088745,
      1.0311625003814697,
      1.2486940622329712,
      -0.33791035413742065,
      0.4800265431404114,
      0.8164920210838318,
      0.7355843186378479,
      0.546856701374054,
      0.03464813902974129,
      -1.3068552017211914,
      0.3502315282821655,
      -0.7819901704788208,
      -1.1768178939819336,
      0.2305118888616562,
      0.554990828037262,
      -0.04346752539277077,
      0.8903882503509521,
      0.5535942912101746,
      -0.12542352080345154,
      1.4615541696548462,
      -0.7421485781669617,
      -0.505255937576294,
      -0.5222204327583313,
      0.7160823941230774,
      0.1619803011417389,
      0.26174718141555786,
      0.37794312834739685,
      -0.26306045055389404,
      -0.3126620352268219,
      -0.6246796250343323,
      -0.640066921710968,
      -0.06945368647575378,
      -0.08877244591712952,
      0.08095017820596695,
      -0.024639131501317024,
      0.10526565462350845,
      0.09703445434570312,
      0.866003155708313,
      1.454817533493042,
      1.0451428890228271,
      0.40554529428482056,
      -0.5139337182044983,
      -0.3439117968082428,
      -0.12379901856184006,
      -0.30884185433387756,
      -0.2412901371717453,
      -0.6422527432441711,
      -1.4842097759246826,
      -0.6770843863487244,
      -0.6023149490356445,
      0.3703984320163727,
      -0.4534052610397339,
      0.6362267136573792,
      -0.2131541222333908,
      0.22255279123783112,
      -0.4554995000362396,
      0.4185689389705658,
      -0.7717312574386597,
      0.4567910134792328,
      -0.045639652758836746,
      0.8573496341705322,
      0.6037982702255249,
      -0.10069549083709717,
      -0.060826532542705536,
      -0.478996217250824,
      0.6335362792015076,
      0.8651453852653503,
      0.20728345215320587,
      0.7425758838653564,
      -0.2644984722137451,
      -0.4029059112071991,
      0.105094313621521,
      0.22094112634658813,
      1.0170598030090332,
      0.39446306228637695,
      0.07298644632101059,
      -0.21820536255836487,
      -0.250532329082489,
      1.577858805656433,
      -0.6021776795387268,
      0.1390092968940735,
      0.6664953827857971,
      0.10216265171766281,
      -0.06582240760326385,
      -0.21375642716884613,
      0.563329815864563,
      -0.24279823899269104,
      -0.05226648971438408,
      -0.03784831985831261,
      -0.39635342359542847,
      0.7292592525482178,
      -0.7627866268157959,
      0.3335125744342804,
      0.7682599425315857,
      -0.5030449628829956,
      0.44922804832458496,
      0.6773450374603271,
      0.08513437956571579,
      -1.7892478704452515,
      -1.1728339195251465,
      0.693936824798584,
      0.1805778443813324,
      0.24307838082313538,
      -0.5142199993133545,
      0.7049816250801086,
      0.5434614419937134,
      -0.13950933516025543,
      1.004576325416565,
      -0.7972216606140137,
      -1.0243107080459595,
      -0.3927728831768036,
      -1.5070269107818604,
      -0.35111314058303833,
      0.6994708180427551,
      0.4724368453025818,
      -0.7132580876350403,
      0.20610970258712769,
      0.38465285301208496,
      0.1587718278169632,
      -0.25469058752059937,
      0.14736415445804596,
      0.9127066135406494,
      -0.2331012487411499,
      0.1670929491519928,
      1.057074785232544,
      1.5614911317825317,
      -0.2105683833360672,
      0.6793413758277893,
      0.04705790802836418,
      0.5543373823165894,
      -0.146172434091568,
      0.961820125579834,
      0.26935330033302307,
      0.4091315269470215,
      -0.6098489761352539,
      0.14228548109531403,
      0.24917547404766083,
      -0.3781965374946594,
      0.5613411664962769,
      0.2739616632461548,
      0.12063701450824738,
      -0.9263640642166138,
      0.6691253781318665,
      -1.525310754776001,
      0.3600670397281647,
      0.44020020961761475,
      -1.1111358404159546,
      -0.07131222635507584,
      0.011172029189765453,
      0.9183015823364258,
      0.38029879331588745,
      0.7531633973121643,
      -0.7333351969718933,
      -0.031238345429301262,
      1.1382514238357544,
      0.28465938568115234,
      -0.7863678336143494,
      -0.6430792212486267,
      -0.3466974198818207,
      0.7213525176048279,
      -0.6151092052459717,
      0.3683573603630066,
      -0.6096379160881042,
      0.26992446184158325,
      -0.11499988287687302,
      -1.4586864709854126,
      -0.0708506777882576,
      0.6243889331817627,
      -0.7510756850242615,
      0.11203888058662415,
      -0.35082995891571045,
      -0.17271515727043152,
      -0.36505818367004395,
      -0.11934075504541397,
      -0.005684393923729658,
      0.05503436550498009,
      0.013702258467674255,
      -0.06380413472652435,
      -1.281050443649292,
      1.0989420413970947,
      0.015217795968055725,
      0.38106608390808105,
      1.5119749307632446,
      -0.5947640538215637,
      -1.0662785768508911,
      0.07993349432945251,
      0.49329477548599243,
      -0.47078368067741394,
      0.2640463709831238,
      0.36669984459877014,
      0.09352940320968628,
      0.11522731184959412,
      1.6329869031906128,
      0.30921459197998047,
      -2.2344470024108887,
      -0.4674772620201111,
      0.8086397647857666,
      0.5560384392738342,
      0.416866660118103,
      0.005990023259073496,
      -0.31614649295806885,
      0.3025324046611786,
      0.4124425947666168,
      -0.506969153881073,
      0.8328070044517517,
      0.43121448159217834,
      -0.07970462739467621,
      -0.7858062982559204,
      -0.8661985397338867,
      0.7409794926643372,
      -0.2186024934053421,
      1.429839015007019,
      -0.6619051694869995,
      -0.9776814579963684,
      0.735085666179657,
      -0.6363118886947632,
      -0.2762368619441986,
      0.6387152671813965,
      0.3052147924900055,
      1.962971568107605,
      -0.2772374153137207,
      -0.10327282547950745,
      0.364728718996048,
      -0.12673752009868622,
      -0.023503778502345085,
      -0.5992246270179749,
      1.0211799144744873,
      -1.1023725271224976,
      0.054662708193063736,
      0.11672105640172958,
      -1.520493745803833,
      0.683022141456604,
      -0.5714148283004761,
      0.655826985836029,
      0.8945344090461731,
      -0.4116427004337311,
      -0.48211896419525146,
      0.08040330559015274,
      0.09070669114589691,
      -0.16808180510997772,
      0.3271488547325134,
      -0.40445664525032043,
      -0.2644018232822418,
      0.5144219994544983,
      0.7415046095848083,
      0.6414965391159058,
      -1.5972819328308105,
      -1.1463639736175537,
      -0.28727924823760986,
      -0.8251875638961792,
      1.2302703857421875,
      0.578774631023407,
      0.13055405020713806,
      0.6426273584365845,
      0.38384151458740234,
      0.5159069895744324,
      0.10010125488042831,
      -0.8216657042503357,
      -0.1339082419872284,
      0.5735796093940735,
      0.09413082152605057,
      -0.005699182394891977,
      0.9690483808517456,
      -0.14159299433231354,
      -0.4781012535095215,
      0.14711229503154755,
      0.08353658020496368,
      0.07221575081348419,
      -0.47825413942337036,
      0.5572121739387512,
      -0.43991515040397644,
      0.7777925133705139,
      -0.14241144061088562,
      -0.7670832276344299,
      -0.4425434470176697,
      0.5716355443000793,
      -0.1878427416086197,
      0.0523676872253418,
      0.41778916120529175,
      -0.24654936790466309,
      -1.1948851346969604,
      0.447598934173584,
      0.23708082735538483,
      -0.0468578077852726,
      0.2973936200141907,
      0.006374484859406948,
      -0.1621951311826706,
      -0.10795562714338303,
      -0.9131931066513062,
      -0.7381099462509155,
      -0.035871900618076324,
      0.8073869943618774,
      -1.7503364086151123,
      0.22905822098255157,
      -0.4538067877292633,
      -0.09512823075056076,
      0.040777672082185745,
      -1.5661243200302124,
      0.022446565330028534,
      -0.11430761963129044,
      -0.30216801166534424,
      -0.6768325567245483,
      1.0155439376831055,
      0.16596382856369019,
      -0.45826682448387146,
      0.16504809260368347,
      0.877143144607544,
      0.3342902660369873,
      -0.13693659007549286,
      -0.19182032346725464,
      0.43728378415107727,
      -0.12304528057575226,
      0.5085864663124084,
      0.785430371761322,
      -1.3309613466262817,
      0.037307605147361755,
      -0.9194557666778564,
      0.63777095079422,
      -0.9468051195144653,
      0.4755430519580841,
      -0.8300274014472961,
      -0.9715613722801208,
      -0.43150192499160767,
      -0.8968313932418823,
      -0.29453688859939575,
      -1.2411267757415771,
      0.7837279438972473,
      1.7999532222747803,
      -0.7081097960472107,
      -0.23948578536510468,
      -0.594815194606781,
      -0.34476524591445923,
      0.30637481808662415,
      0.32055985927581787,
      0.21390044689178467,
      -0.7485775947570801,
      -0.8423203229904175,
      0.13129264116287231,
      -0.0323353111743927,
      -0.7702197432518005,
      0.6383410096168518,
      0.4719034731388092,
      -0.1700368970632553,
      -0.814845860004425,
      -0.7050812840461731,
      0.5210079550743103,
      -1.7405359745025635,
      0.2195446491241455,
      0.30777931213378906,
      -0.034077856689691544,
      0.39224952459335327,
      0.7110102772712708,
      -0.8863164186477661,
      -0.1436251848936081,
      0.024255434051156044,
      -1.032192587852478,
      -0.08399570733308792,
      1.2061810493469238,
      -0.323476642370224,
      0.3059139549732208,
      -0.030932839959859848,
      -0.706204891204834,
      0.3706350028514862,
      0.051552243530750275,
      -1.5392794609069824,
      -0.2488291710615158,
      0.5317907929420471,
      1.3357582092285156,
      -2.1268045902252197,
      0.701241672039032,
      1.0652375221252441,
      -0.8312509059906006,
      0.28269317746162415,
      -0.4437883198261261,
      0.44516560435295105,
      -0.13786257803440094,
      -0.008445757441222668,
      0.03588894382119179,
      0.5773144960403442,
      0.009981734678149223,
      -1.0778454542160034,
      0.5905839204788208,
      0.1523394137620926,
      -0.8920871019363403,
      -0.37181439995765686,
      -0.40932905673980713,
      -0.7560213804244995,
      1.1201496124267578,
      -0.9185236096382141,
      0.7052276730537415,
      -0.5312795639038086,
      -1.4519569873809814,
      -0.4733501672744751,
      0.6190128922462463,
      0.5190791487693787,
      -1.4817392826080322,
      0.014252752996981144,
      -1.5156872272491455,
      -0.015546769835054874,
      -0.7875946164131165,
      2.096282958984375,
      -0.19710706174373627,
      1.1724824905395508,
      0.8820160031318665,
      -0.2524350583553314,
      0.6177057027816772,
      0.44291210174560547,
      -0.5553330183029175,
      0.3250093460083008,
      -0.5475665330886841,
      -0.08238142728805542,
      0.5850069522857666,
      0.2138427048921585,
      0.2855403423309326,
      -0.4747259318828583,
      1.374359369277954,
      0.9830911159515381,
      0.0809130147099495,
      -0.2989234924316406,
      0.4670821726322174,
      -0.41663655638694763,
      0.39631709456443787,
      -0.49211058020591736,
      -0.8604623079299927,
      -0.08202140778303146,
      0.4970424771308899,
      -0.29272404313087463,
      -0.5767715573310852,
      -0.3444655239582062,
      1.0736620426177979,
      -0.04115060716867447,
      -0.09134972840547562,
      -0.18558701872825623,
      -0.3132420480251312,
      -0.11413928121328354,
      0.7316470146179199,
      1.1055071353912354,
      -0.6863204836845398,
      0.8043412566184998,
      0.4256882965564728,
      0.053207412362098694,
      0.8249130249023438,
      1.1540523767471313,
      -0.20951859652996063,
      -0.07290606200695038,
      1.107980489730835,
      0.15559600293636322,
      0.7166468501091003,
      0.43638989329338074,
      -0.03926622122526169,
      -1.2465336322784424,
      0.671708881855011,
      -1.0856610536575317,
      -0.15785548090934753,
      -0.013917448930442333,
      -0.3580460846424103,
      0.5596948862075806,
      0.8525515794754028,
      -0.3717173635959625,
      -0.16216042637825012,
      0.32277122139930725,
      0.5751541256904602,
      -1.051760196685791,
      0.09132003039121628,
      0.5245859622955322,
      0.13050466775894165,
      -0.031012721359729767,
      -0.16112126410007477,
      -0.05139727145433426,
      0.1664029210805893,
      -0.061465684324502945,
      0.3762262761592865,
      -0.31606048345565796,
      0.02733229473233223,
      -0.10331008583307266,
      -0.024244949221611023,
      0.2314559817314148,
      -0.2655395567417145,
      0.8278676271438599,
      -0.9246341586112976,
      0.9387668371200562,
      0.8603088855743408,
      -0.48952436447143555,
      -0.4806498885154724,
      -0.6583572030067444,
      -0.02612222358584404,
      -0.43070587515830994,
      -0.6436999440193176,
      0.5076135993003845,
      -0.2849152982234955,
      -0.20119431614875793,
      -0.02574947476387024,
      -0.0529288649559021,
      -0.38036981225013733,
      0.16724592447280884,
      -1.397841215133667,
      -0.20697425305843353,
      -1.0168285369873047,
      0.9779670834541321,
      -0.3087894916534424,
      0.1949830800294876,
      -1.3492040634155273,
      -0.5827359557151794,
      -0.900883674621582,
      0.10321015864610672,
      -1.1749778985977173,
      0.42682313919067383,
      0.31833043694496155,
      0.4713245630264282,
      -0.5034213662147522,
      -0.5184009671211243,
      -1.027788758277893,
      1.5096275806427002,
      -0.1911972612142563,
      -0.03565889596939087,
      0.3129890561103821,
      -0.7159296274185181,
      -0.8838949203491211,
      0.26309940218925476,
      -0.6979724764823914,
      0.13572958111763,
      -0.2768141031265259,
      0.935825765132904,
      0.7144461870193481,
      0.40919291973114014,
      0.09747443348169327,
      -0.08723300695419312,
      -0.25931331515312195,
      0.5455551147460938,
      0.15476107597351074,
      -1.1359925270080566,
      0.7542238235473633,
      -0.23754020035266876
    ],
    "label": {
      "level1": "SAM",
      "level2": "BET",
      "level3": "IC-1",
      "leafContractCategory": "IC-1",
      "rootCause": "Unacceptable Input Value",
      "effect": "Crash",
      "mlLibrary": "Keras",
      "contractViolationLocation": "Load",
      "detectionTechnique": "Static",
      "reasonsForNotLabeling": "0",
      "reasonsForLabeling": ""
    }
  }
]